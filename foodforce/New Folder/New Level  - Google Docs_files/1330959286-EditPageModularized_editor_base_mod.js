function e(a){throw a;}var g=true,i=null,j=false,n,aa=[];function ba(a){return function(){return aa[a].apply(this,arguments)}};var ca=ca||{},da=this;function o(a,b,c){a=a.split(".");c=c||da;!(a[0]in c)&&c.execScript&&c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)if(!a.length&&b!==undefined)c[d]=b;else c=c[d]?c[d]:(c[d]={})}function ea(a,b){a=a.split(".");b=b||da;for(var c;c=a.shift();)if(b[c])b=b[c];else return i;return b}function fa(){}function ga(a){a.Fa=function(){return a.oW||(a.oW=new a)}}
function ha(a){var b=typeof a;if(b=="object")if(a){if(a instanceof Array||!(a instanceof Object)&&Object.prototype.toString.call(a)=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(!(a instanceof Object)&&(Object.prototype.toString.call(a)=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call")))return"function"}else return"null";
else if(b=="function"&&typeof a.call=="undefined")return"object";return b}function ia(a){return ha(a)=="array"}function ja(a){var b=ha(a);return b=="array"||b=="object"&&typeof a.length=="number"}function q(a){return typeof a=="string"}function ka(a){return typeof a=="number"}function la(a){return ha(a)=="function"}function ma(a){a=ha(a);return a=="object"||a=="array"||a=="function"}function r(a){if(a.hasOwnProperty&&a.hasOwnProperty(na))return a[na];a[na]||(a[na]=++oa);return a[na]}
var na="closure_hashCode_"+Math.floor(Math.random()*2147483648).toString(36),oa=0;function pa(a){var b=ha(a);if(b=="object"||b=="array"){if(a.Sa)return a.Sa.call(a);b=b=="array"?[]:{};for(var c in a)b[c]=pa(a[c]);return b}return a}function u(a,b){var c=b||da;if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return function(){var f=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(f,d);return a.apply(c,f)}}else return function(){return a.apply(c,arguments)}}
function qa(a){var b=Array.prototype.slice.call(arguments,1);return function(){var c=Array.prototype.slice.call(arguments);c.unshift.apply(c,b);return a.apply(this,c)}}var v=Date.now||function(){return+new Date};function w(a,b){function c(){}c.prototype=b.prototype;a.c=b.prototype;a.prototype=new c;a.prototype.constructor=a}Function.prototype.bind=function(a){if(arguments.length>1){var b=Array.prototype.slice.call(arguments,1);b.unshift(this,a);return u.apply(i,b)}else return u(this,a)};
Function.prototype.Gb=function(a){w(this,a)};var ra={},x,sa;function ta(a,b){return a.lastIndexOf(b,0)==0}function ua(a,b){var c=a.length-b.length;return c>=0&&a.indexOf(b,c)==c}function va(a){for(var b=1;b<arguments.length;b++){var c=String(arguments[b]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,c)}return a}function wa(a){return a.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")}function xa(a){return/^[\s\xa0]*$/.test(a)}function ya(a){return!/[^\t\n\r ]/.test(a)}function za(a){return a.replace(/(\r\n|\r|\n)+/g," ")}
function Aa(a){return a.replace(/\xa0|[ \t]+/g," ")}function Ba(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function Ca(a){return a.replace(/^[\s\xa0]+/,"")}var Da=/^[a-zA-Z0-9\-_.!~*'()]*$/;function Fa(a){a=String(a);if(!Da.test(a))return encodeURIComponent(a);return a}function Ga(a){return decodeURIComponent(a.replace(/\+/g," "))}
function Ha(a,b){if(b)return a.replace(Ia,"&amp;").replace(Ja,"&lt;").replace(Ka,"&gt;").replace(La,"&quot;");else{if(!Ma.test(a))return a;if(a.indexOf("&")!=-1)a=a.replace(Ia,"&amp;");if(a.indexOf("<")!=-1)a=a.replace(Ja,"&lt;");if(a.indexOf(">")!=-1)a=a.replace(Ka,"&gt;");if(a.indexOf('"')!=-1)a=a.replace(La,"&quot;");return a}}var Ia=/&/g,Ja=/</g,Ka=/>/g,La=/\"/g,Ma=/[&<>\"]/;function Na(a){if(a.indexOf("&")!=-1)return"document"in da&&a.indexOf("<")==-1?Oa(a):Pa(a);return a}
function Oa(a){var b=da.document.createElement("a");b.innerHTML=a;b.normalize&&b.normalize();a=b.firstChild.nodeValue;b.innerHTML="";return a}function Pa(a){return a.replace(/&([^;]+);/g,function(b,c){switch(c){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:if(c.charAt(0)=="#"){c=Number("0"+c.substr(1));if(!isNaN(c))return String.fromCharCode(c)}return b}})}
function Qa(a,b){for(var c=b.length,d=0;d<c;d++){var f=c==1?b:b.charAt(d);if(a.charAt(0)==f&&a.charAt(a.length-1)==f)return a.substring(1,a.length-1)}return a}function Sa(a,b,c){if(c)a=Na(a);if(a.length>b){var d=Math.floor(b/2),f=a.length-d;d+=b%2;a=a.substring(0,d)+"..."+a.substring(f)}if(c)a=Ha(a);return a}var Ta={"\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\u000b":"\\x0B",'"':'\\"',"'":"\\'","\\":"\\\\"};
function Ua(a){a=String(a);if(a.quote)return a.quote();else{for(var b=['"'],c=0;c<a.length;c++)b[c+1]=Va(a.charAt(c));b.push('"');return b.join("")}}function Va(a){if(a in Ta)return Ta[a];var b=a,c=a.charCodeAt(0);if(c>31&&c<127)b=a;else{if(c<256){b="\\x";if(c<16||c>256)b+="0"}else{b="\\u";if(c<4096)b+="0"}b+=c.toString(16).toUpperCase()}return Ta[a]=b}
function Wa(a,b,c){a=c!==undefined?a.toFixed(c):String(a);c=a.indexOf(".");if(c==-1)c=a.length;b=Math.max(0,b-c);return(new Array(b+1)).join("0")+a}function Xa(a){return a==i?"":String(a)}function Ya(){return Array.prototype.join.call(arguments,"")}function $a(){return Math.floor(Math.random()*2147483648).toString(36)+(Math.floor(Math.random()*2147483648)^v()).toString(36)}
function ab(a,b){var c=0;a=Ba(String(a)).split(".");b=Ba(String(b)).split(".");for(var d=Math.max(a.length,b.length),f=0;c==0&&f<d;f++){var h=a[f]||"",k=b[f]||"",l=new RegExp("(\\d*)(\\D*)","g"),m=new RegExp("(\\d*)(\\D*)","g");do{var p=l.exec(h)||["","",""],t=m.exec(k)||["","",""];if(p[0].length==0&&t[0].length==0)break;c=p[1].length==0?0:parseInt(p[1],10);var s=t[1].length==0?0:parseInt(t[1],10);c=bb(c,s)||bb(p[2].length==0,t[2].length==0)||bb(p[2],t[2])}while(c==0)}return c}
function bb(a,b){if(a<b)return-1;else if(a>b)return 1;return 0}var cb=Math.random()*2147483648|0;function db(){return"goog_"+cb++};var eb={};function fb(a){this.stack=(new Error).stack||"";if(a)this.message=String(a)}w(fb,Error);fb.prototype.name="CustomError";function gb(a,b){b.unshift(a);fb.call(this,va.apply(i,b));b.shift();this.P4=a}w(gb,fb);gb.prototype.name="AssertionError";function hb(a,b,c,d){var f="Assertion failed";if(c){f+=": "+c;var h=d}else if(a){f+=": "+a;h=b}e(new gb(""+f,h||[]))}function ib(a,b){!a&&hb("",i,b,Array.prototype.slice.call(arguments,2))};var jb=i;function kb(){ib(!!jb,"No instance set");return jb};var lb="",mb="",nb="",ob=i,pb="",rb=0,sb=0,tb=0;function ub(a){a=a||vb.Ph();if(pb==a){rb=tb;sb=Math.min(wb,sb);try{kb().ts(j)}catch(b){rce("writely.DocumentState.hasPendingChangesSlow",b)}return j}return g}function xb(a,b){b=b||v();var c=sb;return!!c&&b-c<a}function yb(a,b,c,d){a||zb("Missing Rev ID in UpdateRevisionInfo");q(b)||zb("bad content: "+b);if(b==i)b="";lb=a;nb=b;ob=c;Ab(d);if(a=Bb())a.document.body.innerHTML=b}function Ab(a){pb=typeof a=="string"?a:vb.Ph()}
function Cb(a){return a.replace(/"/g,"&quot;").replace(/'/g,"&apos;")};var Db=j;function Eb(a){a=String(a);if(/^\s*$/.test(a)?j:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x10-\x1f\x80-\x9f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}e(Error("Invalid JSON string: "+a))}function Fb(a){return eval("("+a+")")}function Gb(a){return(new Hb).ls(a)}function Hb(){}Hb.prototype.ls=function(a){var b=[];this.jz(a,b);return b.join("")};
Hb.prototype.jz=function(a,b){switch(typeof a){case "string":this.vK(a,b);break;case "number":this.T_(a,b);break;case "boolean":b.push(a);break;case "undefined":b.push("null");break;case "object":if(a==i){b.push("null");break}if(ia(a)){this.R_(a,b);break}this.U_(a,b);break;case "function":break;default:e(Error("Unknown type: "+typeof a))}};
var Ib={'"':'\\"',"\\":"\\\\","/":"\\/","\u0008":"\\b","\u000c":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\u000b":"\\u000b"},Jb=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;Hb.prototype.vK=function(a,b){b.push('"',a.replace(Jb,function(c){if(c in Ib)return Ib[c];var d=c.charCodeAt(0),f="\\u";if(d<16)f+="000";else if(d<256)f+="00";else if(d<4096)f+="0";return Ib[c]=f+d.toString(16)}),'"')};Hb.prototype.T_=function(a,b){b.push(isFinite(a)&&!isNaN(a)?a:"null")};
Hb.prototype.R_=function(a,b){var c=a.length;b.push("[");for(var d="",f=0;f<c;f++){b.push(d);this.jz(a[f],b);d=","}b.push("]")};Hb.prototype.U_=function(a,b){b.push("{");var c="";for(var d in a)if(a.hasOwnProperty(d)){var f=a[d];if(typeof f!="function"){b.push(c);this.vK(d,b);b.push(":");this.jz(f,b);c=","}}b.push("}")};function Kb(a){return a[a.length-1]}var Lb=Array.prototype,Mb=Lb.indexOf?function(a,b,c){return Lb.indexOf.call(a,b,c)}:function(a,b,c){c=c==i?0:c<0?Math.max(0,a.length+c):c;if(q(a)){if(!q(b)||b.length!=1)return-1;return a.indexOf(b,c)}for(c=c;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Nb=Lb.forEach?function(a,b,c){Lb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=q(a)?a.split(""):a,h=0;h<d;h++)h in f&&b.call(c,f[h],h,a)};
function Ob(a,b,c){var d=a.length,f=q(a)?a.split(""):a;for(d=d-1;d>=0;--d)d in f&&b.call(c,f[d],d,a)}var Pb=Lb.filter?function(a,b,c){return Lb.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=[],h=0,k=q(a)?a.split(""):a,l=0;l<d;l++)if(l in k){var m=k[l];if(b.call(c,m,l,a))f[h++]=m}return f},Qb=Lb.map?function(a,b,c){return Lb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=new Array(d),h=q(a)?a.split(""):a,k=0;k<d;k++)if(k in h)f[k]=b.call(c,h[k],k,a);return f};
function Rb(a,b,c,d){if(a.reduce)return d?a.reduce(u(b,d),c):a.reduce(b,c);var f=c;Nb(a,function(h,k){f=b.call(d,f,h,k,a)});return f}var Sb=Lb.some?function(a,b,c){return Lb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=q(a)?a.split(""):a,h=0;h<d;h++)if(h in f&&b.call(c,f[h],h,a))return g;return j},Tb=Lb.every?function(a,b,c){return Lb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,f=q(a)?a.split(""):a,h=0;h<d;h++)if(h in f&&!b.call(c,f[h],h,a))return j;return g};
function Ub(a,b,c){a:{for(var d=a.length,f=q(a)?a.split(""):a,h=0;h<d;h++)if(h in f&&b.call(c,f[h],h,a)){b=h;break a}b=-1}return b<0?i:q(a)?a.charAt(b):a[b]}function Vb(a,b){return Mb(a,b)>=0}function Wb(a){if(!ia(a))for(var b=a.length-1;b>=0;b--)delete a[b];a.length=0}function Xb(a,b){b=Mb(a,b);var c;if(c=b>=0)Yb(a,b);return c}function Yb(a,b){return Lb.splice.call(a,b,1).length==1}function Zb(){return Lb.concat.apply(Lb,arguments)}
function $b(a){if(ia(a))return Zb(a);else{for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}}function ac(a){if(ia(a))return Zb(a);return $b(a)}function bc(a){for(var b=1;b<arguments.length;b++){var c=arguments[b],d;if(ia(c)||(d=ja(c))&&c.hasOwnProperty("callee"))a.push.apply(a,c);else if(d)for(var f=a.length,h=c.length,k=0;k<h;k++)a[f+k]=c[k];else a.push(c)}}function cc(a){return Lb.splice.apply(a,dc(arguments,1))}
function dc(a,b,c){return arguments.length<=2?Lb.slice.call(a,b):Lb.slice.call(a,b,c)}function ec(a,b,c){var d=0,f=a.length-1;for(c=c||fc;d<=f;){var h=d+f>>1,k=c(b,a[h]);if(k>0)d=h+1;else if(k<0)f=h-1;else return h}return-(d+1)}function fc(a,b){return a>b?1:a<b?-1:0};var gc="StopIteration"in da?da.StopIteration:Error("StopIteration");function hc(){}hc.prototype.next=function(){e(gc)};hc.prototype.Vf=function(){return this};function kc(a){if(a instanceof hc)return a;if(typeof a.Vf=="function")return a.Vf(j);if(ja(a)){var b=0,c=new hc;c.next=function(){for(;;){if(b>=a.length)e(gc);if(b in a)return a[b++];else b++}};return c}e(Error("Not implemented"))}
function lc(a,b,c){if(ja(a))try{Nb(a,b,c)}catch(d){if(d!==gc)e(d)}else{a=kc(a);try{for(;;)b.call(c,a.next(),undefined,a)}catch(f){if(f!==gc)e(f)}}}function mc(a,b,c){a=kc(a);var d=new hc;d.next=function(){for(;;){var f=a.next();if(b.call(c,f,undefined,a))return f}};return d}function nc(a,b,c){a=kc(a);try{for(;;)if(b.call(c,a.next(),undefined,a))return g}catch(d){if(d!==gc)e(d)}return j}
function oc(){var a=arguments,b=a.length,c=0,d=new hc;d.next=function(){try{if(c>=b)e(gc);return kc(a[c]).next()}catch(f){if(f!==gc||c>=b)e(f);else{c++;return this.next()}}};return d};function pc(a,b,c){for(var d in a)b.call(c,a[d],d,a)}function qc(a){var b=[],c=0;for(var d in a)b[c++]=a[d];return b}function rc(a){var b=[],c=0;for(var d in a)b[c++]=d;return b}function sc(a,b){for(var c in a)if(a[c]==b)return g;return j}function tc(a){for(var b in a)return j;return g}function uc(a,b){var c;if(c=b in a)delete a[b];return c}function xc(a,b,c){if(b in a)e(Error('The object already contains the key "'+b+'"'));a[b]=c}function yc(a,b,c){if(b in a)return a[b];return c}
function zc(a){var b={};for(var c in a)b[c]=a[c];return b}function Ac(a){var b={};for(var c in a)b[a[c]]=c;return b}var Bc=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];function Cc(a){for(var b,c,d=1;d<arguments.length;d++){c=arguments[d];for(b in c)a[b]=c[b];for(var f=0;f<Bc.length;f++){b=Bc[f];if(Object.prototype.hasOwnProperty.call(c,b))a[b]=c[b]}}}
function Dc(){var a=arguments.length;if(a==1&&ia(arguments[0]))return Dc.apply(i,arguments[0]);if(a%2)e(Error("Uneven number of arguments"));for(var b={},c=0;c<a;c+=2)b[arguments[c]]=arguments[c+1];return b}function Ec(){var a=arguments.length;if(a==1&&ia(arguments[0]))return Ec.apply(i,arguments[0]);for(var b={},c=0;c<a;c++)b[arguments[c]]=g;return b};function Fc(a){if(typeof a.Kb=="function")return a.Kb();if(ja(a)||q(a))return a.length;var b=0;for(var c in a)b++;return b}function Gc(a){if(typeof a.Kc=="function")return a.Kc();if(q(a))return a.split("");if(ja(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return qc(a)}function Hc(a){if(typeof a.wi=="function")return a.wi();if(typeof a.Kc!="function"){if(ja(a)||q(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return rc(a)}}
function Ic(a,b){if(typeof a.contains=="function")return a.contains(b);if(typeof a.yu=="function")return a.yu(b);if(ja(a)||q(a))return Vb(a,b);return sc(a,b)}function Jc(a,b,c){if(typeof a.forEach=="function")a.forEach(b,c);else if(ja(a)||q(a))Nb(a,b,c);else for(var d=Hc(a),f=Gc(a),h=f.length,k=0;k<h;k++)b.call(c,f[k],d&&d[k],a)}
function Kc(a,b,c){if(typeof a.every=="function")return a.every(b,c);if(ja(a)||q(a))return Tb(a,b,c);for(var d=Hc(a),f=Gc(a),h=f.length,k=0;k<h;k++)if(!b.call(c,f[k],d&&d[k],a))return j;return g};function Mc(a){this.Hb={};this.Ia=[];var b=arguments.length;if(b>1){if(b%2)e(Error("Uneven number of arguments"));for(var c=0;c<b;c+=2)this.u(arguments[c],arguments[c+1])}else a&&this.To(a)}n=Mc.prototype;n.ja=0;n.Eo=0;n.Kb=function(){return this.ja};n.Kc=function(){this.im();for(var a=[],b=0;b<this.Ia.length;b++)a.push(this.Hb[this.Ia[b]]);return a};n.wi=function(){this.im();return this.Ia.concat()};n.Ce=function(a){return Nc(this.Hb,a)};
n.yu=function(a){for(var b=0;b<this.Ia.length;b++){var c=this.Ia[b];if(Nc(this.Hb,c)&&this.Hb[c]==a)return g}return j};n.Sd=function(a,b){if(this===a)return g;if(this.ja!=a.Kb())return j;b=b||Oc;this.im();for(var c,d=0;c=this.Ia[d];d++)if(!b(this.la(c),a.la(c)))return j;return g};function Oc(a,b){return a===b}n=Mc.prototype;n.Oe=function(){return this.ja==0};n.clear=function(){this.Hb={};this.Eo=this.ja=this.Ia.length=0};
n.remove=function(a){if(Nc(this.Hb,a)){delete this.Hb[a];this.ja--;this.Eo++;this.Ia.length>2*this.ja&&this.im();return g}return j};n.im=function(){if(this.ja!=this.Ia.length){for(var a=0,b=0;a<this.Ia.length;){var c=this.Ia[a];if(Nc(this.Hb,c))this.Ia[b++]=c;a++}this.Ia.length=b}if(this.ja!=this.Ia.length){var d={};for(b=a=0;a<this.Ia.length;){c=this.Ia[a];if(!Nc(d,c)){this.Ia[b++]=c;d[c]=1}a++}this.Ia.length=b}};n.la=function(a,b){if(Nc(this.Hb,a))return this.Hb[a];return b};
n.u=function(a,b){if(!Nc(this.Hb,a)){this.ja++;this.Ia.push(a);this.Eo++}this.Hb[a]=b};n.To=function(a){var b;if(a instanceof Mc){b=a.wi();a=a.Kc()}else{b=rc(a);a=qc(a)}for(var c=0;c<b.length;c++)this.u(b[c],a[c])};n.Sa=function(){return new Mc(this)};n.RL=ba(8);n.Vf=function(a){this.im();var b=0,c=this.Ia,d=this.Hb,f=this.Eo,h=this,k=new hc;k.next=function(){for(;;){if(f!=h.Eo)e(Error("The map has changed since the iterator was created"));if(b>=c.length)e(gc);var l=c[b++];return a?l:d[l]}};return k};
function Nc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var Pc=new RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([\\w\\d\\-\\u0100-\\uffff.%]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function Qc(a){return a.match(Pc)}function Rc(a,b){for(var c in b){var d=c,f=b[c];if(ia(f)){f=f;for(var h=0;h<f.length;h++)a.push("&",d,"=",Fa(f[h]))}else f!=i&&a.push("&",d,"=",Fa(f))}return a}function Sc(a){a=Rc([],a);a[0]="";return a.join("")};function Tc(a,b){var c;if(a instanceof Tc){this.sl(b==i?a.Af:b);this.ws(a.Kf);this.Bs(a.yj);this.ns(a.gi);this.us(a.xh);this.ul(a.Hf);this.vl(a.qc.Sa());this.ps(a.ri)}else if(a&&(c=Qc(String(a)))){this.sl(!!b);this.ws(c[1]||"",g);this.Bs(c[2]||"",g);this.ns(c[3]||"",g);this.us(c[4]);this.ul(c[5]||"",g);this.io(c[6]||"",g);this.ps(c[7]||"",g)}else{this.sl(!!b);this.qc=new Uc(i,this,this.Af)}}n=Tc.prototype;n.Kf="";n.yj="";n.gi="";n.xh=i;n.Hf="";n.ri="";n.LW=j;n.Af=j;
n.toString=function(){if(this.ye)return this.ye;var a=[];this.Kf&&a.push(Vc(this.Kf,Wc),":");if(this.gi){a.push("//");this.yj&&a.push(Vc(this.yj,Wc),"@");a.push(Xc(this.gi));this.xh!=i&&a.push(":",String(this.xh))}this.Hf&&a.push(Vc(this.Hf,Yc));var b=String(this.qc);b&&a.push("?",b);this.ri&&a.push("#",Vc(this.ri,Zc));return this.ye=a.join("")};
n.gj=function(a){var b=this.Sa(),c=a.iG();if(c)b.ws(a.Kf);else c=a.pV();if(c)b.Bs(a.yj);else c=a.eG();if(c)b.ns(a.gi);else c=a.lV();var d=a.Hf;if(c)b.us(a.xh);else if(c=a.gG()){if(d.charAt(0)!="/")if(this.eG()&&!this.gG())d="/"+d;else{var f=b.Hf.lastIndexOf("/");if(f!=-1)d=b.Hf.substr(0,f+1)+d}f=d;if(f==".."||f==".")d="";else if(f.indexOf("./")==-1&&f.indexOf("/.")==-1)d=f;else{d=ta(f,"/");f=f.split("/");for(var h=[],k=0;k<f.length;){var l=f[k++];if(l==".")d&&k==f.length&&h.push("");else if(l==".."){if(h.length>
1||h.length==1&&h[0]!="")h.pop();d&&k==f.length&&h.push("")}else{h.push(l);d=g}}d=h.join("/")}}if(c)b.ul(d);else c=a.mV();if(c)b.io(a.uS());else c=a.iV();c&&b.ps(a.ri);return b};n.Sa=function(){var a=this.Kf,b=this.yj,c=this.gi,d=this.xh,f=this.Hf,h=this.qc.Sa(),k=this.ri,l=new Tc(i,this.Af);a&&l.ws(a);b&&l.Bs(b);c&&l.ns(c);d&&l.us(d);f&&l.ul(f);h&&l.vl(h);k&&l.ps(k);return l};n.ws=function(a,b){this.hg();delete this.ye;if(this.Kf=b?$c(a):a)this.Kf=this.Kf.replace(/:$/,"");return this};n.iG=function(){return!!this.Kf};
n.Bs=function(a,b){this.hg();delete this.ye;this.yj=b?$c(a):a;return this};n.pV=function(){return!!this.yj};n.ns=function(a,b){this.hg();delete this.ye;this.gi=b?$c(a):a;return this};n.eG=function(){return!!this.gi};n.us=function(a){this.hg();delete this.ye;if(a){a=Number(a);if(isNaN(a)||a<0)e(Error("Bad port number "+a));this.xh=a}else this.xh=i;return this};n.lV=function(){return this.xh!=i};n.ul=function(a,b){this.hg();delete this.ye;this.Hf=b?$c(a):a;return this};n.gG=function(){return!!this.Hf};
n.mV=function(){return this.qc.toString()!==""};n.vl=function(a,b){this.hg();delete this.ye;if(a instanceof Uc){this.qc=a;this.qc.FA=this;this.qc.sl(this.Af)}else{b||(a=Vc(a,ad));this.qc=new Uc(a,this,this.Af)}return this};n.io=function(a,b){return this.vl(a,b)};n.GE=ba(16);n.uS=function(){return this.qc.W1()};n.vf=ba(3);n.$=function(a,b){this.hg();delete this.ye;this.qc.u(a,b);return this};n.fc=function(a){return this.qc.la(a)};n.ps=function(a,b){this.hg();delete this.ye;this.ri=b?$c(a):a;return this};
n.iV=function(){return!!this.ri};n.RH=function(){this.hg();this.$("zx",$a());return this};n.hg=function(){if(this.LW)e(Error("Tried to modify a read-only Uri"))};n.sl=function(a){this.Af=a;this.qc&&this.qc.sl(a)};function bd(a,b){return a instanceof Tc?a.Sa():new Tc(a,b)}function $c(a){return a?decodeURIComponent(a):""}function Xc(a){if(q(a))return encodeURIComponent(a);return i}var cd=/^[a-zA-Z0-9\-_.!~*'():\/;?]*$/;
function Vc(a,b){var c=i;if(q(a)){c=a;cd.test(c)||(c=encodeURI(a));if(c.search(b)>=0)c=c.replace(b,ed)}return c}function ed(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Wc=/[#\/\?@]/g,Yc=/[\#\?]/g,ad=/[\#\?@]/g,Zc=/#/g;function Uc(a,b,c){this.fg=a||i;this.FA=b||i;this.Af=!!c}
Uc.prototype.pf=function(){if(!this.ub){this.ub=new Mc;if(this.fg)for(var a=this.fg.split("&"),b=0;b<a.length;b++){var c=a[b].indexOf("="),d=i,f=i;if(c>=0){d=a[b].substring(0,c);f=a[b].substring(c+1)}else d=a[b];d=Ga(d);d=this.vi(d);this.add(d,f?Ga(f):"")}}};function fd(a,b,c){var d=Hc(a);if(typeof d=="undefined")e(Error("Keys are undefined"));return gd(d,Gc(a),b,c)}
function gd(a,b,c,d){if(a.length!=b.length)e(Error("Mismatched lengths for keys/values"));c=new Uc(i,c,d);for(d=0;d<a.length;d++)c.add(a[d],b[d]);return c}n=Uc.prototype;n.ub=i;n.ja=i;n.Kb=function(){this.pf();return this.ja};n.add=function(a,b){this.pf();this.mn();a=this.vi(a);if(this.Ce(a)){var c=this.ub.la(a);ia(c)?c.push(b):this.ub.u(a,[c,b])}else this.ub.u(a,b);this.ja++;return this};
n.remove=function(a){this.pf();a=this.vi(a);if(this.ub.Ce(a)){this.mn();var b=this.ub.la(a);if(ia(b))this.ja-=b.length;else this.ja--;return this.ub.remove(a)}return j};n.clear=function(){this.mn();this.ub&&this.ub.clear();this.ja=0};n.Oe=function(){this.pf();return this.ja==0};n.Ce=function(a){this.pf();a=this.vi(a);return this.ub.Ce(a)};n.yu=function(a){var b=this.Kc();return Vb(b,a)};
n.wi=function(){this.pf();for(var a=this.ub.Kc(),b=this.ub.wi(),c=[],d=0;d<b.length;d++){var f=a[d];if(ia(f))for(var h=0;h<f.length;h++)c.push(b[d]);else c.push(b[d])}return c};n.Kc=function(a){this.pf();if(a){a=this.vi(a);if(this.Ce(a)){var b=this.ub.la(a);if(ia(b))return b;else{a=[];a.push(b)}}else a=[]}else{b=this.ub.Kc();a=[];for(var c=0;c<b.length;c++){var d=b[c];ia(d)?bc(a,d):a.push(d)}}return a};
n.u=function(a,b){this.pf();this.mn();a=this.vi(a);if(this.Ce(a)){var c=this.ub.la(a);if(ia(c))this.ja-=c.length;else this.ja--}this.ub.u(a,b);this.ja++;return this};n.la=function(a,b){this.pf();a=this.vi(a);if(this.Ce(a)){a=this.ub.la(a);return ia(a)?a[0]:a}else return b};
n.toString=function(){if(this.fg)return this.fg;if(!this.ub)return"";for(var a=[],b=0,c=this.ub.wi(),d=0;d<c.length;d++){var f=c[d],h=Fa(f);f=this.ub.la(f);if(ia(f))for(var k=0;k<f.length;k++){b>0&&a.push("&");a.push(h,"=",Fa(f[k]));b++}else{b>0&&a.push("&");a.push(h,"=",Fa(f));b++}}return this.fg=a.join("")};n.W1=function(){if(!this.Qj)this.Qj=$c(this.toString());return this.Qj};n.mn=function(){delete this.Qj;delete this.fg;this.FA&&delete this.FA.ye};
n.Sa=function(){var a=new Uc;if(this.Qj)a.Qj=this.Qj;if(this.fg)a.fg=this.fg;if(this.ub)a.ub=this.ub.Sa();return a};n.vi=function(a){a=String(a);if(this.Af)a=a.toLowerCase();return a};n.sl=function(a){if(a&&!this.Af){this.pf();this.mn();Jc(this.ub,function(b,c){var d=c.toLowerCase();if(c!=d){this.remove(c);this.add(d,b)}},this)}this.Af=a};n.extend=function(){for(var a=0;a<arguments.length;a++)Jc(arguments[a],function(b,c){this.add(c,b)},this)};var hd,id,jd,kd,ld,md,nd;function od(){return da.navigator?da.navigator.userAgent:i}function pd(){return da.navigator}ld=kd=jd=id=hd=j;var qd;if(qd=od()){var rd=pd();hd=qd.indexOf("Opera")==0;id=!hd&&qd.indexOf("MSIE")!=-1;kd=(jd=!hd&&qd.indexOf("WebKit")!=-1)&&qd.indexOf("Mobile")!=-1;ld=!hd&&!jd&&rd.product=="Gecko"}var y=hd,z=id,B=ld,E=jd,sd=kd,td=pd(),ud=td&&td.platform||"";md=ud.indexOf("Mac")!=-1;nd=ud.indexOf("Win")!=-1;ud.indexOf("Linux")!=-1;
var vd=!!pd()&&(pd().appVersion||"").indexOf("X11")!=-1,wd="",xd;if(y&&da.opera){var yd=da.opera.version;wd=typeof yd=="function"?yd():yd}else{if(B)xd=/rv\:([^\);]+)(\)|;)/;else if(z)xd=/MSIE\s+([^\);]+)(\)|;)/;else if(E)xd=/WebKit\/(\S+)/;if(xd){var zd=xd.exec(od());wd=zd?zd[1]:""}}var Ad=wd,Bd={};function Cd(a){return Bd[a]||(Bd[a]=ab(Ad,a)>=0)};var Dd=i,Ed=i,Fd=i;function Gd(){Dd||(Dd=new Tc(window.location.href,g));return Dd}function Hd(){if(Ed)return Ed;return Ed=Gd().fc("docid")||Gd().fc("id")||WritelyDocVars.docId}function Id(){if(typeof ra.BS!="undefined")return ra.BS();return i}function F(a,b){if(Fd)Fd(a,b);else{window.alert(Jd(a));if(la(b))b();else if(b&&b.focus)b.focus();else b!==j&&"SetFocusBack"in window&&window.dB()}}function Kd(a,b){return window.prompt(Jd(a),Jd(b))}function Ld(a){return window.confirm(Jd(a))}
function Jd(a){a=String(a);a=a.replace(/&lt;/g,"<").replace(/&amp;/g,"&");return a=a.replace(/\0+/g,"")}o("writely.alert",F,void 0);o("writely.confirm",Ld,void 0);o("writely.prompt",Kd,void 0);o("writely.getDocId",Hd,void 0);function Md(a,b){a=a;b=b;if(a)if(b){if(b<0||b>=2147483647){a=$a()+(new Date).getTime().toString();b=0}}else b=0;else{a=$a()+(new Date).getTime().toString();b=0}this.NL=a;this.ja=b+1}Md.prototype.Kb=function(){return this.ja};Md.prototype.FW=function(){return this.ja==1};function G(a){if(WritelyVars[a]!=i)return String(WritelyVars[a]);var b=Id();if(b&&!b.he){b=b.v4(a);if(b!=i)return WritelyVars[a]=b}return i}function Nd(a){var b=Hd();if(WritelyDocVars[a]!=i)return String(WritelyDocVars[a]);var c=Id();if(c&&!c.he){b=c.t4(b,a);if(b!=i)return WritelyDocVars[a]=b}return i}var Od=/^\s*(true|1)\s*$/i,Pd=/^\s*(false|0)\s*$/i;function Qd(a){if(typeof a=="boolean")return a;if(!a)return i;if(Od.test(a))return g;if(Pd.test(a))return j;return i}
function Rd(a){if(typeof a=="number")return a;if(!a)return i;a=Number(a);return isNaN(a)?i:a}function H(a){return Qd(G(a))}function Sd(a){return Qd(Nd(a))}function Td(a){return Rd(Nd(a))}function Ud(a,b){b=b||b==j||b==0?String(b):"";WritelyVars[a]=b;var c=Id();c&&!c.he&&c.l5(a,b)}function Vd(a,b){var c=Hd();WritelyDocVars[a]=b;var d=Id();d&&!d.he&&d.i5(c,a,b)}function Wd(){var a=Id();return(a&&!a.he?a.s4(Hd()):WritelyDocVars.title)||""}
function Xd(){var a=Wd();return(a==G("untitledGlobal")?G("untitledLocal"):a)||""}function Yd(a){var b=Id();if(b)b.l2(Hd(),i,a);else WritelyDocVars.title=a}function Zd(a){var b=G("siteurl")||"";if(a.indexOf(b)==0)a=a.substring(b.length);else b="";var c=G("siteprefix");if(c&&a.indexOf(c)!=0){if(a&&a.indexOf("/")!=0)a="/"+a;return b+c+a}return b+a}o("writely.Vars",function(){},void 0);o("writely.Vars.getStringSiteVar",G,void 0);o("writely.Vars.getStringDocVar",Nd,void 0);
o("writely.Vars.getNumberDocVar",Td,void 0);o("writely.Vars.getDisplayTitle",Xd,void 0);var wb=IS_GEARS?0:v(),$d=i,ae=0,be=j,ce=0,de=j;function ee(){de=g}function fe(){ce=v()}
function ie(){try{if(!be&&!je("postDocContents_"+Hd())&&!(ke||Db)&&de){var a=v(),b;if(ce)b=g;else{var c=$d;b=c!=i&&v()-c<3E5}c=b?15E3:8E4;var d=b?1E4:9E4,f=ae,h=xb(b?2500:5E3,a);if(f&&a-f>=d)h=j;var k;k=rb==tb?j:ub();try{kb().ts(k)}catch(l){rce("writely.Heartbeat.doPostBackAsNecessary_",l)}var m;b=(b=a)||v();m=b-wb;var p=m>=c&&(Sd("isshared")||k);if(!p){var t=Rd(G("refresh_interval_slow"));p=m>=t}if(p&&!h){(new le(i,g,j,i)).send();ae=0}else if(p&&h)ae=a}}catch(s){me("Sorry, your changes have NOT been saved. To avoid losing your changes, copy the text to the clipboard, refresh the page, then paste the text back in the document. Please also try the troubleshooting steps in the article below:<br/><a target='_blank' href='http://docs.google.com/support/bin/answer.py?answer=157631'>http://docs.google.com/support/bin/answer.py?answer=157631</a> [4]",
j,j);rce("writely.Heartbeat.startHeartbeat",s)}window.setTimeout(u(ie,window),2E3)};function ne(a){this.Ju=a}n=ne.prototype;n.$r=i;n.Vi=i;n.ja=0;n.eb=function(a){if(typeof this.Ju=="number")if(!a||a<=this.Ju||typeof this.Vi=="number"&&this.Vi!=a)this.r_();else{this.Vi=a;++this.ja;if(!this.$r)this.$r=v()}};n.MW=function(){if(typeof this.Ju!="number")return j;if(this.ja<3)return j;return!xb(6E5)||v()-this.$r>36E5};n.r_=function(){this.Vi=i;this.ja=0;this.$r=i};function oe(a,b){this.x=a!==undefined?a:0;this.y=b!==undefined?b:0}oe.prototype.Sa=function(){return new oe(this.x,this.y)};oe.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function pe(a,b){return new oe(a.x-b.x,a.y-b.y)};function qe(a,b){this.width=a;this.height=b}function re(a,b){if(a==b)return g;if(!a||!b)return j;return a.width==b.width&&a.height==b.height}n=qe.prototype;n.Sa=function(){return new qe(this.width,this.height)};n.toString=function(){return"("+this.width+" x "+this.height+")"};n.DN=function(){return this.width*this.height};n.Oe=function(){return!this.DN()};n.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};
n.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};n.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};var se={},te;function ue(a,b){a.className=b}function ve(a){return(a=a.className)&&typeof a.split=="function"?a.split(/\s+/):[]}function I(a){var b=ve(a),c=dc(arguments,1);c=we(b,c);a.className=b.join(" ");return c}function xe(a){var b=ve(a),c=dc(arguments,1);c=ye(b,c);a.className=b.join(" ");return c}function we(a,b){for(var c=0,d=0;d<b.length;d++)if(!Vb(a,b[d])){a.push(b[d]);c++}return c==b.length}function ye(a,b){for(var c=0,d=0;d<a.length;d++)if(Vb(b,a[d])){cc(a,d--,1);c++}return c==b.length}
function ze(a,b,c){for(var d=ve(a),f=j,h=0;h<d.length;h++)if(d[h]==b){cc(d,h--,1);f=g}if(f){d.push(c);a.className=d.join(" ")}return f}function Ae(a,b,c){var d=ve(a);if(q(b))Xb(d,b);else ia(b)&&ye(d,b);if(q(c)&&!Vb(d,c))d.push(c);else ia(c)&&we(d,c);a.className=d.join(" ")}function Be(a,b){return Vb(ve(a),b)}function Ce(a,b,c){c?I(a,b):xe(a,b)};var De="A";function J(a){return a?new Ee(Fe(a)):te||(te=new Ee)}function Ge(a){return q(a)?document.getElementById(a):a}var O=Ge;function He(a,b,c){return Ie(document,a,b,c)}
function Ie(a,b,c,d){d=d||a;b=b&&b!="*"?b.toUpperCase():"";if(d.querySelectorAll&&(b||c)&&(!E||Je(a)||Cd("528")))return d.querySelectorAll(b+(c?"."+c:""));if(c&&d.getElementsByClassName){a=d.getElementsByClassName(c);if(b){d={};for(var f=0,h=0,k;k=a[h];h++)if(b==k.nodeName)d[f++]=k;d.length=f;return d}else return a}a=d.getElementsByTagName(b||"*");if(c){d={};for(h=f=0;k=a[h];h++){b=k.className;if(typeof b.split=="function"&&Vb(b.split(/\s+/),c))d[f++]=k}d.length=f;return d}else return a}
function Ke(a,b){pc(b,function(c,d){if(d=="style")a.style.cssText=c;else if(d=="class")a.className=c;else if(d=="for")a.htmlFor=c;else if(d in Le)a.setAttribute(Le[d],c);else a[d]=c})}var Le={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",type:"type"};
function Me(a){a=a||window;var b=a.document;if(E&&!Cd("500")&&!sd){if(typeof a.innerHeight=="undefined")a=window;b=a.innerHeight;var c=a.document.documentElement.scrollHeight;if(a==a.top)if(c<b)b-=15;a=new qe(a.innerWidth,b)}else{a=Je(b)&&(!y||y&&Cd("9.50"))?b.documentElement:b.body;a=new qe(a.clientWidth,a.clientHeight)}return a}function Ne(a){return a?a.parentWindow||a.defaultView:window}function Oe(){return Pe(document,arguments)}
function Pe(a,b){var c=b[0],d=b[1];if(z&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Ha(d.name),'"');if(d.type){c.push(' type="',Ha(d.type),'"');d=pa(d);delete d.type}c.push(">");c=c.join("")}var f=a.createElement(c);if(d)if(q(d))f.className=d;else Ke(f,d);if(b.length>2){d=function(k){if(k)f.appendChild(q(k)?a.createTextNode(k):k)};for(c=2;c<b.length;c++){var h=b[c];ja(h)&&!(ma(h)&&h.nodeType>0)?Nb(Re(h)?$b(h):h,d):d(h)}}return f}var Se=Oe;
function Te(a,b){var c=a.createElement("div");c.innerHTML=b;if(c.childNodes.length==1)return c.removeChild(c.firstChild);else{for(a=a.createDocumentFragment();c.firstChild;)a.appendChild(c.firstChild);return a}}function Je(a){return a.compatMode=="CSS1Compat"}
function Ue(a){if(a.nodeType!=1)return j;if("canHaveChildren"in a)return a.canHaveChildren;switch(a.tagName){case "APPLET":case "AREA":case "BASE":case "BR":case "COL":case "FRAME":case "HR":case "IMG":case "INPUT":case "IFRAME":case "ISINDEX":case "LINK":case "NOFRAMES":case "NOSCRIPT":case "META":case "OBJECT":case "PARAM":case "SCRIPT":case "STYLE":return j}return g}function Ve(a,b){a.appendChild(b)}function We(a){for(var b;b=a.firstChild;)a.removeChild(b)}
function Xe(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)}function Ye(a,b){b.parentNode&&b.parentNode.insertBefore(a,b.nextSibling)}function P(a){return a&&a.parentNode?a.parentNode.removeChild(a):i}function Ze(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)}function $e(a){var b,c=a.parentNode;if(c&&c.nodeType!=11)if(a.removeNode)return a.removeNode(j);else{for(;b=a.firstChild;)c.insertBefore(b,a);return P(a)}}function af(a){return bf(a.firstChild,g)}function cf(a){return bf(a.nextSibling,g)}
function bf(a,b){for(;a&&a.nodeType!=1;)a=b?a.nextSibling:a.previousSibling;return a}function df(a,b){if(a.contains&&b.nodeType==1)return a==b||a.contains(b);if(typeof a.compareDocumentPosition!="undefined")return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}
function ef(a,b){if(a==b)return 0;if(a.compareDocumentPosition)return a.compareDocumentPosition(b)&2?1:-1;if("sourceIndex"in a||a.parentNode&&"sourceIndex"in a.parentNode){var c=a.nodeType==1,d=b.nodeType==1;if(c&&d)return a.sourceIndex-b.sourceIndex;else{var f=a.parentNode,h=b.parentNode;if(f==h)return ff(a,b);if(!c&&df(f,b))return-1*gf(a,b);if(!d&&df(h,a))return gf(b,a);return(c?a.sourceIndex:f.sourceIndex)-(d?b.sourceIndex:h.sourceIndex)}}d=Fe(a);c=d.createRange();c.selectNode(a);c.collapse(g);
a=d.createRange();a.selectNode(b);a.collapse(g);return c.compareBoundaryPoints(da.Range.START_TO_END,a)}function gf(a,b){var c=a.parentNode;if(c==b)return-1;for(b=b;b.parentNode!=c;)b=b.parentNode;return ff(b,a)}function ff(a,b){for(b=b;b=b.previousSibling;)if(b==a)return-1;return 1}
function hf(){var a,b=arguments.length;if(b){if(b==1)return arguments[0]}else return i;var c=[],d=Infinity;for(a=0;a<b;a++){for(var f=[],h=arguments[a];h;){f.unshift(h);h=h.parentNode}c.push(f);d=Math.min(d,f.length)}f=i;for(a=0;a<d;a++){h=c[0][a];for(var k=1;k<b;k++)if(h!=c[k][a])return f;f=h}return f}function Fe(a){return a.nodeType==9?a:a.ownerDocument||a.document}function jf(a){return E?a.document||a.contentWindow.document:a.contentDocument||a.contentWindow.document}
function kf(a,b){if("textContent"in a)a.textContent=b;else if(a.firstChild&&a.firstChild.nodeType==3){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{We(a);a.appendChild(Fe(a).createTextNode(b))}}function lf(a){if("outerHTML"in a)return a.outerHTML;else{var b=Fe(a).createElement("div");b.appendChild(a.cloneNode(g));return b.innerHTML}}var mf={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},nf={IMG:" ",BR:"\n"};
function of(a){var b=a.getAttributeNode("tabindex");if(b&&b.specified){a=a.tabIndex;return ka(a)&&a>=0}return j}function pf(a,b){if(b)a.tabIndex=0;else a.removeAttribute("tabIndex")}function qf(a){if(z&&"innerText"in a)a=a.innerText.replace(/(\r\n|\r|\n)/g,"\n");else{var b=[];rf(a,b,g);a=b.join("")}a=a.replace(/\xAD/g,"");a=a.replace(/ +/g," ");if(a!=" ")a=a.replace(/^\s*/,"");return a}function sf(a){var b=[];rf(a,b,j);return b.join("")}
function rf(a,b,c){if(!(a.nodeName in mf))if(a.nodeType==3)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in nf)b.push(nf[a.nodeName]);else for(a=a.firstChild;a;){rf(a,b,c);a=a.nextSibling}}function Re(a){if(a&&typeof a.length=="number")if(ma(a))return typeof a.item=="function"||typeof a.item=="string";else if(la(a))return typeof a.item=="function";return j}
function tf(a,b,c){var d=b?b.toUpperCase():i;return uf(a,function(f){return(!d||f.nodeName==d)&&(!c||Be(f,c))},g)}function uf(a,b,c,d){if(!c)a=a.parentNode;c=d==i;for(var f=0;a&&(c||f<=d);){if(b(a))return a;a=a.parentNode;f++}return i}function Ee(a){this.lb=a||da.document||document}n=Ee.prototype;n.G=J;n.M=function(){return this.lb};n.b=function(a){return q(a)?this.lb.getElementById(a):a};n.Oh=Ee.prototype.b;n.sf=function(a,b,c){return Ie(this.lb,a,b,c)};n.qM=Ee.prototype.sf;
n.pF=function(a){return Me(a||this.pa())};n.o=function(){return Pe(this.lb,arguments)};n.nb=Ee.prototype.o;n.createElement=function(a){return this.lb.createElement(a)};n.createTextNode=function(a){return this.lb.createTextNode(a)};n.Ep=function(a,b,c){var d=this.lb,f=!!c;c=["<tr>"];for(var h=0;h<b;h++)c.push(f?"<td>&nbsp;</td>":"<td></td>");c.push("</tr>");c=c.join("");b=["<table>"];for(h=0;h<a;h++)b.push(c);b.push("</table>");a=d.createElement("DIV");a.innerHTML=b.join("");return a.removeChild(a.firstChild)};
n.tG=ba(19);n.qn=function(){return Je(this.lb)};n.pa=function(){return this.lb.parentWindow||this.lb.defaultView};n.EE=function(){return!E&&Je(this.lb)?this.lb.documentElement:this.lb.body};n.oe=function(){var a=!E&&Je(this.lb)?this.lb.documentElement:this.lb.body;return new oe(a.scrollLeft,a.scrollTop)};n.appendChild=Ve;n.Dy=We;n.Vw=Xe;n.iW=Ye;n.removeNode=P;n.replaceNode=Ze;n.cE=$e;n.ti=af;n.XS=cf;n.contains=df;n.VE=Fe;n.jw=qf;function vf(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}vf.prototype.Sa=function(){return new vf(this.top,this.right,this.bottom,this.left)};vf.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};vf.prototype.contains=function(a){return!this||!a?j:a instanceof vf?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};vf.prototype.expand=ba(21);
function wf(a,b){if(a==b)return g;if(!a||!b)return j;return a.top==b.top&&a.right==b.right&&a.bottom==b.bottom&&a.left==b.left};function xf(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}n=xf.prototype;n.Sa=function(){return new xf(this.left,this.top,this.width,this.height)};n.gA=ba(0);n.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};
n.SG=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(d<=a){this.left=b;this.top=d;this.width=c-b;this.height=a-d;return g}}return j};n.contains=function(a){return a instanceof xf?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
n.hw=function(){return new qe(this.width,this.height)};function yf(a,b,c){q(b)?zf(a,c,b):pc(b,qa(zf,a))}function zf(a,b,c){a.style[Af(c)]=b}function Bf(a,b){var c=Fe(a);if(c.defaultView&&c.defaultView.getComputedStyle)if(a=c.defaultView.getComputedStyle(a,""))return a[b];return i}function Cf(a,b){return a.currentStyle?a.currentStyle[b]:i}function Df(a,b){return Bf(a,b)||Cf(a,b)||a.style[b]}function Ef(a){return Df(a,"position")}
function Ff(a,b,c){var d,f=B&&(md||vd)&&Cd("1.9");if(b instanceof oe){d=b.x;b=b.y}else{d=b;b=c}a.style.left=typeof d=="number"?(f?Math.round(d):d)+"px":d;a.style.top=typeof b=="number"?(f?Math.round(b):b)+"px":b}function Gf(a){a=a?a.nodeType==9?a:Fe(a):document;if(z&&!J(a).qn())return a.body;return a.documentElement}
function Hf(a){var b=a.getBoundingClientRect();if(z){a=a.ownerDocument;b.left-=a.documentElement.clientLeft+a.body.clientLeft;b.top-=a.documentElement.clientTop+a.body.clientTop}return b}
function If(a){if(z)return a.offsetParent;var b=Fe(a),c=Df(a,"position"),d=c=="fixed"||c=="absolute";for(a=a.parentNode;a&&a!=b;a=a.parentNode){c=Df(a,"position");d=d&&c=="static"&&a!=b.documentElement&&a!=b.body;if(!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||c=="fixed"||c=="absolute"))return a}return i}
function Jf(a){var b=new vf(0,Infinity,Infinity,0),c=J(a),d=c.M().body,f=c.EE(),h;for(a=a;a=If(a);)if((!z||a.clientWidth!=0)&&(!E||a.clientHeight!=0||a!=d)&&(a.scrollWidth!=a.clientWidth||a.scrollHeight!=a.clientHeight)&&Df(a,"overflow")!="visible"){var k=Kf(a),l;l=a;if(B&&!Cd("1.9")){var m=parseFloat(Bf(l,"borderLeftWidth"));if(Lf(l)){var p=l.offsetWidth-l.clientWidth-m-parseFloat(Bf(l,"borderRightWidth"));m+=p}l=new oe(m,parseFloat(Bf(l,"borderTopWidth")))}else l=new oe(l.clientLeft,l.clientTop);
k.x+=l.x;k.y+=l.y;b.top=Math.max(b.top,k.y);b.right=Math.min(b.right,k.x+a.clientWidth);b.bottom=Math.min(b.bottom,k.y+a.clientHeight);b.left=Math.max(b.left,k.x);h=h||a!=f}d=f.scrollLeft;f=f.scrollTop;if(E){b.left+=d;b.top+=f}else{b.left=Math.max(b.left,d);b.top=Math.max(b.top,f)}if(!h||E){b.right+=d;b.bottom+=f}c=c.pF();b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return b.top>=0&&b.left>=0&&b.bottom>b.top&&b.right>b.left?b:i}
function Kf(a){var b,c=Fe(a),d=Df(a,"position"),f=B&&c.getBoxObjectFor&&!a.getBoundingClientRect&&d=="absolute"&&(b=c.getBoxObjectFor(a))&&(b.screenX<0||b.screenY<0),h=new oe(0,0),k=Gf(c);if(a==k)return h;if(a.getBoundingClientRect){b=Hf(a);a=J(c).oe();h.x=b.left+a.x;h.y=b.top+a.y}else if(c.getBoxObjectFor&&!f){b=c.getBoxObjectFor(a);a=c.getBoxObjectFor(k);h.x=b.screenX-a.screenX;h.y=b.screenY-a.screenY}else{b=a;do{h.x+=b.offsetLeft;h.y+=b.offsetTop;if(b!=a){h.x+=b.clientLeft||0;h.y+=b.clientTop||
0}if(E&&Ef(b)=="fixed"){h.x+=c.body.scrollLeft;h.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(y||E&&d=="absolute")h.y-=c.body.offsetTop;for(b=a;(b=If(b))&&b!=c.body&&b!=k;){h.x-=b.scrollLeft;if(!y||b.tagName!="TR")h.y-=b.scrollTop}}return h}function Mf(a){var b=new oe;if(a.nodeType==1)if(a.getBoundingClientRect){var c=Hf(a);b.x=c.left;b.y=c.top}else{c=J(a).oe();a=Kf(a);b.x=a.x-c.x;b.y=a.y-c.y}else{b.x=a.clientX;b.y=a.clientY}return b}
function Nf(a,b,c){var d=Kf(a);if(b instanceof oe){c=b.y;b=b.x}Ff(a,a.offsetLeft+(b-d.x),a.offsetTop+(c-d.y))}function Of(a,b,c){if(b instanceof qe){c=b.height;b=b.width}else{if(c==undefined)e(Error("missing height argument"));c=c}a.style.width=typeof b=="number"?Math.round(b)+"px":b;a.style.height=typeof c=="number"?Math.round(c)+"px":c}
function Pf(a){var b=y&&!Cd("10");if(Df(a,"display")!="none")return b?new qe(a.offsetWidth||a.clientWidth,a.offsetHeight||a.clientHeight):new qe(a.offsetWidth,a.offsetHeight);var c=a.style,d=c.display,f=c.visibility,h=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";if(b){b=a.offsetWidth||a.clientWidth;a=a.offsetHeight||a.clientHeight}else{b=a.offsetWidth;a=a.offsetHeight}c.display=d;c.position=h;c.visibility=f;return new qe(b,a)}
function Qf(a){var b=Kf(a);a=Pf(a);return new xf(b.x,b.y,a.width,a.height)}var Sf={};function Af(a){return Sf[a]||(Sf[a]=String(a).replace(/\-([a-z])/g,function(b,c){return c.toUpperCase()}))}function Tf(a,b){a=a.style;if("opacity"in a)a.opacity=b;else if("MozOpacity"in a)a.MozOpacity=b;else if("filter"in a)a.filter=b===""?"":"alpha(opacity="+b*100+")"}function Q(a,b){a.style.display=b?"":"none"}function Uf(a){return a.style.display!="none"}
function Vf(a,b){b=J(b);var c=i;if(z){c=b.M().createStyleSheet();Wf(c,a)}else{var d=b.sf("head")[0];if(!d){c=b.sf("body")[0];d=b.o("head");c.parentNode.insertBefore(d,c)}c=b.o("style");Wf(c,a);b.appendChild(d,c)}return c}function Xf(a){P(a.ownerNode||a.owningElement||a)}function Wf(a,b){if(z)a.cssText=b;else a[E?"innerText":"innerHTML"]=b}function Lf(a){return"rtl"==Df(a,"direction")}var Yf=B?"MozUserSelect":E?"WebkitUserSelect":i;
function Zf(a){if(Yf)return a.style[Yf].toLowerCase()=="none";else if(z||y)return a.getAttribute("unselectable")=="on";return j}function $f(a,b,c){c=!c?a.getElementsByTagName("*"):i;if(Yf){b=b?"none":"";a.style[Yf]=b;if(c){a=0;for(var d;d=c[a];a++)d.style[Yf]=b}}else if(z||y){b=b?"on":"";a.setAttribute("unselectable",b);if(c)for(a=0;d=c[a];a++)d.setAttribute("unselectable",b)}};function ag(){}n=ag.prototype;n.he=j;n.wW=function(){return this.he};n.AS=ag.prototype.wW;n.p=function(){if(!this.he){this.he=g;this.k()}};n.k=function(){};function bg(a){a&&typeof a.p=="function"&&a.p()};function R(a,b){this.type=a;this.currentTarget=this.target=b}w(R,ag);n=R.prototype;n.k=function(){delete this.type;delete this.target;delete this.currentTarget};n.zh=j;n.gl=g;n.stopPropagation=function(){this.zh=g};n.preventDefault=function(){this.gl=j};function cg(a){a.preventDefault()};function dg(a,b){this.Ui=b;this.Hc=[];this.xP(a)}w(dg,ag);n=dg.prototype;n.Cu=i;n.tD=i;n.fo=function(a){this.Cu=a};n.gh=function(){if(this.Hc.length)return this.Hc.pop();return this.nm()};n.dj=function(a){this.Hc.length<this.Ui?this.Hc.push(a):this.Uj(a)};n.xP=function(a){if(a>this.Ui)e(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var b=0;b<a;b++)this.Hc.push(this.nm())};n.nm=function(){return this.Cu?this.Cu():{}};
n.Uj=function(a){if(this.tD)this.tD(a);else if(la(a.p))a.p();else for(var b in a)delete a[b]};n.k=function(){dg.c.k.call(this);for(var a=this.Hc;a.length;)this.Uj(a.pop());delete this.Hc};function eg(a,b){a&&this.re(a,b)}w(eg,R);var fg=[1,4,2];n=eg.prototype;n.target=i;n.relatedTarget=i;n.offsetX=0;n.offsetY=0;n.clientX=0;n.clientY=0;n.screenX=0;n.screenY=0;n.button=0;n.keyCode=0;n.charCode=0;n.ctrlKey=j;n.altKey=j;n.shiftKey=j;n.metaKey=j;n.jZ=j;n.kc=i;
n.re=function(a,b){var c=this.type=a.type;this.target=a.target||a.srcElement;this.currentTarget=b;if(b=a.relatedTarget){if(B)try{b=b.nodeName&&b}catch(d){b=i}}else if(c=="mouseover")b=a.fromElement;else if(c=="mouseout")b=a.toElement;this.relatedTarget=b;this.offsetX=a.offsetX!==undefined?a.offsetX:a.layerX;this.offsetY=a.offsetY!==undefined?a.offsetY:a.layerY;this.clientX=a.clientX!==undefined?a.clientX:a.pageX;this.clientY=a.clientY!==undefined?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=
a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(c=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.jZ=md?a.metaKey:a.ctrlKey;this.kc=a;delete this.gl;delete this.zh};n.pn=function(a){return z?this.type=="click"?a==0:!!(this.kc.button&fg[a]):this.kc.button==a};n.stopPropagation=function(){this.zh=g;if(this.kc.stopPropagation)this.kc.stopPropagation();else this.kc.cancelBubble=g};
var gg=z&&!Cd("8");eg.prototype.preventDefault=function(){this.gl=j;var a=this.kc;if(a.preventDefault)a.preventDefault();else{a.returnValue=j;if(gg)try{if(a.ctrlKey||a.keyCode>=112&&a.keyCode<=123)a.keyCode=-1}catch(b){}}};eg.prototype.qE=function(){return this.kc};eg.prototype.k=function(){eg.c.k.call(this);this.relatedTarget=this.currentTarget=this.target=this.kc=i};var hg;var ig=(hg="ScriptEngine"in da&&da.ScriptEngine()=="JScript")?da.ScriptEngineMajorVersion()+"."+da.ScriptEngineMinorVersion()+"."+da.ScriptEngineBuildVersion():"0";function jg(){}var kg=0;n=jg.prototype;n.Wb=0;n.el=j;n.cu=j;n.re=function(a,b,c,d,f,h){if(la(a))this.aH=g;else if(a&&a.handleEvent&&la(a.handleEvent))this.aH=j;else e(Error("Invalid listener argument"));this.Ok=a;this.pJ=b;this.src=c;this.type=d;this.capture=!!f;this.yk=h;this.cu=j;this.Wb=++kg;this.el=j};n.handleEvent=function(a){if(this.aH)return this.Ok.call(this.yk||this.src,a);return this.Ok.handleEvent.call(this.Ok,a)};var lg,mg,ng,og,pg,qg,rg,sg,tg,ug,vg;
(function(){function a(){return{ja:0,Te:0}}function b(){return[]}function c(){function A(D){return k.call(A.src,A.Wb,D)}return A}function d(){return new jg}function f(){return new eg}var h=hg&&!(ab(ig,"5.7")>=0),k;qg=function(A){k=A};if(h){lg=function(){return l.gh()};mg=function(A){l.dj(A)};ng=function(){return m.gh()};og=function(A){m.dj(A)};pg=function(){return p.gh()};rg=function(){p.dj(c())};sg=function(){return t.gh()};tg=function(A){t.dj(A)};ug=function(){return s.gh()};vg=function(A){s.dj(A)};
var l=new dg(0,600);l.fo(a);var m=new dg(0,600);m.fo(b);var p=new dg(0,600);p.fo(c);var t=new dg(0,600);t.fo(d);var s=new dg(0,600);s.fo(f)}else{lg=a;mg=fa;ng=b;og=fa;pg=c;rg=fa;sg=d;tg=fa;ug=f;vg=fa}})();var wg={},xg={},yg={},zg={};
function U(a,b,c,d,f){if(b)if(ia(b)){for(var h=0;h<b.length;h++)U(a,b[h],c,d,f);return i}else{d=!!d;var k=xg;b in k||(k[b]=lg());k=k[b];if(!(d in k)){k[d]=lg();k.ja++}k=k[d];var l=r(a),m;k.Te++;if(k[l]){m=k[l];for(h=0;h<m.length;h++){k=m[h];if(k.Ok==c&&k.yk==f){if(k.el)break;return m[h].Wb}}}else{m=k[l]=ng();k.ja++}h=pg();h.src=a;k=sg();k.re(c,h,a,b,d,f);c=k.Wb;h.Wb=c;m.push(k);wg[c]=k;yg[l]||(yg[l]=ng());yg[l].push(k);if(a.addEventListener){if(a==da||!a.SC)a.addEventListener(b,h,d)}else a.attachEvent(Ag(b),
h);return c}else e(Error("Invalid event type"))}function Bg(a,b,c,d,f){if(ia(b)){for(var h=0;h<b.length;h++)Bg(a,b[h],c,d,f);return i}a=U(a,b,c,d,f);wg[a].cu=g;return a}function Cg(a,b,c,d,f){if(ia(b)){for(var h=0;h<b.length;h++)Cg(a,b[h],c,d,f);return i}d=!!d;a=Dg(a,b,d);if(!a)return j;for(h=0;h<a.length;h++)if(a[h].Ok==c&&a[h].capture==d&&a[h].yk==f)return Eg(a[h].Wb);return j}
function Eg(a){if(!wg[a])return j;var b=wg[a];if(b.el)return j;var c=b.src,d=b.type,f=b.pJ,h=b.capture;if(c.removeEventListener){if(c==da||!c.SC)c.removeEventListener(d,f,h)}else c.detachEvent&&c.detachEvent(Ag(d),f);c=r(c);f=xg[d][h][c];if(yg[c]){var k=yg[c];Xb(k,b);k.length==0&&delete yg[c]}b.el=g;f.kI=g;Fg(d,h,c,f);delete wg[a];return g}
function Fg(a,b,c,d){if(!d.zn)if(d.kI){for(var f=0,h=0;f<d.length;f++)if(d[f].el){var k=d[f].pJ;k.src=i;rg(k);tg(d[f])}else{if(f!=h)d[h]=d[f];h++}d.length=h;d.kI=j;if(h==0){og(d);delete xg[a][b][c];xg[a][b].ja--;if(xg[a][b].ja==0){mg(xg[a][b]);delete xg[a][b];xg[a].ja--}if(xg[a].ja==0){mg(xg[a]);delete xg[a]}}}}
function Gg(a,b,c){var d=0,f=a==i,h=b==i,k=c==i;c=!!c;if(f)pc(yg,function(m){for(var p=m.length-1;p>=0;p--){var t=m[p];if((h||b==t.type)&&(k||c==t.capture)){Eg(t.Wb);d++}}});else{a=r(a);if(yg[a]){a=yg[a];for(f=a.length-1;f>=0;f--){var l=a[f];if((h||b==l.type)&&(k||c==l.capture)){Eg(l.Wb);d++}}}}return d}function Dg(a,b,c){var d=xg;if(b in d){d=d[b];if(c in d){d=d[c];a=r(a);if(d[a])return d[a]}}return i}
function Hg(a,b,c,d,f){d=!!d;if(a=Dg(a,b,d))for(b=0;b<a.length;b++)if(a[b].Ok==c&&a[b].capture==d&&a[b].yk==f)return a[b];return i}var Ig=z?"focusin":"DOMFocusIn";function Ag(a){if(a in zg)return zg[a];return zg[a]="on"+a}function Jg(a,b,c,d,f){var h=1;b=r(b);if(a[b]){a.Te--;a=a[b];if(a.zn)a.zn++;else a.zn=1;try{for(var k=a.length,l=0;l<k;l++){var m=a[l];if(m&&!m.el)h&=Kg(m,f)!==j}}finally{a.zn--;Fg(c,d,b,a)}}return Boolean(h)}function Kg(a,b){b=a.handleEvent(b);a.cu&&Eg(a.Wb);return b}
qg(function(a,b){if(!wg[a])return g;a=wg[a];var c=a.type,d=xg;if(!(c in d))return g;d=d[c];var f,h;if(z){f=b||ea("window.event");b=g in d;var k=j in d;if(b){if(f.keyCode<0||f.returnValue!=undefined)return g;a:{var l=j;if(f.keyCode==0)try{f.keyCode=-1;break a}catch(m){l=g}if(l||f.returnValue==undefined)f.returnValue=g}}l=ug();l.re(f,this);f=g;try{if(b){for(var p=ng(),t=l.currentTarget;t;t=t.parentNode)p.push(t);h=d[g];h.Te=h.ja;for(var s=p.length-1;!l.zh&&s>=0&&h.Te;s--){l.currentTarget=p[s];f&=Jg(h,
p[s],c,g,l)}if(k){h=d[j];h.Te=h.ja;for(s=0;!l.zh&&s<p.length&&h.Te;s++){l.currentTarget=p[s];f&=Jg(h,p[s],c,j,l)}}}else f=Kg(a,l)}finally{if(p){p.length=0;og(p)}l.p();vg(l)}return f}h=new eg(b,this);try{f=Kg(a,h)}finally{h.p()}return f});var Lg=0;function Mg(a){return a+"_"+Lg++};function V(a){this.qa=a}w(V,ag);var Ng=new dg(0,100);n=V.prototype;n.g=function(a,b,c,d,f){if(ia(b))for(var h=0;h<b.length;h++)this.g(a,b[h],c,d,f);else this.zJ(U(a,b,c||this,d||j,f||this.qa||this));return this};n.GH=function(a,b,c,d,f){if(ia(b))for(var h=0;h<b.length;h++)this.GH(a,b[h],c,d,f);else this.zJ(Bg(a,b,c||this,d||j,f||this.qa||this));return this};n.zJ=function(a){if(this.Ia)this.Ia[a]=g;else if(this.rh){this.Ia=Ng.gh();this.Ia[this.rh]=g;this.rh=i;this.Ia[a]=g}else this.rh=a};
n.Da=function(a,b,c,d,f){if(this.rh||this.Ia)if(ia(b))for(var h=0;h<b.length;h++)this.Da(a,b[h],c,d,f);else if(a=Hg(a,b,c||this,d||j,f||this.qa||this)){a=a.Wb;Eg(a);if(this.Ia)uc(this.Ia,a);else if(this.rh==a)this.rh=i}return this};n.Mc=function(){if(this.Ia){for(var a in this.Ia){Eg(a);delete this.Ia[a]}Ng.dj(this.Ia);this.Ia=i}else this.rh&&Eg(this.rh)};n.k=function(){V.c.k.call(this);this.Mc()};n.handleEvent=function(){e(Error("EventHandler.handleEvent not implemented"))};function Og(){}w(Og,ag);n=Og.prototype;n.SC=g;n.Yk=i;n.Az=function(a){this.Yk=a};n.addEventListener=function(a,b,c,d){U(this,a,b,c,d)};n.removeEventListener=function(a,b,c,d){Cg(this,a,b,c,d)};
n.dispatchEvent=function(a){a=a;if(q(a))a=new R(a,this);else if(a instanceof R)a.target=a.target||this;else{var b=a;a=new R(a.type,this);Cc(a,b)}b=1;var c,d=a.type,f=xg;if(d in f){f=f[d];d=g in f;var h;if(d){c=[];for(h=this;h;h=h.Yk)c.push(h);h=f[g];h.Te=h.ja;for(var k=c.length-1;!a.zh&&k>=0&&h.Te;k--){a.currentTarget=c[k];b&=Jg(h,c[k],a.type,g,a)&&a.gl!=j}}if(j in f){h=f[j];h.Te=h.ja;if(d)for(k=0;!a.zh&&k<c.length&&h.Te;k++){a.currentTarget=c[k];b&=Jg(h,c[k],a.type,j,a)&&a.gl!=j}else for(c=this;!a.zh&&
c&&h.Te;c=c.Yk){a.currentTarget=c;b&=Jg(h,c,a.type,j,a)&&a.gl!=j}}a=Boolean(b)}else a=g;return a};n.k=function(){Og.c.k.call(this);Gg(this);this.Yk=i};function Pg(){}ga(Pg);Pg.prototype.aY=0;Pg.prototype.YS=function(){return":"+(this.aY++).toString(36)};Pg.Fa();function Qg(a){this.K=a||J();this.Rn=Rg}w(Qg,Og);Qg.prototype.GV=Pg.Fa();var Rg=i;function Sg(a,b){switch(a){case 1:return b?"disable":"enable";case 2:return b?"highlight":"unhighlight";case 4:return b?"activate":"deactivate";case 8:return b?"select":"unselect";case 16:return b?"check":"uncheck";case 32:return b?"focus":"blur";case 64:return b?"open":"close";default:}e(Error("Invalid component state"))}n=Qg.prototype;n.nc=i;n.K=i;n.va=j;n.D=i;n.Rn=i;n.Fn=i;n.Ca=i;n.Ec=i;n.ze=i;n.oM=j;
n.Lb=function(){return this.nc||(this.nc=this.GV.YS())};n.lj=function(a){if(this.Ca&&this.Ca.ze){uc(this.Ca.ze,this.nc);xc(this.Ca.ze,a,this)}this.nc=a};n.b=function(){return this.D};n.Wc=function(a){this.D=a};n.Qa=function(){return this.sk||(this.sk=new V(this))};n.Mf=function(a){if(this==a)e(Error("Unable to set parent component"));if(a&&this.Ca&&this.nc&&this.Ca.C(this.nc)&&this.Ca!=a)e(Error("Unable to set parent component"));this.Ca=a;Qg.c.Az.call(this,a)};
n.Az=function(a){if(this.Ca&&this.Ca!=a)e(Error("Method not supported"));Qg.c.Az.call(this,a)};n.G=function(){return this.K};n.o=function(){this.D=this.K.createElement("div")};n.db=function(a){this.PJ(a)};n.PJ=function(a,b){if(this.va)e(Error("Component already rendered"));this.D||this.o();a?a.insertBefore(this.D,b||i):this.K.M().body.appendChild(this.D);if(!this.Ca||this.Ca.va)this.Ua()};
n.Aa=function(a){if(this.va)e(Error("Component already rendered"));else if(a&&this.Qc(a)){this.oM=g;if(!this.K||this.K.M()!=Fe(a))this.K=J(a);this.bd(a);this.Ua()}else e(Error("Invalid element to decorate"))};n.Qc=function(){return g};n.bd=function(a){this.D=a};n.Ua=function(){this.va=g;this.ke(function(a){!a.va&&a.b()&&a.Ua()})};n.tb=function(){this.ke(function(a){a.va&&a.tb()});this.sk&&this.sk.Mc();this.va=j};
n.k=function(){Qg.c.k.call(this);this.va&&this.tb();if(this.sk){this.sk.p();delete this.sk}this.ke(function(a){a.p()});!this.oM&&this.D&&P(this.D);this.Ca=this.Fn=this.D=this.ze=this.Ec=i};n.NH=function(a){return this.Lb()+"."+a};n.JK=function(a){this.Fn=a};n.kb=function(a,b){this.Wf(a,this.ne(),b)};
n.Wf=function(a,b,c){if(a.va&&(c||!this.va))e(Error("Component already rendered"));if(b<0||b>this.ne())e(Error("Child component index out of bounds"));if(!this.ze||!this.Ec){this.ze={};this.Ec=[]}if(a.Ca==this){this.ze[a.Lb()]=a;Xb(this.Ec,a)}else xc(this.ze,a.Lb(),a);a.Mf(this);cc(this.Ec,b,0,a);if(a.va&&this.va&&a.Ca==this){c=this.xa();c.insertBefore(a.b(),c.childNodes[b]||i)}else if(c){this.D||this.o();b=this.mc(b+1);a.PJ(this.xa(),b?b.D:i)}else this.va&&!a.va&&a.D&&a.Ua()};n.xa=function(){return this.D};
n.un=function(){if(this.Rn==i)this.Rn=Lf(this.va?this.D:this.K.M().body);return this.Rn};n.wl=function(a){if(this.va)e(Error("Component already rendered"));this.Rn=a};n.Iw=ba(18);n.ne=function(){return this.Ec?this.Ec.length:0};n.jS=function(){var a=[];this.ke(function(b){a.push(b.Lb())});return a};n.C=function(a){return this.ze&&a?yc(this.ze,a)||i:i};n.mc=function(a){return this.Ec?this.Ec[a]||i:i};n.ke=function(a,b){this.Ec&&Nb(this.Ec,a,b)};n.Gk=function(a){return this.Ec&&a?Mb(this.Ec,a):-1};
n.removeChild=function(a,b){if(a){var c=q(a)?a:a.Lb();a=this.C(c);if(c&&a){uc(this.ze,c);Xb(this.Ec,a);if(b){a.tb();a.D&&P(a.D)}a.Mf(i)}}if(!a)e(Error("Child is not in parent component"));return a};n.Cy=function(a,b){return this.removeChild(this.mc(a),b)};n.Dy=ba(6);function Tg(a){Qg.call(this,a)}w(Tg,Qg);Tg.prototype.o=function(){this.Wc(this.G().o("div","apps-marquee"))};function Ug(a){Qg.call(this,a)}w(Ug,Qg);n=Ug.prototype;n.o=function(){var a=this.G();this.La=a.o("div","apps-marquee-text");this.iA=a.o("div","apps-marquee-round-top");this.SB=a.o("div","apps-marquee-round-bottom");this.Wc(a.o("span",{"aria-live":"polite","aria-relevant":"all"},this.iA,this.La,this.SB));this.y0(j);this.v1(j);this.z(j)};n.xa=function(){return this.La};
n.yz=function(a){this.D0(a?document.createTextNode(a):i)};n.D0=function(a){if(a!=this.zr){this.zr&&P(this.zr);this.zr=a;this.z(!!a);a&&Ve(this.La,a)}};n.z=function(a){Q(this.b(),a);this.xb=a};n.ga=function(){return this.xb};n.y0=function(a){this.b().className="apps-marquee-item"+(a?" apps-marquee-warning":"")};n.v1=function(a){Q(this.iA,a)};n.k=function(){Ug.c.k.call(this);delete this.La;delete this.iA;delete this.SB};var Vg=i,Wg=i;function Xg(){if(!Vg){Vg=new Tg;Wg=new Ug;Vg.kb(Wg,g);Vg.db()}}function Yg(){Xg();return Vg}function Zg(a){a||(a="Working...");Xg();Wg.yz(a)}function $g(){Xg();Wg.yz(i)}function ah(a){var b=O("buttercontents"),c=O("GDS_pageButter");if(b&&c){for(var d="",f=0;f<a.length;f++)d+='<p class="app bpara">'+(f?"":"<b>")+a[f]+(f?"":"</b>")+"</p>";b.innerHTML=d;c.style.display=""}}o("writely.chrome.showWorking",Zg,void 0);o("writely.chrome.hideWorking",$g,void 0);
o("writely.chrome.showButter",ah,void 0);o("writely.chrome.closeButter",function(a){O("GDS_pageButter").style.display="none";a&&bh("butter",{butter:a,on:j})},void 0);function ch(a,b,c){X.focus();if(dh&&"createRange"in dh)try{dh.createRange()}catch(d){dh=i}else if(dh&&"pasteHTML"in dh){if(eh)dh=fh;if(c){dh.moveStart("character",0);dh.collapse()}gh(dh);dh.pasteHTML(a);dh.collapse();dh.select()}else{if(c&&hh&&"collapseToStart"in hh)try{hh.collapseToStart()}catch(f){}ih(a)}return b?X.document.getElementById(b):i}var jh="",kh=i,lh=j;function mh(a){if(!nh()){lh=a;oh("BlogSettings")}}
function rh(){$g();rce("Blog operation timed out.");F("Sorry, but the blog operation timed out. Please try again soon.")}
function sh(){if(!nh()){var a=i,b=function(c){a&&window.clearTimeout(a);$g();if(!th(c)){Vd("isposted",g);uh()}};if(Sd("isposted")){if(Ld("Click OK to update your blog post now.")){Zg();a=window.setTimeout(rh,3E4);vh("blog_repost",{localDate:wh()},b)}}else if(G("blogusername")==""||G("blogtype")=="")mh(g);else if(Ld("Click OK to post this to your blog now.")){Zg();a=window.setTimeout(rh,3E4);vh("blog_post",{localDate:wh()},b)}}}
function xh(){if(Sd("isposted"))if(Ld("Click OK to remove this post from your blog.")){Zg();var a=window.setTimeout(rh,3E4);vh("blog_remove",{},function(b){th(b);$g();Vd("isposted",j);new (function(){window.clearTimeout(a);uh()})})}}function vh(a,b,c){b.docID=Hd();bh(a,b,c)}function nh(){if(H("isunconfirmed")){window.location="?action=confirm";return g}return j}function yh(a){if(a<10)return"0"+a;return a}
function wh(){var a=new Date,b=a.getYear();if(b<2E3)b+=1900;var c=yh(a.getMonth()+1),d=yh(a.getDate()),f=yh(a.getHours()),h=yh(a.getMinutes()),k=yh(a.getSeconds());a=a.getTimezoneOffset();var l="tzm";if(a<0){a=-a;l="tzp"}return b+"-"+c+"-"+d+"T"+f+":"+h+":"+k+l+a}var zh="";function Ah(){zh=Bh(X).Ab();oh("FindReplace")}o("BlogSettingsDlg",mh,void 0);o("DeleteFromBlog",xh,void 0);o("PostToBlog",sh,void 0);function Ch(a){this.Hb=new Mc;a&&this.To(a)}function Dh(a){var b=typeof a;return b=="object"&&a||b=="function"?"o"+r(a):b.substr(0,1)+a}n=Ch.prototype;n.Kb=function(){return this.Hb.Kb()};n.add=function(a){this.Hb.u(Dh(a),a)};n.To=function(a){a=Gc(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};n.Mc=function(a){a=Gc(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};n.remove=function(a){return this.Hb.remove(Dh(a))};n.clear=function(){this.Hb.clear()};n.Oe=function(){return this.Hb.Oe()};
n.contains=function(a){return this.Hb.Ce(Dh(a))};n.SG=function(a){var b=new Ch;a=Gc(a);for(var c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};n.Kc=function(){return this.Hb.Kc()};n.Sa=function(){return new Ch(this)};n.Sd=function(a){return this.Kb()==Fc(a)&&this.OW(a)};n.OW=function(a){var b=Fc(a);if(this.Kb()>b)return j;if(!(a instanceof Ch)&&b>5)a=new Ch(a);return Kc(this,function(c){return Ic(a,c)})};n.Vf=function(){return this.Hb.Vf(j)};function Eh(a,b,c,d,f,h,k,l){var m,p=c.offsetParent;if(p){var t=p.tagName=="HTML"||p.tagName=="BODY";if(!t||Ef(p)!="static"){m=Kf(p);t||(m=pe(m,new oe(p.scrollLeft,p.scrollTop)))}}p=Qf(a);(t=Jf(a))&&p.SG(new xf(t.left,t.top,t.right-t.left,t.bottom-t.top));t=J(a);var s=J(c);if(t.M()!=s.M()){var A=t.M().body;s=s.pa();var D=new oe(0,0),L=Ne(Fe(A)),N=A;do{var K=L==s?Kf(N):Mf(N);D.x+=K.x;D.y+=K.y}while(L&&L!=s&&(N=L.frameElement)&&(L=L.parent));s=D;s=pe(s,Kf(A));if(z&&!t.qn())s=pe(s,t.oe());p.left+=s.x;
p.top+=s.y}a=(b&4&&Lf(a)?b^2:b)&-5;b=new oe(a&2?p.left+p.width:p.left,a&1?p.top+p.height:p.top);if(m)b=pe(b,m);if(f){b.x+=(a&2?-1:1)*f.x;b.y+=(a&1?-1:1)*f.y}var M;if(k)if((M=Jf(c))&&m){M.top=Math.max(0,M.top-m.y);M.right-=m.x;M.bottom-=m.y;M.left=Math.max(0,M.left-m.x)}return Fh(b,c,d,h,M,k,l)}
function Fh(a,b,c,d,f,h,k){a=a.Sa();var l=0;c=(c&4&&Lf(b)?c^2:c)&-5;var m=Pf(b);k=k?k.Sa():m;if(d||c!=0){if(c&2)a.x-=k.width+(d?d.right:0);else if(d)a.x+=d.left;if(c&1)a.y-=k.height+(d?d.bottom:0);else if(d)a.y+=d.top}if(h){l=f?Gh(a,k,f,h):256;if(l&496)return l}Ff(b,a);re(m,k)||Of(b,k);return l}
function Gh(a,b,c,d){var f=0;if(a.x<c.left&&d&1){a.x=c.left;f|=1}if(a.x<c.left&&a.x+b.width>c.right&&d&16){b.width-=a.x+b.width-c.right;f|=4}if(a.x+b.width>c.right&&d&1){a.x=Math.max(c.right-b.width,c.left);f|=1}if(d&2)f|=(a.x<c.left?16:0)|(a.x+b.width>c.right?32:0);if(a.y<c.top&&d&4){a.y=c.top;f|=2}if(a.y>=c.top&&a.y+b.height>c.bottom&&d&32){b.height-=a.y+b.height-c.bottom;f|=8}if(a.y+b.height>c.bottom&&d&4){a.y=Math.max(c.bottom-b.height,c.top);f|=2}if(d&8)f|=(a.y<c.top?64:0)|(a.y+b.height>c.bottom?
128:0);return f};function Hh(){}Hh.prototype.Ga=function(){};function Ih(a,b){this.Ee=a;this.ci=b}w(Ih,Hh);Ih.prototype.Ga=function(a,b,c){Eh(this.Ee,this.ci,a,b,undefined,c)};function Jh(a,b,c){Ih.call(this,a,b);this.rN=c}w(Jh,Ih);Jh.prototype.Ga=function(a,b,c,d){var f=Eh(this.Ee,this.ci,a,b,i,c,10,d);if(f&496){var h=this.ci,k=b;if(f&48){h^=2;k^=2}if(f&192){h^=1;k^=1}f=Eh(this.Ee,h,a,k,i,c,10,d);if(f&496)this.rN?Eh(this.Ee,this.ci,a,b,i,c,5,d):Eh(this.Ee,this.ci,a,b,i,c,0,d)}};function Kh(a,b,c,d){Jh.call(this,a,b,c);this.Ny=d}w(Kh,Jh);Kh.prototype.Ga=function(a,b,c,d){this.Ny?Eh(this.Ee,this.ci,a,b,i,c,33,d):Kh.c.Ga.call(this,a,b,c,d)};function Lh(a,b){this.Ug=a instanceof oe?a:new oe(a,b)}w(Lh,Hh);Lh.prototype.Ga=function(a,b,c,d){var f=Gf(a);Eh(f,0,a,b,new oe(this.Ug.x+f.scrollLeft,this.Ug.y+f.scrollTop),c,i,d)};function Mh(a,b){Lh.call(this,a,b)}w(Mh,Lh);Mh.prototype.Ga=function(a,b,c,d){var f=Gf(a);f=Jf(f);var h=J(a).EE();h=new oe(this.Ug.x+h.scrollLeft,this.Ug.y+h.scrollTop);var k=b,l=Fh(h,a,k,c,f,10,d);if((l&496)!=0){if(l&16||l&32)k^=2;if(l&64||l&128)k^=1;l=Fh(h,a,k,c,f,10,d);(l&496)!=0&&Fh(h,a,b,c,f,undefined,d)}};function Nh(a,b){if(B){a.setAttribute("role",b);a.d5=b}}function Oh(a,b,c){B&&a.setAttribute("aria-"+b,c)};function Ph(a,b,c,d,f){if(!z&&!(E&&Cd("525")))return g;if(md&&f)return Qh(a);if(f&&!d)return j;if(z&&!c&&(b==17||b==18))return j;if(z&&d&&b==a)return j;switch(a){case 13:return g;case 27:return!E}return Qh(a)}function Qh(a){if(a>=48&&a<=57)return g;if(a>=96&&a<=106)return g;if(a>=65&&a<=90)return g;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return g;default:return j}};function Rh(a){a&&this.Pg(a)}w(Rh,Og);n=Rh.prototype;n.D=i;n.nr=i;n.px=i;n.or=i;n.xn=-1;n.Nk=-1;
var Sh={"3":13,"12":144,"63232":38,"63233":40,"63234":37,"63235":39,"63236":112,"63237":113,"63238":114,"63239":115,"63240":116,"63241":117,"63242":118,"63243":119,"63244":120,"63245":121,"63246":122,"63247":123,"63248":44,"63272":46,"63273":36,"63275":35,"63276":33,"63277":34,"63289":144,"63302":45},Th={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},Uh={61:187,
59:186},Vh=z||E&&Cd("525");n=Rh.prototype;n.xw=function(a){if(Vh&&!Ph(a.keyCode,this.xn,a.shiftKey,a.ctrlKey,a.altKey))this.handleEvent(a);else this.Nk=B&&a.keyCode in Uh?Uh[a.keyCode]:a.keyCode};n.CU=function(){this.Nk=this.xn=-1};
n.handleEvent=function(a){var b=a.kc,c,d;if(z&&a.type=="keypress"){c=this.Nk;d=c!=13&&c!=27?b.keyCode:0}else if(E&&a.type=="keypress"){c=this.Nk;d=b.charCode>=0&&b.charCode<63232&&Qh(c)?b.charCode:0}else if(y){c=this.Nk;d=Qh(c)?b.keyCode:0}else{c=b.keyCode||this.Nk;d=b.charCode||0;if(md&&d==63&&!c)c=191}var f=c,h=b.keyIdentifier;if(c)if(c>=63232&&c in Sh)f=Sh[c];else{if(c==25&&a.shiftKey)f=9}else if(h&&h in Th)f=Th[h];a=f==this.xn;this.xn=f;b=new Wh(f,d,a,b);try{this.dispatchEvent(b)}finally{b.p()}};
n.b=function(){return this.D};n.Pg=function(a){this.or&&this.detach();this.D=a;this.nr=U(this.D,"keypress",this);this.px=U(this.D,"keydown",this.xw,j,this);this.or=U(this.D,"keyup",this.CU,j,this)};n.detach=function(){if(this.nr){Eg(this.nr);Eg(this.px);Eg(this.or);this.or=this.px=this.nr=i}this.D=i;this.xn=-1};n.k=function(){Rh.c.k.call(this);this.detach()};function Wh(a,b,c,d){d&&this.re(d,void 0);this.type="key";this.keyCode=a;this.charCode=b;this.repeat=c}w(Wh,eg);function Xh(a){for(var b;a;){b=r(a);if(b=Yh[b])break;a=a.c?a.c.constructor:i}if(b)return la(b.Fa)?b.Fa():new b;return i}function Zh(a,b){if(!a)e(Error("Invalid class name "+a));if(!la(b))e(Error("Invalid decorator function "+b));$h[a]=b}function ai(a){for(var b=ve(a),c=0,d=b.length;c<d;c++)if(a=b[c]in $h?$h[b[c]]():i)return a;return i}var Yh={},$h={};function bi(){}var ci;ga(bi);function di(a,b){a=new a;a.Z=function(){return b};return a}n=bi.prototype;n.le=function(){};n.o=function(a){return a.G().o("div",this.rf(a).join(" "),a.La)};n.xa=function(a){return a};n.Rp=function(a,b,c){if(a=a.b?a.b():a)if(z&&!Cd("7")){var d=this.Kv(ve(a),b);d.push(b);qa(c?I:xe,a).apply(i,d)}else Ce(a,b,c)};n.ED=function(a,b,c){this.Rp(a,b,c)};n.Qc=function(){return g};
n.Aa=function(a,b){b.id&&a.lj(b.id);var c=this.xa(b);c&&c.firstChild?a.ol(c.firstChild.nextSibling?$b(c.childNodes):c.firstChild):a.ol(i);var d=0,f=this.Z(),h=this.Ai(),k=j,l=j;c=j;var m=ve(b);Nb(m,function(t){if(!k&&t==f){k=g;if(h==f)l=g}else if(!l&&t==h)l=g;else d|=this.iw(t)},this);a.SK(d);if(!k){m.push(f);if(h==f)l=g}l||m.push(h);(a=a.Fe)&&m.push.apply(m,a);if(z&&!Cd("7")){var p=this.Kv(m);if(p.length>0){m.push.apply(m,p);c=g}}if(!k||!l||a||c)ue(b,m.join(" "));return b};
n.se=function(a){a.un()&&this.wl(a.b(),g);a.W()&&this.hd(a,a.ga())};n.wK=function(a){if(B){var b=this.le();b&&Nh(a,b)}};n.$n=function(a,b){$f(a,!b,!z&&!y)};n.wl=function(a,b){this.Rp(a,this.Ai()+"-rtl",b)};n.tg=function(a){var b;if(a.xd(32)&&(b=a.Ub()))return of(b);return j};n.hd=function(a,b){var c;if(a.xd(32)&&(c=a.Ub())){if(!b&&a.$G()){try{c.blur()}catch(d){}a.$G()&&a.rd(i)}of(c)!=b&&pf(c,b)}};n.z=function(a,b){Q(a,b)};
n.Zd=function(a,b,c){var d=a.b();if(d){var f=this.Nm(b);f&&this.Rp(a,f,c);this.Nl(d,b,c)}};n.Nl=function(a,b,c){if(B){ci||(ci=Dc(1,"disabled",4,"pressed",8,"selected",16,"checked",64,"expanded"));(b=ci[b])&&Oh(a,b,c)}};n.hb=function(a,b){var c=this.xa(a);if(c){We(c);if(b)if(q(b))kf(c,b);else{a=function(d){if(d){var f=Fe(c);c.appendChild(q(d)?f.createTextNode(d):d)}};if(ia(b))Nb(b,a);else ja(b)&&!("nodeType"in b)?Nb($b(b),a):a(b)}}};n.Ub=function(a){return a.b()};n.Z=function(){return"goog-control"};
n.Ai=function(){return this.Z()};n.rf=function(a){var b=this.Z(),c=[b],d=this.Ai();d!=b&&c.push(d);b=this.lS(a.qe());c.push.apply(c,b);(a=a.Fe)&&c.push.apply(c,a);z&&!Cd("7")&&c.push.apply(c,this.Kv(c));return c};n.Kv=function(a,b){var c=[];if(b)a=a.concat([b]);Nb([],function(d){if(Tb(d,qa(Vb,a))&&(!b||Vb(d,b)))c.push(d.join("_"))});return c};n.lS=function(a){for(var b=[];a;){var c=a&-a;b.push(this.Nm(c));a&=~c}return b};n.Nm=function(a){this.mp||this.CC();return this.mp[a]};
n.iw=function(a){this.wL||this.IP();a=parseInt(this.wL[a],10);return isNaN(a)?0:a};n.CC=function(){var a=this.Ai();this.mp=Dc(1,a+"-disabled",2,a+"-hover",4,a+"-active",8,a+"-selected",16,a+"-checked",32,a+"-focused",64,a+"-open")};n.IP=function(){this.mp||this.CC();this.wL=Ac(this.mp)};function ei(a){var b=ai(a);b&&b.Aa(a);return b};function fi(a,b,c){Qg.call(this,c);this.ha=b||Xh(this.constructor);this.ol(a)}w(fi,Qg);n=fi.prototype;n.La=i;n.ya=0;n.vo=39;n.dp=255;n.Ms=0;n.xb=g;n.Fe=i;n.zw=g;n.Zo=j;n.uz=function(a){this.va&&a!=this.zw&&this.GD(a);this.zw=a};n.Ub=function(){return this.ha.Ub(this)};n.sq=function(){return this.oc||(this.oc=new Rh)};n.Qh=function(a){if(a){if(this.Fe)Vb(this.Fe,a)||this.Fe.push(a);else this.Fe=[a];this.ha.ED(this,a,g)}};
n.UZ=function(a){if(a&&this.Fe){Xb(this.Fe,a);if(this.Fe.length==0)this.Fe=i;this.ha.ED(this,a,j)}};n.Rp=function(a,b){b?this.Qh(a):this.UZ(a)};n.o=function(){var a=this.ha.o(this);this.Wc(a);this.ha.wK(a);this.Zo||this.ha.$n(a,j);this.ga()||this.ha.z(a,j)};n.xa=function(){return this.ha.xa(this.b())};n.Qc=function(a){return this.ha.Qc(a)};n.bd=function(a){a=this.ha.Aa(this,a);this.Wc(a);this.ha.wK(a);this.Zo||this.ha.$n(a,j);this.xb=a.style.display!="none"};
n.Ua=function(){fi.c.Ua.call(this);this.ha.se(this);if(this.vo&-2){this.zw&&this.GD(g);if(this.xd(32)){var a=this.Ub();if(a){var b=this.sq();b.Pg(a);this.Qa().g(b,"key",this.sd).g(a,"focus",this.zf).g(a,"blur",this.rd)}}}};
n.GD=function(a){var b=this.Qa(),c=this.b();if(a){b.g(c,"mouseover",this.td).g(c,"mousedown",this.qg).g(c,"mouseup",this.Di).g(c,"mouseout",this.Ci);z&&b.g(c,"dblclick",this.zF)}else{b.Da(c,"mouseover",this.td).Da(c,"mousedown",this.qg).Da(c,"mouseup",this.Di).Da(c,"mouseout",this.Ci);z&&b.Da(c,"dblclick",this.zF)}};n.tb=function(){fi.c.tb.call(this);this.oc&&this.oc.detach();this.ga()&&this.W()&&this.ha.hd(this,j)};
n.k=function(){fi.c.k.call(this);if(this.oc){this.oc.p();delete this.oc}delete this.ha;this.Fe=this.La=i};n.hb=function(a){this.ha.hb(this.b(),a);this.ol(a)};n.ol=function(a){this.La=a};n.fk=function(){var a=this.La;if(!a||q(a))return a;return(a=ia(a)?Qb(a,qf).join(""):qf(a))&&Ba(a)};n.yc=function(a){this.hb(a)};n.wl=function(a){fi.c.wl.call(this,a);var b=this.b();b&&this.ha.wl(b,a)};n.$n=function(a){this.Zo=a;var b=this.b();b&&this.ha.$n(b,a)};n.ga=function(){return this.xb};
n.z=function(a,b){if(b||this.xb!=a&&this.dispatchEvent(a?"show":"hide")){(b=this.b())&&this.ha.z(b,a);this.W()&&this.ha.hd(this,a);this.xb=a;return g}return j};n.W=function(){return!this.Ke(1)};n.HW=function(){var a=this.Ca;return!!a&&typeof a.W=="function"&&!a.W()};n.F=function(a){if(!this.HW()&&this.Qi(1,!a)){if(!a){this.setActive(j);this.Fd(j)}this.ga()&&this.ha.hd(this,a);this.Zd(1,!a)}};n.Fd=function(a){this.Qi(2,a)&&this.Zd(2,a)};n.Ne=function(){return this.Ke(4)};
n.setActive=function(a){this.Qi(4,a)&&this.Zd(4,a)};n.kH=ba(15);n.xl=function(a){this.Qi(8,a)&&this.Zd(8,a)};n.Bf=function(){return this.Ke(16)};n.zc=function(a){this.Qi(16,a)&&this.Zd(16,a)};n.$G=function(){return this.Ke(32)};n.FK=function(a){this.Qi(32,a)&&this.Zd(32,a)};n.isOpen=function(){return this.Ke(64)};n.Cb=function(a){this.Qi(64,a)&&this.Zd(64,a)};n.qe=function(){return this.ya};n.Ke=function(a){return!!(this.ya&a)};
n.Zd=function(a,b){if(this.xd(a)&&b!=this.Ke(a)){this.ha.Zd(this,a,b);this.ya=b?this.ya|a:this.ya&~a}};n.SK=function(a){this.ya=a};n.xd=function(a){return!!(this.vo&a)};n.we=function(a,b){if(this.va&&this.Ke(a)&&!b)e(Error("Component already rendered"));!b&&this.Ke(a)&&this.Zd(a,j);this.vo=b?this.vo|a:this.vo&~a};n.Vd=function(a){return!!(this.dp&a)&&this.xd(a)};n.a0=function(a,b){this.dp=b?this.dp|a:this.dp&~a};n.ms=function(a,b){this.Ms=b?this.Ms|a:this.Ms&~a};
n.Qi=function(a,b){return this.xd(a)&&this.Ke(a)!=b&&(!(this.Ms&a)||this.dispatchEvent(Sg(a,b)))&&!this.he};n.td=function(a){a.relatedTarget&&!df(this.b(),a.relatedTarget)&&this.dispatchEvent("enter")&&this.W()&&this.Vd(2)&&this.Fd(g)};n.Ci=function(a){if(a.relatedTarget&&!df(this.b(),a.relatedTarget)&&this.dispatchEvent("leave")){this.Vd(4)&&this.setActive(j);this.Vd(2)&&this.Fd(j)}};
n.qg=function(a){if(this.W()){this.Vd(2)&&this.Fd(g);if(a.pn(0)){this.Vd(4)&&this.setActive(g);this.ha.tg(this)&&this.Ub().focus()}}!this.Zo&&a.pn(0)&&a.preventDefault()};n.Di=function(a){if(this.W()){this.Vd(2)&&this.Fd(g);this.Ne()&&this.If(a)&&this.Vd(4)&&this.setActive(j)}};n.zF=function(a){this.W()&&this.If(a)};
n.If=function(a){this.Vd(16)&&this.zc(!this.Bf());this.Vd(8)&&this.xl(g);this.Vd(64)&&this.Cb(!this.isOpen());var b=new R("action",this);if(a)for(var c=["altKey","ctrlKey","metaKey","shiftKey"],d,f=0;d=c[f];f++)b[d]=a[d];return this.dispatchEvent(b)};n.zf=function(){this.Vd(32)&&this.FK(g)};n.rd=function(){this.Vd(4)&&this.setActive(j);this.Vd(32)&&this.FK(j)};n.sd=function(a){if(this.ga()&&this.W()&&this.uk(a)){a.preventDefault();a.stopPropagation();return g}return j};
n.uk=function(a){return a.keyCode==13&&this.If(a)};if(!la(fi))e(Error("Invalid component class "+fi));if(!la(bi))e(Error("Invalid renderer class "+bi));var gi=r(fi);Yh[gi]=bi;Zh("goog-control",function(){return new fi(i)});function hi(){}w(hi,bi);ga(hi);hi.prototype.o=function(a){return a.G().o("div",this.Z())};hi.prototype.Aa=function(a,b){if(b.tagName=="HR"){var c=b;b=this.o(a);Xe(b,c);P(c)}else I(b,this.Z());return b};hi.prototype.hb=function(){};hi.prototype.Z=function(){return"goog-menuseparator"};function ii(a,b){fi.call(this,i,a||hi.Fa(),b);this.we(1,j);this.we(2,j);this.we(4,j);this.we(32,j);this.SK(1)}w(ii,fi);ii.prototype.Ua=function(){ii.c.Ua.call(this);Nh(this.b(),"separator")};Zh("goog-menuseparator",function(){return new ii});function ji(){}ga(ji);n=ji.prototype;n.le=function(){};n.nV=function(a){if(a){var b=a.getAttributeNode("tabindex");if(b&&b.specified){a=a.tabIndex;return ka(a)&&a>=0}}return j};n.nv=function(a,b){if(a)a.tabIndex=b?0:-1};n.o=function(a){return a.G().o("div",this.rf(a).join(" "))};n.xa=function(a){return a};n.Qc=function(a){return a.tagName=="DIV"};n.Aa=function(a,b){b.id&&a.lj(b.id);var c=this.Z(),d=j,f=ve(b);f&&Nb(f,function(h){if(h==c)d=g;else h&&this.Ez(a,h,c)},this);d||I(b,c);this.UP(a,b);return b};
n.Ez=function(a,b,c){if(b==c+"-disabled")a.F(j);else if(b==c+"-horizontal")a.zz("horizontal");else b==c+"-vertical"&&a.zz("vertical")};n.UP=function(a,b){if(b)for(var c=b.firstChild,d;c&&c.parentNode==b;){d=c.nextSibling;if(c.nodeType==1){var f=this.Om(c);if(f){f.Wc(c);a.W()||f.F(j);a.kb(f);f.Aa(c)}}else if(!c.nodeValue||Ba(c.nodeValue)=="")b.removeChild(c);c=d}};n.Om=function(a){return ai(a)};n.se=function(a){a=a.b();$f(a,g,B);if(z)a.hideFocus=g;var b=this.le();b&&Nh(a,b)};n.Ub=function(a){return a.b()};
n.Z=function(){return"goog-container"};n.rf=function(a){var b=this.Z(),c=[b,a.vh=="horizontal"?b+"-horizontal":b+"-vertical"];a.W()||c.push(b+"-disabled");return c};n.zE=function(){return"vertical"};function ki(a,b,c){Qg.call(this,c);this.ha=b||ji.Fa();this.vh=a||this.ha.zE()}w(ki,Qg);n=ki.prototype;n.ZW=i;n.oc=i;n.ha=i;n.vh=i;n.xb=g;n.mb=g;n.Fv=g;n.Mb=-1;n.pc=i;n.Nx=j;n.sN=j;n.Qg=i;n.Ub=function(){return this.ZW||this.ha.Ub(this)};n.sq=function(){return this.oc||(this.oc=new Rh(this.Ub()))};n.o=function(){this.Wc(this.ha.o(this))};n.xa=function(){return this.ha.xa(this.b())};n.Qc=function(a){return this.ha.Qc(a)};
n.bd=function(a){this.Wc(this.ha.Aa(this,a));if(a.style.display=="none")this.xb=j};n.Ua=function(){ki.c.Ua.call(this);this.ke(function(b){b.va&&this.BJ(b)},this);var a=this.b();this.ha.se(this);this.z(this.xb,g);this.Qa().g(this,"enter",this.uw).g(this,"highlight",this.ww).g(this,"unhighlight",this.Fw).g(this,"open",this.LU).g(this,"close",this.QT).g(a,"mousedown",this.qg).g(Fe(a),"mouseup",this.bU).g(a,["mousedown","mouseup","mouseover","mouseout"],this.PT);this.tg()&&this.FD(g)};
n.FD=function(a){var b=this.Qa(),c=this.Ub();a?b.g(c,"focus",this.zf).g(c,"blur",this.rd).g(this.sq(),"key",this.sd):b.Da(c,"focus",this.zf).Da(c,"blur",this.rd).Da(this.sq(),"key",this.sd)};n.tb=function(){this.Xc(-1);this.pc&&this.pc.Cb(j);this.Nx=j;ki.c.tb.call(this)};n.k=function(){ki.c.k.call(this);if(this.oc){this.oc.p();this.oc=i}this.ha=this.pc=this.Qg=i};n.uw=function(){return g};
n.ww=function(a){var b=this.Gk(a.target);if(b>-1&&b!=this.Mb){var c=this.mg();c&&c.Fd(j);this.Mb=b;c=this.mg();this.Nx&&c.setActive(g);if(this.pc&&c!=this.pc)c.xd(64)?c.Cb(g):this.pc.Cb(j)}Oh(this.b(),"activedescendant",a.target.b().id)};n.Fw=function(a){if(a.target==this.mg())this.Mb=-1;Oh(this.b(),"activedescendant","")};n.LU=function(a){if((a=a.target)&&a!=this.pc&&a.Ca==this){this.pc&&this.pc.Cb(j);this.pc=a}};n.QT=function(a){if(a.target==this.pc)this.pc=i};
n.qg=function(a){this.mb&&this.Dh(g);var b=this.Ub();this.ha.nV(b)?b.focus():a.preventDefault()};n.bU=function(){this.Dh(j)};n.PT=function(a){var b=this.aT(a.target);if(b)switch(a.type){case "mousedown":b.qg(a);break;case "mouseup":b.Di(a);break;case "mouseover":b.td(a);break;case "mouseout":b.Ci(a);break}};n.aT=function(a){if(this.Qg)for(var b=this.b();a&&a.parentNode&&a!=b;){var c=a.id;if(c in this.Qg)return this.Qg[c];a=a.parentNode}return i};n.zf=function(){};
n.rd=function(){this.Xc(-1);this.Dh(j);this.pc&&this.pc.Cb(j)};n.sd=function(a){if(this.W()&&this.ne()!=0&&this.uk(a)){a.preventDefault();a.stopPropagation();return g}return j};
n.uk=function(a){var b=this.mg();if(b&&typeof b.sd=="function"&&b.sd(a))return g;if(this.pc&&this.pc!=b&&typeof this.pc.sd=="function"&&this.pc.sd(a))return g;switch(a.keyCode){case 27:if(this.tg())this.Ub().blur();else return j;break;case 36:this.pG();break;case 35:this.AV();break;case 38:if(this.vh=="vertical")this.Mw();else return j;break;case 37:if(this.vh=="horizontal")this.un()?this.Lw():this.Mw();else return j;break;case 40:if(this.vh=="vertical")this.Lw();else return j;break;case 39:if(this.vh==
"horizontal")this.un()?this.Mw():this.Lw();else return j;break;default:return j}return g};n.BJ=function(a){var b=a.b();b=b.id||(b.id=a.Lb());if(!this.Qg)this.Qg={};this.Qg[b]=a};n.kb=function(a,b){ki.c.kb.call(this,a,b)};n.Wf=function(a,b,c){a.ms(2,g);a.ms(64,g);if(this.tg()||!this.sN)a.we(32,j);a.uz(j);ki.c.Wf.call(this,a,b,c);c&&this.va&&this.BJ(a);b<=this.Mb&&this.Mb++};
n.removeChild=function(a,b){var c=this.Gk(a);if(c!=-1)if(c==this.Mb)a.Fd(j);else c<this.Mb&&this.Mb--;(c=a.b())&&c.id&&uc(this.Qg,c.id);a=ki.c.removeChild.call(this,a,b);a.uz(g);return a};n.zz=function(a){if(this.b())e(Error("Component already rendered"));this.vh=a};n.ga=function(){return this.xb};n.z=function(a,b){if(b||this.xb!=a&&this.dispatchEvent(a?"show":"hide")){this.xb=a;var c=this.b();if(c){Q(c,a);this.tg()&&this.ha.nv(this.Ub(),this.mb&&this.xb);this.xb&&!b&&this.dispatchEvent("aftershow")}return g}return j};
n.W=function(){return this.mb};n.F=function(a){if(this.mb!=a&&this.dispatchEvent(a?"enable":"disable")){if(a){this.mb=g;this.ke(function(b){if(b.pM)delete b.pM;else b.F(g)})}else{this.ke(function(b){if(b.W())b.F(j);else b.pM=g});this.mb=j;this.Dh(j)}this.tg()&&this.ha.nv(this.Ub(),a&&this.xb)}};n.tg=function(){return this.Fv};n.hd=function(a){a!=this.Fv&&this.va&&this.FD(a);this.Fv=a;this.mb&&this.xb&&this.ha.nv(this.Ub(),a)};n.Xc=function(a){if(a=this.mc(a))a.Fd(g);else this.Mb>-1&&this.mg().Fd(j)};
n.Fd=function(a){this.Xc(this.Gk(a))};n.mg=function(){return this.mc(this.Mb)};n.pG=function(){this.Uq(function(a,b){return(a+1)%b},this.ne()-1)};n.AV=function(){this.Uq(function(a,b){a--;return a<0?b-1:a},0)};n.Lw=function(){this.Uq(function(a,b){return(a+1)%b},this.Mb)};n.Mw=function(){this.Uq(function(a,b){a--;return a<0?b-1:a},this.Mb)};n.Uq=function(a,b){b=b<0?this.Gk(this.pc):b;var c=this.ne();b=a(b,c);for(var d=0;d<=c;){var f=this.mc(b);if(f&&this.bC(f)){this.vz(b);return g}d++;b=a(b,c)}return j};
n.bC=function(a){return a.ga()&&a.W()&&a.xd(2)};n.vz=function(a){this.Xc(a)};n.Dh=function(a){this.Nx=a};function li(){this.np=[]}w(li,bi);ga(li);n=li.prototype;n.gk=function(a){var b=this.np[a];if(!b){switch(a){case 0:b=this.Ai()+"-highlight";break;case 1:b=this.Ai()+"-checkbox";break;case 2:b=this.Ai()+"-content";break}this.np[a]=b}return b};n.le=function(){return"menuitem"};n.o=function(a){var b=a.G().o("div",this.rf(a).join(" "),this.EC(a.La,a.G()));this.qz(a,b,a.xd(8)||a.xd(16));return b};n.xa=function(a){return a&&a.firstChild};
n.Aa=function(a,b){this.gV(b)||b.appendChild(this.EC(b.childNodes,a.G()));if(Be(b,"goog-option")){a.bo(g);this.bo(a,b,g)}return li.c.Aa.call(this,a,b)};n.hb=function(a,b){var c=this.xa(a),d=this.Hw(a)?c.firstChild:i;li.c.hb.call(this,a,b);if(d&&!this.Hw(a))c.insertBefore(d,c.firstChild||i)};n.gV=function(a){a=af(a);var b=this.gk(2);return!!a&&a.className.indexOf(b)!=-1};n.EC=function(a,b){var c=this.gk(2);return b.o("div",c,a)};
n.xs=function(a,b,c){if(b){Nh(b,c?"menuitemradio":this.le());this.qz(a,b,c)}};n.bo=function(a,b,c){if(b){Nh(b,c?"menuitemcheckbox":this.le());this.qz(a,b,c)}};n.Hw=function(a){if(a=this.xa(a)){a=a.firstChild;var b=this.gk(1);return!!a&&!!a.className&&a.className.indexOf(b)!=-1}return j};n.qz=function(a,b,c){if(c!=this.Hw(b)){Ce(b,"goog-option",c);b=this.xa(b);if(c){c=this.gk(1);b.insertBefore(a.G().o("div",c),b.firstChild||i)}else b.removeChild(b.firstChild)}};
n.Nm=function(a){switch(a){case 2:return this.gk(0);case 16:case 8:return"goog-option-selected";default:return li.c.Nm.call(this,a)}};n.iw=function(a){var b=this.gk(0);switch(a){case "goog-option-selected":return 16;case b:return 2;default:return li.c.iw.call(this,a)}};n.Z=function(){return"goog-menuitem"};function mi(a,b,c,d){fi.call(this,a,d||li.Fa(),c);this.jb(b)}w(mi,fi);mi.prototype.Ya=function(){var a=this.Fn;return a!=i?a:this.fk()};mi.prototype.jb=function(a){this.JK(a)};mi.prototype.xs=function(a){this.we(8,a);this.Bf()&&!a&&this.zc(j);var b=this.b();b&&this.ha.xs(this,b,a)};mi.prototype.bo=function(a){this.we(16,a);var b=this.b();b&&this.ha.bo(this,b,a)};Zh("goog-menuitem",function(){return new mi(i)});function ni(){}w(ni,ji);ga(ni);n=ni.prototype;n.le=function(){return"menu"};n.Qc=function(a){return a.tagName=="UL"||ni.c.Qc.call(this,a)};n.Om=function(a){return a.tagName=="HR"?new ii:ni.c.Om.call(this,a)};n.lf=function(a,b){return df(a.b(),b)};n.Z=function(){return"goog-menu"};n.se=function(a){ni.c.se.call(this,a);a=a.b();Oh(a,"haspopup","true")};function oi(a){ii.call(this,hi.Fa(),a)}w(oi,ii);Zh("goog-menuseparator",function(){return new ii});function pi(a,b){ki.call(this,"vertical",b||ni.Fa(),a);this.hd(j)}w(pi,ki);n=pi.prototype;n.Lt=g;n.tN=j;n.Z=function(){return this.ha.Z()};n.lf=function(a){if(this.ha.lf(this,a))return g;for(var b=0,c=this.ne();b<c;b++){var d=this.mc(b);if(typeof d.lf=="function"&&d.lf(a))return g}return j};n.oa=function(a){this.kb(a,g)};n.Og=function(a,b){this.Wf(a,b,g)};n.ue=ba(13);n.ng=function(a){return this.mc(a)};n.lk=function(){return this.ne()};n.mk=function(){return this.Ec||[]};
n.setPosition=function(a,b){var c=this.ga();c||Q(this.b(),g);Nf(this.b(),a,b);c||Q(this.b(),j)};n.uf=function(){return this.ga()?Kf(this.b()):i};n.ll=function(a){(this.Lt=a)&&this.hd(g)};n.z=function(a,b){(b=pi.c.z.call(this,a,b))&&a&&this.va&&this.Lt&&this.Ub().focus();return b};n.uw=function(a){this.Lt&&this.Ub().focus();return pi.c.uw.call(this,a)};n.bC=function(a){return(this.tN||a.W())&&a.ga()&&a.xd(2)};function qi(a,b){this.Ni=a||1;this.xo=b||ri;this.$t=u(this.S1,this);this.ux=v()}w(qi,Og);qi.prototype.enabled=j;var ri=da.window;n=qi.prototype;n.Ib=i;n.setInterval=function(a){this.Ni=a;if(this.Ib&&this.enabled){this.stop();this.start()}else this.Ib&&this.stop()};n.S1=function(){if(this.enabled){var a=v()-this.ux;if(a>0&&a<this.Ni*0.8)this.Ib=this.xo.setTimeout(this.$t,this.Ni-a);else{this.vQ();if(this.enabled){this.Ib=this.xo.setTimeout(this.$t,this.Ni);this.ux=v()}}}};n.vQ=function(){this.dispatchEvent("tick")};
n.start=function(){this.enabled=g;if(!this.Ib){this.Ib=this.xo.setTimeout(this.$t,this.Ni);this.ux=v()}};n.stop=function(){this.enabled=j;if(this.Ib){this.xo.clearTimeout(this.Ib);this.Ib=i}};n.k=function(){qi.c.k.call(this);this.stop();delete this.xo};function si(a,b,c){if(la(a)){if(c)a=u(a,c)}else if(a&&typeof a.handleEvent=="function")a=u(a.handleEvent,a);else e(Error("Invalid listener argument"));return b>2147483647?-1:ri.setTimeout(a,b||0)}function ti(a){ri.clearTimeout(a)};function ui(a,b){this.qa=new V(this);this.os(a||i);b&&this.$0(b)}w(ui,Og);n=ui.prototype;n.D=i;n.NN=g;n.NB=i;n.Qe=j;n.n1=j;n.zH=-1;n.vH=-1;n.yV=j;n.JQ=g;n.Zb="toggle_display";n.xf=function(){return this.Zb};n.$0=function(a){this.Zb=a};n.b=function(){return this.D};n.os=function(a){this.PQ();this.D=a};n.PQ=function(){if(this.Qe)e(Error("Can not change this state of the popup while showing."))};n.ga=function(){return this.Qe};n.z=function(a){a?this.po():this.Bk()};n.Ga=fa;
n.po=function(){if(!this.Qe)if(this.Vx()){if(!this.D)e(Error("Caller must call setElement before trying to show the popup"));this.Ga();var a=Fe(this.D);this.yV&&this.qa.g(a,"keydown",this.uY,g);if(this.NN){this.qa.g(a,"mousedown",this.uI,g);if(z){for(var b=a.activeElement;b&&b.nodeName=="IFRAME";){try{var c=jf(b)}catch(d){break}a=c;b=a.activeElement}this.qa.g(a,"mousedown",this.uI,g);this.qa.g(a,"deactivate",this.tI)}else this.qa.g(a,"blur",this.tI)}if(this.Zb=="toggle_display")this.u1();else this.Zb==
"move_offscreen"&&this.Ga();this.Qe=g;this.by()}};n.Bk=function(a){if(!this.Qe||!this.kY(a))return j;this.qa&&this.qa.Mc();if(this.Zb=="toggle_display")this.n1?si(this.nG,0,this):this.nG();else this.Zb=="move_offscreen"&&this.SX();this.Qe=j;this.yg(a);return g};n.u1=function(){this.D.style.visibility="visible";Q(this.D,g)};n.nG=function(){this.D.style.visibility="hidden";Q(this.D,j)};n.SX=function(){this.D.style.left="-200px";this.D.style.top="-200px"};n.Vx=function(){return this.dispatchEvent("beforeshow")};
n.by=function(){this.zH=v();this.vH=-1;this.dispatchEvent("show")};n.kY=function(a){return this.dispatchEvent({type:"beforehide",target:a})};n.yg=function(a){this.vH=v();this.dispatchEvent({type:"hide",target:a})};n.uI=function(a){a=a.target;if(!df(this.D,a)&&(!this.NB||df(this.NB,a))&&!this.dL())this.Bk(a)};n.uY=function(a){if(a.keyCode==27)if(this.Bk(a.target)){a.preventDefault();a.stopPropagation()}};
n.tI=function(a){if(this.JQ){var b=Fe(this.D);if(z||y){if((a=b.activeElement)&&df(this.D,a))return}else if(a.target!=b)return;this.dL()||this.Bk()}};n.dL=function(){return v()-this.zH<150};n.k=function(){ui.c.k.call(this);this.qa.p();delete this.D;delete this.qa};function vi(a,b){pi.call(this,a,b);this.ll(g);this.z(j,g);this.Qf=new Mc}w(vi,pi);n=vi.prototype;n.Y1=j;n.wH=0;n.di=i;n.bd=function(a){vi.c.bd.call(this,a);(a=a.getAttribute("for")||a.htmlFor)&&this.Pg(this.G().b(a),1)};n.Ua=function(){vi.c.Ua.call(this);Jc(this.Qf,this.FB,this);var a=this.Qa();a.g(this,"action",this.iY);a.g(this.G().M(),"mousedown",this.sI,g);E&&a.g(this.G().M(),"contextmenu",this.sI,g)};n.Pg=function(a,b,c,d,f){if(!this.TG(a)){a=this.nP(a,b,c,d,f);this.va&&this.FB(a)}};
n.nP=function(a,b,c,d,f){if(!a)return i;b={D:a,CL:b,MX:c,MD:d?"contextmenu":"mousedown",Gx:f};this.Qf.u(r(a),b);return b};n.TG=function(a){return a?this.Qf.Ce(r(a)):j};n.FB=function(a){this.Qa().g(a.D,a.MD,this.KI)};n.detach=function(a){if(!this.TG(a))e(Error("Menu not attached to provided element, unable to detach."));a=r(a);this.va&&this.fQ(this.Qf.la(a));this.Qf.remove(a)};n.fQ=function(a){this.Qa().Da(a.D,a.MD,this.KI)};
n.Rz=function(a,b,c,d){var f=this.ga();if((f||this.K2())&&this.Y1)this.hide();else if(this.dispatchEvent("beforeshow")){b=typeof b!="undefined"?b:4;if(!f)this.b().style.visibility="hidden";Q(this.b(),g);a.Ga(this.b(),b,c);if(!f)this.b().style.visibility="visible";this.Xc(-1);this.di=d||i;this.z(g)}};n.iL=function(a,b,c){this.Rz(a.CL!==undefined?new Jh(a.D,a.CL,g):new Mh(b,c),a.MX,a.Gx,a.D)};n.fL=function(a,b,c){this.Rz(new Mh(a,b),c)};n.o1=function(a,b,c){this.Rz(new Kh(a,b,g),c,i,a)};
n.hide=function(){this.z(j);if(!this.ga()){this.wH=v();this.di=i}};n.K2=function(){return v()-this.wH<150};n.iY=function(){this.hide()};n.KI=function(a){for(var b=this.Qf.wi(),c=0;c<b.length;c++){var d=this.Qf.la(b[c]);if(d.D==a.currentTarget){this.iL(d,a.clientX,a.clientY);a.preventDefault();a.stopPropagation();return}}};n.sI=function(a){this.ga()&&!this.lf(a.target)&&this.hide()};n.rd=function(a){vi.c.rd.call(this,a);this.hide()};n.k=function(){vi.c.k.call(this);if(this.Qf){this.Qf.clear();delete this.Qf}};var wi={zM:["BC","AD"],yM:["Before Christ","Anno Domini"],LM:["J","F","M","A","M","J","J","A","S","O","N","D"],UM:["J","F","M","A","M","J","J","A","S","O","N","D"],GM:["January","February","March","April","May","June","July","August","September","October","November","December"],TM:["January","February","March","April","May","June","July","August","September","October","November","December"],QM:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],WM:["Jan","Feb","Mar","Apr","May",
"Jun","Jul","Aug","Sep","Oct","Nov","Dec"],aN:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],YM:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],SM:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],XM:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],m3:["S","M","T","W","T","F","S"],VM:["S","M","T","W","T","F","S"],RM:["Q1","Q2","Q3","Q4"],NM:["1st quarter","2nd quarter","3rd quarter","4th quarter"],rM:["AM","PM"],RA:["EEEE, MMMM d, y","MMMM d, y","MMM d, y",
"M/d/yy"],eB:["h:mm:ss a zzzz","h:mm:ss a z","h:mm:ss a","h:mm a"],R2:{Md:"M/d",MMMMd:"MMMM d",MMMd:"MMM d"},f3:6,D3:[5,6],g3:2};function xi(){}function yi(a){if(typeof a=="number"){var b=new xi;b.rL=a;b.LL=zi(a);a=a;if(a==0)a="UTC";else{var c=["UTC",a<0?"+":"-"];a=Math.abs(a);c.push(Math.floor(a/60)%100);a%=60;a!=0&&c.push(":",a);a=c.join("")}b.mA=[a,a];b.Ys=[];return b}b=new xi;b.LL=a.id;b.rL=-a.std_offset;b.mA=a.names;b.Ys=a.transitions;return b}function zi(a){if(a==0)return"Etc/GMT";var b=["Etc/GMT",a<0?"-":"+"];a=Math.abs(a);b.push(Math.floor(a/60)%100);a%=60;a!=0&&b.push(":",Wa(a,2));return b.join("")}n=xi.prototype;
n.yE=function(a){a=Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes())/36E5;for(var b=0;b<this.Ys.length&&a>=this.Ys[b];)b+=2;return b==0?0:this.Ys[b-1]};n.IS=function(a){a=this.Zv(a);var b=["GMT"];b.push(a<=0?"+":"-");a=Math.abs(a);b.push(Wa(Math.floor(a/60)%100,2),":",Wa(a%60,2));return b.join("")};n.TS=function(a){return this.mA[this.XG(a)?3:1]};n.Zv=function(a){return this.rL-this.yE(a)};
n.gT=function(a){a=-this.Zv(a);var b=[a<0?"-":"+"];a=Math.abs(a);b.push(Wa(Math.floor(a/60)%100,2),Wa(a%60,2));return b.join("")};n.nT=function(a){return this.mA[this.XG(a)?2:0]};n.XG=function(a){return this.yE(a)>0};function Ai(a){ib(a!==undefined,"Pattern must be defined");this.Or=[];typeof a=="number"?this.BB(a):this.AB(a)}var Bi=[/^\'(?:[^\']|\'\')*\'/,/^(?:G+|y+|M+|k+|S+|E+|a+|h+|K+|H+|c+|L+|Q+|d+|m+|s+|v+|z+|Z+)/,/^[^\'GyMkSEahKHcLQdmsvzZ]+/];n=Ai.prototype;n.AB=function(a){for(;a;)for(var b=0;b<Bi.length;++b){var c=a.match(Bi[b]);if(c){c=c[0];a=a.substring(c.length);if(b==0)if(c=="''")c="'";else{c=c.substring(1,c.length-1);c=c.replace(/\'\'/,"'")}this.Or.push({text:c,type:b});break}}};
n.Hv=function(a,b){var c=b?(a.getTimezoneOffset()-b.Zv(a))*6E4:0,d=c?new Date(a.getTime()+c):a,f=d;if(b&&d.getTimezoneOffset()!=a.getTimezoneOffset()){c+=c>0?-86400000:864E5;f=new Date(a.getTime()+c)}c=[];for(var h=0;h<this.Or.length;++h){var k=this.Or[h].text;1==this.Or[h].type?c.push(this.JR(k,a,d,f,b)):c.push(k)}return c.join("")};n.BB=function(a){if(a<4)a=wi.RA[a];else if(a<8)a=wi.eB[a-4];else if(a<12)a=wi.RA[a-8]+" "+wi.eB[a-8];else{this.BB(10);return}this.AB(a)};
n.IR=function(a,b){b=b.getFullYear()>0?1:0;return a>=4?wi.yM[b]:wi.zM[b]};n.VR=function(a,b){b=b.getFullYear();if(b<0)b=-b;return a==2?Wa(b%100,2):String(b)};n.MR=function(a,b){b=b.getMonth();switch(a){case 5:return wi.LM[b];case 4:return wi.GM[b];case 3:return wi.QM[b];default:return Wa(b+1,a)}};n.DR=function(a,b){return Wa(b.getHours()||24,a)};n.KR=function(a,b){return(b.getTime()%1E3/1E3).toFixed(Math.min(3,a)).substr(2)+(a>3?Wa(0,a-3):"")};
n.GR=function(a,b){b=b.getDay();return a>=4?wi.aN[b]:wi.SM[b]};n.ER=function(a,b){a=b.getHours();return wi.rM[a>=12&&a<24?1:0]};n.CR=function(a,b){return Wa(b.getHours()%12||12,a)};n.zR=function(a,b){return Wa(b.getHours()%12,a)};n.AR=function(a,b){return Wa(b.getHours(),a)};n.PR=function(a,b){b=b.getDay();switch(a){case 5:return wi.VM[b];case 4:return wi.YM[b];case 3:return wi.XM[b];default:return Wa(b,1)}};
n.QR=function(a,b){b=b.getMonth();switch(a){case 5:return wi.UM[b];case 4:return wi.TM[b];case 3:return wi.WM[b];default:return Wa(b+1,a)}};n.NR=function(a,b){b=Math.floor(b.getMonth()/3);return a<4?wi.RM[b]:wi.NM[b]};n.FR=function(a,b){return Wa(b.getDate(),a)};n.LR=function(a,b){return Wa(b.getMinutes(),a)};n.OR=function(a,b){return Wa(b.getSeconds(),a)};n.SR=function(a,b,c){c=c||yi(b.getTimezoneOffset());return a<4?c.gT(b):c.IS(b)};
n.UR=function(a,b,c){c=c||yi(b.getTimezoneOffset());return a<4?c.nT(b):c.TS(b)};n.RR=function(a,b){b=b||yi(a.getTimezoneOffset());return b.LL};
n.JR=function(a,b,c,d,f){var h=a.length;switch(a.charAt(0)){case "G":return this.IR(h,c);case "y":return this.VR(h,c);case "M":return this.MR(h,c);case "k":return this.DR(h,d);case "S":return this.KR(h,d);case "E":return this.GR(h,c);case "a":return this.ER(h,d);case "h":return this.CR(h,d);case "K":return this.zR(h,d);case "H":return this.AR(h,d);case "c":return this.PR(h,c);case "L":return this.QR(h,c);case "Q":return this.NR(h,c);case "d":return this.FR(h,c);case "m":return this.LR(h,d);case "s":return this.OR(h,
d);case "v":return this.RR(b,f);case "z":return this.UR(h,b,f);case "Z":return this.SR(h,b,f);default:return""}};function Ci(a){if(a.tagName!="A")return j;if(a.hash&&a.hash.length>1){a=a.search.match(/id\=([^\&]+)/i);if((a?a[1]:i)==Hd())return g}return j}function Di(a){var b=G("userTimeZone");if(b!=i&&b!=="")b=yi(-Number(b));a=(new Ai(11)).Hv(new Date(a),b);if(/[^\u200F]+\u200F/.test(a))a="\u200f"+a;return a}window.isUPWindow=g;
function Ei(a){var b=O("hidden_download_frame");if(b)b.src=a;else{O("hidden_download_container").innerHTML='<iframe id="hidden_download_frame" style="width:0;height:0;border:0" src="'+a+'"></iframe>';b=O("hidden_download_frame")}Bg(b,"load",function(){Fi("print")})}function Gi(a){if(a&&a.childNodes&&a.childNodes.length)return a.childNodes.length;return 0}function Hi(a,b){for(;a!=i&&Gi(a)==1&&a.childNodes[0].nodeType!=3;)a=a.childNodes[0];kf(a,b)}
function Ii(a){var b=a.style[Af("background-color")];if(b){yf(a,"background-color","");a.setAttribute("bgcolor",b);return b}else return a.getAttribute("bgcolor")}function Ji(a){return function(b,c){b=b?b:window.event?window.event:i;if(b==i&&X)b=X.event;if(b){var d=b.target?b.target:b.srcElement;if(d)return a(b,d,c)}return g}}function Ki(a){try{return!!a.match(/^\d+$/)}catch(b){return j}}function Li(a){return Ba(a)}function Mi(a){return a?za(a):a}
function Ni(a){if(a==i||a.length==0)return"";a=Ba(a);return a.replace(/\s/g,"_")}
function Oi(){try{var a=G("siteprefix")+"/";Pi();var b=j,c=j,d=j;try{b=window.opener&&!window.opener.closed&&"isUPWindow"in window.opener&&window.opener.isUPWindow!=i;c=window.opener==window;if(b&&!c)window.opener.newDoclist||window.opener.location.reload(g);d=window.opener.closed}catch(f){}if(!b||c){window.location.href=a;window.name="Writely"}else{if(!window.closed)if(z){if(window.offline){window.location.href=a;window.name="Writely";return}var h=window.navigator.appVersion,k=h.indexOf("MSIE "),
l=h.substring(k+5,k+8);if(parseFloat(l)>=7){window.open("","_self");window.setTimeout(function(){self.close()},100)}else self.close()}else window.setTimeout(function(){window.close()},100);b&&d&&window.opener.focus()}}catch(m){rce("ReloadOpener",m)}}function zb(a,b){if(b){var c=b.name,d=b.message;if(c)a+=":"+c;if(d)a+=":"+d;if(!c&&!d)a+=":"+b.toString()}typeof RunningOnLocalServer=="function"&&RunningOnLocalServer()?F(a):rce("DebugAlert",a)}
function Qi(){var a="",b=Qi,c=[];try{a:for(;b!=i;){c.push(b);var d=b.toString(),f=d.indexOf("(");if(f>=0)d=d.substring(0,f);a+=d+"(";if("arguments"in b)for(var h=0;h<b.arguments.length;h++){var k=b.arguments[h]||"null";if(k.length>100)k=k.substring(0,100);a+=String(k);if(h<b.arguments.length-1)a+=", "}a+=")\n";b=b.caller;for(h=0;h<c.length;h++)if(c[h]==b)break a}}catch(l){}return a}function Ri(a,b,c,d){if(c!=i&&c.length>0)b+=c;if(d!=i)b+=": "+d.tagName.toLowerCase();rce(a,b);return i}
function Si(a,b,c){try{if(a==i)return Ri("UpToTag","nodeorpath is null");var d="length"in a?a[0]:a;for(;;){if(d==i)return Ri("UpToTag","node is null in while",i,i);if(!("tagName"in d))return Ri("UpToTag","tagName is undefined in while",i,i);if(d.tagName==i)return Ri("UpToTag","node.tagName is null in while",i,i);if(!("parentNode"in d))return Ri("UpToTag","parentNode is undefined in while",i,d);if(d.parentNode==i)return Ri("UpToTag","node.parentNode is null in while",i,d);if(d.tagName.toLowerCase()==
b)return d;if(c!=i&&d.tagName.toLowerCase()==c)return d;if(d.tagName=="BODY")return i;d=d.parentNode}}catch(f){rce("UpToTag",f,"Can't go up to \""+b+'".')}return i}
function Ti(a,b){try{if(a==i)return Ri("UpToClass","nodeorpath is null");var c="length"in a?a[0]:a;for(;;){if(c==i)return Ri("UpToClass","node is null in while",path,i);if(j in c)return Ri("UpToClass","parentNode is undefined in while",path,c);if(c.parentNode==i)return Ri("UpToClass","node.parentNode is null in while",path,c);if(Be(c,b))return c;c=c.parentNode}}catch(d){rce("UpToClass",d,"Can't go up to \""+b+'".')}return i}window.gData=i;
function Ui(){window.setTimeout(function(){for(var a=window.document.getElementsByTagName("SELECT"),b=0,c;c=a[b];b++)c.style.display="";if(typeof X!="undefined"&&X!=i){try{X.focus()}catch(d){}if(dh&&"moveEnd"in dh){dh.moveEnd("character",0);dh.collapse();dh.select()}}},y?100:0)}function Vi(a,b,c,d,f,h){if(a=oh("MiscTextBox",{text:a,caption:b,title:c,width:d,FH:f})){if(!la(h)&&h!==j)if(h&&h.focus){var k=h;h=function(){k.focus()}}else h=la(window.dB)?Ui:i;h&&Bg(a,"afterhide",h)}}
function Wi(a,b){if(a==i)return"";a=a;if(a.indexOf(b+":")==0)a=a.substring((b+":").length);if(a.indexOf("<!DOCTYPE")!=-1)a=a.substring(0,a.indexOf("<!DOCTYPE"));return a}function Xi(a){if(a&&typeof X!="undefined"&&X&&!X.document.getElementById(a))return a;a=Math.random()*4E7;a=Yi.charAt(a%26)+Yi.charAt((a>>6)%40)+Yi.charAt((a>>12)%40)+Yi.charAt((a>>18)%40);if(typeof X!="undefined"&&X)for(;X.document.getElementById(a);)a+=Yi.charAt(Math.random()*40);if(a.indexOf("--")!=-1)return Xi();return a}
var Yi="abcdefghijklmnopqrstuvwxyz0123456789-_:.";function Zi(a){if(X.document.createRange){var b=X.document.createRange();b.setStart(a,0);b.setEnd(a,0);if(a=$i(X)){a.removeAllRanges();a.addRange(b)}}else{b=X.document.body.createTextRange();b.moveToElementText(a);b.collapse();b.select()}return j}
function aj(a){if(X.document.createRange){var b=X.document.createRange();b.selectNodeContents(a);if(a=$i(X)){a.removeAllRanges();a.addRange(b)}}else{b=X.document.body.createTextRange();b.moveToElementText(a);b.select()}return j}function bj(a,b){if(b)if(b.parentNode==a.document.body)if(b.nextSibling==i||j in b.nextSibling||b.nextSibling.tagName==i){b=a.document.createElement("br");a.document.body.appendChild(b)}}
function cj(){window.location==window.top.location&&typeof dj!="undefined"?window.setTimeout(ej,0):window.location.reload(g)}
function th(a){if(a){var b;b=a.responseText;b=b==i?j:b.indexOf("Warning:")==0;if(b){$g();return!Ld(Wi(a.responseText,"Warning"))}else{b=a.responseText;b=b==i?j:b.indexOf("Error:")==0;if(b){$g();F(Wi(a.responseText,"Error"));return g}else{b=a.responseText;b=b==i?j:b.indexOf("Redirect:")==0;if(b){$g();window.location.href=Jd(Wi(a.responseText,"Redirect"));return g}}}}return j}function uh(){typeof ra!="undefined"&&typeof dj!="undefined"&&"publish"==fj()?ej():$g()}
var gj=/google-navclient-hilite|__firefox-findbar-search-id|gtbmisp_\d+/i,hj=/__mozilla-findbar-search/i;function ij(){return(window.getComputedStyle?window.getComputedStyle(document.body,i):document.body.currentStyle).direction=="rtl"}function jj(a){kj&&lj("dl_1st_email");var b=Sd("isshared");window.ToCollaborators=b;window.ToViewers=b;window.ToBoth=b&&b;window.AllowAttach=g;window.NewFolks=i;window.SendDocument=a;oh("EmailDocument")}window.NewFolks=i;window.ToCollaborators=j;window.ToViewers=j;
window.ToBoth=j;window.AllowAttach=j;window.SendDocument=j;o("InError",th,void 0);o("Stack",Qi,void 0);function mj(a,b,c,d,f,h){this.D=a;this.Be=b;this.uc=c;this.jM=d;this.iQ=f||nj;this.Oc=h||this.Bn;this.ea=new vi}var oj=[{name:"Yellow",className:"writely-comment-yellow",event:4},{name:"Orange",className:"writely-comment-orange",event:5},{name:"Pink",className:"writely-comment-pink",event:6},{name:"Green",className:"writely-comment-green",event:7},{name:"Blue",className:"writely-comment-blue",event:8},{name:"Purple",className:"writely-comment-purple",event:9}];n=mj.prototype;
n.Bn=function(a){switch(a.target.Ya()){case 0:this.uc.focus();break;case 1:this.ZP();break;case 2:this.fW();break;case 3:break;case 4:this.nl(oj[0]);break;case 5:this.nl(oj[1]);break;case 6:this.nl(oj[2]);break;case 7:this.nl(oj[3]);break;case 8:this.nl(oj[4]);break;case 9:this.nl(oj[5]);break;default:}this.p()};
n.Yc=function(){this.ea.oa(new mi("Close this menu",0));this.ea.oa(new oi);this.ea.oa(new mi("Delete comment",1));this.ea.oa(new mi("Insert comment text into document",2));this.ea.oa(new oi);var a=new mi("Comment Color:",3);a.xs(j);this.ea.oa(a);a=this.qS();for(var b=0;b<oj.length;b++){var c=oj[b],d=new mi(c.name,c.event);d.bo(g);d.zc(c==a);this.ea.oa(d)}this.ea.ll(j);U(this.ea,"action",this.Oc,g,this);U(this.uc.document,"mousedown",this.p,j,this);U(this.uc.document,"keydown",this.p,g,this);this.ea.db(this.D);
this.ea.o1(this.Be,1);this.ea.z(g)};n.qS=function(){for(var a=0;a<oj.length;a++){var b=oj[a];if(Be(this.Be,b.className))return b}return i};n.p=function(){Cg(this.ea,"action",this.Oc,g,this);Cg(this.uc.document,"mousedown",this.p,j,this);Cg(this.uc.document,"keydown",this.p,g,this);this.ea.p()};
n.nl=function(a){if(this.Be){pj=a;a=this.uc.document.getElementsByTagName("span");var b=0;if(this.Be.id=="writely-comment-id-"+this.jM)for(var c=0,d;d=a[c];c++)d.id==this.Be.id&&b++;b>1?this.iQ.openDialog("CommentSettings"):qj(j,this.Be.id=="writely-comment-id-"+this.jM)}};n.ZP=function(){if(this.Be){this.Be.parentNode.removeChild(this.Be);x.fa();x.Ta();X.focus()}};n.fW=function(){if(this.Be){this.Be.className="";x.fa();x.Ta();X.focus()}};var pj=oj[0];function rj(){sj(Di(v()))}
function sj(a){var b=oj[typeof DefaultCommentColor!="undefined"?DefaultCommentColor:editUI.Rj];if(X)var c=tj(X,b,function(){return Ld("Include the selected text in the comment?")});if(c){a=Na("-"+G("userShortName")+" "+a);if(z){b=X.document.body.createTextRange();b.moveToElementText(c);var d=b.duplicate();d.collapse(j);d.pasteHTML("&nbsp;"+Ha(a));b.select()}else{aj(c.childNodes[1]||c);a=X.document.createTextNode(" "+a);c.appendChild(a)}bj(X,c)}x.fa();X.focus()}var uj=i;
function qj(a,b){for(var c=[],d=0;d<oj.length;d++)c.push(oj[d].className);if(a){a=X.document.getElementsByTagName("span");d=0;for(var f;f=a[d];d++)f.id==uj.id&&Ae(f,c,pj.className)}else Ae(uj,c,pj.className);x.fa();x.Ta();if(b&&uj.id=="writely-comment-id-"+G("userId"))for(b=0;b<oj.length;b++)if(pj==oj[b]){if(typeof DefaultCommentColor!="undefined")DefaultCommentColor=b;else editUI.Rj=b;Aj("highlightcolor",{color:b});break}}
function tj(a,b,c){var d=i,f=Bh(a);if(!f&&dh)f=se.a4(dh);if(!f)return i;if(f.isCollapsed()){a:{d=f;f=i;try{ih('<span id="writely-temp-comment-id" class="writely-comment '+b.className+'">&nbsp;</span>&nbsp;')}catch(h){f=a.document.createElement("span");if(!d){d=i;break a}d.insertNode(f)}if(f=a.document.getElementById("writely-temp-comment-id")){f.removeAttribute("id");f.removeAttribute("ID")}d=f}if(d){d.id="writely-comment-id-"+G("userId");d.className="writely-comment "+b.className;d.firstChild&&d.removeChild(d.firstChild);
E&&d.appendChild(a.document.createTextNode(" "));a=a.document.createTextNode("type here");d.appendChild(a)}}else{d=f.Ab();if(!c())return i;gh(f.vc());c=Ba(d)||"type here";f.gd();d=a.document.createElement("span");d.className="writely-comment "+b.className;E&&d.appendChild(a.document.createTextNode("\u00a0"));d=f.insertNode(d,j);a=a.document.createTextNode(c);d.appendChild(a);d.id="writely-comment-id-"+G("userId");x.Ta()}return d};function Bj(a,b,c){this.nI=a;this.A_=!!c;a&&!b&&this.next()}w(Bj,hc);Bj.prototype.next=function(){var a=this.nI;if(!a)e(gc);this.nI=this.A_?a.previousSibling:a.nextSibling;return a};function Cj(a,b,c){c!==undefined||(c=b&&a.childNodes.length?a.childNodes.length-1:0);Bj.call(this,a.childNodes[c],g,b)}w(Cj,Bj);var Dj=Ec("ADDRESS","BLOCKQUOTE","BODY","CAPTION","CENTER","COL","COLGROUP","DIR","DIV","DL","DD","DT","FIELDSET","FORM","H1","H2","H3","H4","H5","H6","HR","ISINDEX","OL","LI","MAP","MENU","OPTGROUP","OPTION","P","PRE","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","TL","UL"),Ej=Ec("IMG","IFRAME","EMBED");function Fj(a){return J(a).qn()}function Gj(a){for(var b;b=Hj(a);)a=b;return a}function Ij(a){for(var b;b=Jj(a);)a=b;return a}function Jj(a){return!a||a.nodeType!=1?i:Kj(mc(new Cj(a,j),Lj))}
function Hj(a){return!a||a.nodeType!=1?i:Kj(mc(new Cj(a,g),Lj))}function Mj(a){return Kj(mc(new Bj(a,j,g),Lj))}function Nj(a){return Kj(mc(new Bj(a),Lj))}function Kj(a){try{return a.next()}catch(b){return i}}function Lj(a){return a.nodeType==1||a.nodeType==3&&!ya(a.nodeValue)}function Oj(a,b){var c=sf(a);if(a.getElementsByTagName)for(var d in Ej)if(a.tagName==d||a.getElementsByTagName(d).length>0)return j;return!b&&c=="\u00a0"||ya(c)}function Pj(a){return a.length||a.childNodes.length}
function Qj(a){return!!Dj[a.tagName]}function Rj(a){for(;a&&a.nodeType==3&&!a.nodeValue;)a=a.nextSibling;return a}function Sj(a){return a.getAttribute&&a.getAttribute("g_editable")=="true"};function Tj(a){return function(){return a}}var Uj=Tj(j),Vj=Tj(g);function Wj(a){return a}function Xj(a){return function(){return a.call(this)}};var Yj={Vl:"+undo",Tl:"+redo",YA:"+link",Io:"+formatBlock",XA:"+indent",bB:"+outdent",Po:"+removeFormat",cB:"+strikeThrough",WA:"+insertHorizontalRule",Bt:"+subscript",Ct:"+superscript",Ul:"+underline",ZM:"+unlink",Rl:"+bold",Sl:"+italic",VA:"+fontSize",UA:"+fontName",Ho:"+foreColor",xM:"+emoticon",qt:"+backColor",Oo:"+insertOrderedList",Qo:"+insertUnorderedList",w3:"+table",Jo:"+justifyCenter",Ko:"+justifyFull",Mo:"+justifyRight",Lo:"+justifyLeft",sM:"+BLOCKQUOTE",SA:"ltr",rt:"rtl",CM:"image",wM:"editHtml",
a3:"+defaultTag",X2:"clearlorem",A3:"updatelorem",B3:"usinglorem",l3:"link"};function Zj(){this.mb=this.Gt()}w(Zj,Og);n=Zj.prototype;n.n=i;n.yb=function(){return this.n&&this.n.sb};n.MB=g;n.Dd=function(a){this.n=a};n.Rf=function(){if(this.n){this.Fc(this.n);this.n=i}};n.qd=function(a){if(this.n==a)this.mb=g};n.Fc=function(a){if(this.n==a)this.mb=j};n.W=function(a){return this.n==a?this.mb:j};n.Z_=function(a){this.MB=a};n.Gt=Uj;n.NW=Uj;n.k=function(){this.n&&this.Rf(this.n);Zj.c.k.call(this)};
var $j=Ac({yU:1,Mq:2,zU:3,Fi:4,an:5,execCommand:6,queryCommandValue:7,Sr:8,mC:10,JO:11}),ak=Ec(8,10,11);Zj.prototype.execCommand=function(a){var b=this.NW(a);if(!b){B&&this.n.$e(g,g);this.n.Uc()}try{var c=this.bh.apply(this,arguments)}finally{if(!b){this.n.fa();a!="+link"&&this.n.Ta()}}return c};Zj.prototype.te=function(){return j};function bk(){Zj.call(this)}w(bk,Zj);function ck(){Zj.call(this)}w(ck,bk);n=ck.prototype;n.gb=function(){return"WritelyBackspaceHandler"};n.Mq=function(a){if(!B||a.keyCode!=46)return j;var b=j;if(this.jD(a.keyCode))b=g;if(this.YP())b=g;b&&a.preventDefault();return b};
n.YP=function(){var a=this.n.O();if(a.isCollapsed()){var b=a.da();a=a.Ma();var c=i;if(b.nodeType==3)if(a==b.nodeValue.length){c=b.nextSibling;b=b.parentNode}else return;else if(b.nodeType==1)c=b.childNodes[a];if(c&&c.tagName=="BR"){c!=this.n.b().lastChild&&b.removeChild(c);return g}}};n.an=function(a){var b=j;if(a.keyCode!=8&&a.keyCode!=46)return j;if(a.keyCode==8&&!z&&this.ZY())b=g;if(!b&&!z&&this.jD(a.keyCode))b=g;!b&&E&&this.nR();b&&a.preventDefault();return b};
n.ZY=function(){var a=this.ZD(this.n.O(),"LI");if(a==i||a.parentNode==i)return j;var b=a.parentNode;if(!b||b.tagName!="UL"&&b.tagName!="OL")return j;if(!this.ZG(a))return j;sa.execute("+outdent");return g};n.jD=function(a){var b=i;if(a==8)b=this.ZD(this.n.O(),"TD");else if(a==46)b=this.dR(this.n.O(),"TD");if(b==i)return j;return g};
n.nR=function(){var a=this.n.O(),b=a.L();if(a.isCollapsed()&&b.nodeType==3&&/^[\t\n\r ]/.test(b.nodeValue)&&b.previousSibling&&Qj(b.previousSibling)){var c=b.nodeValue.length;a=a.ka();b.nodeValue=b.nodeValue.replace(/^[\t\n\r ]+/,"");dk(b,Math.max(0,a-(c-b.nodeValue.length))).select()}};n.ZD=function(a,b){if(!a)return i;if(!a.isCollapsed())return i;if(a.ka()!=0)return i;a=uf(a.L(),u(function(c){if(!this.ZG(c))return g;return c.tagName==b},this),g,5);return a.tagName==b?a:i};
n.ZG=function(a){var b=a.parentNode;if(!b)return j;var c=b.firstChild;if(a==c)return g;if(a==b.childNodes[1]&&c.nodeType==3&&c.data&&c.data.match(/^[\n\r\t ]+$/))return g;return j};n.dR=function(a,b){if(!a)return i;if(!a.isCollapsed())return i;var c=a.L();if(c.nodeType==3){if(a.ka()!=c.nodeValue.length)return i}else if(a.ka()!=c.childNodes.length)return i;a=uf(c,u(function(d){if(!this.DW(d))return g;return d.tagName==b},this),g,5);return a.tagName==b?a:i};
n.DW=function(a){var b=a.parentNode;if(!b)return j;b=b.lastChild;if(a==b)return g;if(a==b.previousSibling&&b.nodeType==3&&b.data&&b.data.match(/^[\n\r\t ]+$/))return g;return j};function ek(a,b,c,d,f){this.Nc=!!b;a&&this.setPosition(a,d);this.ge=f!=undefined?f:this.Ac||0;if(this.Nc)this.ge*=-1;this.Ap=!c}w(ek,hc);n=ek.prototype;n.J=i;n.Ac=i;n.aA=j;n.setPosition=function(a,b,c){if(this.J=a)this.Ac=ka(b)?b:this.J.nodeType!=1?0:this.Nc?-1:1;if(ka(c))this.ge=c};n.ag=function(a){this.J=a.J;this.Ac=a.Ac;this.ge=a.ge;this.Nc=a.Nc;this.Ap=a.Ap};n.Sa=function(){return new ek(this.J,this.Nc,!this.Ap,this.Ac,this.ge)};
n.Is=function(){var a=this.Nc?-1:1;if(this.Ac==a){this.Ac=a*-1;this.ge+=this.Ac*(this.Nc?-1:1)}};n.u_=function(){var a=this.Nc?1:-1;if(this.Ac==a){this.Ac=a*-1;this.ge+=this.Ac*(this.Nc?-1:1)}};
n.next=function(){var a;if(this.aA){if(!this.J||this.Ap&&this.ge==0)e(gc);a=this.J;var b=this.Nc?-1:1;if(this.Ac==b){var c=this.Nc?a.lastChild:a.firstChild;c?this.setPosition(c):this.setPosition(a,b*-1)}else(c=this.Nc?a.previousSibling:a.nextSibling)?this.setPosition(c):this.setPosition(a.parentNode,b*-1);this.ge+=this.Ac*(this.Nc?-1:1)}else this.aA=g;a=this.J;if(!this.J)e(gc);return a};n.nH=function(){return this.Ac==1};n.fx=function(){return this.Ac==-1};
n.Sd=function(a){return a.J==this.J&&(!this.J||a.Ac==this.Ac)};n.splice=function(){var a=this.J;this.u_();this.Nc=!this.Nc;ek.prototype.next.call(this);this.Nc=!this.Nc;for(var b=ja(arguments[0])?arguments[0]:arguments,c=b.length-1;c>=0;c--)Ye(b[c],a);P(a)};function fk(){}w(fk,ag);fk.prototype.restore=function(a){var b=this.as();a||this.p();return b};function gk(a){this.sL=db();this.HD=db();this.K=J(a.M());a.wo(this.AC(g),this.AC(j))}w(gk,fk);n=gk.prototype;n.V1=function(){var a=i,b=this.lg(g),c=this.lg(j);if(b&&c)a=hk(b,0,c,0);return a};n.lg=function(a){return this.K.Oh(a?this.sL:this.HD)};n.Pn=function(a){P(this.lg(g));P(this.lg(j));return a};
n.as=function(){var a=i,b=this.lg(g),c=this.lg(j);if(b&&c){a=b.parentNode;b=Mb(a.childNodes,b);var d=c.parentNode;c=Mb(d.childNodes,c);if(d==a)c-=1;a=hk(a,b,d,c);a=this.Pn(a);a.select()}else this.Pn();return a};n.k=function(){this.Pn();this.K=i};n.AC=function(a){return this.K.o("SPAN",{id:a?this.sL:this.HD})};function ik(){}function $i(a){if(a.getSelection)return a.getSelection();else{a=a.document;var b=a.selection;if(b){try{var c=b.createRange();if(c.parentElement){if(c.parentElement().document!=a)return i}else if(!c.length||c.item(0).document!=a)return i}catch(d){return i}return b}return i}}n=ik.prototype;n.hh=function(){for(var a=[],b=0,c=this.Bi();b<c;b++)a.push(this.Ud(b));return a};n.Tb=function(){var a=this.Jc();return a.nodeType==1?a:a.parentNode};n.hq=function(){return this.vg()?this.da():this.L()};
n.iq=function(){return this.vg()?this.Ma():this.ka()};n.jk=function(){return this.vg()?this.L():this.da()};n.Rm=function(){return this.vg()?this.ka():this.Ma()};n.vg=function(){return j};n.M=function(){return Fe(z?this.Jc():this.L())};n.pa=function(){return Ne(this.M())};n.containsNode=function(a,b){return this.$f(jk(a,void 0),b)};n.fl=function(a){this.isCollapsed()||this.gd();return this.insertNode(a,g)};n.eK=function(){return this.L()&&this.da()?new gk(this):i};
function kk(a,b){ek.call(this,a,b,g)}w(kk,ek);function lk(a,b,c,d,f){var h;if(a){this.T=a;this.ba=b;this.ca=c;this.ia=d;if(a.nodeType==1&&a.tagName!="BR"){a=a.childNodes;if(b=a[b]){this.T=b;this.ba=0}else{if(a.length)this.T=Kb(a);h=g}}if(c.nodeType==1)if(this.ca=c.childNodes[d])this.ia=0;else this.ca=c}kk.call(this,f?this.ca:this.T,f);if(h)try{this.next()}catch(k){if(k!=gc)e(k)}}w(lk,kk);n=lk.prototype;n.T=i;n.ca=i;n.ba=0;n.ia=0;n.Hq=function(){return this.J.nodeType!=3?-1:this.J==this.T?this.ba:0};
n.lq=function(){return this.J.nodeType!=3?-1:this.J==this.ca?this.ia:this.J.nodeValue.length};n.L=function(){return this.T};n.da=function(){return this.ca};n.tn=function(){return this.aA&&this.J==this.ca&&(!this.ia||!this.nH())};n.next=function(){if(this.tn())e(gc);return lk.c.next.call(this)};n.Is=function(){lk.c.Is.apply(this);if(df(this.J,this.ca))e(gc)};n.ag=function(a){this.T=a.T;this.ca=a.ca;this.ba=a.ba;this.ia=a.ia;this.Pe=a.Pe;lk.c.ag.call(this,a)};
n.Sa=function(){var a=new lk(this.T,this.ba,this.ca,this.ia,this.Pe);a.ag(this);return a};var mk,nk,ok,pk,qk,rk;rk=qk=pk=ok=nk=mk=j;var sk=od();if(sk)if(sk.indexOf("Firefox")!=-1)mk=g;else if(sk.indexOf("Camino")!=-1)nk=g;else if(sk.indexOf("iPhone")!=-1||sk.indexOf("iPod")!=-1)ok=g;else if(sk.indexOf("Android")!=-1)pk=g;else if(sk.indexOf("Chrome")!=-1)qk=g;else if(sk.indexOf("Safari")!=-1)rk=g;var tk=y,uk=z,vk=nk,wk=ok,xk=pk,yk=qk,zk=rk;var Ak;a:{var Bk="",Ck,Dk;if(mk)Ck=/Firefox\/([0-9.]+)/;else if(uk||tk){Ak=Ad;break a}else if(yk)Ck=/Chrome\/([0-9.]+)/;else if(zk)Ck=/Safari\/([0-9.]+)/;else if(wk){Ck=/Version\/(\S+).*Mobile\/(\S+)/;Dk=g}else if(xk)Ck=/Android\s+([0-9.]+)(?:.*Version\/([0-9.]+))?/;else if(vk)Ck=/Camino\/([0-9.]+)/;if(Ck){var Ek=Ck.exec(od());Bk=Ek?Dk?Ek[1]+"."+Ek[2]:Ek[2]||Ek[1]:""}Ak=Bk}var Fk=Ak;var Gk=z,Hk=B||E||y,Ik=z||E||y||j,Jk=B,Kk=E||j,Lk=B,Mk=z||E||y,Nk=B||E,Ok=B&&g,Pk=z,Qk=B||E||y,Rk=B||y,Sk=z;z&&Cd("7.0");var Tk=B&&Cd("1.8")||E||y,Uk=E;z||y||B&&Cd("1.9");var Vk=B||E,Wk=z||y,Xk=E,Yk=y,Zk=y,$k=z||B||E,al=z||E&&Cd("525"),bl=E&&!Cd("531"),cl=E&&!Cd("528");B&&Cd("1.9")||z||y||E&&Cd("531");var dl=z||B||y,el=B||E&&!Cd("526"),fl=z||y,gl=!z&&!y,hl=!E;yk&&ab(Fk,"4")>=0;function il(){}w(il,ik);il.prototype.$f=function(a,b){var c=this.hh();a=a.hh();return(b?Sb:Tb)(a,function(d){return Sb(c,function(f){return f.$f(d,b)})})};il.prototype.insertNode=function(a,b){b?Xe(a,this.L()):Ye(a,this.da());return a};il.prototype.wo=function(a,b){this.insertNode(a,g);this.insertNode(b,j)};function jl(a){this.ta=hg?[]:"";a!=i&&this.append.apply(this,arguments)}jl.prototype.u=function(a){this.clear();this.append(a)};if(hg){jl.prototype.au=0;jl.prototype.append=function(a,b){if(b==i)this.ta[this.au++]=a;else{this.ta.push.apply(this.ta,arguments);this.au=this.ta.length}return this}}else jl.prototype.append=function(a,b){this.ta+=a;if(b!=i)for(var c=1;c<arguments.length;c++)this.ta+=arguments[c];return this};jl.prototype.clear=function(){if(hg)this.au=this.ta.length=0;else this.ta=""};
jl.prototype.toString=function(){if(hg){var a=this.ta.join("");this.clear();a&&this.append(a);return a}else return this.ta};function kl(){}n=kl.prototype;n.$f=function(a,b){return this.xu(a.H,b)};n.xu=function(a,b){try{return b?this.$h(a,0,1)>=0&&this.$h(a,1,0)<=0:this.$h(a,0,0)>=0&&this.$h(a,1,1)<=0}catch(c){if(!z)e(c);return j}};n.containsNode=function(a,b){return this.$f(ll(a),b)};
n.ui=function(){var a=new jl;lc(this,function(b,c,d){if(b.nodeType==3)a.append(Ha(b.nodeValue.substring(d.Hq(),d.lq())));else if(b.nodeType==1)if(d.fx())Ue(b)&&a.append("</"+b.tagName+">");else{c=b.cloneNode(j);c=lf(c);if(z&&b.tagName=="LI")a.append(c);else{b=c.lastIndexOf("<");a.append(b?c.substr(0,b):c)}}},this);return a.toString()};n.Vf=function(){return new lk(this.L(),this.ka(),this.da(),this.Ma())};function ml(a){this.H=a}w(ml,kl);function nl(a){var b=Fe(a).createRange();if(a.nodeType==3){b.setStart(a,0);b.setEnd(a,a.length)}else{for(var c,d=a;c=d.firstChild;)d=c;b.setStart(d,0);for(d=a;c=d.lastChild;)d=c;b.setEnd(d,d.nodeType==1?d.childNodes.length:d.length)}return b}function ol(a,b,c,d){var f=Fe(a).createRange();f.setStart(a,b);f.setEnd(c,d);return f}n=ml.prototype;n.Sa=function(){return new this.constructor(this.H.cloneRange())};n.Jc=function(){return this.H.commonAncestorContainer};
n.L=function(){return this.H.startContainer};n.ka=function(){return this.H.startOffset};n.da=function(){return this.H.endContainer};n.Ma=function(){return this.H.endOffset};n.$h=function(a,b,c){return this.H.compareBoundaryPoints(c==1?b==1?da.Range.START_TO_START:da.Range.START_TO_END:b==1?da.Range.END_TO_START:da.Range.END_TO_END,a)};n.isCollapsed=function(){return this.H.collapsed};n.Ab=function(){return this.H.toString()};
n.yf=function(){var a=J(this.H.startContainer).o("div");a.appendChild(this.H.cloneContents());a=a.innerHTML;if(ta(a,"<")||!this.isCollapsed()&&this.L()==this.da())return a;var b=this.Jc();b=b.nodeType==1?b:b.parentNode;return lf(b.cloneNode(j)).replace(">",">"+a)};n.select=function(a){this.hs(Ne(Fe(this.L())).getSelection(),a)};n.hs=function(a){a.removeAllRanges();a.addRange(this.H)};
n.gd=function(){var a=this.H;a.extractContents();if(a.startContainer.hasChildNodes())if(a=a.startContainer.childNodes[a.startOffset]){var b=a.previousSibling;sf(a)==""&&P(a);b&&sf(b)==""&&P(b)}};n.insertNode=function(a,b){var c=this.H.cloneRange();c.collapse(b);c.insertNode(a);c.detach();return a};
n.wo=function(a,b){var c=Ne(Fe(this.L()));if(c=Bh(c))var d=c.L(),f=c.da(),h=c.ka(),k=c.Ma();var l=this.H.cloneRange(),m=this.H.cloneRange();l.collapse(j);m.collapse(g);l.insertNode(b);m.insertNode(a);l.detach();m.detach();if(c){if(d.nodeType==3)for(;h>d.length;){h-=d.length;do d=d.nextSibling;while(d==a||d==b)}if(f.nodeType==3)for(;k>f.length;){k-=f.length;do f=f.nextSibling;while(f==a||f==b)}hk(d,h,f,k).select()}};n.collapse=function(a){this.H.collapse(a)};function pl(a){this.H=a}w(pl,ml);pl.prototype.hs=function(a,b){var c=b?this.da():this.L(),d=b?this.Ma():this.ka(),f=b?this.L():this.da();b=b?this.ka():this.Ma();a.collapse(c,d);if(c!=f||d!=b)a.extend(f,b)};function ql(a,b,c,d){ek.call(this,a,b,c,i,d)}w(ql,ek);ql.prototype.next=function(){do ql.c.next.call(this);while(this.fx());return this.J};function rl(a,b){this.H=a;this.Xg=b}w(rl,kl);function sl(a){var b=Fe(a).body.createTextRange();if(a.nodeType==1)b.moveToElementText(a);else{for(var c=0,d=a;d=d.previousSibling;){var f=d.nodeType;if(f==3)c+=d.length;else if(f==1){b.moveToElementText(d);break}}d||b.moveToElementText(a.parentNode);b.collapse(!d);c&&b.move("character",c);b.moveEnd("character",a.length)}return b}
function tl(a,b,c,d){var f=j;if(a.nodeType==1){b=a.childNodes[b];f=!b;a=b||a.lastChild||a;b=0}a=sl(a);b&&a.move("character",b);f&&a.collapse(j);f=j;if(c.nodeType==1){c=(b=c.childNodes[d])||c.lastChild||c;d=0;f=!b}c=sl(c);c.collapse(!f);d&&c.moveEnd("character",d);a.setEndPoint("EndToEnd",c);return a}function ul(a){var b=new rl(sl(a),Fe(a));b.$i=a;return b}n=rl.prototype;n.$i=i;n.T=i;n.ca=i;n.Sa=function(){var a=new rl(this.H.duplicate(),this.Xg);a.$i=this.$i;a.T=this.T;a.ca=this.ca;return a};
n.Pd=function(){this.$i=this.T=this.ca=i};n.Jc=function(){if(!this.$i){for(var a=this.H.text,b=this.H.duplicate(),c=1;a.charAt(a.length-c)==" ";c++)b.moveEnd("character",-1);c=b.parentElement();for(b=za(b.htmlText);b.length>za(c.outerHTML).length;)c=c.parentNode;for(;c.childNodes.length==1&&c.innerText==(c.firstChild.nodeType==3?c.firstChild.nodeValue:c.firstChild.innerText);){if(c.firstChild.tagName=="IMG")break;c=c.firstChild}if(a.length==0)c=this.VD(c);this.$i=c}return this.$i};
n.VD=function(a){for(var b=a.childNodes,c=0,d=b.length;c<d;c++){var f=b[c];if(f.nodeType==1)if(this.H.inRange(sl(f)))return this.VD(f)}return a};n.L=function(){return this.T||(this.T=this.Tv(1))};n.ka=function(){return this.yq(1)};n.da=function(){return this.ca||(this.ca=this.Tv(0))};n.Ma=function(){return this.yq(0)};n.$f=function(a,b){return this.xu(a.H,b)};n.$h=function(a,b,c){return this.H.compareEndPoints((b==1?"Start":"End")+"To"+(c==1?"Start":"End"),a)};
n.Tv=function(a,b){b=b||this.Jc();if(!b||!b.firstChild){if(a==0&&b.previousSibling&&b.previousSibling.tagName=="BR"&&this.yq(a,b)==0)b=b.previousSibling;return b.tagName=="BR"?b.parentNode:b}for(var c=a==1?b.firstChild:b.lastChild;c;){if(this.containsNode(c,g))return this.Tv(a,c);c=a==1?c.nextSibling:c.previousSibling}return b};
n.yq=function(a,b){b=b||(a==1?this.L():this.da());if(b.nodeType==1){b=b.childNodes;for(var c=b.length,d=a==1?0:c-1;d>=0&&d<c;){var f=b[d];if(this.containsNode(f,g)){a==0&&f.previousSibling&&f.previousSibling.tagName=="BR"&&this.yq(a,f)==0&&d--;break}d+=a==1?1:-1}return d==-1?0:d}else{c=this.H.duplicate();d=sl(b);c.setEndPoint(a==1?"EndToEnd":"StartToStart",d);c=c.text.length;return a==0?c:b.length-c}};
n.Pi=function(){var a=this.Xg.body.createTextRange();a.moveToElementText(this.Xg.body);return this.xu(a,g)};n.isCollapsed=function(){return this.H.text==""};n.Ab=function(){return this.H.text};n.yf=function(){return this.H.htmlText};n.select=function(){this.H.select()};
n.gd=function(){if(this.H.htmlText){var a=this.L(),b=this.da(),c=this.H.text,d=this.H.duplicate();d.moveStart("character",1);d.moveStart("character",-1);if(d.text!=c){var f=new ql(a,j,g),h=[];lc(f,function(m){if(m.nodeType!=3&&this.containsNode(m)){h.push(m);f.Is()}if(m==b)e(gc)});this.collapse(g);Nb(h,P);this.Pd()}else{this.H=d;this.H.text="";this.Pd();c=this.L();d=this.ka();try{var k=a.nextSibling;if(a==b&&a.parentNode&&a.nodeType==3&&k&&k.nodeType==3){a.nodeValue+=k.nodeValue;P(k);this.H=sl(c);
this.H.move("character",d);this.Pd()}}catch(l){}}}};function vl(a,b,c,d){d=d||J(a.parentElement());var f;if(b.nodeType!=1){f=g;b=d.o("DIV",i,b)}a.collapse(c);b=b;c=(c=d)||J(a.parentElement());var h,k=h=b.id;if(!h)h=b.id=db();a.pasteHTML(b.outerHTML);if(b=c.Oh(h))k||b.removeAttribute("id");b=b;if(f){a=b.firstChild;d.cE(b);b=a}return b}rl.prototype.insertNode=function(a,b){a=vl(this.H.duplicate(),a,b);this.Pd();return a};
rl.prototype.wo=function(a,b){var c=this.H.duplicate(),d=this.H.duplicate();vl(c,a,g);vl(d,b,j);this.Pd()};rl.prototype.collapse=function(a){this.H.collapse(a);if(a)this.ca=this.T;else this.T=this.ca};function wl(a){this.H=a}w(wl,ml);wl.prototype.hs=function(a){a.collapse(this.L(),this.ka());if(this.da()!=this.L()||this.Ma()!=this.ka())a.extend(this.da(),this.Ma());a.rangeCount==0&&a.addRange(this.H)};function xl(a){this.H=a}w(xl,ml);xl.prototype.$h=function(a,b,c){if(Cd("528"))return xl.c.$h.call(this,a,b,c);return this.H.compareBoundaryPoints(c==1?b==1?da.Range.START_TO_START:da.Range.END_TO_START:b==1?da.Range.START_TO_END:da.Range.END_TO_END,a)};xl.prototype.hs=function(a,b){a.removeAllRanges();b?a.setBaseAndExtent(this.da(),this.Ma(),this.L(),this.ka()):a.setBaseAndExtent(this.L(),this.ka(),this.da(),this.Ma())};function yl(a){return z?new rl(a,Fe(a.parentElement())):E?new xl(a):B?new pl(a):y?new wl(a):new ml(a)}function ll(a){return z?ul(a):E?new xl(nl(a)):B?new pl(nl(a)):y?new wl(nl(a)):new ml(nl(a))}function zl(a,b,c,d){return z?new rl(tl(a,b,c,d),Fe(a)):E?new xl(ol(a,b,c,d)):B?new pl(ol(a,b,c,d)):y?new wl(ol(a,b,c,d)):new ml(ol(a,b,c,d))};function Al(){}w(Al,ik);function Bl(a,b){var c=new Al;c.Vh=a;c.Pe=!!b;return c}function jk(a,b){return Bl(ll(a),b)}function hk(a,b,c,d){var f=new Al;f.Pe=Cl(a,b,c,d);if(a.tagName=="BR"){var h=a.parentNode;b=Mb(h.childNodes,a);a=h}if(c.tagName=="BR"){h=c.parentNode;d=Mb(h.childNodes,c);c=h}if(f.Pe){f.T=c;f.ba=d;f.ca=a;f.ia=b}else{f.T=a;f.ba=b;f.ca=c;f.ia=d}return f}n=Al.prototype;n.Vh=i;n.T=i;n.ba=i;n.ca=i;n.ia=i;n.Pe=j;
n.Sa=function(){var a=new Al;a.Vh=this.Vh;a.T=this.T;a.ba=this.ba;a.ca=this.ca;a.ia=this.ia;a.Pe=this.Pe;return a};n.xf=function(){return"text"};n.vc=function(){return this.Ic().H};n.Pd=function(){this.T=this.ba=this.ca=this.ia=i};n.Bi=function(){return 1};n.Ud=function(){return this};n.Ic=function(){return this.Vh||(this.Vh=zl(this.L(),this.ka(),this.da(),this.Ma()))};n.Jc=function(){return this.Ic().Jc()};n.L=function(){return this.T||(this.T=this.Ic().L())};
n.ka=function(){return this.ba!=i?this.ba:(this.ba=this.Ic().ka())};n.da=function(){return this.ca||(this.ca=this.Ic().da())};n.Ma=function(){return this.ia!=i?this.ia:(this.ia=this.Ic().Ma())};n.vg=function(){return this.Pe};n.$f=function(a,b){var c=a.xf();if(c=="text")return this.Ic().$f(a.Ic(),b);else if(c=="control"){a=a.hk();return(b?Sb:Tb)(a,function(d){return this.containsNode(d,b)},this)}return j};
function Dl(a){if(z){var b=j;try{b=a.parentNode}catch(c){}return!!b}else return df(a.ownerDocument.body,a)}n=Al.prototype;n.Pi=function(){return(!this.T||Dl(this.T))&&(!this.ca||Dl(this.ca))&&(!z||this.Ic().Pi())};n.isCollapsed=function(){return this.Ic().isCollapsed()};n.Ab=function(){return this.Ic().Ab()};n.ui=function(){return this.Ic().ui()};n.yf=function(){return this.Ic().yf()};n.Tm=ba(2);n.Vf=function(){return new lk(this.L(),this.ka(),this.da(),this.Ma())};n.select=function(){this.Ic().select(this.Pe)};
n.gd=function(){this.Ic().gd();this.Pd()};n.insertNode=function(a,b){a=this.Ic().insertNode(a,b);this.Pd();return a};n.wo=function(a,b){this.Ic().wo(a,b);this.Pd()};n.hj=function(){return new El(this)};n.collapse=function(a){a=this.vg()?!a:a;this.Vh&&this.Vh.collapse(a);if(a){this.ca=this.T;this.ia=this.ba}else{this.T=this.ca;this.ba=this.ia}this.Pe=j};function El(a){this.xB=a.hq();this.uN=a.iq();this.dE=a.jk();this.rR=a.Rm()}w(El,fk);El.prototype.as=function(){return hk(this.xB,this.uN,this.dE,this.rR)};
El.prototype.k=function(){El.c.k.call(this);this.dE=this.xB=i};function Fl(){}w(Fl,il);function Gl(a){var b=new Fl;b.H=a;return b}function Hl(){for(var a=Fe(arguments[0]).body.createControlRange(),b=0,c=arguments.length;b<c;b++)a.addElement(arguments[b]);return Gl(a)}n=Fl.prototype;n.H=i;n.Ea=i;n.qo=i;n.Pd=function(){this.qo=this.Ea=i};n.Sa=function(){return Hl.apply(this,this.hk())};n.xf=function(){return"control"};n.vc=function(){return this.H||document.body.createControlRange()};n.Bi=function(){return this.H?this.H.length:0};n.Ud=function(a){return jk(this.H.item(a))};
n.Jc=function(){return hf.apply(i,this.hk())};n.L=function(){return this.Gq()[0]};n.ka=function(){return 0};n.da=function(){var a=this.Gq(),b=Kb(a);return Ub(a,function(c){return df(c,b)})};n.Ma=function(){return this.da().childNodes.length};n.hk=function(){if(!this.Ea){this.Ea=[];if(this.H)for(var a=0;a<this.H.length;a++)this.Ea.push(this.H.item(a))}return this.Ea};n.Gq=function(){if(!this.qo){this.qo=this.hk().concat();this.qo.sort(function(a,b){return a.sourceIndex-b.sourceIndex})}return this.qo};
n.Pi=function(){var a=j;try{a=Tb(this.hk(),function(c){return z?c.parentNode:df(c.ownerDocument.body,c)})}catch(b){}return a};n.isCollapsed=function(){return!this.H||!this.H.length};n.Ab=function(){return""};n.ui=function(){return Qb(this.Gq(),lf).join("")};n.yf=function(){return this.ui()};n.Tm=Fl.prototype.yf;n.Vf=function(){return new Il(this)};n.select=function(){this.H&&this.H.select()};n.gd=function(){if(this.H){for(var a=[],b=0,c=this.H.length;b<c;b++)a.push(this.H.item(b));Nb(a,P);this.collapse(j)}};
n.fl=function(a){a=this.insertNode(a,g);this.isCollapsed()||this.gd();return a};n.hj=function(){return new Jl(this)};n.collapse=function(){this.H=i;this.Pd()};function Jl(a){this.Ea=a.hk()}w(Jl,fk);Jl.prototype.as=function(){for(var a=(this.Ea.length?Fe(this.Ea[0]):document).body.createControlRange(),b=0,c=this.Ea.length;b<c;b++)a.addElement(this.Ea[b]);return Gl(a)};Jl.prototype.k=function(){Jl.c.k.call(this);delete this.Ea};
function Il(a){if(a){this.Ea=a.Gq();this.T=this.Ea.shift();this.ca=Kb(this.Ea)||this.T}kk.call(this,this.T,j)}w(Il,kk);n=Il.prototype;n.T=i;n.ca=i;n.Ea=i;n.Hq=function(){return 0};n.lq=function(){return 0};n.L=function(){return this.T};n.da=function(){return this.ca};n.tn=function(){return!this.ge&&!this.Ea.length};n.next=function(){if(this.tn())e(gc);else if(!this.ge){var a=this.Ea.shift();this.setPosition(a,1,1);return a}return Il.c.next.call(this)};
n.ag=function(a){this.Ea=a.Ea;this.T=a.T;this.ca=a.ca;Il.c.ag.call(this,a)};n.Sa=function(){var a=new Il(i);a.ag(this);return a};function Kl(){this.ff=[];this.bl=[];this.sc=this.Gl=i}w(Kl,il);function Ll(a){var b=new Kl;b.bl=a;b.ff=Qb(a,function(c){return c.vc()});return b}n=Kl.prototype;n.Pd=function(){this.bl=[];this.sc=this.Gl=i};n.Sa=function(){var a=new Kl;a.ff=$b(this.ff);return a};n.xf=function(){return"mutli"};n.vc=function(){return this.ff[0]};n.Bi=function(){return this.ff.length};n.Ud=function(a){this.bl[a]||(this.bl[a]=Bl(yl(this.ff[a]),void 0));return this.bl[a]};
n.Jc=function(){if(!this.sc){for(var a=[],b=0,c=this.Bi();b<c;b++)a.push(this.Ud(b).Jc());this.sc=hf.apply(i,a)}return this.sc};n.Xm=function(){if(!this.Gl){this.Gl=this.hh();this.Gl.sort(function(a,b){var c=a.L();a=a.ka();var d=b.L();b=b.ka();if(c==d&&a==b)return 0;return Cl(c,a,d,b)?1:-1})}return this.Gl};n.L=function(){return this.Xm()[0].L()};n.ka=function(){return this.Xm()[0].ka()};n.da=function(){return Kb(this.Xm()).da()};n.Ma=function(){return Kb(this.Xm()).Ma()};
n.Pi=function(){return Tb(this.hh(),function(a){return a.Pi()})};n.isCollapsed=function(){return this.ff.length==0||this.ff.length==1&&this.Ud(0).isCollapsed()};n.Ab=function(){return Qb(this.hh(),function(a){return a.Ab()}).join("")};n.ui=function(){return this.yf()};n.yf=function(){return Qb(this.hh(),function(a){return a.yf()}).join("")};n.Tm=ba(1);n.Vf=function(){return new Ml(this)};n.select=function(){var a=$i(this.pa());a.removeAllRanges();for(var b=0,c=this.Bi();b<c;b++)a.addRange(this.Ud(b).vc())};
n.gd=function(){Nb(this.hh(),function(a){a.gd()})};n.hj=function(){return new Nl(this)};n.collapse=function(a){if(!this.isCollapsed()){var b=a?this.Ud(0):this.Ud(this.Bi()-1);this.Pd();b.collapse(a);this.bl=[b];this.Gl=[b];this.ff=[b.vc()]}};function Nl(a){this.Yy=Qb(a.hh(),function(b){return b.hj()})}w(Nl,fk);Nl.prototype.as=function(){var a=Qb(this.Yy,function(b){return b.restore()});return Ll(a)};Nl.prototype.k=function(){Nl.c.k.call(this);Nb(this.Yy,function(a){a.p()});delete this.Yy};
function Ml(a){if(a)this.Df=Qb(a.Xm(),function(b){return kc(b)});kk.call(this,a?this.L():i,j)}w(Ml,kk);n=Ml.prototype;n.Df=i;n.Pj=0;n.Hq=function(){return this.Df[this.Pj].Hq()};n.lq=function(){return this.Df[this.Pj].lq()};n.L=function(){return this.Df[0].L()};n.da=function(){return Kb(this.Df).da()};n.tn=function(){return this.Df[this.Pj].tn()};
n.next=function(){try{var a=this.Df[this.Pj],b=a.next();this.setPosition(a.J,a.Ac,a.ge);return b}catch(c){if(c!==gc||this.Df.length-1==this.Pj)e(c);else{this.Pj++;return this.next()}}};n.ag=function(a){this.Df=$b(a.Df);Ml.c.ag.call(this,a)};n.Sa=function(){var a=new Ml(i);a.ag(this);return a};function Bh(a){return(a=$i(a||window))&&Ol(a)}function Ol(a){var b,c=j;if(a.createRange)try{b=a.createRange()}catch(d){return i}else if(a.rangeCount)if(a.rangeCount>1){b=new Kl;c=0;for(var f=a.rangeCount;c<f;c++)b.ff.push(a.getRangeAt(c));return b}else{b=a.getRangeAt(0);c=Cl(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)}else return i;return Pl(b,c)}function Pl(a,b){return a&&a.addElement?Gl(a):Bl(yl(a),b)}function dk(a,b){return hk(a,b,a,b)}function Ql(a,b,c,d){return hk(a,b,c,d)}
function Rl(a){if(a=$i(a||window))if(a.empty)try{a.empty()}catch(b){}else a.removeAllRanges()}function Cl(a,b,c,d){if(a==c)return d<b;var f;if(a.nodeType==1&&b)if(f=a.childNodes[b]){a=f;b=0}else if(df(a,c))return g;if(c.nodeType==1&&d)if(f=c.childNodes[d]){c=f;d=0}else if(df(c,a))return j;return(ef(a,c)||b-d)>0};function Sl(a,b){if(a.nodeType!=1)return i;return z?Cf(a,b):Bf(a,b)}function Tl(a){var b=a&&a.nodeName.toLowerCase();return!!(a&&(Sl(a,"display")=="block"||b=="td"||b=="table"||b=="li"))}function Ul(a){return uf(a,Tl,g)};function Vl(a,b){var c=Wl(a,1,b);c=Wl(c,0,b);var d=c.L();a=c.da();var f=c.ka();c=c.Ma();if(d==a){for(;a!=b&&f==0&&c==Pj(a);){d=a.parentNode;f=Mb(d.childNodes,a);c=f+1;a=d}d=a}return hk(d,f,a,c)}function Wl(a,b,c){for(var d=(b=b==1)?a.L():a.da(),f=b?a.ka():a.Ma(),h=a.Tb();d!=h&&d!=c;){if(b&&f!=0||!b&&f!=Pj(d))break;var k=d.parentNode;d=Mb(k.childNodes,d);f=b?d:d+1;d=k}return Ql(b?d:a.L(),b?f:a.ka(),b?a.da():d,b?a.Ma():f)}
function Xl(a,b){J(a);var c=a.parentNode;a=Mb(c.childNodes,a)+(b?0:1);b=Yl(c,a,b);b=dk(b.J,b.Bd);b.select();return b}function Zl(a){var b=Bh(Ne(Fe(a)));(a=$l(a,b))&&a.select()}function am(a){for(var b=i,c=a.firstChild;c;){var d=c.nextSibling;if(c.nodeType==3)if(c.nodeValue=="")a.removeChild(c);else if(b){b.nodeValue+=c.nodeValue;a.removeChild(c)}else b=c;else{am(c);b=i}c=d}}function bm(a){z?am(a):a.normalize()}
function $l(a,b){if(b)var c=cm(b),d=Ul(b.Tb());if(d)bm(hf(d,a));else a&&bm(a);return c?c():i}function dm(a,b){return b?Yl(a.L(),a.ka()):Yl(a.da(),a.Ma())}
function cm(a){var b=em(dm(a,g)),c=b.WE(),d=b.J.previousSibling;if(b.J.nodeType==3)b.J=i;var f=em(dm(a,j)),h=f.WE(),k=f.J.previousSibling;if(f.J.nodeType==3)f.J=i;return function(){if(!b.J&&d){b.J=d.nextSibling;b.J||(b=new fm(d,Pj(d)))}if(!f.J&&k){f.J=k.nextSibling;f.J||(f=new fm(k,Pj(k)))}return hk(b.J||c.J.firstChild,b.Bd,f.J||h.J.firstChild,f.Bd)}}
function em(a){var b;if(a.J.nodeType==3){for(b=a.J.previousSibling;b&&b.nodeType==3;b=b.previousSibling)a.Bd+=Pj(b);b=b}else b=a.J.previousSibling;var c=a.J.parentNode;a.J=b?b.nextSibling:c.firstChild;return a}function gm(a){var b=a.Tb();return a.L()!=b.parentElement&&Sj(b)||!!uf(b,Sj)}function fm(a,b){this.J=a;this.Bd=b}fm.prototype.WE=function(){var a=this.J.parentNode;return new fm(a,Mb(a.childNodes,this.J))};
function Yl(a,b,c){for(;a.nodeType==1;){var d=a.childNodes[b];if(!d&&!a.lastChild)break;if(d){a=d.previousSibling;if(c&&a){a=a;b=Pj(a)}else{a=d;b=0}}else{a=a.lastChild;b=Pj(a)}}return new fm(a,b)}function hm(a){gk.call(this,a)}w(hm,gk);hm.prototype.Pn=function(a){var b=this.lg(g),c=this.lg(j);b=b&&c?hf(b,c):b||c;hm.c.Pn.call(this);if(a)return $l(b,a);else b&&Zl(b)};function im(a,b){this.$o=a;this.D4=b}im.prototype.rS=function(){if(!this.QC)this.QC=sf(this.$o);return this.QC};im.prototype.MG=function(a){this.$o.href=a};im.prototype.aJ=function(){var a=this.$o;if(cl){var b;if((b=a.nextSibling)&&b.nodeType==3&&(ta(b.data,"\u00a0")||ta(b.data," ")))b=b;else{b=J(a).createTextNode("\u00a0");Ye(b,a)}dk(b,1).select()}else Xl(a,j)};var jm=/^[\w-]+(\.[\w-]+)*\@([\w-]+\.)+(\d+|\w\w+)$/i;function km(a,b){im.call(this,a,b)}w(km,im);function lm(a,b,c){var d=new km(a,g);d.MG(b);if(c)a.target=c;return d};var om=String.fromCharCode(160);function pm(a,b){this.Gr=[];for(this.Ar=[];a&&a.nodeName!="BODY"&&a!=b;){for(var c=0,d=a.previousSibling;d;){d=d.previousSibling;++c}this.Gr.unshift(c);this.Ar.unshift(a.nodeName);a=a.parentNode}}w(pm,ag);pm.prototype.toString=function(){for(var a=[],b,c=0;b=this.Ar[c];c++)a.push(this.Gr[c]+","+b);return a.join("\n")};pm.prototype.ck=function(a){for(var b=a,c=0;a=this.Ar[c];++c){b=b.childNodes[this.Gr[c]];if(!b||b.nodeName!=a)return i}return b};pm.prototype.k=function(){delete this.Gr;delete this.Ar};function qm(){Zj.call(this)}w(qm,Zj);n=qm.prototype;n.gb=function(){return"EnterHandler"};n.Sr=function(a){if(!a||ya(a))return Qk?this.ZS():"";return a};n.ZS=Tj("<br>");n.ET=function(a,b){var c=this.n.b();b=b&&b.L();if(c.firstChild==b&&Oj(b)){a.preventDefault();a.stopPropagation()}};
n.AZ=function(a,b){if(z||y)this.KD("DIV");else if(!b&&E)if((b=this.n.O())&&rm(b.Tb())){var c=this.yb(),d=c.createElement("BR");b.insertNode(d,g);Qj(d.parentNode)&&!Rj(d.nextSibling)&&Xe(c.createElement("BR"),d);Xl(d,j);a.preventDefault()}};function rm(a){for(a=a;a;a=a.parentNode)if(Qj(a))return a.tagName=="BLOCKQUOTE";return j}n=qm.prototype;n.YT=function(a){this.XP(a)};
n.XP=function(a){var b=this.n.O();if(b.isCollapsed()){var c=b.da();if(c.nodeType==1)if((b=c.childNodes[b.Ma()])&&b.tagName=="BR"){var d=Mj(b),f=b.nextSibling;c.removeChild(b);a.preventDefault();if(f&&Qj(f))if(d&&!(d.tagName=="BR"||Qj(d)))dk(d,Pj(d)).select();else{a=Ij(f);dk(a,0).select()}}}};
n.Mq=function(a){if(!(B&&this.n.jn()))if(a.keyCode==8)this.ET(a,this.n.O());else if(a.keyCode==13)if(B)a.shiftKey||this.jU(a);else{this.n.Uc();var b=this.YC(),c=!!this.n.execCommand("+splitBlockquote",b);if(c){a.preventDefault();a.stopPropagation()}this.DJ(b);this.AZ(a,c);this.n.fa()}else B&&a.keyCode==46&&this.YT(a)};n.zU=function(a){B&&this.n.jn()||this.AU(a)};n.AU=function(a){if((z||y)&&a.keyCode==13)this.KD("DIV",g)};
n.jU=function(a){var b=this.n.O();!b||b.isCollapsed();b=this.YC();if(this.n.execCommand("+splitBlockquote",b)){a.preventDefault();a.stopPropagation()}this.DJ(b)};var sm=Ec("LI","DIV","H1","H2","H3","H4","H5","H6");n=qm.prototype;
n.KD=function(a,b){var c,d;if(z){d=this.n.O().vc();c=d.parentElement()}else{d=this.n.O();c=d.Jc()}for(var f=this.n.b(),h;c&&c!=f;){var k=c.nodeName;if(k==a||sm[k]&&!(b&&Oj(c)&&c.getElementsByTagName("BR").length==1)){if(y&&h){if(k==a&&h==c.lastChild&&Oj(h)){Ye(h,c);jk(h,void 0).select()}break}return}if(y&&b&&k=="P"&&k!=a)h=c;c=c.parentNode}if(z){var l=j;b=d.duplicate();b.moveEnd("character",1);if(b.text.length){l=b.parentElement();b=b.duplicate();b.collapse(j);b=b.parentElement();if(l=l!=b&&b!=d.parentElement()){d.move("character",
-1);d.select()}}}this.n.sb.M().execCommand("FormatBlock",j,"<"+a+">");if(l){d.move("character",1);d.select()}};n.YC=function(){return Hk?this.aQ():this.$P()};n.DJ=function(a){Hk||a.removeNode(g)};n.$P=function(){var a=this.yb().M(),b=a.selection.createRange(),c=db();b.pasteHTML('<span id="'+c+'"></span>');a=a.getElementById(c);a.id="";return a};
n.aQ=function(){var a=this.n.O();if(!a.isCollapsed()){var b=g;if(y){var c=a.L(),d=a.ka();if(c==a.da()&&c.lastChild&&c.lastChild.tagName=="BR"&&d==c.childNodes.length-1)b=j}b&&tm(a)}return dm(a,g)};
function tm(a){if(a&&!a.isCollapsed()){var b=g,c=a.Tb(),d=new pm(a.L(),c),f=a.ka(),h,k=a;h=k.L();if(Tl(h))h=h.childNodes[k.ka()]||h;h=Ul(h);var l=k.da();if(Tl(l))l=l.childNodes[k.Ma()]||l;l=Ul(l);h=h==l;k=!h&&um(a);a.gd();a=dk(d.ck(c),f);a.select();if(h){h=Ul(a.L());if(Oj(h,g)){b="&nbsp;";if(y&&h.tagName=="LI")b="<br>";h.innerHTML=b;dk(Ij(h.firstChild),0).select();b=j}}if(k){a=Ul(a.L());if(k=Nj(a)){for(;h=k.firstChild;)a.appendChild(h);P(k)}}if(b){a=dk(d.ck(c),f);a.select()}}}
function um(a){var b=a.da();a=a.Ma();var c=b;if(Tl(c)){var d=c.childNodes[a];if(!d||d.nodeType==1&&Tl(d))return j}for(d=Ul(c);d!=c;){if(Nj(c))return g;c=c.parentNode}return a!=Pj(b)};function vm(){Zj.call(this)}w(vm,Zj);n=vm.prototype;n.gb=function(){return"EnterHandlerInstaller"};n.uP=function(){return new qm};n.Wp=i;n.QB=i;n.Dd=function(a){vm.c.Dd.call(this,a);this.Wp=this.Wp||this.uP();a.cb(this.Wp)};n.Rf=function(a){vm.c.Rf.call(this,a);a.pA(this.Wp);this.QB&&a.pA(this.QB)};function wm(){Zj.call(this)}w(wm,bk);wm.prototype.gb=function(){return"BasicTextFormatter"};wm.prototype.Dd=function(a){wm.c.Dd.call(this,a)};wm.prototype.Rf=function(a){wm.c.Rf.call(this,a)};
var xm=Ac({YA:"+link",Io:"+formatBlock",XA:"+indent",bB:"+outdent",cB:"+strikeThrough",WA:"+insertHorizontalRule",Bt:"+subscript",Ct:"+superscript",Ul:"+underline",ZM:"+unlink",Rl:"+bold",Sl:"+italic",VA:"+fontSize",UA:"+fontName",Ho:"+foreColor",xM:"+emoticon",qt:"+backColor",Oo:"+insertOrderedList",Qo:"+insertUnorderedList",Jo:"+justifyCenter",Ko:"+justifyFull",Mo:"+justifyRight",Lo:"+justifyLeft",sM:"+BLOCKQUOTE"});n=wm.prototype;n.te=function(a){return a in xm};n.pe=function(){return this.n.O()};
n.He=function(){return this.yb().M()};
n.bh=function(a){var b,c,d,f,h,k=arguments[1];switch(a){case "+backColor":if(k!==i)if(Vk)this.vN(k);else y?this.mi("hiliteColor",k):this.mi(a,k);break;case "+link":h=this.X1("/",k);break;case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":this.YW(a);break;case "+BLOCKQUOTE":break;case "+emoticon":break;default:if(z&&a=="+formatBlock"&&k)k="<"+k+">";if(a=="+foreColor"&&k===i)break;switch(a){case "+indent":case "+outdent":if(Tk){if(B)c=g;if(y)c=a=="+outdent"?!this.He().queryCommandEnabled("outdent"):
g}case "+insertOrderedList":case "+insertUnorderedList":if(fl&&this.sJ(this.He(),a))d=g;else gl||this.iP();if(B&&el&&!this.queryCommandValue(a))f|=this.WN();case "+formatBlock":b=!!this.n.tf("Bidi");break;case "+subscript":case "+superscript":dl&&this.BN(a);break;case "+underline":case "+bold":case "+italic":c=B&&Tk&&this.queryCommandValue(a);break;case "+foreColor":case "+fontName":c=Tk&&B}this.mi(a,k,b,c);f&&this.He().execCommand("Delete",j,g);d&&this.He().execCommand("FormatBlock",j,"<div>")}B&&
this.yb().pa().focus();return h};
n.queryCommandValue=function(a){var b;switch(a){case "+link":return this.GW("a");case "+justifyCenter":case "+justifyFull":case "+justifyRight":case "+justifyLeft":return this.CW(a);case "+formatBlock":return ym(this.n.O());case "+BLOCKQUOTE":case "+indent":case "+outdent":case "+insertHorizontalRule":case "+unlink":return j;case "+fontSize":case "+fontName":case "+foreColor":case "+backColor":return this.Vr(this.He(),a,Tk&&B);case "+underline":case "+bold":case "+italic":b=Tk&&B;default:return this.sJ(this.He(),
a,b)}};n.Sr=function(a){if(Qk&&a.match(/^\s*<script/i))a="&nbsp;"+a;if(Rk){a=a.replace(/<(\/?)strong([^\w])/gi,"<$1b$2");a=a.replace(/<(\/?)em([^\w])/gi,"<$1i$2")}return a};n.JO=function(a){a=He("IMG",i,a);for(var b=0,c;c=a[b];b++)if(Pk){c.removeAttribute("tabIndex");c.removeAttribute("tabIndexSet");var d=c;"removeAttribute"in d&&d.removeAttribute(na);try{delete d[na]}catch(f){}if(c.qI)c.tabIndex=c.qI}};
n.mC=function(a){if(Xk){for(var b=this.n.sb.qM("HEAD"),c=[],d=b.length,f=1;f<d;++f)for(var h=He("STYLE",i,b[f]),k=h.length,l=0;l<k;++l)c.push(h[l].outerHTML);return c.join("")+a}return a};n.an=function(a,b,c){if(!c)return j;var d;switch(b){case "b":d="+bold";break;case "i":d="+italic";break;case "u":d="+underline";break;case "s":return g}if(d){this.n.execCommand(d);return g}return j};var zm=z?/<br([^\/>]*)\/?>/gi:/<br([^\/>]*)\/?>(?!<\/(div|p)>)/gi;
wm.prototype.iP=function(){if(!z&&!y)return j;var a=this.pe(),b=a.Tb(),c=this.He();zm.lastIndex=0;if(zm.test(b.innerHTML)){a=a.eK();if(b.tagName=="P")Am(b,g);else{b.innerHTML=b.innerHTML.replace(zm,'<p$1 trtempbr="temp_br">');b=ac(b.getElementsByTagName("P"));lc(b,function(d){if(d.getAttribute("trtempbr")=="temp_br"){d.removeAttribute("trtempbr");if(ya(qf(d))){var f=z?c.createTextNode("\u00a0"):c.createElement("BR");d.appendChild(f)}Am(d)}})}a.restore();return g}return j};
function Am(a,b){if(z||y){var c=a.outerHTML.replace(/<(\/?)p/gi,"<$1div");if(b)c=c.replace(zm,"</div><div$1>");if(y&&!/<\/div>$/i.test(c))c+="</div>";a.outerHTML=c}}function Bm(a){return a.indexOf("+")==0?a.substring(1):a}wm.prototype.YW=function(a){this.mi(a,i,j,g);B&&this.mi(a,i,j,g);Tk&&B||lc(this.n.O(),Cm)};function Cm(a){a=Ul(a);if(a.align&&!(z&&0)){a.style.textAlign=a.align;a.removeAttribute("align")}}
wm.prototype.mi=function(a,b,c,d){var f=i;if(c)f=this.n.queryCommandValue("rtl")?"rtl":this.n.queryCommandValue("ltr")?"ltr":i;a=Bm(a);var h,k;if(z){k=this.xN(a);h=k[0];k=k[1]}if(E)h=this.yN(a);B&&this.wN(a);hl&&a.toLowerCase()=="fontsize"&&this.XZ();c=this.He();if(d&&Tk){c.execCommand("styleWithCSS",j,g);y&&this.pW()}c.execCommand(a,j,b);d&&Tk&&c.execCommand("styleWithCSS",j,j);E&&!Cd("526")&&a.toLowerCase()=="formatblock"&&b&&/^[<]?h\d[>]?$/i.test(b)&&this.KO();if(/insert(un)?orderedlist/i.test(a)){E&&
this.lR();if(z){this.jR();k&&P(k)}}h&&P(h);f&&this.n.execCommand(f)};wm.prototype.vN=function(a){var b=this.n.O(),c,d;if(b&&b.isCollapsed()){c=this.yb().createTextNode(B?" ":"");d=b.L();d=d.nodeType==1?d:d.parentNode;if(d.innerHTML==""){d.style.textIndent="-10000px";d.appendChild(c)}else{d=this.yb().o("span",{style:"text-indent:-10000px"},c);b.fl(d)}jk(c,void 0).select()}this.mi("hiliteColor",a,j,g);if(c){if(B)c.data="";d.style.textIndent=""}};
wm.prototype.X1=function(a,b){var c=this.pe(),d=c&&c.Tb();if((d=tf(d,"a"))&&uf(d,Sj))$e(d);else return this.yP(c,a,b);return i};
wm.prototype.yP=function(a,b,c){var d=i,f=a&&a.Tb();if(f&&f.tagName=="IMG")return i;if(a&&a.isCollapsed()){a=a.Ud(0).vc();if(Hk){d=this.yb().createElement("a");a.insertNode(d)}else if(Gk){a.pasteHTML("<a id='newLink'></a>");d=this.yb().b("newLink");d.removeAttribute("id")}}else{var h=db();this.mi("CreateLink",h);Nb(this.n.si().getElementsByTagName("a"),function(k){if(ua(k.href,h))d=k})}return lm(d,b,c)};var Dm={insertOrderedList:1,insertUnorderedList:1};n=wm.prototype;
n.BN=function(a){if(!this.queryCommandValue(a)){a=a=="+subscript"?"+superscript":"+subscript";var b=Bm(a);this.queryCommandValue(a)||this.He().execCommand(b,j,i);this.He().execCommand(b,j,i)}};n.XZ=function(){var a=Vl(this.n.O(),this.n.b());lc(mc(a,function(b,c,d){return d.nH()&&a.containsNode(b)}),function(b){yf(b,"font-size","");B&&b.style.length==0&&b.getAttribute("style")!=i&&b.removeAttribute("style")})};
n.xN=function(a){var b=[],c=i,d=this.pe();c=this.yb();if(a in Dm)if(a=d&&d.Tb()){for(var f=He("BLOCKQUOTE",i,a),h,k=0;k<f.length;k++)if(d.containsNode(f[k])){h=f[k];break}if(a=h||tf(a,"BLOCKQUOTE")){c=c.o("div",{style:"height:0"});a.appendChild(c);b.push(c);if(h)d=hk(h,0,c,0);else if(d.containsNode(c))d=Ql(d.L(),d.ka(),c,0);d.select()}}return b};n.KO=function(){lc(this.pe(),function(a){if(a.className=="Apple-style-span"){a.style.fontSize="";a.style.fontWeight=""}})};
n.lR=function(){var a=j;lc(this.pe(),function(b){var c=b.tagName;if(c=="UL"||c=="OL")if(a){if(c=bf(b.previousSibling,j)){var d=b.ownerDocument.createRange();d.setStartAfter(c);d.setEndBefore(b);if(xa(d.toString()))if(c.nodeName==b.nodeName){for(;c.lastChild;)b.insertBefore(c.lastChild,b.firstChild);c.parentNode.removeChild(c)}}}else a=g})};var Em={"1":1,a:1,A:1,i:1,I:1},Fm={disc:1,circle:1,square:1};
wm.prototype.jR=function(){var a=this.pe();for(a=a&&a.Jc();a&&a.tagName!="UL"&&a.tagName!="OL";)a=a.parentNode;if(a)a=a.parentNode;if(a){var b=ac(a.getElementsByTagName("UL"));bc(b,ac(a.getElementsByTagName("OL")));Nb(b,function(c){var d=c.type;if(d)if(!(c.tagName=="UL"?Fm:Em)[d])c.type=""})}};var Gm={justifyCenter:1,justifyFull:1,justifyRight:1,justifyLeft:1,formatBlock:1},Hm={insertOrderedList:1,insertUnorderedList:1};
wm.prototype.yN=function(a){var b;if(Gm[a]){b=this.yb().o("div",{style:"height: 0"},"x");this.n.si().appendChild(b)}if(Hm[a]){a=this.n.si();b=this.yb().o("div",{style:"height: 0"},"x");a.insertBefore(b,a.firstChild)}return b};wm.prototype.wN=function(a){if(Cd("1.9")&&a.toLowerCase()=="formatblock"){a=this.pe();var b=a.L();if(a.isCollapsed()&&b&&b.tagName=="BODY"){var c=a.ka();if((b=b.childNodes[c])&&b.tagName=="BR"){a=a.vc();a.setStart(b,0);a.setEnd(b,0)}}}};
wm.prototype.pW=function(){var a=[],b=this.n.O().Tb();do a.push(b);while(b=b.parentNode);a=oc(kc(this.n.O()),kc(a));a=mc(a,Tl);lc(a,function(c){var d=c.style.outline;c.style.outline="0px solid red";c.style.outline=d})};wm.prototype.WN=function(){var a=this.pe();if(a.isCollapsed()&&a.Jc().nodeType!=3){var b=this.yb().createTextNode("\u00a0");a.insertNode(b,j);jk(b,void 0).select();return g}return j};
function ym(a){var b=i;lc(a,function(c,d,f){if(!f.fx()){c=Ul(c).tagName;b=b||c;if(b!=c){b=i;e(gc)}f.Is()}});return b}var Im={center:1,justify:1,right:1,left:1};wm.prototype.CW=function(a){a=a.replace("+justify","").toLowerCase();if(a=="full")a="justify";var b=this.n.tf("Bidi");if(b)return a==b.jT();else{var c=this.pe();if(!c)return j;var d=c.Tb();b=Pb(d.childNodes,function(h){return Lj(h)&&c.containsNode(h,g)});b=b.length?b:[d];for(d=0;d<b.length;d++){var f=Ul(b[d]);if(a!=Jm(f))return j}return g}};
function Jm(a){var b=Df(a,"textAlign");b=b.replace(/^-(moz|webkit)-/,"");Im[b]||(b=a.align||"left");return b}wm.prototype.GW=function(a){var b=this.pe();b=b&&b.Tb();a=tf(b,a);return!!a&&!!uf(a,Sj)};wm.prototype.sJ=function(a,b,c){return this.rJ(g,a,b,c)};wm.prototype.Vr=function(a,b,c){return this.rJ(j,a,b,c)};wm.prototype.rJ=function(a,b,c,d){c=Bm(c);if(d){var f=this.He();f.execCommand("styleWithCSS",j,g)}a=a?b.queryCommandState(c):b.queryCommandValue(c);d&&f.execCommand("styleWithCSS",j,j);return a};function Km(){R.call(this,"hover")}w(Km,R);function Lm(){R.call(this,"unhover")}w(Lm,R);function Mm(a){R.call(this,"datachange");this.je=a}w(Mm,R);function Nm(){R.call(this,"reload")}w(Nm,R);function Om(a){R.call(this,"addnewitem");this.ip=a}w(Om,R);function Pm(){R.call(this,"documentchange")}w(Pm,R);function Qm(){R.call(this,"documentchangepost")}w(Qm,R);function Rm(){R.call(this,"documentreload")}w(Rm,R);function Sm(a){R.call(this,"remove");this.Q3=a}w(Sm,R);
function Tm(a){R.call(this,"positionchange");this.mZ=a}w(Tm,R);Tm.prototype.uf=function(){return this.mZ};function Um(){R.call(this,"sizechange")}w(Um,R);function Vm(){R.call(this,"pageviewswitch")}w(Vm,R);function Wm(){R.call(this,"calloutclick")}w(Wm,R);function Xm(){this.ip=new Mc;this.Pc=new V(this);this.q=new V(this);this.q.g(this,"documentreload",this.load);this.Em=new Ch;this.du=j}var Ym;w(Xm,Og);Xm.prototype.d0=function(a){this.du=a};function Zm(){return Ym||(Ym=new Xm)}n=Xm.prototype;n.Dm=function(a){ia(a)?this.Em.To(a):this.Em.add(a);$m()};n.av=function(a){ia(a)?this.Em.Mc(a):this.Em.remove(a);$m()};n.Zw=function(a){return this.Em.contains(a)};
n.load=function(){if(!X)return i;var a=X.document.getElementsByTagName("gdoc:callout");if(a.length==0){a=X.document.getElementsByTagName("callout");if(a.length==0)a=X.document.getElementsByName("gdoccallout")}this.Pc.Mc();this.dispatchEvent(new Nm);this.ip.clear();for(var b=this.Zw("comment"),c=this.Zw("footnote"),d=[],f=0,h;h=a[f];f++){var k;if((k=h.getAttribute("callouttype"))!=i){var l;if(b&&k=="comment"){k=new ra.xp.fB(k);l=new ra.xp.y3(k);k.qA(h)}else if(c&&k=="footnote"){k=new an;l=new bn(k);
k.qA(h)}if(l&&!l.Lk()){l.o0(h);this.Pc.g(l,"remove",this.sw);d.push(l)}}}this.dispatchEvent(new Om(d));cn();return this.ip};n.sw=function(){};function dn(){for(var a=X.document.getElementsByTagName("marker"),b=0,c;c=a[b];b++)P(c)}var en=/(<gdoc:callout [^>]*calloutclosed=\"true\"[^>]*>).*(<\/gdoc:callout>)/ig,fn=/(<marker [^>]*>)[^<>]*(<\/marker>)/ig;function gn(a){a=a.replace(en,"<span>$2</span>");return a=a.replace(fn,"")}function cn(){Zm().dispatchEvent(new Pm);Zm().dispatchEvent(new Qm)}
function $m(){X&&X.document&&Zm().dispatchEvent(new Rm)};function hn(){Zj.call(this)}w(hn,wm);hn.prototype.bh=function(a){var b,c=this.n.O(),d=j;if(B)if(a=="+justifyCenter"||a=="+justifyFull"||a=="+justifyLeft"||a=="+justifyRight"){if(this.uU(a,c))return b}else if(jn(a,c)){b=Zm();if(b.Zw("footnote")){b.av("footnote");d=g}}b=hn.c.bh.call(this,a,arguments[1]);d&&Zm().Dm("footnote");return b};function jn(a,b){if(a!="+outdent"||!b||!b.isCollapsed())return j;return!!uf(b.L(),function(c){return c.nodeName=="LI"},g)}
hn.prototype.uU=function(a,b){var c=b.L(),d=i;if(c.nodeName=="TD"&&b.ka()==0)d=c;else if(c.nodeName!="TD"){var f=g;d=uf(c,function(m){if(m.nodeName=="TD")return g;else if(m.previousSibling)f=j},g,10);if(!d||!f)return j}else return j;c=b.da();b=b.Ma();var h=d.lastChild?d.lastChild.nodeName=="BR":j,k=j;if(c==d&&(b==c.childNodes.length||h&&b==c.childNodes.length-1))k=g;else if(c.nodeName!="TD"){var l=g;if(uf(c,function(m){if(m==d)return g;var p=m.parentNode;if(!p||m!=p.lastChild&&!(p==d&&h&&m==p.childNodes[p.childNodes.length-
2]))l=j},g,10)&&l)k=g}if(!k)return j;c="left";switch(a){case "+justifyCenter":c="center";break;case "+justifyFull":c="justify";break;case "+justifyRight":c="right";break}d.style.textAlign=c;this.yb().pa().focus();return g};function kn(){Zj.call(this)}w(kn,bk);kn.prototype.gb=function(){return"WritelyEnterHandler"};kn.prototype.Mq=function(a){if(!z||!this.n.hi)return j;this.n.hi=j;if(a.keyCode!=13)return j;var b=editUI.jg;if(!b.ga()||!b.nU())return j;a.preventDefault();return g};kn.prototype.yU=function(a){if(this.n.hi&&a.keyCode!=13)this.n.hi=j;return j};function ln(){this.Jn=[]}w(ln,ag);var mn=i;function nn(){mn||(mn=new ln);return mn}n=ln.prototype;n.W=function(){return this.mb};n.F=function(a){this.mb=a};n.xJ=function(a,b){if(this.W()){var c={};c.ic=a;if(b)c.m=b;this.Jn.push(c)}};n.jV=function(){return this.Jn.length>0};n.mT=function(){var a=$b(this.Jn);this.clear();return Gb(a)};n.clear=function(){this.Jn.length=0};n.k=function(){ln.c.k.call(this);delete this.Jn};function on(){Zj.call(this);this.ly=this.kz=j;if(H("enable_cloudboard")&&H("cloudboard_native_integration"))this.qC=pn("editorDeferred",5)}w(on,bk);n=on.prototype;n.gb=function(){return"WritelyPasteFilter"};n.te=function(a){return a=="userpaste"};
n.execCommand=function(a){if(a=="userpaste"){var b=arguments[1];if(b){var c=b;if(E)b=this.kR(b);var d=document.createElement("div");d.innerHTML=b;H("enable_clean_on_paste")&&qn(d);b=d.innerHTML;if(b.indexOf("<")!=-1)this.kz=g;H("impression_tracking")&&nn().xJ(1,{size:b.length});if(this.qC){this.qC(c,b);b=""}this.ly=g;si(function(){this.ly=j},0,this);return b}}};n.OO=function(){this.kz=j};n.kR=function(a){if(a.indexOf("__goog_page__")!=-1)a=a.replace(/style\=([\"\']).*?__goog_page__.*?\1/g,"");return a};
var rn={APPLET:1,FRAMESET:1,HEAD:1,OBJECT:1,SCRIPT:1,STYLE:1,TITLE:1,IFRAME:1,NOSCRIPT:1},sn={BR:1,DIV:1,P:1,SPAN:1,B:1,STRONG:1,I:1,EM:1,U:1,STRIKE:1,S:1,DEL:1,FONT:1,A:1,IMG:1,LI:1,UL:1,OL:1,TABLE:1,TR:1,TD:1,TH:1,TBODY:1,TFOOT:1,H1:1,H2:1,H3:1,H4:1,H5:1,H6:1,HR:1,SUP:1,SUB:1,CENTER:1,BLOCKQUOTE:1,PRE:1,"GDOC:CALLOUT":1},tn={EM:{nodeName:"I",attributes:{}},STRONG:{nodeName:"B",attributes:{}},S:{nodeName:"STRIKE",attributes:{}},DEL:{nodeName:"STRIKE",attributes:{}},PRE:{nodeName:"FONT",attributes:{face:"Courier New"}},
CODE:{nodeName:"FONT",attributes:{face:"Courier New"}}},un={"background-color":1,background:1,"background-image":1,"background-repeat":1,border:1,"border-color":1,"border-style":1,"border-width":1,color:1,direction:1,"float":1,font:1,"font-family":1,"font-size":1,"font-style":1,"font-weight":1,height:1,"list-style-type":1,margin:1,"margin-left":1,"margin-right":1,"text-align":1,"text-decoration":1,"vertical-align":1,width:1},vn=[{tagName:"B",Il:"font-weight",Nr:/bold|bolder|600|700|800|900/},{tagName:"I",
Il:"font-style",Nr:/italic|oblique/},{tagName:"U",Il:"text-decoration",Nr:"underline"},{tagName:"STRIKE",Il:"text-decoration",Nr:"line-through"}];
function qn(a){var b=new Ee(a.ownerDocument);lc(new ql(a),function(c,d,f){if(c!=a)if(c.nodeType==1)if(rn[c.nodeName])f.splice();else{if(tn[c.nodeName]){d=tn[c.nodeName];d=b.o(d.nodeName,d.attributes,c.childNodes);f.splice(d)}else if(!sn[c.nodeName]){f.splice(c.childNodes);return}if(d=wn(c)){d=d.split(";");for(f=0;f<d.length;f++){var h=Ba(d[f].split(":")[0]);if(h&&!un[h])c.style[Af(h)]="";if((c.nodeName=="P"||c.nodeName=="DIV")&&(h=="width"||h=="height"))c.style[Af(h)]=""}}f=wn(c);if(f.indexOf("font-size")!=
-1)if(d=xn(c.style.fontSize)){c.style.fontSize="";c.nodeName=="FONT"?c.setAttribute("size",d):yn(c,"FONT",{size:d},b,"font-size")}for(h=0;h<vn.length;h++){d=vn[h];var k=Af(d.Il);if(f.indexOf(d.Il)!=-1&&c.style[k].match(d.Nr)){c.nodeName!=d.tagName&&yn(c,d.tagName,i,b,d.Il);c.style[k]=""}}if(c.id&&X.document.getElementById(c.id))c.id=Xi();if(c.nodeName=="TABLE"&&(!c.getAttribute("border")||c.getAttribute("border")=="0"))I(c,"zeroBorder");wn(c)||c.removeAttribute("style")}})}
function xn(a){if(!a)return i;a=a.toLowerCase();var b=a.match(/([0-9.]+)(pt|px|em|in|cm|mm|pc|ex|%)?/);if(b)try{var c=parseFloat(b[1]),d=(b[2]||"px").toLowerCase();if(d=="px")c*=0.75;else if(d=="em")c*=12;else if(d=="in")c*=72;else if(d=="cm")c*=72/2.54;else if(d=="mm")c*=72/25.4;else if(d=="pc")c*=12;else if(d=="ex")c*=6;else if(d=="%")c*=0.12;return c<=8?1:c<=10?2:c<=12?3:c<=15?4:c<=20?5:c<=29?6:7}catch(f){return""}else switch(a){case "xx-small":case "x-small":return 1;case "small":return 2;case "medium":return 3;
case "large":return 4;case "x-large":return 5;case "xx-large":return 6;case "-webkit-xxx-large":return 7}return""}function yn(a,b,c,d,f){function h(p){if(k.length>0){var t=d.o(b,c,k);d.iW(t,p);k=[]}}for(var k=[],l=a.lastChild;l;l=l.previousSibling){var m=wn(l);if(l.tagName==b||m.indexOf(f)!=-1)h(l);else if(Qj(l)){h(l);yn(l,b,c,d,f)}else cc(k,0,0,l)}if(k.length>0){f=d.o(b,c,k);a.firstChild?d.Vw(f,a.firstChild):d.appendChild(a,f)}}
function wn(a){if(a.nodeType!=1)return"";if(z)return(a.style.cssText||"").toLowerCase();return(a.getAttribute("style")||"").toLowerCase()};function zn(a){this.nd=a||window;this.sr=U(this.nd,"resize",this.PU,j,this);this.rc=Me(this.nd);if(this.IW())this.gt=window.setInterval(u(this.hC,this),500)}w(zn,Og);n=zn.prototype;n.sr=i;n.nd=i;n.rc=i;n.gt=i;n.IW=function(){return E&&nd||y&&this.nd.f5!=this.nd.top};n.hw=function(){return this.rc?this.rc.Sa():i};n.k=function(){zn.c.k.call(this);if(this.sr){Eg(this.sr);this.sr=i}if(this.gt){window.clearInterval(this.gt);this.gt=i}this.rc=this.nd=i};n.PU=function(){this.hC()};
n.hC=function(){var a=Me(this.nd);if(!re(a,this.rc)){this.rc=a;this.dispatchEvent("resize")}};function An(a,b,c){this.target=a;this.nw=b||a;this.xx=c||new xf(NaN,NaN,NaN,NaN);this.lb=Fe(a);this.q=new V(this);U(this.nw,"mousedown",this.tL,j,this)}w(An,Og);var Bn=z||B&&Cd("1.9.3");n=An.prototype;n.screenX=0;n.screenY=0;n.uL=0;n.vL=0;n.tm=0;n.um=0;n.mb=g;n.Yg=j;n.uG=0;n.QX=0;n.IV=j;n.Qa=function(){return this.q};n.F=function(a){this.mb=a};n.k=function(){An.c.k.call(this);Cg(this.nw,"mousedown",this.tL,j,this);this.q.p();delete this.target;delete this.nw;delete this.q};
n.tL=function(a){if(this.mb&&!this.Yg&&(a.type!="mousedown"||a.pn(0))){if(this.uG==0){this.LG(a);if(this.Yg)a.preventDefault();else return}else a.preventDefault();this.e1();this.screenX=this.uL=a.screenX;this.screenY=this.vL=a.screenY;this.tm=this.target.offsetLeft;this.um=this.target.offsetTop;this.In=J(this.lb).oe();this.QX=v()}};
n.e1=function(){var a=this.lb,b=a.documentElement,c=!Bn;this.q.g(a,"mousemove",this.RX,c);this.q.g(a,"mouseup",this.Tp,c);if(Bn){b.setCapture(j);this.q.g(b,"losecapture",this.Tp)}else this.q.g(Ne(a),"blur",this.Tp);z&&this.IV&&this.q.g(a,"dragstart",cg);this.M_&&this.q.g(this.M_,"scroll",this.NY,c)};n.LG=function(a){if(this.dispatchEvent(new Cn("start",this,a.clientX,a.clientY,a))!==j)this.Yg=g};
n.Tp=function(a,b){this.q.Mc();Bn&&this.lb.releaseCapture();if(this.Yg){this.Yg=j;var c=this.CH(this.tm),d=this.DH(this.um);this.dispatchEvent(new Cn("end",this,a.clientX,a.clientY,a,c,d,b))}};
n.RX=function(a){if(this.mb){var b=a.screenX-this.screenX,c=a.screenY-this.screenY;this.screenX=a.screenX;this.screenY=a.screenY;if(!this.Yg){var d=this.uL-this.screenX,f=this.vL-this.screenY;if(d*d+f*f>this.uG){this.LG(a);if(!this.Yg){this.Tp(a);return}}}c=this.fp(b,c);b=c.x;c=c.y;if(this.Yg)if(this.dispatchEvent(new Cn("beforedrag",this,a.clientX,a.clientY,a,b,c))!==j){this.vD(a,b,c,j);a.preventDefault()}}};
n.fp=function(a,b){var c=J(this.lb).oe();a+=c.x-this.In.x;b+=c.y-this.In.y;this.In=c;this.tm+=a;this.um+=b;a=this.CH(this.tm);b=this.DH(this.um);return new oe(a,b)};n.NY=function(a){var b=this.fp(0,0);a.clientX=this.In.x-this.screenX;a.clientY=this.In.x-this.screenY;this.vD(a,b.x,b.y,g)};n.vD=function(a,b,c){this.VP(b,c);this.dispatchEvent(new Cn("drag",this,a.clientX,a.clientY,a,b,c))};
n.CH=function(a){var b=this.xx,c=!isNaN(b.left)?b.left:i;b=!isNaN(b.width)?b.width:0;return Math.min(c!=i?c+b:Infinity,Math.max(c!=i?c:-Infinity,a))};n.DH=function(a){var b=this.xx,c=!isNaN(b.top)?b.top:i;b=!isNaN(b.height)?b.height:0;return Math.min(c!=i?c+b:Infinity,Math.max(c!=i?c:-Infinity,a))};n.VP=function(a,b){this.target.style.left=a+"px";this.target.style.top=b+"px"};
function Cn(a,b,c,d,f,h,k,l){R.call(this,a);this.clientX=c;this.clientY=d;this.O3=f;this.left=h!==undefined?h:b.tm;this.top=k!==undefined?k:b.um;this.i4=b;this.h4=!!l}w(Cn,R);function Dn(a){if(a.target){a=a.target;if(a.nodeName=="IFRAME"&&a.target)if(a.className!="igm")a=a.target;return a}else if(a.srcElement)return a.srcElement;else if(a.currentTarget)return a.currentTarget}function En(a,b){b.target=a;a.dispatchEvent(b)};function Fn(a,b,c){var d=a.getElementsByTagName("input");if(c)for(c=0;c<d.length;c++){var f=d[c];Gn(f)&&Zf(f)&&f.setAttribute("_wasUnselectable",g)}Nk&&b.g(a,"mousedown",Hn,g);$f(a,g);for(c=0;c<d.length;c++){f=d[c];if(Gn(f)){f.getAttribute("_wasUnselectable")||In(f);f.removeAttribute("_wasUnselectable")}}}function Gn(a){return a.type=="text"||a.type=="file"||a.type=="url"}function Hn(a){var b=Dn(a).nodeName;b!="TEXTAREA"&&b!="INPUT"&&a.preventDefault()}
function In(a){$f(a,j);if(Nk)for(var b=Jn(a);b;){a=a;for(var c=b;a&&a!=c;){var d=a;a=a.parentNode;if(a.style){var f=Kn();a.style[f]="";for(var h=a.firstChild;h;){if(h!=d&&h.style)h.style[f]="none";h=h.nextSibling}}}a=b;b=Jn(a)}}function Kn(){if(B)return"MozUserSelect";else if(E)return"WebkitUserSelect"}function Jn(a){return uf(a,function(b){var c=Kn();return b&&b.style&&b.style[c].toLowerCase()=="none"},g)};function Ln(a,b,c){for(b=b;b&&b!=c;){var d=b.nextSibling;a.appendChild(b);b=d}b&&a.appendChild(b)}function Mn(a,b){b=a.ownerDocument.createTextNode(b);a.appendChild(b);return b};function Nn(a){this.b1(a)}function On(a){a=a.location.toString();a=a.substring(0,a.lastIndexOf("/")+1);return new Nn({base:a,winbase:a,draft:a,preview:a,live:a,edit:a})}Nn.prototype.b1=function(a){this.xe=a;this.xe.site=this.xe.base.substring(0,this.xe.base.indexOf("/",9))};Nn.prototype.qk=function(a,b){if(this.BW(a))a=(this.xe[b]||this.xe.base)+Pn(a);return a};
Nn.prototype.uT=function(a){a=a.getAttribute("href")||"";var b=this.xe.base;if(b&&b!=this.xe.winbase&&a.indexOf(b)==0)a=this.xe.winbase+a.substring(b.length);return a};var Qn={thumb:96,small:96,medium:200,large:420};Nn.prototype.oT=function(a,b){return Qn[b]};Nn.prototype.Dx=function(a){a=a.getElementsByTagName("img");for(var b=0,c=a.length;b<c;b++)a[b].src=this.qk(a[b].src,"live")};
function Pn(a){var b;b=a.lastIndexOf("/");var c;a:{if(/.*\/([^\/]+)\.\w{1,4}\/([^\/]+)-(small|medium|large|full|custom).*(?:\.\w{1,4})?$/.test(a)){c=RegExp.$3;if(RegExp.$1==RegExp.$2){c=c;break a}}c=i}if(c)b=a.lastIndexOf("/",b-1);if(a.indexOf("about:blank",b+1)==0)b+=11;b=b+1;c=a.lastIndexOf("?");if(c==-1)return decodeURIComponent(a.substring(b));return decodeURIComponent(a.substring(b,c))}var Rn=j;
Nn.prototype.BW=function(a){var b=Rn;if(b)if(la(b))return b(a);else{if(a&&ta(a,"mailto:"))return j;b=j;for(var c in this.xe)if(this.xe[c]!="")b|=a.search(this.xe[c])==0;return b||a.search(/[^:\/\s]+:\/\//)!=0||a.search("/")==0}else return j};function Sn(a){if(a.search(/:/)<0)a="http://"+Ca(a);return a}var Tn=j;function Un(a,b){b=b.substring(0,b.indexOf("/",9));return a==b+"/"||a==b};function Vn(a,b,c,d){var f=a.sb.createElement("img");Wn(f,qa(Xn,f,b,c));f.removeAttribute("height");f.removeAttribute("width");if(a.O()&&!gm(a.O())){alert("Select a paragraph to insert the image into.");return i}if(d)Ze(f,d);else{d=f;d.setAttribute("id","setTempIdToRetrieveImage");a.O().fl(d);(d=a.sb.b("setTempIdToRetrieveImage"))&&d.removeAttribute("id");f=d}z&&Yn(f,b,c);return f}var Zn={},$n={},ao={};
function Wn(a,b,c){var d=r(a);if(b){b=qa(bo,b);Zn[d]=U(a,z?"readystatechange":"load",b,j)}if(c){c=qa(bo,c);$n[d]=U(a,"error",c,j)}}function Yn(a,b,c){var d=r(a);b=qa(Xn,a,b,c);ao[d]=da.setInterval(qa(bo,b,{currentTarget:a}),300)}function bo(a,b){b=b.currentTarget;var c=b.readyState;if(!(c&&c!="complete")){c=r(b);Eg(Zn[c]);delete Zn[c];Eg($n[c]);delete $n[c];if(ao[c]){da.clearInterval(ao[c]);delete ao[c]}a(b)}}function Xn(a,b,c){b.oT(a.src,"medium");c&&c(a)}
function co(a){if(!a.M1){if(a.tabIndex)a.qI=a.tabIndex;a.tabIndex="-1";a.M1=g}};function eo(a){this.Xg=a;this.K=J(a)}eo.prototype.Ep=function(a){a=this.LC(a,"tr_feedback",g);a.align="center";return a};eo.prototype.ZK=function(a,b,c,d,f){a=a.cells;this.lo(a[0],b,f);this.lo(a[1],c,f);this.lo(a[2],d,f)};
eo.prototype.LC=function(a,b,c){var d;d=this.Xg;var f=q(3)?parseInt(3,10):3,h=q(3)?parseInt(3,10):3;d=J(d).Ep(f,h,g);Ke(d,{"class":b,border:0,cellSpacing:0,cellPadding:0});b=d.rows;this.ZK(b[0],"tr_tl",c?i:"tr_t","tr_tr",c?i:2);f=b[1].cells;this.lo(f[0],c?i:"tr_l");Ke(f[1],a);this.lo(f[2],c?i:"tr_r");this.ZK(b[2],"tr_bl",c?i:"tr_b","tr_br",c?i:2);return d};
eo.prototype.lo=function(a,b,c){a.innerHTML="";a.className=b||"tr_sidebar";if(c){a.width=c;a.height=c}a.appendChild(this.K.o("img",{height:1,width:1,alt:""}))};function fo(a){this.VB=a;Zj.call(this)}w(fo,Zj);n=fo.prototype;n.gb=Tj("BubbleBase");n.te=function(a){return a==this.VB};n.bh=function(a){if(a==this.VB)return this.TF(arguments[1])};n.qd=function(a){fo.c.qd.call(this,a);if(this.W(a))this.Fo=new zn(this.n.cf)};n.Fc=function(a){fo.c.Fc.call(this,a);if(this.Fo&&!this.W(a)){this.Fo.p();this.Fo=i}};n.fV=function(){this.ga()&&this.Ga()};n.c0=function(a){this.eO=a;this.gf&&yf(this.gf,"zIndex",a)};
n.Fi=function(a){if(a)a=Dn(a);else{var b=(a=this.n.O())&&a.L();if(z&&a&&a.isCollapsed()&&b!=a.da())a=dk(b,a.ka());a=a&&a.Tb()}return this.TF(a)};n.TF=function(a){if(a)if(a=this.Mm(a)){if(a!=this.wb||!this.gf){this.gf&&this.Sc();this.oP(a)}this.XY();return g}return j};
n.oP=function(a){this.K=new J(this.dO||this.n.cf.document.body);this.wb=a;this.j4=this.yb().pa();var b=this.K.o("div",{className:"tr_bubble"});(this.dO||this.K.M().body).appendChild(b);this.gf=b;this.c0(this.eO||this.n.oE());this.s5=a.nodeName;this.ea=new ui(b);this.Pa=new V(this);this.oc=new Rh(a.ownerDocument);this.Pa.g(this.oc,"key",this.sd);this.Pa.g(this.ea,"show",this.po);this.Pa.g(this.ea,"hide",this.RF);this.Mj(this.pP());this.gN();this.Ga();this.Fo&&this.Pa.g(this.Fo,"resize",this.fV,j,this);
Fn(b,this.Pa)};n.pP=function(){var a=new eo(this.K.M()),b="tr_bubble-content-"+db();this.gf.appendChild(a.LC({className:"tr_body",id:b},"tr_bubble"));a=this.K.Oh(b);a.innerHTML="";return this.cO=a};n.gN=function(){var a=this.K.o("div",{className:"tr_bubble_closebox",innerHTML:"&nbsp;"});this.By(a,this.Sc);this.cO.appendChild(a)};n.By=function(a,b){this.Pa.g(a,"click",b)};n.XY=function(){if(this.ea){this.ea.z(g);this.Ga()}};n.Sc=function(){this.ea&&this.ea.z(j);this.RF()};
n.po=function(){this.Jr();this.Ga()};n.Jr=fa;n.RF=function(){if(this.gf){P(this.gf);this.gf=i;if(this.Pa){this.Pa.p();this.Pa=i}if(this.oc){this.oc.p();this.oc=i}}};n.ga=function(){if(this.ea)return this.ea.ga();return j};var go=z?4:2,ho=new vf(go,0,go,0);n=fo.prototype;n.Ga=function(){var a=this.wb,b=496;a=Lf(this.gf)!=Lf(a);b=this.qy(a?7:5,4,9);if(b&496)b=this.qy(a?6:4,5,9);if(b&496)this.qy(a?7:5,4,5)};n.qy=function(a,b,c){return Eh(this.wb,a,this.gf,b,i,ho,c)};
n.Nj=function(a){return this.K.o("span",{id:a,"class":"tr_option-link"},this.K.createTextNode("\u00a0-\u00a0"))};n.nf=function(a,b,c,d){a=this.HC(a,b,j,d);c&&this.By(a,c);return a};n.HC=function(a,b,c,d){b=this.K.o(c?"a":"span",{className:"tr_bubble_link"},b);this.h1(b,a,d);Fn(b,this.Pa);return b};n.h1=function(a,b,c){if(c)c.appendChild(a);else if(c=this.K.b(b)){Ye(a,c);P(c)}a.id=b};n.sd=function(){this.Sc();return g};var io={CM:"image",t3:"spChar",wM:"editHtml",d3:"editImage",YA:"link",k3:"insertModule"};function jo(){if(B){this.Sg={};this.lt={};this.Js=[]}}n=jo.prototype;n.mb=B;n.F=function(a){this.mb=B&&a};n.Ur=function(a){this.mb&&this.Js.push(q(a)?a:ma(a)?r(a):"")};n.Qr=function(){this.mb&&this.j2(this.Js.pop())};n.tW=function(a){if(!this.mb)return g;return!this.Sg[q(a)?a:ma(a)?r(a):""]};n.CX=function(a){if(this.mb){a=r(a);for(var b=0;b<this.Js.length;b++){var c=this.Js[b];this.Xo(this.Sg,c,a);this.Xo(this.lt,a,c)}}};
n.BX=function(a){if(this.mb){a=r(a);delete this.lt[a];for(var b in this.Sg){Xb(this.Sg[b],a);this.Sg[b].length==0&&delete this.Sg[b]}}};n.j2=function(a){var b=this.lt[a],c=this.Sg[a];b&&c&&Nb(b,function(d){Nb(c,function(f){this.Xo(this.Sg,d,f);this.Xo(this.lt,f,d)},this)},this)};n.Xo=function(a,b,c){a[b]||(a[b]=[]);Vb(a[b],c)||a[b].push(c)};var ko=new jo;function lo(){this.Br="closure_frame"+mo++;this.hn=[];no[this.Br]=this}var oo;w(lo,Og);var no={},mo=0;function po(a,b){Jc(b,function(c,d){c=Oe("input",{type:"hidden",name:d,value:c});a.appendChild(c)})}n=lo.prototype;n.ec=i;n.Ba=i;n.Ji=i;n.bY=0;n.$b=j;n.bi=j;n.Qs=j;n.Ti=i;n.pr=i;n.Wd=0;n.Ll=0;n.Jh=i;n.$D=i;n.kh=i;
n.send=function(a,b,c,d){if(this.$b)e(Error("[goog.net.IframeIo] Unable to send, already active."));this.Ti=a=new Tc(a);b=b?b.toUpperCase():"GET";c&&a.RH();if(!oo){oo=Oe("form");oo.acceptCharset="utf-8";c=oo.style;c.position="absolute";c.visibility="hidden";c.top=c.left="-10px";c.width=c.height="10px";c.overflow="hidden";document.body.appendChild(oo)}this.ec=oo;b=="GET"&&po(this.ec,a.qc);d&&po(this.ec,d);this.ec.action=a.toString();this.ec.method=b;this.mK()};
n.Q_=function(a,b,c){if(this.$b)e(Error("[goog.net.IframeIo] Unable to send, already active."));b=new Tc(b||a.action);c&&b.RH();this.Ti=b;this.ec=a;this.ec.action=b.toString();this.mK()};n.abort=function(a){if(this.$b){Gg(this.bw());this.Qs=this.$b=this.bi=j;this.Wd=a||7;this.dispatchEvent("abort");this.Ex()}};n.k=function(){this.$b&&this.abort();lo.c.k.call(this);this.Ba&&this.hK();this.sD();delete this.LD;this.Ti=this.dX=this.pr=this.cX=this.ec=i;this.Wd=0;delete no[this.Br]};n.ax=function(){return this.bi};
n.oH=function(){return this.Qs};n.Ne=function(){return this.$b};n.Dq=function(){return this.pr};n.cF=function(){return Eb(this.pr)};n.uq=ba(5);n.tq=ba(24);n.Al=function(a){this.Ll=Math.max(0,a)};n.dispatchEvent=function(a){this.Ba&&ko.Ur(this.Ba);try{lo.c.dispatchEvent.call(this,a)}finally{this.Ba&&ko.Qr()}};
n.mK=function(){this.$b=g;this.bi=j;this.Wd=0;this.Bu();if(z){this.ec.target=this.Ji||"";this.zB();U(this.Ba,"readystatechange",this.Hn,j,this);try{this.uv=j;this.ec.submit()}catch(a){Cg(this.Ba,"readystatechange",this.Hn,j,this);this.pg(1)}}else{this.zB();var b=this.Ji+"_inner",c=jf(this.Ba),d="<body><iframe id="+b+" name="+b+"></iframe>";if(y)c.documentElement.innerHTML=d;else c.write(d);U(c.getElementById(b),"load",this.$x,j,this);var f=this.ec.getElementsByTagName("textarea");d=0;for(var h=f.length;d<
h;d++)qf(f[d])!=f[d].value&&kf(f[d],f[d].value);f=c.importNode(this.ec,g);f.target=b;c.body.appendChild(f);var k=this.ec.getElementsByTagName("select"),l=f.getElementsByTagName("select");d=0;for(h=k.length;d<h;d++)l[d].selectedIndex=k[d].selectedIndex;k=this.ec.getElementsByTagName("input");l=f.getElementsByTagName("input");d=0;for(h=k.length;d<h;d++)if(k[d].type=="file")if(k[d].value!=l[d].value){this.ec.target=b;f=this.ec;break}try{this.uv=j;f.submit();c.close();if(B)this.$D=si(this.GL,250,this)}catch(m){Cg(c.getElementById(b),
"load",this.$x,j,this);c.close();this.pg(2)}}};n.Hn=function(){if(this.Ba.readyState=="complete"){Cg(this.Ba,"readystatechange",this.Hn,j,this);var a;try{a=jf(this.Ba);if(z&&a.location=="about:blank"&&!navigator.onLine){this.pg(9);return}}catch(b){this.pg(1);return}this.bn(a)}};n.$x=function(){if(!(y&&this.Ov().location=="about:blank")){Cg(this.bw(),"load",this.$x,j,this);this.bn(this.Ov())}};
n.bn=function(a){this.bi=g;this.$b=j;var b;try{var c=a.body;this.pr=c.textContent||c.innerText;this.cX=c.innerHTML}catch(d){b=1}var f;if(!b&&typeof this.LD=="function")if(f=this.LD(a))b=4;if(b)this.pg(b,f);else{this.Qs=g;this.Wd=0;this.dispatchEvent("complete");this.dispatchEvent("success");this.Ex()}};n.pg=function(a,b){if(!this.uv){this.$b=this.Qs=j;this.bi=g;this.Wd=a;if(a==4)this.dX=b;this.dispatchEvent("complete");this.dispatchEvent("error");this.Ex();this.uv=g}};
n.Ex=function(){var a=this.Ba;this.hK();this.sD();ko.Ur(a);try{this.dispatchEvent("ready")}finally{ko.Qr()}};n.Bu=function(){this.Ji=this.Br+"_"+(this.bY++).toString(36);var a={name:this.Ji,id:this.Ji};if(z&&Ad<7)a.src='javascript:""';this.Ba=Oe("iframe",a);a=this.Ba.style;a.visibility="hidden";a.width=a.height="10px";if(E)a.marginTop=a.marginLeft="-10px";else{a.position="absolute";a.top=a.left="-10px"}};n.zB=function(){document.body.appendChild(this.Ba)};
n.hK=function(){var a=this.Ba;if(a){a.onreadystatechange=i;a.onload=i;a.onerror=i;this.hn.push(a)}if(this.kh){ti(this.kh);this.kh=i}if(B||y)this.kh=si(this.gv,2E3,this);else this.gv();this.Ji=this.Ba=i};n.gv=function(){if(this.kh){ti(this.kh);this.kh=i}for(var a=0;a<this.hn.length;){var b=this.hn[a];if(ko.tW(b)){Yb(this.hn,a);P(b)}else a++}if(this.hn.length!=0)this.kh=si(this.gv,2E3,this)};n.sD=function(){this.ec&&this.ec==oo&&We(this.ec);this.ec=i};
n.Ov=function(){if(this.Ba)return jf(this.bw());return i};n.bw=function(){if(this.Ba)return z?this.Ba:jf(this.Ba).getElementById(this.Ji+"_inner");return i};n.GL=function(){if(this.$b){this.Ov();this.$D=si(this.GL,250,this)}};function qo(){return ro()}var ro=i,so=i,to=i;ro=function(){var a=uo();return a?new ActiveXObject(a):new XMLHttpRequest};so=function(){var a={};if(uo()){a[0]=g;a[1]=g}return a};to=i;var vo=i;
function uo(){if(!vo&&typeof XMLHttpRequest=="undefined"&&typeof ActiveXObject!="undefined"){for(var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],b=0;b<a.length;b++){var c=a[b];try{new ActiveXObject(c);return vo=c}catch(d){}}e(Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed"))}return vo};function wo(){this.headers=new Mc}w(wo,Og);var xo=[];function yo(a,b,c,d,f,h){var k=new wo;xo.push(k);b&&U(k,"complete",b);U(k,"ready",qa(zo,k));h&&k.Al(h);k.send(a,c,d,f)}function zo(a){a.p();Xb(xo,a)}n=wo.prototype;n.$b=j;n.za=i;n.kt=i;n.Ti="";n.eX="";n.Wd=0;n.Si="";n.tv=j;n.Zq=j;n.Rw=j;n.Ki=j;n.Ll=0;n.Jh=i;n.Al=function(a){this.Ll=Math.max(0,a)};
n.send=function(a,b,c,d){if(this.$b)e(Error("[goog.net.XhrIo] Object is active with another request"));b=b||"GET";this.Ti=a;this.Si="";this.Wd=0;this.eX=b;this.tv=j;this.$b=g;this.za=this.LP();this.kt=to||(to=so());ko.CX(this.za);this.za.onreadystatechange=u(this.II,this);try{this.Rw=g;this.za.open(b,a,g);this.Rw=j}catch(f){this.Sb(5,f);return}a=c||"";var h=this.headers.Sa();d&&Jc(d,function(l,m){h.u(m,l)});b=="POST"&&!h.Ce("Content-Type")&&h.u("Content-Type","application/x-www-form-urlencoded;charset=utf-8");
Jc(h,function(l,m){this.za.setRequestHeader(m,l)},this);try{if(this.Jh){ri.clearTimeout(this.Jh);this.Jh=i}if(this.Ll>0)this.Jh=ri.setTimeout(u(this.eA,this),this.Ll);this.Zq=g;this.za.send(a);this.Zq=j}catch(k){this.Sb(5,k)}};n.LP=function(){return new qo};n.dispatchEvent=function(a){if(this.za){ko.Ur(this.za);try{return wo.c.dispatchEvent.call(this,a)}finally{ko.Qr()}}else return wo.c.dispatchEvent.call(this,a)};
n.eA=function(){if(typeof ca!="undefined")if(this.za){this.Si="Timed out after "+this.Ll+"ms, aborting";this.Wd=8;this.dispatchEvent("timeout");this.abort(8)}};n.Sb=function(a,b){this.$b=j;if(this.za){this.Ki=g;this.za.abort();this.Ki=j}this.Si=b;this.Wd=a;this.oD();this.op()};n.oD=function(){if(!this.tv){this.tv=g;this.dispatchEvent("complete");this.dispatchEvent("error")}};
n.abort=function(a){if(this.za){this.$b=j;this.Ki=g;this.za.abort();this.Ki=j;this.Wd=a||7;this.dispatchEvent("complete");this.dispatchEvent("abort");this.op()}};n.k=function(){if(this.za){if(this.$b){this.$b=j;this.Ki=g;this.za.abort();this.Ki=j}this.op(g)}wo.c.k.call(this)};n.II=function(){!this.Rw&&!this.Zq&&!this.Ki?this.ay():this.HI()};n.ay=function(){this.HI()};
n.HI=function(){if(this.$b)if(typeof ca!="undefined")if(!(this.kt[1]&&this.Vm()==4&&this.Iq()==2))if(this.Zq&&this.Vm()==4)ri.setTimeout(u(this.II,this),0);else{this.dispatchEvent("readystatechange");if(this.ax()){this.$b=j;if(this.oH()){this.dispatchEvent("complete");this.dispatchEvent("success")}else{this.Wd=6;this.Si=this.qT()+" ["+this.Iq()+"]";this.oD()}this.op()}}};
n.op=function(a){if(this.za){var b=this.za,c=this.kt[0]?fa:i;this.kt=this.za=i;if(this.Jh){ri.clearTimeout(this.Jh);this.Jh=i}if(!a){ko.Ur(b);this.dispatchEvent("ready");ko.Qr()}ko.BX(b);try{b.onreadystatechange=c}catch(d){}}};n.Ne=function(){return this.$b};n.ax=function(){return this.Vm()==4};n.oH=function(){switch(this.Iq()){case 0:case 200:case 204:case 304:return g;default:return j}};n.Vm=function(){return this.za?this.za.readyState:0};n.Iq=function(){try{return this.Vm()>2?this.za.status:-1}catch(a){return-1}};
n.qT=function(){try{return this.Vm()>2?this.za.statusText:""}catch(a){return""}};n.uq=ba(4);n.Dq=function(){return this.za?this.za.responseText:""};n.cF=function(a){if(this.za){var b=this.za.responseText;if(a&&b.indexOf(a)==0)b=b.substring(a.length);return Eb(b)}};n.getResponseHeader=function(a){return this.za&&this.ax()?this.za.getResponseHeader(a):undefined};n.tq=ba(23);function Ao(a){a=a.toString();var b;b=Nd("propagated_uri_params");b=b==i?i:Eb(b);a=Rc([a],b);if(a[1]){b=a[0];var c=b.indexOf("#");if(c>=0){a.push(b.substr(c));a[0]=b=b.substr(0,c)}c=b.indexOf("?");if(c<0)a[1]="?";else if(c==b.length-1)a[1]=undefined}return a.join("")};var Bo={};function bh(a,b,c,d){b=b||new Mc;var f=new Tc("MiscCommands");f.vl(gd(["command"],[a],f));Co(f,b,c,d)}function Aj(a,b,c,d){b=b||new Mc;var f=new Tc("UserMiscCommands");f.vl(gd(["command"],[a],f));Co(f,b,c,d)}function Do(a,b){a=a||new Mc;var c=new Tc("SendEmail");Co(c,a,b,"EmailDocument")}
function Co(a,b,c,d){var f=new wo;f.Al(3E4);if(d){var h=Bo[d];if(h){Eo(h);h=i}Bo[d]=f}U(f,["success","error","timeout","abort"],u(Fo,i,c,d));b=b?fd(b):new Uc;b.u("POST_TOKEN",G("posttoken"));H("userloggedin")||b.u("gu","true");b.u("bl",G("label"));var k=b.toString();if(k)k+="&";k+="finis=true";var l=Ao(Zd(a?a.toString():""));window.setTimeout(function(){f.send(l,"POST",k)},0)}
function Fo(a,b,c){delete Bo[b];b=c.target;try{var d=b.Iq(),f=d&&c.type=="success";if(d==302||d==301){var h=b.getResponseHeader("Location");h.indexOf("unavailable.html")==-1&&h.indexOf("Error")==-1&&Go();f=j}var k=da.offline;k&&k.aM&&k.aM(!f);if(a)a(f?b.za:i,c.type=="timeout")}finally{Eo(b)}}function Ho(a){var b=document;a=b.location.protocol+"//"+(b.location.host+a).replace(/\/\//g,"/");if(a.charAt(a.length-1)!="/")a+="/";return a}
function Go(){var a=G("siteprefix"),b=new Tc("https://www.google.com");b.ul(a+(a?"":"/accounts")+"/ServiceLogin");var c=new Uc;c.add("service","writely");c.add("continue",Ho(a));b.vl(c);a="You may have been logged out. "+('<a target="_blank" href="'+b.toString()+'">Click here</a> to login in a new window.');ah([a])}function Eo(a){Gg(a);a.abort();a.p()}function je(a){return a in Bo}o("writely.net.sendRequest",Co,void 0);o("writely.net.miscCommand",bh,void 0);o("writely.net.userMiscCommand",Aj,void 0);function Io(a){this.D=a;a=z?"focusout":"blur";this.mX=U(this.D,z?"focusin":"focus",this,!z);this.nX=U(this.D,a,this,!z)}w(Io,Og);Io.prototype.handleEvent=function(a){var b=new eg(a.kc);b.type=a.type=="focusin"||a.type=="focus"?"focusin":"focusout";try{this.dispatchEvent(b)}finally{b.p()}};Io.prototype.k=function(){Io.c.k.call(this);Eg(this.mX);Eg(this.nX);delete this.D};function Jo(a,b,c){Qg.call(this,c);this.bc=a||"modal-dialog";this.HA=!!b;this.ac=Ko}w(Jo,Qg);n=Jo.prototype;n.cq=i;n.HA=j;n.En=g;n.zm=g;n.QN=0.5;n.ld="";n.La="";n.ac=i;n.od=i;n.xb=j;n.uD=j;n.Oa=i;n.Jb=i;n.Ld=i;n.Nd=i;n.fA=i;n.be=i;n.tc=i;n.Dc=i;n.Ka=function(a){this.ld=a;this.Nd&&kf(this.Nd,a)};n.pk=function(){return this.ld};n.hb=function(a){this.La=a;if(this.tc)this.tc.innerHTML=a};n.xa=function(){this.tc||this.db();return this.tc};n.Ym=function(){this.va||this.db();return this.Ld};
n.tT=function(){this.va||this.db();return this.Nd};n.kF=function(){this.va||this.db();return this.be};n.eh=function(){this.va||this.db();return this.Dc};n.yS=function(){this.va||this.db();return this.b()};n.gS=function(){this.va||this.db();return this.Oa};n.E0=function(a){this.En=a;this.Fx();var b=this.G();if(this.va&&a&&this.ga()){this.Jb&&b.Vw(this.Jb,this.b());this.Oa&&b.Vw(this.Oa,this.b());this.fj()}};n.CK=ba(17);
n.GC=function(){var a=new An(this.b(),this.Ld);I(this.Ld,this.bc+"-title-draggable");return a};
n.o=function(){this.Fx();var a=this.G();this.Wc(a.o("div",{className:this.bc,tabIndex:0},this.Ld=a.o("div",{className:this.bc+"-title",id:this.Lb()},this.Nd=a.o("span",this.bc+"-title-text",this.ld),this.be=a.o("span",this.bc+"-title-close")),this.tc=a.o("div",this.bc+"-content"),this.Dc=a.o("div",this.bc+"-buttons"),this.zL=a.o("span",{tabIndex:0})));this.fA=this.Ld.id;Nh(this.b(),"dialog");Oh(this.b(),"labelledby",this.fA||"");if(this.La)this.tc.innerHTML=this.La;Q(this.b(),j);this.ac&&this.ac.Qt(this.Dc)};
n.Fx=function(){if(this.HA&&this.En&&!this.Jb){this.Jb=this.G().o("iframe",{frameborder:0,style:"border:0;vertical-align:bottom;",src:'javascript:""'});this.Jb.className=this.bc+"-bg";Q(this.Jb,j);Tf(this.Jb,0)}else if((!this.HA||!this.En)&&this.Jb){P(this.Jb);this.Jb=i}if(this.En&&!this.Oa){this.Oa=this.G().o("div",this.bc+"-bg");Tf(this.Oa,this.QN);Q(this.Oa,j)}else if(!this.En&&this.Oa){P(this.Oa);this.Oa=i}};
n.db=function(a){if(this.va)e(Error("Component already rendered"));this.b()||this.o();a=a||this.G().M().body;this.NJ(a);Jo.c.db.call(this,a)};n.NJ=function(a){this.Jb&&a.appendChild(this.Jb);this.Oa&&a.appendChild(this.Oa)};n.Qc=function(a){return a&&a.tagName&&a.tagName=="DIV"&&Jo.c.Qc.call(this,a)};
n.bd=function(a){Jo.c.bd.call(this,a);I(this.b(),this.bc);a=this.bc+"-content";if(this.tc=He(i,a,this.b())[0])this.La=this.tc.innerHTML;else{this.tc=this.G().o("div",a);if(this.La)this.tc.innerHTML=this.La;this.b().appendChild(this.tc)}a=this.bc+"-title";var b=this.bc+"-title-text",c=this.bc+"-title-close";if(this.Ld=He(i,a,this.b())[0]){this.Nd=He(i,b,this.Ld)[0];this.be=He(i,c,this.Ld)[0]}else{this.Ld=this.G().o("div",a);this.b().insertBefore(this.Ld,this.tc)}if(this.Nd)this.ld=qf(this.Nd);else{this.Nd=
this.G().o("span",b,this.ld);this.Ld.appendChild(this.Nd)}Oh(this.b(),"labelledby",this.fA||"");if(!this.be){this.be=this.G().o("span",c);this.Ld.appendChild(this.be)}a=this.bc+"-buttons";if(this.Dc=He(i,a,this.b())[0]){this.ac=new Lo(this.G());this.ac.Aa(this.Dc)}else{this.Dc=this.G().o("div",a);this.b().appendChild(this.Dc);this.ac&&this.ac.Qt(this.Dc)}this.Fx();this.NJ(Fe(this.b()).body);Q(this.b(),j)};
n.Ua=function(){Jo.c.Ua.call(this);this.cq=new Io(this.G().M());if(this.zm&&!this.od)this.od=this.GC();this.Qa().g(this.be,"click",this.UY).g(this.cq,"focusin",this.AY);Nh(this.b(),"dialog");this.Nd.id!==""&&Oh(this.b(),"labelledby",this.Nd.id)};n.tb=function(){this.ga()&&this.z(j);this.cq.p();this.cq=i;if(this.od){this.od.p();this.od=i}Jo.c.tb.call(this)};
n.z=function(a){if(a!=this.xb){var b=this.G().M(),c=Ne(b)||window;this.va||this.db(b.body);if(a){this.fj();this.Ga();this.Qa().g(this.b(),"keydown",this.Ir,g).g(this.b(),"keypress",this.Ir,g).g(c,"resize",this.JI,g)}else this.Qa().Da(this.b(),"keydown",this.Ir,g).Da(this.b(),"keypress",this.Ir,g).Da(c,"resize",this.JI,g);this.Jb&&Q(this.Jb,a);this.Oa&&Q(this.Oa,a);Q(this.b(),a);a&&this.focus();if(this.xb=a)this.Qa().g(this.Dc,"click",this.rI);else{this.Qa().Da(this.Dc,"click",this.rI);this.dispatchEvent("afterhide");
this.uD&&this.p()}}};n.ga=function(){return this.xb};n.focus=function(){try{this.b().focus()}catch(a){}if(this.ac){var b=this.ac.qm;if(b)for(var c=this.G().M(),d=this.Dc.getElementsByTagName("button"),f=0,h;h=d[f];f++)if(h.name==b){try{if(E||y){var k=c.createElement("input");k.style.cssText="position:fixed;width:0;height:0;left:0;top:0;";this.b().appendChild(k);k.focus();this.b().removeChild(k)}h.focus()}catch(l){}break}}};
n.fj=function(){this.Jb&&Q(this.Jb,j);this.Oa&&Q(this.Oa,j);var a=this.G().M(),b=Me(Ne(a)||window),c=a.body.scrollWidth;a=Math.max(a.body.scrollHeight,b.height);if(this.Jb){Q(this.Jb,g);Of(this.Jb,c,a)}if(this.Oa){Q(this.Oa,g);Of(this.Oa,c,a)}if(this.zm){b=Pf(this.b());this.od.xx=new xf(0,0,c-b.width,a-b.height)}};
n.Ga=function(){var a=this.G().M(),b=Ne(a)||window;if(Ef(this.b())=="fixed")var c=a=0;else{c=this.G().oe();a=c.x;c=c.y}var d=Pf(this.b());b=Me(b);a=Math.max(a+b.width/2-d.width/2,0);c=Math.max(c+b.height/2-d.height/2,0);d=this.b();if(this.un()){d.style.right=Math.round(a)+"px";d.style.top=Math.round(c)+"px"}else Ff(d,a,c)};n.UY=function(){var a=this.ac,b=a&&a.eu;if(b){a=a.la(b);this.dispatchEvent(new Mo(b,a))&&this.z(j)}else this.z(j)};n.BK=function(a){this.uD=a};
n.k=function(){Jo.c.k.call(this);if(this.Oa){P(this.Oa);this.Oa=i}if(this.Jb){P(this.Jb);this.Jb=i}this.zL=this.Dc=this.be=i};n.We=function(a){this.ac=a;if(this.Dc)if(this.ac)this.ac.Qt(this.Dc);else this.Dc.innerHTML=""};n.rI=function(a){if((a=this.aR(a.target))&&!a.disabled){a=a.name;var b=this.ac.la(a);this.dispatchEvent(new Mo(a,b))&&this.z(j)}};n.aR=function(a){for(a=a;a!=i&&a!=this.Dc;){if(a.tagName=="BUTTON")return a;a=a.parentNode}return i};
n.Ir=function(a){var b=j,c=j,d=this.ac,f=a.target;if(a.type=="keydown")if(a.keyCode==27){var h=d&&d.eu;f=f.tagName=="SELECT"&&!f.disabled;if(h&&!f){c=g;b=d.la(h);b=this.dispatchEvent(new Mo(h,b))}else f||(b=g)}else{if(a.keyCode==9&&a.shiftKey&&f==this.b())c=g}else if(a.keyCode==13){if(f.tagName=="BUTTON")h=f.name;else if(d){var k=d.qm,l=k&&d.rE(k);f=(f.tagName=="TEXTAREA"||f.tagName=="SELECT")&&!f.disabled;if(l&&!l.disabled&&!f)h=k}if(h){c=g;b=this.dispatchEvent(new Mo(h,String(d.la(h))))}}if(b||
c){a.stopPropagation();a.preventDefault()}b&&this.z(j)};n.JI=function(){this.fj()};n.AY=function(a){this.zL==a.target&&si(this.Ev,0,this)};n.Ev=function(){z&&this.G().M().body.focus();this.b().focus()};function Mo(a,b){this.type="dialogselect";this.Wb=a;this.caption=b}w(Mo,R);function Lo(a){this.K=a||J();Mc.call(this)}var Ko,No,Oo;w(Lo,Mc);n=Lo.prototype;n.bc="goog-buttonset";n.qm=i;n.D=i;n.eu=i;n.u=function(a,b,c,d){Mc.prototype.u.call(this,a,b);if(c)this.qm=a;if(d)this.eu=a;return this};
n.Qt=function(a){this.D=a;this.db()};n.db=function(){if(this.D){this.D.innerHTML="";var a=J(this.D);Jc(this,function(b,c){b=a.o("button",{name:c},b);if(c==this.qm)b.className=this.bc+"-default";this.D.appendChild(b)},this)}};n.Aa=function(a){if(!(!a||a.nodeType!=1)){this.D=a;a=this.D.getElementsByTagName("button");for(var b=0,c,d,f;c=a[b];b++){d=c.name||c.id;f=qf(c)||c.value;if(d){var h=b==0;this.u(d,f,h,c.name=="cancel");h&&I(c,this.bc+"-default")}}}};n.pz=function(a){this.qm=a};
n.rE=function(a){for(var b=this.cS(),c=0,d;d=b[c];c++)if(d.name==a||d.id==a)return d;return i};n.cS=function(){return this.D.getElementsByTagName("BUTTON")};No=(new Lo).u("ok","OK",g,g);Ko=(new Lo).u("ok","OK",g).u("cancel","Cancel",j,g);Oo=(new Lo).u("yes","Yes",g).u("no","No",j,g);(new Lo).u("yes","Yes").u("no","No",g).u("cancel","Cancel",j,g);(new Lo).u("continue","Continue").u("save","Save").u("cancel","Cancel",g,g);function nj(){}var Po={},Qo=i;function Ro(){Qo={BlogSettings:So,Britannica:To,Captcha:Uo,ChangeCell:Vo,ChangeColumn:Wo,ChangeList:Xo,ChangeRow:Yo,CSSEdit:Zo,CommentSettings:$o,DocSettings:ap,EditHtmlSelection:bp,EmailDocument:cp,FindReplace:dp,InsertBookmark:ep,InsertImage:fp,InsertLink:gp,InsertTable:hp,MiscTextBox:ip,PrintSettings:jp,TocSettings:kp,WordCount:lp}}var mp={},np=i,op=i,pp=j;
function oh(a,b){Qo||Ro();if(!a)return i;var c=Po[a];if(!c&&la(Qo[a])){c=new Qo[a];Po[a]=c}if(!c)return i;kj&&lj("dl_"+a);c.sa(b);return c}function qp(){if(!(np||pp)){kj&&lj("load_dialogs");var a=[];for(var b in DIALOG_VERSIONS)a.push("f="+b,"v="+DIALOG_VERSIONS[b]);a.push("lang="+G("language"));a=a.join("&");np=new wo;np.Al(3E4);U(np,"success",rp);U(np,["error","timeout"],sp);np.send(Ao("DialogFetcher?"+a))}}
function tp(){typeof up!="undefined"&&vp(G("urchinid"),G("domainurchinid"),G("dasherdomain"))}function rp(){var a=np.Dq();if(ta(a,"while(true);"))a=a.substr(12);a=Fb(a);for(var b=0;b<a.dialogs.length;b++){var c=a.dialogs[b];mp[c.id]={title:c.title,html:c.html}}if(op){oh(op);op=i}np.p();np=i;Fd=function(d,f){Vi(i,d,"Attention",300,i,f)};kj&&Fi("load_dialogs");pp=g;tp();G("deferred_scripts")&&wp()&&xp(G("deferred_scripts").split(","))}
function xp(a){for(var b=0;b<a.length;b++){var c=a[b];if(!xa(Xa(c))){var d=document.createElement("script");d.src=c;document.body.appendChild(d)}}}function sp(){np.p();np=i;var a=op;if(a){F("Sorry, but we are unable to connect with the service right now.\nPlease make sure your network connection is working or try again in a few minutes.");Po[a].z(j);op=i}tp()}o("writely.DialogFetcher",nj,void 0);o("writely.DialogFetcher.openDialog",oh,void 0);function Y(){Jo.call(this);this.OD=this.eD=i;if(z&&ij()){var a=this.Ym();a.appendChild(a.firstChild);a.style.direction="ltr";a.style.height="2em";a=this.tT();a.style.position="absolute";a.style.right="16px";a.style.direction="rtl"}a=this.kF();var b=Oe("span",{id:this.j("close_box"),title:"Close Dialog","class":"goog-inline-block close_box"});a.appendChild(b);a=new Lo;a.u("ok","OK",g);a.u("cancel","Cancel",j,g);this.We(a);U(this,"dialogselect",this.Qq,j,this);this.eh().style.textAlign=ij()?"right":
"left"}w(Y,Jo);Y.prototype.qb=i;Y.prototype.sa=function(a,b){if(!this.eD){var c=mp[this.qb];if(c){this.Ka(c.title);this.hb(c.html);this.eD=c;b=function(){return j};c=0;for(var d;d=document.forms[c];c++)if(!d.onsubmit&&!d.action)d.onsubmit=b}else{op=this.qb;this.OD=b||i;qp();return j}}a||this.z(g);if(kj){var f="dl_"+this.qb;window.setTimeout(function(){Fi(f)},0)}return g};
Y.prototype.Ga=function(){Y.c.Ga.call(this);if(z){var a=document.body.offsetWidth,b=parseInt(this.D.style.left,10),c=this.D.offsetWidth;c||(c=a/2);if(b>a-c){this.D.style.left=(a-c)/2+"px";if(c){if(!this.D.id){if(document.getElementById("WritelyDialog"))O("WritelyDialog").id="";this.D.id="WritelyDialog"}window.setTimeout('document.getElementById("'+this.D.id+'").style.width = "'+c+'px"',0)}}}};var ke=j;n=Y.prototype;
n.z=function(a){ke=a;Y.c.z.call(this,a);!a&&this.qb!="MiscTextBox"&&la(window.dB)&&Ui()};n.Qq=function(a){if(a&&a.Wb=="ok")this.Na(a);else if(a&&a.Wb=="cancel")this.Vk(a);else a&&this.Yx(a)};n.Pu=function(){};n.Na=Y.prototype.Pu;n.Vk=Y.prototype.Pu;n.Yx=Y.prototype.Pu;n.j=function(a){return this.qb+a};n.Y=function(a){if(a=O(this.j(a)))return a.value;return i};n.zb=function(a){try{var b=O(this.j(a));if(b)return b.options[b.selectedIndex].value}catch(c){}return i};
n.Db=function(a){(a=O(this.j(a)))&&yf(a,"display","")};n.Ha=function(a){(a=O(this.j(a)))&&yf(a,"display","none")};n.ud=function(a,b,c,d){c=O(this.j(c));a=a.getAttribute(b);c.value=a||d};n.hm=function(a,b,c){var d=parseInt(this.Y(a),10);if(isNaN(d)||d<b)this.na(a,b);else d>c&&this.na(a,c)};
n.na=function(a,b){var c=O(this.j(a));if(c.type=="select-one"){for(var d=j,f=0;f<c.options.length;f++)if(c.options[f].value==b){c.selectedIndex=f;d=g;break}d||rce("Option not found in selection widget.",a,b)}else c.value=b?b.toString():""};n.Wa=function(a){try{var b=O(this.j(a));if(b)return b.checked}catch(c){}return j};n.Gd=function(a,b,c,d){if(d){a.setAttribute(c,b);return g}a.removeAttribute(c);return j};
n.Ik=function(a,b,c,d){if(a=a.getAttribute(b))a=a.toString();c=O(this.j(c));if(a)if(a=="100%")c.value=0;else{if(a.indexOf("%")>0){a=a.substring(0,a.length-1);c.value=3}else c.value=2;O(this.j(d)).value=a}else c.value=1};n.xj=function(){this.Ol("width_select","width_amt",j);this.Ol("height_select","height_amt",j)};n.Ol=function(a,b,c){a=this.Y(a);b=O(this.j(b));if(a>1){b.style.display="";c&&b.focus()}else b.style.display="none"};
n.zl=function(a,b,c,d){b=this.Y(b);c=this.Y(c);c=this.rT(b,c);c!=i?a.setAttribute(d,c,0):a.removeAttribute(d)};n.rT=function(a,b){if(a==0)return"100%";else if(a==2)return Ki(b)?b.toString():i;else if(a==3)return Ki(b)?b+"%":i;return i};n.nh=function(a,b){var c=O(this.j(b)),d=ei(c);b=O(this.j(b+"Value"));P(b);c.appendChild(b);d.jb(a);U(d,"action",this.pY.bind(this));this.yK(c,a||"")};n.eo=function(a,b,c){b=this.kq(O(this.j(b)));b==""?a.removeAttribute(c):a.setAttribute(c,b,0)};
n.Qe=function(a){return a&&(typeof a.style=="undefined"||a.style.display=="")};n.pY=function(a){var b=a.target.Ya();this.yK(O(a.target.Lb()),b)};n.kq=function(a){a=O(a.id+"Value");a=a.innerHTML;a=a.replace(/&lrm;/g,"").replace(/\u200E/g,"");return a=="none"?"":a};
n.yK=function(a,b){a=O(a.id+"Value");a.style.backgroundColor=b;var c=b.match(/^#?([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])([a-f0-9][a-f0-9])$/i);if(c){var d=parseInt(c[1],16),f=parseInt(c[2],16);c=parseInt(c[3],16);a.style.color=d+f+c>382.5?"black":"white"}b=b.replace(/^#/,"&lrm;#");if(b=="none")b="";a.innerHTML=b||""};
n.SD=function(a,b,c){a=a.getElementsByTagName("a");b=O(this.j(b));We(b);if(a.length>0){var d=0;if(c)b.options[d++]=new Option("Select a bookmark","");c=0;for(var f;f=a[c];c++)if(f.name)b.options[d++]=new Option(f.name,f.name)}else b.options[0]=new Option("No bookmarks in this document.","")};n.Vc=function(a){this.tE("ok").innerHTML=a};n.MJ=function(a){this.tE("cancel").innerHTML=a};n.tE=function(a){for(var b=this.eh().getElementsByTagName("button"),c=0,d;d=b[c];c++)if(d.name==a)return d;return i};
o("writely.Dialog",Y,void 0);function fp(){this.qb="InsertImage";Y.call(this)}fp.Gb(Y);var yp=i,eh=i,zp=i,fh=i,Ap={};
fp.prototype.sa=function(){if(fp.c.sa.call(this)){Bp("Working");O(this.j("ImageForm")).reset();O(this.j("ImageOptionsForm")).reset();if(Z){var a=Z;if(!a||a.tagName!="IMG")try{Cp();a=Z}catch(b){}if(a&&a.tagName&&a.tagName.toLowerCase()=="img"){this.Ka("Change Image");this.Vc("Change");Bp("Upload");Bp("Toggle");Dp("ImageOptions");this.RV(Ep(Z))}}else{this.Ka("Insert Image");this.Vc("Insert");Fp();zp=j;Gp();Dp("Upload");Dp("UploadImageFormDiv");Bp("URLImageFormDiv");Dp("Toggle");O(this.j("FileUpload")).checked=
g;O(this.j("UrlUpload")).checked=j;O(this.j("ImageOptionsForm")).ShowOptions.value=="true"&&Hp()}this.Ga()}};
fp.prototype.RV=function(a){var b=O(this.j("ImageOptionsForm"));if(!a.width||a.width=="auto"){b.ImageWidth.value="original";b.ImageWidthPx.value=""}else{var c=/([\d.]+)(%|e[mx]\b|p[xtc]\b|in\b|[cm]m\b)/i.exec(a.width),d=c[1]?parseFloat(c[1]):i;c=c[2]?c[2].toLowerCase():i;if(!isNaN(d))if(!c||c=="px"){b.ImageWidth.value="custom";b.ImageWidthPx.value=d}else{b.ImageWidth.value=c=="%"?"fit":"original";b.ImageWidthPx.value=""}}Gp();if(a.align)b.ImagePosition.value=a.align;b.WrapText.checked=a.Tf;Ip();b.LinkImage.checked=
a.yn};
fp.prototype.Na=function(a){if(Z&&Z.tagName&&Z.tagName=="IMG"){this.o2(Z);fp.prototype.WJ();Z=i;if(z){fh.collapse();fh.select()}}else if(O(this.j("FileUpload")).checked){Fp();a.preventDefault();var b=O(this.j("ImageForm")),c=b.ImageFile.value;if(c==i||c.length==0){F("Please select an image file -- you can use the Browse button to find it.",b.ImageFile);Bp("Working");b.reset();return}else if(z&&(c.length<2||!/^(\\\\|\w:)/i.test(c))){F("Please select an image file -- you can use the Browse button to find it.",b.ImageFile);
Bp("Working");b.reset();return}else{c=Zd("Dialogs/ImageUploader?DocID="+encodeURIComponent(Hd()));b.action=Ao(c);Dp("Working");c=new lo;U(c,"success",this.WY.bind(this));U(c,"error",this.MI.bind(this));U(c,"timeout",this.MI.bind(this));c.Q_(b)}}else{a.preventDefault();c=O("InsertImageImageURL");b=c.value;if(Ba(b).length==0){F("Please select a valid url image file.",c);return}else{Dp("Working");c=new Tc("Dialogs/UrlImageUploader");c.$("DocID",Hd());Co(c,{urlimagesrc:b},this.D2.bind(this))}}fp.c.Na.call(this,
a)};
fp.prototype.D2=function(a){if(a){var b=i;try{var c=a.responseText;if(ta(c,"while(true);"))c=c.substr(12);b=Fb(c)}catch(d){F("Unable to upload images at this time. Please try again later or try downsizing the image you're attempting to upload. If the error persists, please post to the <a target='_blank' href='http://www.google.com/support/forum/p/Google+Docs'>Google Docs help forum</a>. (2)");this.tb()}if(b)if(b.type=="ok"){if(b.details!=i){this.Pw=b.details;yp=this.Pw.fileName;this.BE(yp,this.Mi);this.tb()}this.tb()}else{a=
O(this.j("ImageURL"));if(b.details&&b.details=="Invalid File Type"){F("Please select a valid url image file.",a);Bp("Working");a.value=""}else{F(b.details||"Unable to upload images at this time. Please try again later or try downsizing the image you're attempting to upload. If the error persists, please post to the <a target='_blank' href='http://www.google.com/support/forum/p/Google+Docs'>Google Docs help forum</a>. (3)");Bp("Working");a.value="";this.tb()}}else{F("Unable to upload images at this time. Please try again later or try downsizing the image you're attempting to upload. If the error persists, please post to the <a target='_blank' href='http://www.google.com/support/forum/p/Google+Docs'>Google Docs help forum</a>. (4)");
this.tb()}Fp()}else{F("Unable to upload images at this time. Please try again later or try downsizing the image you're attempting to upload. If the error persists, please post to the <a target='_blank' href='http://www.google.com/support/forum/p/Google+Docs'>Google Docs help forum</a>. (1)");this.tb()}};function Bp(a){O("InsertImage"+a).style.display="none"}function Dp(a){O("InsertImage"+a).style.display=""}
fp.prototype.o2=function(a){var b=O(this.j("ImageOptionsForm")),c=Ep(a),d=this.nO(b.ImageWidth.value,b.ImageWidthPx.value,c.naturalWidth,c.naturalHeight);if(d.width!=c.width)a.style.width=d.width;if(d.height!=c.height)a.style.height=d.height;a.removeAttribute("width");a.removeAttribute("height");d=c.Cc;if(b.LinkImage.checked!=c.yn)if(b.LinkImage.checked){d=a.ownerDocument.createElement("a");d.href=a.src;d.target="_blank";a.parentNode.insertBefore(d,a);d.appendChild(a)}else{for(;d=c.Cc.firstChild;){if(d.parentNode!=
c.Cc)break;c.Cc.parentNode.insertBefore(c.Cc.removeChild(d),c.Cc)}c.Cc.parentNode.removeChild(c.Cc);d=i}if(!c.Tf&&!b.WrapText.checked&&c.align!=b.ImagePosition.value){c.dg.style.textAlign=b.ImagePosition.value;a.style.cssFloat="";a.style.styleFloat=""}else if(c.Tf&&(!b.WrapText.checked||b.ImagePosition.value=="center")){c=a.ownerDocument.createElement("div");c.style.textAlign=b.ImagePosition.value;if(d){d.parentNode.insertBefore(c,d);c.appendChild(d)}else{a.parentNode.insertBefore(c,a);c.appendChild(a)}a.style.cssFloat=
"";a.style.styleFloat="";a.style.marginLeft="";a.style.marginRight=""}else if(!c.Tf&&b.WrapText.checked&&b.ImagePosition.value!="center"){if(c.dg){for(;d=c.dg.firstChild;){if(d.parentNode!=c.dg)break;c.dg.parentNode.insertBefore(c.dg.removeChild(d),c.dg)}c.dg.parentNode.removeChild(c.dg)}a.style.cssFloat=b.ImagePosition.value;a.style.styleFloat=b.ImagePosition.value;a.style.marginLeft=a.style.cssFloat=="left"?"0":"1em";a.style.marginRight=a.style.cssFloat=="right"?"0":"1em"}else if(c.Tf&&b.WrapText.checked&&
c.align!=b.ImagePosition.value&&b.ImagePosition.value!="center"){a.style.cssFloat=b.ImagePosition.value;a.style.styleFloat=b.ImagePosition.value;a.style.marginLeft=a.style.cssFloat=="left"?"0":"1em";a.style.marginRight=a.style.cssFloat=="right"?"0":"1em"}a.removeAttribute("align");try{Jp()}catch(f){}x.fa();x.Ta()};
function Gp(){var a=O("InsertImageImageOptionsForm");if(a.ImageWidth&&a.ImageWidthPx)if(a.ImageWidth.value=="custom"){a.ImageWidthPx.disabled=j;a.ImageWidthPx.style.display="";O("InsertImageImageWidthPxLabel").style.display=""}else{a.ImageWidthPx.disabled=g;a.ImageWidthPx.style.display="none";O("InsertImageImageWidthPxLabel").style.display="none"}}
function Ip(){var a=O("InsertImageImageOptionsForm");if(a.ImagePosition&&a.WrapText)if(a.ImagePosition.value=="center"){a.WrapText.disabled=g;a.WrapText.style.display="none";O("InsertImageWrapTextLabel").style.display="none"}else{a.WrapText.disabled=j;a.WrapText.style.display="";O("InsertImageWrapTextLabel").style.display=""}}
function Hp(){var a=O("InsertImageImageOptions"),b=O("InsertImageImageOptionsForm").ShowOptions;if(a)if(a.style.display=="none"){Dp("ImageOptions");Bp("ToggleIconPlus");Bp("ToggleLinkPlus");Dp("ToggleIconMinus");Dp("ToggleLinkMinus");b.value="true"}else{Bp("ImageOptions");Bp("ToggleIconMinus");Bp("ToggleLinkMinus");Dp("ToggleIconPlus");Dp("ToggleLinkPlus");b.value="false"}}
function Fp(){O("InsertImageImagePreviewTextDiv").style.display="";O("InsertImageImagePreviewDiv").style.display="none";O("InsertImageImagePreview").src=""}
fp.prototype.nO=function(a,b,c,d){var f={};if(a=="fit"){f.width="100%";f.height=i}else if(d&&c){switch(a){case "custom":f.width=parseFloat(b);break;case "default":f.width=Math.min(648,c);break;case "xs":f.width=Math.min(160,c);break;case "s":f.width=Math.min(320,c);break;case "m":f.width=Math.min(640,c);break;case "l":f.width=Math.min(1024,c);break;case "xl":f.width=Math.min(1600,c);break;case "original":default:f.width=c;break}f.height=f.width==c?d:f.width*(d/c);f.width+="px";f.height+="px"}else{switch(a){case "custom":f.width=
parseFloat(b)+"px";break;case "xs":f.width="160px";break;case "s":f.width="320px";break;case "m":f.width="640px";break;case "l":f.width="1024px";break;case "xl":f.width="1600px";break;case "default":case "original":default:f.width=i;break}f.height=i}return f};
fp.prototype.Mi=function(a){var b=O("InsertImageImagePosition"),c=O("InsertImageImageWidth");b={src:yp,yn:O("InsertImageLinkImage").checked,Tf:O("InsertImageWrapText").checked,align:b.options[b.selectedIndex].value};c=c.options[c.selectedIndex].value;var d=O("InsertImageImageWidthPx").value;if(c=="fit"){b.width="100%";b.height=i}else if(a.naturalHeight&&a.naturalWidth){b.naturalWidth=a.naturalWidth;b.naturalHeight=a.naturalHeight;switch(c){case "custom":b.width=parseFloat(d);break;case "default":b.width=
Math.min(648,b.naturalWidth);break;case "xs":b.width=Math.min(160,b.naturalWidth);break;case "s":b.width=Math.min(320,b.naturalWidth);break;case "m":b.width=Math.min(640,b.naturalWidth);break;case "l":b.width=Math.min(1024,b.naturalWidth);break;case "xl":b.width=Math.min(1600,b.naturalWidth);break;case "original":default:b.width=b.naturalWidth;break}b.height=b.width==b.naturalWidth?b.naturalHeight:b.width*(b.naturalHeight/b.naturalWidth);b.width+="px";b.height+="px"}else{switch(c){case "custom":b.width=
parseFloat(d)+"px";break;case "xs":b.width="160px";break;case "s":b.width="320px";break;case "m":b.width="640px";break;case "l":b.width="1024px";break;case "xl":b.width="1600px";break;case "default":b.width="default";break;case "original":default:b.width=i;break}b.height=i}a=fp.prototype.CS(b);c=a.ownerDocument.createElement("div");c.appendChild(a);try{eh=g;var f=ch(c.innerHTML,a.id,j);if(b.width=="default"&&f.childNodes[0]){var h=f.childNodes[0];f=function(){var m=Lp(h);h.style.width=Math.min(m.naturalWidth,
648)+"px"};if(h.complete)f();else h.onload=f}}catch(k){rce("InsertImage_insertImage",k,this)}x.fa();try{Jp()}catch(l){}eh=j;zp=g};
fp.prototype.WY=function(a){var b;if(a!=i&&a.target!=i){try{var c=a.target.cF()}catch(d){F("Unable to upload images at this time. Please try again later or try downsizing the image you're attempting to upload. If the error persists, please post to the <a target='_blank' href='http://www.google.com/support/forum/p/Google+Docs'>Google Docs help forum</a>. (5)");this.tb();return}if(c.type=="ok"){if(c.details!=i){this.Pw=c.details;yp=this.Pw.fileName;this.BE(yp,this.Mi);x.fa();this.tb()}}else if(c.type==
"error")if(c.details!=i){b=c.details;var f=O(this.j("ImageFile"));window.setTimeout(function(){F(b,f)},0);Bp("Working");f.value=""}}};fp.prototype.MI=function(){F("Upload Failed",j)};
function Ep(a){if(a){var b={};b.src=a.src;if("naturalWidth"in a&&"naturalHeight"in a){b.naturalWidth=a.naturalWidth;b.naturalHeight=a.naturalHeight}else{var c=a.style.width,d=a.style.height,f=a.width,h=a.height;a.style.width="";a.style.height="";a.removeAttribute("width");a.removeAttribute("height");b.naturalWidth=a.width;b.naturalHeight=a.height;a.style.width=c||f;a.style.height=d||h}b.width=a.style.width||(z?a.currentStyle.width:a.getAttribute("width"));b.height=a.style.height||(z?a.currentStyle.height:
a.getAttribute("height"));b.yn=j;for(c=a.parentNode;c&&c!=c.ownerDocument.body;c=c.parentNode)if(c.tagName&&c.tagName=="A"){if(c.href==a.src){b.yn=g;b.Cc=c}break}b.Tf=g;if(a.style.cssFloat&&a.style.cssFloat!=""||a.style.styleFloat&&a.style.styleFloat!=""){if(a=a.style.cssFloat||a.style.styleFloat)a=a.toLowerCase();if(a=="left"||a=="right"){b.align=a;b.Tf=g}}else if(a.align&&a.align!=""){a=a.align.toLowerCase();if(a=="left"||a=="right"){b.align=a;b.Tf=g}}else for(c=a.parentNode;c&&c!=c.ownerDocument.body;c=
c.parentNode)if(c.tagName&&c.tagName=="DIV"){if(a=c.style.textAlign||c.getAttribute("align")){a=a.toLowerCase();if(a=="left"||a=="right"||a=="center"){b.align=a;b.dg=c;b.Tf=j}}break}return b}else return i}function Lp(a){var b={};if(a){a.removeAttribute("width");a.removeAttribute("height");a.style.height="auto";a.style.width="auto";b.naturalWidth=a.naturalWidth||a.width;b.naturalHeight=a.naturalHeight||a.height}return b}
function Mp(a,b){if(!zp){if(Ap&&Ap[a.src]){window.clearTimeout(Ap[a.src]);Ap[a.src]=i;delete Ap[a.src]}b(Lp(a))}}fp.prototype.BE=function(a,b){if(a&&b){var c=new Image;c.onload=c.onerror=c.onabort=function(){Mp(c,b)};c.src=a+(a.indexOf("?")!=-1?"&t=":"?t=")+(new Date).getTime();Ap[c.src]=window.setTimeout(function(){Mp(c,b)},1E4)}};
fp.prototype.CS=function(a){var b=i;if(a){var c=document.createElement("img");c.src=a.src;b=c;if(a.width)if(a.width!="default")c.style.width=a.width;if(a.height)c.style.height=a.height;if(a.yn){var d=document.createElement("a");d.target="_blank";d.href=a.src;d.appendChild(b);b=d}if(c.style.width&&c.style.width=="100%"){c=document.createElement("div");c.style.textAlign="center";c.appendChild(b);b=c}else if(a.Tf&&(a.align=="left"||a.align=="right")){c.style.cssFloat=a.align;c.style.styleFloat=a.align;
c.style.marginLeft=a.align=="left"?"0":"1em";c.style.marginRight=a.align=="right"?"0":"1em"}else{c=document.createElement("div");c.style.textAlign=a.align;c.appendChild(b);b=c}b.id=Xi()}return b};fp.prototype.Vk=function(){if(z){fh.collapse();fh.select()}if(Z&&Z.tagName&&Z.tagName=="IMG"){fp.prototype.WJ();Z=i}else Fp()};
fp.prototype.WJ=function(){Dp("Upload");Dp("UploadImageFormDiv");Bp("URLImageFormDiv");Dp("Toggle");Bp("ImageOptions");Bp("ToggleIconMinus");Bp("ToggleLinkMinus");Dp("ToggleIconPlus");Dp("ToggleLinkPlus")};function Np(a){if(!(a&&window.LIMITED_EDITING)){if(a)Z=i;else if(!Z||!Z.tagName||Z.tagName!="IMG")return;fh=dh;oh("InsertImage")}}o("writely.Dialog.InsertImage",fp,void 0);o("writely.Dialog.InsertImage.toggleOptions",Hp,void 0);o("writely.Dialog.InsertImage.handleChangeWidth",Gp,void 0);
o("writely.Dialog.InsertImage.handleChangePosition",Ip,void 0);fp.prototype.insertImage=fp.prototype.Mi;o("writely.Dialog.InsertImage.onLoadHandler",Mp,void 0);o("writely.Dialog.InsertImage.getNaturalDimensions",Lp,void 0);o("writely.Dialog.InsertImage.handleChangeUrlUpload",function(){Fp();O("InsertImageFileUpload").checked=j;Dp("URLImageFormDiv");Bp("UploadImageFormDiv");O("InsertImageImageOptionsForm").reset();O("InsertImageImageURL").value=""},void 0);
o("writely.Dialog.InsertImage.handleChangeFileUpload",function(){Fp();O("InsertImageUrlUpload").checked=j;Bp("URLImageFormDiv");Dp("UploadImageFormDiv");O("InsertImageImageForm").reset();O("InsertImageImageOptionsForm").reset()},void 0);
o("writely.Dialog.InsertImage.checkForPreview",function(){var a=new Image;a.src=O("InsertImageImageURL").value;var b=O("InsertImageImagePreview"),c=O("InsertImageImagePreviewDiv");if(a.complete){O("InsertImageImagePreviewTextDiv").style.display="none";b.src=a.src;if(a.width>120||a.height>120){var d=a.width;a=a.height;var f=120/d,h=120/a;if(h>f){d=120;a*=f}else{a=120;d*=h}b.width=d;b.height=a}c.style.display=""}else Fp()},void 0);function Op(){fo.call(this,"openImageBubble")}w(Op,fo);Op.prototype.Mm=function(a){if(a&&a.nodeName=="IMG")return a;return i};Op.prototype.Mj=function(a){var b=Oe("span","tr_bubble_link","Change Image");U(b,"click",u(this.zO,this));a.appendChild(b);Mn(a,"\u00a0-\u00a0");b=Oe("span","tr_bubble_link","Remove Image");U(b,"click",u(this.b_,this));a.appendChild(b)};Op.prototype.zO=function(){Z=this.wb;Np(j)};
Op.prototype.b_=function(){var a=this.wb,b=a.parentNode;if(b&&b.nodeName=="DIV"&&b.childNodes.length==1)a=b;P(a);this.Sc()};function Pp(a,b,c){b||(b={});var d=c||window;c=typeof a.href!="undefined"?a.href:String(a);a=b.target||a.target;var f=[];for(var h in b)switch(h){case "width":case "height":case "top":case "left":f.push(h+"="+b[h]);break;case "target":case "noreferrer":break;default:f.push(h+"="+(b[h]?1:0))}h=f.join(",");if(b.noreferrer){if(b=d.open("",a,h)){b.document.write('<META HTTP-EQUIV="refresh" content="0; url='+Ha(c)+'">');b.document.close()}}else b=d.open(c,a,h);return b};var Qp=top;function Rp(a){if(/\s/.test(a))return j;if(jm.test(a))return j;var b=j;if(!/^[^:\/?#.]+:/.test(a)){a="http://"+a;b=g}a=Qc(a);if(Mb(["mailto","aim"],a[1])!=-1)return g;var c=a[3];if(!c||b&&c.indexOf(".")==-1)return j;b=a[5];return!b||b.indexOf("/")==0};function Sp(){fo.call(this,"openLinkBubble");this.Yp=ac(arguments);this.So=[]}w(Sp,fo);n=Sp.prototype;n.Fc=function(a){Sp.c.Fc.call(this,a);this.Bc=i};n.J1=j;n.gb=function(){return"LinkBubble"};n.Mm=function(a){a=tf(a,De);if(!a){var b=this.n.O();if(b&&b.isCollapsed()&&b.ka()==0)if((b=b.L().previousSibling)&&b.tagName==De)a=b}if(a&&!(a.getAttribute&&a.getAttribute("imageanchor")))return a;return i};n.nk=function(){return this.mF().uT(this.wb)};
n.Mj=function(a){var b=this.SS(),c;if(jm.test(b.yx)||b.color=="red")c=this.K.o("span",{id:"tr_link-text",style:"color:"+b.color},this.K.createTextNode(b.yx));else{var d=this.K.o("span",{id:"tr_test-link-span"},"Go to link: ");c=this.K.o("span",{id:"tr_link-text",style:"color:"+b.color},"");this.nf("tr_test-link",this.K.createTextNode(Sa(b.yx,48)).data,this.Ts,c)}var f=this.Nj("tr_change-link-span");this.nf("tr_change-link","Change",this.hL,f);this.So=[];for(b=0;b<this.Yp.length;b++){var h=this.Yp[b],
k=this.Nj(h.B1);this.So.push(k);this.nf(h.K4,h.zr,function(){h.E3(this.nk())},k)}k=this.Nj("tr_delete-link-span");this.nf("tr_delete-link","Remove",this.bQ,k);this.Jr();c=this.K.o("div",{id:"tr_link-div",style:"padding-top:2px;"},d?d:"",c,f);for(b=0;b<this.So.length;b++)c.appendChild(this.So[b]);c.appendChild(k);a.appendChild(c)};n.Ts=function(){Pp(this.sT(),{target:"_blank",noreferrer:this.J1},this.n.cf)};
n.SS=function(){var a,b=this.nk();if(b&&ta(b,"mailto:"))b=b.substring(7);else{var c=this.mF().xe.base;if(Tn&&(b=="http://"||b=="http:///"||b==""||b=="/"||Un(b,c))){b="invalid url";a=g}}return{yx:b,color:a?"red":"black"}};n.hL=function(){this.n.execCommand("link",new km(this.wb,j));this.Sc()};n.bQ=function(){this.n.Uc();this.Sc();var a=this.wb,b=a.lastChild;$e(a);Xl(b,j);this.n.fa()};
n.Jr=function(){if(this.K.b("tr_link-div")){var a=this.K.b("tr_test-link-span");if(a){var b=this.nk();Q(a,!(!!b&&ta(b,"mailto:")))}for(a=0;a<this.Yp.length;a++){b=this.Yp[a];var c=this.K.b(b.B1);c&&Q(c,b.t5(this.nk()))}}};n.sT=function(){var a=this.nk();return this.R1?this.R1(a):a};n.mF=function(){if(!this.Bc)this.Bc=On(this.yb().pa());return this.Bc};function gp(){this.qb="InsertLink";Y.call(this);this.KA=""}gp.Gb(Y);n=gp.prototype;
n.sa=function(){this.HV=z&&ab("7.0",Ad)==1;if(gp.c.sa.call(this)){var a=O(this.j("DocLinkType")),b=O(this.j("DocLinkTypeLabel"));if(window.LIMITED_EDITING){a.setAttribute("disabled",g);I(b,"textDisabled")}else{a.removeAttribute("disabled");xe(b,"textDisabled")}Aj("getinsertlinklist",i,this.tY.bind(this));if(!this.vb){a=O(this.j("WebLinkType"));b=O(this.j("DocLinkType"));var c=O(this.j("AnchorLinkType")),d=O(this.j("EmailLinkType"));U(a,"click",this.Of.bind(this,"WebLink"));U(b,"click",this.Of.bind(this,
"DocLink"));U(c,"click",this.Of.bind(this,"AnchorLink"));U(d,"click",this.Of.bind(this,"EmailLink"));this.vb=g;this.Ga()}a=b=a=i;this.SD(X.document,"AnchorLinkCtl",g);if(this.wc=Z){this.Ka("Change Link");this.Vc("Change");this.wc=Si(this.wc,"a");if(!this.wc){F("Please click on a link and try again.");this.z(j);return}a=this.wc.href?this.wc.href:"";if(Ci(this.wc))a=a.substring(a.indexOf("#"));b=this.VQ(a);if(a.indexOf("mailto:")==0){b=a.indexOf("?");if(b==-1)b=a.length;a=this.ln("EmailLink","EmailLinkType",
"EmailLinkCtl",a.substring(7,b))}else a=a.indexOf("#")==0?this.ln("AnchorLink","AnchorLinkType","AnchorLinkCtl",a.substring(a.indexOf("#")+1)):(a.indexOf("/")>=0||a.indexOf("View")>=0)&&this.PD(b,"docid")?this.ln("DocLink","DocLinkType","DocLinkCtl",this.PD(b,"docid")):this.ln("WebLink","WebLinkType","WebLinkCtl",a);this.na("linktitle",Mi(this.wc.getAttribute("title")));this.gK=Mi(qf(this.wc));this.na("linktext",this.gK)}else{this.Ka("Insert Link");this.Vc("Insert");this.ln("WebLink","WebLinkType",
"linktext",Mi(jh));a=O(this.j("WebLinkCtl"));jh.search(/^\s*(https?|gopher|news):\/\/\S/i)!=-1?this.na("WebLinkCtl",Ba(jh)):this.na("WebLinkCtl","");this.na("linktitle","");this.na("EmailLinkCtl","")}a!=i&&a.focus()}};
n.Na=function(a){var b="",c=Li(this.Y("linktext"));if(this.Wa("WebLinkType")){b=Li(this.Y("WebLinkCtl"));if(!b||b=="http://"){F("Please enter a web address.",O(this.j("WebLinkCtl")));a.preventDefault();return}if(b&&b.indexOf(":")==-1)b="http://"+b;c||(c=b)}else if(this.Wa("DocLinkType")){if(!this.Y("DocLinkCtl")){F("Please select a document.",O(this.j("DocLinkCtl")));a.preventDefault();return}b=Zd("View?docid="+this.Y("DocLinkCtl"));if(!c){c=O(this.j("DocLinkCtl"));c=c.options[c.selectedIndex].text}}else if(this.Wa("AnchorLinkType")){var d=
this.Y("AnchorLinkCtl");if(!d){F("Please select a bookmark.",O(this.j("AnchorLinkCtl")));a.preventDefault();return}b="#"+Ni(d);c||(c=d)}else if(this.Wa("EmailLinkType")){if(b=Li(this.Y("EmailLinkCtl"))){if(!b.match(/\S@\S/)||b.match(/\s/)){F("That email address is invalid.",O(this.j("EmailLinkCtl")));a.preventDefault();return}}else{F("Please enter an email address.",O(this.j("EmailLinkCtl")));a.preventDefault();return}if(b.indexOf("mailto")==-1)b="mailto:"+b;c||(c=b)}else{F("You must select a link type first.",
j);return j}if(!this.wc){d=Xi();this.wc=ch('<a id="'+d+'">'+c+"</a>",d,j);(new km(this.wc,g)).aJ();bj(X,this.wc)}this.wc.href=b;this.gK!=c&&Hi(this.wc,c);this.Wa("AnchorLinkType")?this.wc.setAttribute("target","_self"):this.wc.removeAttribute("target");b=Li(this.Y("linktitle"))||c;this.wc.setAttribute("title",b);x.fa();Jp();gp.c.Na.call(this,a)};n.ln=function(a,b,c,d){this.Of(a);O(this.j(b)).checked=g;if(c=="DocLinkCtl")this.KA=d;if(c!="DocLinkCtl"||O(this.j(c)).options.length>1)this.na(c,d);return O(this.j(c))};
n.Of=function(a){if(this.HV){O(this.j("DocLink")).style.position=a=="DocLink"?"static":"absolute";O(this.j("DocLink")).style.visibility=a=="DocLink"?"visible":"hidden";O(this.j("AnchorLink")).style.position=a=="AnchorLink"?"static":"absolute";O(this.j("AnchorLink")).style.visibility=a=="AnchorLink"?"visible":"hidden"}else{this.Ha("DocLink");this.Ha("AnchorLink")}this.Ha("WebLink");this.Ha("EmailLink");a!=""&&this.Db(a)};
n.VQ=function(a){var b=i,c=i;if((a=a.split("?"))&&a.length>=2){a=a[1].split("&");b=[];c=[];for(var d=0;d<a.length;d++){var f=a[d].split("=");if(f&&f.length>1)c[d]=f[1];f&&f.length>0&&b.push(f[0])}}return[b,c]};n.PD=function(a,b){if(!a||!a.length||a.length<2||!a[0]||!a[1])return i;b=b.toLowerCase();for(var c=0;c<a[0].length;c++)if(a[0][c].toLowerCase()==b)return a[1][c];return i};
n.tY=function(a){if(a){for(var b=O(this.j("DocLinkCtl")),c=b.lastChild;c!=b.firstChild;){var d=c.previousSibling;b.removeChild(c);c=d}b.firstChild.setAttribute("selected","");a=a.responseText;if(ta(a,"while(true);"))a=a.substr(12);a=Fb(a);for(c=0;c<a.documentList.length;c++){d=Oe("option",{value:a.documentList[c].id},a.documentList[c].title);b.appendChild(d);if(this.KA==d.value)d.selected=g}this.KA=""}};
function Tp(a){if(kh=Si(a,"img"))F("Sorry, but we don't support linking from images yet.");else{jh=Bh(X).Ab();if((Z=Si(a,"a"))&&!Z.getAttribute("href"))Z=i;oh("InsertLink")}};function Up(){Sp.call(this)}w(Up,Sp);n=Up.prototype;n.hL=function(){Tp(this.wb);this.Sc()};n.Mm=function(a){if((a=tf(a,De))&&!(a.getAttribute&&a.getAttribute("imageanchor"))&&a.href)return a;return i};n.Mj=function(a){var b=this.wb;this.rH(b)?this.JP(b,a):Up.c.Mj.call(this,a)};n.rH=function(a){if(a.tagName=="A"){a=Vp(a);if(Wp(a,"writely-toc"))return g}return j};
n.JP=function(a,b){a=a.innerText||a.textContent;var c=this.K.o("span",{id:"tr_link-text",style:"color: black"},""),d=this.K.o("span",{id:"tr_test-link-span"},"Go to link: ");this.By(this.HC("tr_test-link",this.K.createTextNode(Sa(a,48)).data,g,c),this.Ts);a=this.K.o("div",{id:"tr_link-div",style:"padding-top:2px;"},d,c);b.appendChild(a)};n.Jr=fa;n.Ts=function(){var a=this.wb;this.rH(a)||Ci(a)?this.N_():Up.c.Ts.call(this)};
n.N_=function(){var a=this.nk();a=a.substring(a.indexOf("#")+1);(X.document.getElementById(a)||X.document.anchors[a]).scrollIntoView(g);document.location.hash=a;this.Sc()};function Xp(){Zj.call(this);this.YY=i}w(Xp,Zj);var Yp=/^(DIV|TR|LI|BLOCKQUOTE|H\d|PRE|XMP)/;function Zp(a){a.push("<br>")}Xp.prototype.gb=function(){return"RemoveFormatting"};Xp.prototype.te=function(a){return a=="+removeFormat"};Xp.prototype.bh=function(a){a=="+removeFormat"&&this.YZ()};
Xp.prototype.YZ=function(){if(!this.n.O().isCollapsed()){this.yC(this.YY||u(this.LJ,this));this.yb().M().execCommand("RemoveFormat",j,undefined);bl&&this.yC(function(a){var b=Cd("528")?/&nbsp;/g:/\u00A0/g;return a.replace(b," ")})}};function $p(a){return uf(a,function(b){return b.tagName=="TABLE"},g)}n=Xp.prototype;
n.fZ=function(a){var b=this.n.O(),c=this.yb(),d=db(),f=db();a='<span id="'+d+'"></span>'+a+'<span id="'+f+'"></span>';var h=db(),k='<span id="'+h+'"></span>';if(Gk){var l=b.Ud(0).vc();l.pasteHTML(k);for(var m;(m=l.parentElement())&&Oj(m)&&!Sj(m);){b=m.nodeName;if(b=="TD"||b=="TR"||b=="TH")break;P(m)}l.pasteHTML(a);(h=c.b(h))&&P(h)}else if(Hk){c.M().execCommand("insertImage",j,h);b=new RegExp("<[^<]*"+h+"[^>]*>");m=this.n.O().Tb();if(m.nodeType==3)m=m.parentNode;for(;!b.test(m.innerHTML);)m=m.parentNode;
if(B)m.innerHTML=m.innerHTML.replace(b,a);else{m.innerHTML=m.innerHTML.replace(b,k);for(m=h=c.b(h);(m=h.parentNode)&&Oj(m)&&!Sj(m);){b=m.nodeName;if(b=="TD"||b=="TR"||b=="TH")break;Ye(h,m);P(m)}m.innerHTML=m.innerHTML.replace(new RegExp(k,"i"),a)}}a=c.b(d);c=c.b(f);hk(a,0,c,c.childNodes.length).select();P(a);P(c)};
n.KS=function(a){var b=this.yb().o("div"),c=a.vc();if(Hk)b.appendChild(c.cloneContents());else if(Gk){var d=a.Ab();d=d.replace(/\r\n/g,"\r");var f=d.length;a=f-Ca(d).length;d=f-d.replace(/[\s\xa0]+$/,"").length;c.moveStart("character",a);c.moveEnd("character",-d);a=c.htmlText;if(c.queryCommandValue("formatBlock")=="Formatted")a=c.htmlText.replace(/(\r\n|\r|\n)/g,"<br>");b.innerHTML=a}return b.innerHTML};
n.qN=function(a,b,c){var d=new hm(a),f=a.L(),h=a.ka(),k=a.da();a=a.Ma();var l=this.yb();if(b){var m=l.createTextNode("");Ye(m,b);f=m;h=0}if(c){m=l.createTextNode("");Xe(m,c);k=m;a=0}hk(f,h,k,a).select();return d};n.qJ=function(a,b){a=P(a.lg(b));if(b)this.Zz=a;else this.ov=a};n.w_=function(){var a=this.n.b();if(this.Zz){a.insertBefore(this.Zz,a.firstChild);this.Zz=i}if(this.ov){a.appendChild(this.ov);this.ov=i}};
n.yC=function(a){var b=this.n.O();if(!(b.Bi()>1)){if(B){var c=Vl(b,this.n.b()),d=$p(c.L()),f=$p(c.da());if(d||f){if(d==f)return;var h=this.qN(b,d,f);d||this.qJ(h,g);f||this.qJ(h,j);b=this.n.O();c=Vl(b,this.n.b())}c.select();b=c}b=this.KS(b);this.fZ(a(b));if(B&&h){b=this.n.O();this.w_();a=h.V1();Ql((d?a:b).L(),(d?a:b).ka(),(f?a:b).da(),(f?a:b).Ma()).select();h.p()}}};
n.LJ=function(a){var b=document.createElement("div");b.innerHTML=a;a=[];b=[b.childNodes,0];for(var c=[],d=0,f=[],h=0,k=0;k>=0;k-=2){for(var l=j;h>0&&k<=f[h-1];){h--;l=g}l&&Zp(a);for(l=j;d>0&&k<=c[d-1];){d--;l=g}l&&Zp(a);l=b[k];for(var m=b[k+1];m<l.length;){var p=l[m++],t=p.nodeName,s=this.nF(p);if(s)a.push(s);else{switch(t){case "#text":p=d>0?p.nodeValue:za(p.nodeValue);p=Ha(p);a.push(p);continue;case "P":Zp(a);Zp(a);break;case "BR":Zp(a);continue;case "TABLE":Zp(a);f[h++]=k;break;case "PRE":case "XMP":c[d++]=
k;break;case "STYLE":case "SCRIPT":case "SELECT":continue;case De:if(p.href&&p.href!=""){a.push("<a href='");a.push(p.href);a.push("'>");a.push(this.LJ(p.innerHTML));a.push("</a>");continue}else break;case "IMG":a.push("<img src='");a.push(p.src);a.push("'>");continue;case "TD":p.previousSibling&&a.push(" ");break;case "TR":p.previousSibling&&Zp(a);break;case "DIV":s=p.parentNode;if(s.firstChild==p&&Yp.test(s.tagName))break;default:Yp.test(t)&&Zp(a)}p=p.childNodes;if(p.length>0){b[k++]=l;b[k++]=m;
l=p;m=0}}}}return Aa(a.join(""))};n.nF=function(){return i};function aq(){Xp.call(this);this.Hy=new Mc}w(aq,Xp);var bq=/\[\{gdoc:callout\(([^\(\)]*)\)\}\]/g;n=aq.prototype;
n.nF=function(a){var b=a.nodeName.toLowerCase();if(b=="gdoc:callout"||b=="callout"){b='<gdoc:callout calloutmarkerid="'+a.getAttribute("calloutmarkerid")+'" calloutclosed="'+a.getAttribute("calloutclosed")+'" calloutshowfull="'+a.getAttribute("calloutshowfull")+'" class="'+a.className+'" callouttype="'+a.getAttribute("callouttype")+'">';b+=a.innerHTML;b+="</gdoc:callout>";a=Xi();var c;c=E?"[{gdoc:callout("+a+")}]":'<img id="gdoc:callout('+a+')" src="images/footnote_doc_icon.gif" height=0 width=0>';
this.Hy.u(a,b);return c}return i};n.execCommand=function(a,b){aq.c.execCommand.call(this,a,b);a=="+removeFormat"&&this.v_()};
n.v_=function(){var a=this.yb().M();if(E){var b=a.body.innerHTML,c=u(this.i_,this);b=b.replace(bq,c);a.body.innerHTML=b}else{var d=a.getElementsByTagName("img");b=[];c=0;for(var f;f=d[c];c++)b.push(f);for(c=0;f=b[c];c++)if(d=f.id.match(/gdoc:callout\(([^\(\)]*)\)/)){var h=this.nE(d[1]);if(h){d=a.createElement("span");d.innerHTML=h;Ye(d,f);h=af(d);P(d);Ze(h,f)}else{P(f);rce("writely.RemoveFormatting.restoreCallouts_","Found a Callout IMG node but no matching callout data.")}}}};
n.i_=function(a,b){a=this.nE(b);if(!a){a="";rce("writely.RemoveFormatting.replaceBackupCallouts","Found a callout marker in the document but no matching backup data.")}return a};n.nE=function(a){var b=this.Hy.la(a);b&&this.Hy.remove(a);return b};function cq(){Zj.call(this);od().toLowerCase();this.rn=B&&ab(Ad,"1.9")==-1;if(H("enable_powerkey")&&B){pn("editorDeferred",2)();this.rW=pn("editorDeferred",3)}}w(cq,bk);n=cq.prototype;n.gb=function(){return"WritelyShortcuts"};n.Mq=function(a){if(!md||!a.ctrlKey)return j;var b=a.which||a.charCode||a.keyCode,c=String.fromCharCode(b).toLowerCase();if(b==13){a.which=a.charCode="m".charCodeAt(0);c="m"}if(this.rn||"0123456789m".indexOf(c)!=-1){(b=this.MF(a))&&a.preventDefault&&a.preventDefault();return b}return j};
n.an=function(a,b,c){if(c)return this.MF(a);b=j;switch(a.keyCode){case 13:case 37:case 39:if(H("enable_comments")||H("enable_footnotes"))if(z?dq(a.keyCode):eq(a.keyCode))b=g;break;case 9:Cp();b=!a.shiftKey;c=fq();if(c=gq(c))if(hq(c,"td")||hq(c,"th")){var d=b?c.nextSibling:c.previousSibling;if(d&&d.nodeType!=1)d=b?c.nextSibling:c.previousSibling;if(d)iq(d);else{var f=c.parentNode;if((d=b?f.nextSibling:f.previousSibling)&&d.nodeType!=1)d=b?c.nextSibling:c.previousSibling;if(!d&&b){Z=f;jq(j);d=f.nextSibling}if(d&&
d.hasChildNodes())iq(b?d.firstChild:d.lastChild)}b=g}else b=j;else b=j;break;case 8:Cp();b=kq(a)||lq(a);break;case 27:mq(j);if(editUI.jg&&editUI.jg.ga())editUI.jg.hide();else editUI.X.X.tg()&&editUI.X.X.b().focus();b=g;break;case 33:case 34:z&&a.target.tagName=="BODY"&&frames.wys_frame.document.documentElement.setActive();break}b&&a.stopPropagation();return b};
n.MF=function(a){var b=i,c=j,d=a.which||a.charCode||a.keyCode;if(B)d=a.kc.charCode;if(z||E)switch(d){case 191:d=a.shiftKey?63:47;break;case 188:d=44;break;case 190:d=46;break}d=String.fromCharCode(d).toLowerCase();if(md&&a.metaKey&&"0123456789m".indexOf(d)!=-1)return j;if(a.shiftKey){d=d.toUpperCase();if(d==" ")d="nbsp"}switch(d){case "b":b=$.Rl;break;case "i":b=$.Sl;break;case "u":b=$.Ul;break;case ",":b=$.Bt;break;case ".":b=$.Ct;break;case "l":b=$.Lo;break;case "e":b=$.Jo;break;case "r":b=$.Mo;
break;case "j":b=$.Ko;break;case "f":if(H("enable_find_bar")){editUI.jg.Yc();c=g}break;case "F":mq(g);c=g;break;case "g":if(H("enable_find_bar")){editUI.jg.ZQ();c=g}break;case "G":if(H("enable_find_bar")){editUI.jg.bR();c=g}break;case "h":if(!H("enable_find_bar")){Ah();c=g}break;case "m":if(editUI.X.Mk("w-comment"))H("enable_comments")?ra.xp.Z2.C4():rj();c=g;break;case "M":G("enable_powerkey")=="true"&&B&&this.rW();break;case "k":editUI.X.Mk("w-link")&&Tp(Vp());c=g;break;case "K":nq(g);c=g;break;
case "o":window.open(G("siteprefix")+"/#documents","_blank");c=g;break;case "p":oq();c=g;break;case "s":pq(i);c=g;break;case "1":this.Gi("H1","H1");c=g;break;case "2":this.Gi("H2","H2");c=g;break;case "3":this.Gi("H3","H3");c=g;break;case "4":this.Gi("H4","H4");c=g;break;case "5":this.Gi("H5","H5");c=g;break;case "6":this.Gi("H6","H6");c=g;break;case "7":b=$.Oo;break;case "L":case "8":b=$.Qo;break;case "9":d=Vp();if(qq(d,"ul")||qq(d,"ol")){oh("ChangeList");c=g}break;case "0":this.Gi("P","P");c=g;
break;case " ":b=$.Po;break;case "?":case "/":window.open(rq);c=g;break;case "C":oh("WordCount",{lK:Bh(X)});c=g;break;case "nbsp":ih("&nbsp;");c=g;break}if(b){editUI.X.Mk(b)&&editUI.V.Mk(b)&&this.n.execCommand(b);c=g}if(c){a.stopPropagation();return g}return j};n.Gi=function(a,b){editUI.X.Mk(a)&&this.n.execCommand($.Io,b)};var sq=["BLOCKQUOTE","BR","CENTER","DD","DIR","DIV","DL","DT","FORM","H1","H2","H3","H4","H5","H6","HEAD","HR","HTML","ISINDEX","LI","MENU","NOFRAMES","OL","P","PRE","TABLE","TD","TH","TITLE","TR","UL"];function tq(a,b,c){this.type=a;this.J=b;this.Bd=c}w(tq,ag);tq.prototype.Sd=function(a){return!!(a&&this.type==a.type&&this.J==a.J&&this.Bd==a.Bd)};tq.prototype.wq=function(){var a=this.J,b=this.Bd;if(this.type==1)b=this.J.childNodes.length;return{J:a,Bd:b}};
tq.prototype.k=function(){tq.c.k.call(this);this.J=i};function uq(a,b,c,d){vq(wq(a.L(),a.ka()),wq(a.da(),a.Ma()),d,b,c);return j}function xq(a,b,c,d){return vq(a,i,d,b,c)}function wq(a,b){var c=uf(a,function(d){return/^(gdoc\:)?callout$/i.test(d.tagName)},g);if(c)return new tq(2,c,0);return a.nodeType==3?new tq(0,a,b):b>=a.childNodes.length?new tq(1,a,0):new tq(2,a.childNodes[b],0)}
function vq(a,b,c,d,f){var h,k=a.J,l=b&&b.J,m=a.Bd,p=b&&b.Bd;d=d==1;a=d==(a.type!=1);for(var t=!d;;){if(k==l)if(m!=p&&m<p==d){if(k.nodeType==3){f(0,k,Math.min(m,p),Math.abs(p-m));return j}}else if(k.nodeType==3||a==(b.type==2)==d)return j;if(k.nodeType==3){if(!ya(k.nodeValue)&&f(0,k,d?m:0,d?k.nodeValue.length-m:m)==j)return j;m=0;a=j}else if(!t)if(f(a==d?2:1,k,0,0)==j)return j;t=j;if(a)if(!/^(gdoc\:)?callout$/i.test(k.tagName)&&(h=d?k.firstChild:k.lastChild))k=h;else a=j;else{if(k==c)return g;if(h=
d?k.nextSibling:k.previousSibling){k=h;a=g}else{k=k.parentNode;if(!k)return g}}if(!d&&k.nodeType==3)m=k.nodeValue.length}}function yq(a){this.cK=a;this.ta="";this.rb=[];this.Ck=this.Dk=j;this.Xh=[];this.pR=function(b,c){Nb(b,function(d){c[d]=g});return c}(sq,{})}w(yq,ag);n=yq.prototype;n.reset=function(){this.ta="";this.rb=[];this.Ck=this.Dk=j;Nb(this.Xh,function(a){a.ad=i});this.Xh=[]};
n.yQ=function(a,b){this.reset();this.Tg(u(uq,i,a),i,1);if(this.ta.length>0)return this.An(this.dd(0),this.dd(this.ta.length-1));a=wq(a.L(),a.ka());this.Tg(u(xq,i,a),1,b);return this.ta.length>0?this.dd(0):i};n.fh=function(a,b){a=this.Ge(a)+b;b=this.ta.length-1;if(a<0||a>b){var c=a<0,d=c?-a:a-b;d=this.Tg(u(xq,i,this.dd(c?0:b)),d,c?0:1);b+=d;a+=c?d:0;if(a<0){a=0;this.Dk=g}if(a>b){a=b;this.Ck=g}}return this.dd(a)};n.An=function(a,b){return new zq(a,b)};n.hx=function(a){return this.Dk&&this.Ge(a)==0};
n.lr=function(a){return this.Ck&&this.Ge(a)==this.ta.length-1};n.KE=function(){if(!this.Dk){var a=this.ta.length==0;this.Tg(u(xq,i,a?this.fF(j):this.dd(0)),a?1:i,a?1:0);this.Dk=g}return this.ta.length>0?this.dd(0):i};n.RS=function(){if(!this.Ck){var a=this.ta.length-1,b=a==-1;a+=this.Tg(u(xq,i,b?this.fF(g):this.dd(a)),b?1:i,b?0:1);this.Ck=g}return a>=0?this.dd(a):i};
n.xR=function(a){var b=this.Ge(a);a=this.Gm(b);this.ta=this.ta.substring(b);Nb(this.rb.concat(this.Xh),function(c){c.ad-=b});this.rb=this.rb.slice(a);this.Dk=j};n.wR=function(a){a=this.Ge(a);var b=this.Gm(a);this.ta=this.ta.substring(0,a+1);this.rb=this.rb.slice(0,b+1);this.Ck=j};
n.WD=function(a,b){var c=this.fh(a.start,-1),d=this.fh(a.$a,1);c=this.hx(a.start)?i:this.ta.charAt(this.Ge(c));var f=this.lr(a.$a)?i:this.ta.charAt(this.Ge(d));d=this.Ge(a.start);a=this.Ge(a.$a);a=this.ta.substring(d,a+1);return(b=b(a,c,f))&&this.An(this.dd(d+b[0]),this.dd(d+b[0]+b[1]-1))};
n.replace=function(a,b){var c=this.Ge(a.start),d=this.Ge(a.$a),f=b(this.ta.substring(c,d+1)),h=this.Gm(c);a=this.Gm(d);var k=this;Nb(this.rb.slice(h,a+1),function(l,m){if(l.type==0)k.k_(l.J,c-l.ad,d-c+1,f);else if(m==0){m=document.createTextNode(f);l.type==1?Ye(m,l.J):Xe(m,l.J);k.rb[h]=new Aq(0,m,0,c)}});a=this.rb.slice(a+1);Nb(a,function(l){l.ad+=c+f.length-d-1});this.rb=this.rb.slice(0,h+1).concat(a);this.ta=[this.ta.substring(0,c),f,this.ta.substring(d+1)].join("");Nb(this.Xh,function(l){l.ad=
i});this.Xh=[];return this.An(this.dd(c),this.dd(c+f.length-1))};n.k_=function(a,b,c,d){var f=a.nodeValue,h=f.length,k=b+c;c=b>0?f.substring(0,b):"";f=k<h?f.substring(k):"";f=[c,b<0?"":d,f].join("");a.nodeValue=f};n.Ge=function(a){var b=a.ad,c=this.ta.length-1;if(b==i){this.reset();this.Tg(u(xq,i,a),1,1);return 0}else if(b<0){this.Tg(u(xq,i,this.dd(0)),-b,0);return 0}else if(b>c){c+=this.Tg(u(xq,i,this.dd(c)),b-c,1);return c}else return b};
n.Gm=function(a){if(a==0)return 0;else if(a==this.ta.length-1)return this.rb.length-1;else{a=ec(this.rb,a,function(b,c){b=b.ad!=i?b.ad:b;c=c.ad!=i?c.ad:c;return b<c?-1:b>c?1:0});return a>=0?a:-a-2}};n.dd=function(a){var b=this.rb[this.Gm(a)];a=new Aq(b.type,b.J,a-b.ad,a);b=this.Xh;if(b.length==8)b.shift().ad=i;b.push(a);return a};n.fF=function(a){return new tq(a?1:2,this.cK,0)};
n.Tg=function(a,b,c){var d=[],f=[],h=c==1,k=this.ta.length>0?this.ta.charAt(h?this.ta.length-1:0):i,l=this.rb.length>0?this.rb[h?this.rb.length-1:0]:i;this.jP(a,d,f,b,c,k=="\n"&&l.J.tagName.toUpperCase()!="BR",k!=i&&h);if(d.length==0)return 0;if(h){var m=this.ta.length;Nb(f,function(s){s.ad+=m});f[0].Sd(l)&&f.shift();this.ta+=d.join("");this.rb=this.rb.concat(f);return this.ta.length-m}else{var p=d.join("").length,t=0;Nb(f,function(s,A){A=d[A].length;s.ad+=p-t*2-A;t+=A});Nb(this.rb.concat(this.Xh),
function(s){s.ad+=p});d.reverse();f[0].Sd(l)&&f.shift();f.reverse();this.ta=d.join("")+this.ta;this.rb=f.concat(this.rb);return p}};
n.jP=function(a,b,c,d,f,h,k){var l=b.join("").length,m=f==1,p=this;return a(f,function(t,s,A,D){var L=t==0,N=s.tagName&&s.tagName.toUpperCase();if(L){if(k){k=j;A++;D--}if(D<=0||A>=s.nodeValue.length)return g;h=j}else{if(k){k=j;return g}if(N!="BR"){if(!p.pR[N]||h)return g;h=g}else if(t==1)return g}D=L?s.nodeValue.substring(A,A+D).replace(/\n/g," "):"\n";L=D.length;if(d!=i&&L>d){m||(A+=L-d);L=(D=D.substring(m?0:L-d,m?d:L)).length}c.push(new Aq(t,s,0,l-A));b.push(D.replace(/\xA0/g," "));l+=L;if(d!=i)d-=
L;return d==i||d>0},this.cK)};n.k=function(){yq.c.k.call(this)};function Aq(a,b,c,d){tq.call(this,a,b,c);this.ad=d}w(Aq,tq);Aq.prototype.wq=function(a){var b=Aq.c.wq.call(this);a&&this.type==0&&b.Bd++;return b};function zq(a,b){this.start=a;this.$a=b}w(zq,ag);zq.prototype.Sd=function(a){return!!(a&&this.start.Sd(a.start)&&this.$a.Sd(a.$a))};zq.prototype.hA=function(){var a=this.start.wq(j),b=this.$a.wq(g);return hk(a.J,a.Bd,b.J,b.Bd)};zq.prototype.k=function(){zq.c.k.call(this);this.start.p();this.$a.p()};
function Bq(a){this.nd=a;this.ht=j;this.KG=i}n=Bq.prototype;n.YQ=function(a,b){return(a=this.YD(a,b,i))&&a.hA()};n.replace=function(a,b,c){return(a=this.YD(a,b,c))&&a.hA()};n.YD=function(a,b,c){this.ht=j;var d=new yq(this.nd.document.body),f=this.JE(d,a,b),h=a==1,k=(a=d.yQ(this.KG,a))&&((h?a.start:a.$a)||a),l=k&&f(k);if(l&&l.Sd(a))if(c!=i)return d.replace(l,u(this.bF,this,b,c));else{l=i;k=d.fh(k,h?1:-1);if(h?!d.lr(k):!d.hx(k))l=f(k)}if(!l){this.ht=g;d.reset();l=(k=h?d.KE():d.RS())&&f(k)}return l};
n.JE=function(a,b,c){return u(b==1?this.$Q:this.cR,this,a,c,this.US(c))};n.Iy=function(a,b){var c=new yq(this.nd.document.body),d=this.JE(c,1,a),f=c.KE();if(!f)return 0;for(var h,k=0;;){if(!(f=d(f)))return k>0?{gY:k,hX:h.hA()}:i;h=c.replace(f,u(this.bF,this,a,b));f=c.fh(h.$a,1);if(c.lr(f))break;k++}};n.$Q=function(a,b,c,d){for(var f,h=c;;){d=a.An(d,a.fh(d,h-1));if((f=a.WD(d,u(this.XD,this,b,j)))||a.lr(d.$a))return f;a.xR(d=a.fh(d.$a,2-c));h=Math.min(h*2,4096)}};
n.cR=function(a,b,c,d){for(var f,h=c;;){d=a.An(a.fh(d,1-h),d);if((f=a.WD(d,u(this.XD,this,b,g)))||a.hx(d.start))return f;a.wR(d=a.fh(d.start,c-2));h=Math.min(h*2,4096)}};n.XD=function(a,b,c,d,f){c=[d||"\n",c,f||"\n"].join("");d=this.aw(a,g);var h=(f=d.exec(c))&&f.index;if(f&&b)for(;b=d.exec(c.substring(h+1));){h+=b.index+1;f=b}if(f)if(c.substring(h+1,h+f[0].length-1).replace(this.aw(a,j),"")=="")return[h,f[0].length-2];return i};
n.bF=function(a,b,c){if(!a.mx)return b;return c.replace(this.aw(a,j),b)};n.aw=function(a,b){var c=b?a.TQ:a.QZ;if(!c){c=a.IL;var d=a.EX?"m":"mi";a.mx||(c=c.replace(/([^a-zA-Z0-9])/g,"\\$1"));if(a.M2)c="\\b"+c+"\\b";if(b)a.TQ=c=new RegExp("[^\u0000]"+c+"[^\u0000]",d);else a.QZ=c=new RegExp(c,d)}return c};n.US=function(a){var b=a.IL;return a.mx&&/[*+{]/.test(b)?256:b.length};n.R0=function(a){this.KG=a};function Cq(a,b,c,d){this.IL=a;this.mx=b;this.EX=c;this.M2=d};function Dq(a,b,c,d,f,h,k){this.OA=a;this.PA=b;this.D=c;this.bI=d;this.Rs=f;this.uc=h;this.Oc=k||this.Bn;this.ea=new vi}Dq.prototype.Bn=function(a){switch(a.target.Ya()){case 0:break;case 1:Eq(this.bI.id);break;case 2:Fq(this.bI.id,a.target.b().childNodes[0].innerHTML);break;default:}this.p()};
Dq.prototype.Yc=function(){if(this.Rs==i||this.Rs.length==0)this.ea.oa(new mi("No Suggestions",0));else for(var a in this.Rs)this.ea.oa(new mi(this.Rs[a],2));this.ea.oa(new oi);this.ea.oa(new mi("Add to Dictionary",1));this.ea.ll(j);U(this.ea,"action",this.Oc,g,this);U(this.uc.document,"mousedown",this.p,j,this);U(this.uc.document,"keydown",this.p,g,this);this.ea.db(this.D);this.ea.fL(this.OA,this.PA,0);this.ea.z(g)};
Dq.prototype.p=function(){Cg(this.ea,"action",this.Oc,g,this);Cg(this.uc.document,"mousedown",this.p,j,this);Cg(this.uc.document,"keydown",this.p,g,this);this.ea.p()};function Gq(a,b){this.lb=a;this.Wj=J(a);this.aS=!!b}Gq.prototype.al=function(a){var b=[this.Cx(a.hq(),a.iq()),"-"];a.isCollapsed()||b.push(this.Cx(a.jk(),a.Rm()));return b.join(" ")};
Gq.prototype.Cx=function(a,b){var c="";if(a.nodeType==1){var d=a.childNodes[b];if(d&&d.nodeType==1){c=(d.nodeName||"").toLowerCase().replace(/\W/g,"").replace(/(.+)/,"<$1>");var f=d.id&&/^\w*$/.test(d.id)?d.id:"";if(!f&&this.aS){for(var h=0;this.Wj.Oh(f="node"+h);h++);d.id=f}if(f)return["#",f,c].join("")}else if(d&&d.nodeType==3)c=d.nodeValue?Ua(d.nodeValue):""}else if(a.nodeType==3)c=(c=a.nodeValue.charAt(b))&&Ua(c);return[a==this.lb.documentElement?"":this.Cx(a.parentNode,Mb(a.parentNode.childNodes,
a))+":",b,c].join("")};function Hq(){function a(){for(var b=0,c=1,d=2;c!=d;){b++;c=d;d<<=1}return b}this.st=1;this.b3=4;this.vM=32;this.aB=this.yt=0.5;this.$A=100;this.ZA=1E3;this.p3=4;this.KM=a()}n=Hq.prototype;
n.Tj=function(a,b,c){if(a==b)return[[0,a]];if(typeof c=="undefined")c=g;var d=c,f=this.Zu(a,b);c=a.substring(0,f);a=a.substring(f);b=b.substring(f);f=this.Jp(a,b);var h=a.substring(a.length-f);a=a.substring(0,a.length-f);b=b.substring(0,b.length-f);a=this.mQ(a,b,d);c&&a.unshift([0,c]);h&&a.push([0,h]);this.Yu(a);return a};
n.mQ=function(a,b,c){var d;if(!a)return[[1,b]];if(!b)return[[-1,a]];d=a.length>b.length?a:b;var f=a.length>b.length?b:a,h=d.indexOf(f);if(h!=-1){d=[[1,d.substring(0,h)],[0,f],[1,d.substring(h+f.length)]];if(a.length>b.length)d[0][0]=d[2][0]=-1;return d}if(d=this.nQ(a,b)){b=d[1];var k=d[3];a=d[4];d=this.Tj(d[0],d[2],c);c=this.Tj(b,k,c);return d.concat([[0,a]],c)}if(c&&(a.length<100||b.length<100))c=j;if(c){k=this.oQ(a,b);a=k[0];b=k[1];k=k[2]}(d=this.pQ(a,b))||(d=[[-1,a],[1,b]]);if(c){this.jQ(d,k);
this.kQ(d);d.push([0,""]);b=a=c=0;for(f=k="";c<d.length;){switch(d[c][0]){case 1:b++;f+=d[c][1];break;case -1:a++;k+=d[c][1];break;case 0:if(a>=1&&b>=1){k=this.Tj(k,f,j);d.splice(c-a-b,a+b);c=c-a-b;for(a=k.length-1;a>=0;a--)d.splice(c,0,k[a]);c+=k.length}a=b=0;f=k="";break}c++}d.pop()}return d};
n.oQ=function(a,b){function c(h){for(var k="",l=0,m=-1,p=d.length;m<h.length-1;){m=h.indexOf("\n",l);if(m==-1)m=h.length-1;var t=h.substring(l,m+1);l=m+1;if(f.hasOwnProperty?f.hasOwnProperty(t):f[t]!==undefined)k+=String.fromCharCode(f[t]);else{k+=String.fromCharCode(p);f[t]=p;d[p++]=t}}return k}var d=[],f={};d[0]="";a=c(a);b=c(b);return[a,b,d]};n.jQ=function(a,b){for(var c=0;c<a.length;c++){for(var d=a[c][1],f=[],h=0;h<d.length;h++)f[h]=b[d.charCodeAt(h)];a[c][1]=f.join("")}};
n.pQ=function(a,b){var c=(new Date).getTime()+this.st*1E3,d=a.length+b.length-1,f=this.vM*2<d,h=[],k=[],l={},m={};l[1]=0;m[1]=0;for(var p,t,s,A={},D=j,L=!!A.hasOwnProperty,N=(a.length+b.length)%2,K=0;K<d;K++){if(this.st>0&&(new Date).getTime()>c)return i;h[K]={};for(var M=-K;M<=K;M+=2){p=M==-K||M!=K&&l[M-1]<l[M+1]?l[M+1]:l[M-1]+1;t=p-M;if(f){s=p+","+t;if(N&&(L?A.hasOwnProperty(s):A[s]!==undefined))D=g;N||(A[s]=K)}for(;!D&&p<a.length&&t<b.length&&a.charAt(p)==b.charAt(t);){p++;t++;if(f){s=p+","+t;
if(N&&(L?A.hasOwnProperty(s):A[s]!==undefined))D=g;N||(A[s]=K)}}l[M]=p;h[K][p+","+t]=g;if(p==a.length&&t==b.length)return this.$u(h,a,b);else if(D){k=k.slice(0,A[s]+1);c=this.$u(h,a.substring(0,p),b.substring(0,t));return c.concat(this.hD(k,a.substring(p),b.substring(t)))}}if(f){k[K]={};for(M=-K;M<=K;M+=2){p=M==-K||M!=K&&m[M-1]<m[M+1]?m[M+1]:m[M-1]+1;t=p-M;s=a.length-p+","+(b.length-t);if(!N&&(L?A.hasOwnProperty(s):A[s]!==undefined))D=g;if(N)A[s]=K;for(;!D&&p<a.length&&t<b.length&&a.charAt(a.length-
p-1)==b.charAt(b.length-t-1);){p++;t++;s=a.length-p+","+(b.length-t);if(!N&&(L?A.hasOwnProperty(s):A[s]!==undefined))D=g;if(N)A[s]=K}m[M]=p;k[K][p+","+t]=g;if(D){h=h.slice(0,A[s]+1);c=this.$u(h,a.substring(0,a.length-p),b.substring(0,b.length-t));return c.concat(this.hD(k,a.substring(a.length-p),b.substring(b.length-t)))}}}}return i};
n.$u=function(a,b,c){for(var d=[],f=b.length,h=c.length,k=i,l=a.length-2;l>=0;l--)for(;;)if(a[l].hasOwnProperty?a[l].hasOwnProperty(f-1+","+h):a[l][f-1+","+h]!==undefined){f--;if(k===-1)d[0][1]=b.charAt(f)+d[0][1];else d.unshift([-1,b.charAt(f)]);k=-1;break}else if(a[l].hasOwnProperty?a[l].hasOwnProperty(f+","+(h-1)):a[l][f+","+(h-1)]!==undefined){h--;if(k===1)d[0][1]=c.charAt(h)+d[0][1];else d.unshift([1,c.charAt(h)]);k=1;break}else{f--;h--;if(k===0)d[0][1]=b.charAt(f)+d[0][1];else d.unshift([0,
b.charAt(f)]);k=0}return d};
n.hD=function(a,b,c){for(var d=[],f=0,h=b.length,k=c.length,l=i,m=a.length-2;m>=0;m--)for(;;)if(a[m].hasOwnProperty?a[m].hasOwnProperty(h-1+","+k):a[m][h-1+","+k]!==undefined){h--;if(l===-1)d[f-1][1]+=b.charAt(b.length-h-1);else d[f++]=[-1,b.charAt(b.length-h-1)];l=-1;break}else if(a[m].hasOwnProperty?a[m].hasOwnProperty(h+","+(k-1)):a[m][h+","+(k-1)]!==undefined){k--;if(l===1)d[f-1][1]+=c.charAt(c.length-k-1);else d[f++]=[1,c.charAt(c.length-k-1)];l=1;break}else{h--;k--;if(l===0)d[f-1][1]+=b.charAt(b.length-
h-1);else d[f++]=[0,b.charAt(b.length-h-1)];l=0}return d};n.Zu=function(a,b){if(!a||!b||a.charCodeAt(0)!==b.charCodeAt(0))return 0;for(var c=0,d=Math.min(a.length,b.length),f=d,h=0;c<f;){if(a.substring(h,f)==b.substring(h,f))h=c=f;else d=f;f=Math.floor((d-c)/2+c)}return f};
n.Jp=function(a,b){if(!a||!b||a.charCodeAt(a.length-1)!==b.charCodeAt(b.length-1))return 0;for(var c=0,d=Math.min(a.length,b.length),f=d,h=0;c<f;){if(a.substring(a.length-f,a.length-h)==b.substring(b.length-f,b.length-h))h=c=f;else d=f;f=Math.floor((d-c)/2+c)}return f};
n.nQ=function(a,b){function c(l,m,p){for(var t=l.substring(p,p+Math.floor(l.length/4)),s=-1,A="",D,L,N,K;(s=m.indexOf(t,s+1))!=-1;){var M=h.Zu(l.substring(p),m.substring(s)),T=h.Jp(l.substring(0,p),m.substring(0,s));if(A.length<T+M){A=m.substring(s-T,s)+m.substring(s,s+M);D=l.substring(0,p-T);L=l.substring(p+M);N=m.substring(0,s-T);K=m.substring(s+M)}}return A.length>=l.length/2?[D,L,N,K,A]:i}var d=a.length>b.length?a:b,f=a.length>b.length?b:a;if(d.length<10||f.length<1)return i;var h=this,k=c(d,
f,Math.ceil(d.length/4));d=c(d,f,Math.ceil(d.length/2));if(!k&&!d)return i;else k=d?k?k[4].length>d[4].length?k:d:d:k;if(a.length>b.length){a=k[0];b=k[1];d=k[2];f=k[3]}else{d=k[0];f=k[1];a=k[2];b=k[3]}return[a,b,d,f,k[4]]};n.kQ=function(a){for(var b=j,c=[],d=0,f=i,h=0,k=0,l=0;h<a.length;){if(a[h][0]==0){c[d++]=h;k=l;l=0;f=a[h][1]}else{l+=a[h][1].length;if(f!==i&&f.length<=k&&f.length<=l){a.splice(c[d-1],0,[-1,f]);a[c[d-1]+1][0]=1;d--;d--;h=d>0?c[d-1]:-1;l=k=0;f=i;b=g}}h++}b&&this.Yu(a);this.lQ(a)};
n.lQ=function(a){function b(K,M){if(!K||!M)return 5;var T=0;if(K.charAt(K.length-1).match(c)||M.charAt(0).match(c)){T++;if(K.charAt(K.length-1).match(d)||M.charAt(0).match(d)){T++;if(K.charAt(K.length-1).match(f)||M.charAt(0).match(f)){T++;if(K.match(h)||M.match(k))T++}}}return T}for(var c=/[^a-zA-Z0-9]/,d=/\s/,f=/[\r\n]/,h=/\n\r?\n$/,k=/^\r?\n\r?\n/,l=1;l<a.length-1;){if(a[l-1][0]==0&&a[l+1][0]==0){var m=a[l-1][1],p=a[l][1],t=a[l+1][1],s=this.Jp(m,p);if(s){var A=p.substring(p.length-s);m=m.substring(0,
m.length-s);p=A+p.substring(0,p.length-s);t=A+t}s=m;A=p;for(var D=t,L=b(m,p)+b(p,t);p.charAt(0)===t.charAt(0);){m+=p.charAt(0);p=p.substring(1)+t.charAt(0);t=t.substring(1);var N=b(m,p)+b(p,t);if(N>=L){L=N;s=m;A=p;D=t}}if(a[l-1][1]!=s){if(s)a[l-1][1]=s;else{a.splice(l-1,1);l--}a[l][1]=A;if(D)a[l+1][1]=D;else{a.splice(l+1,1);l--}}}l++}};
n.Yu=function(a){a.push([0,""]);for(var b=0,c=0,d=0,f="",h="",k;b<a.length;)switch(a[b][0]){case 1:d++;h+=a[b][1];b++;break;case -1:c++;f+=a[b][1];b++;break;case 0:if(c!==0||d!==0){if(c!==0&&d!==0){k=this.Zu(h,f);if(k!==0){if(b-c-d>0&&a[b-c-d-1][0]==0)a[b-c-d-1][1]+=h.substring(0,k);else{a.splice(0,0,[0,h.substring(0,k)]);b++}h=h.substring(k);f=f.substring(k)}k=this.Jp(h,f);if(k!==0){a[b][1]=h.substring(h.length-k)+a[b][1];h=h.substring(0,h.length-k);f=f.substring(0,f.length-k)}}if(c===0)a.splice(b-
c-d,c+d,[1,h]);else d===0?a.splice(b-c-d,c+d,[-1,f]):a.splice(b-c-d,c+d,[-1,f],[1,h]);b=b-c-d+(c?1:0)+(d?1:0)+1}else if(b!==0&&a[b-1][0]==0){a[b-1][1]+=a[b][1];a.splice(b,1)}else b++;c=d=0;h=f="";break}a[a.length-1][1]===""&&a.pop();c=j;for(b=1;b<a.length-1;){if(a[b-1][0]==0&&a[b+1][0]==0)if(a[b][1].substring(a[b][1].length-a[b-1][1].length)==a[b-1][1]){a[b][1]=a[b-1][1]+a[b][1].substring(0,a[b][1].length-a[b-1][1].length);a[b+1][1]=a[b-1][1]+a[b+1][1];a.splice(b-1,1);c=g}else if(a[b][1].substring(0,
a[b+1][1].length)==a[b+1][1]){a[b-1][1]+=a[b+1][1];a[b][1]=a[b][1].substring(a[b+1][1].length)+a[b+1][1];a.splice(b+1,1);c=g}b++}c&&this.Yu(a)};n.iD=function(a,b){var c=0,d=0,f=0,h=0,k;for(k=0;k<a.length;k++){if(a[k][0]!==1)c+=a[k][1].length;if(a[k][0]!==-1)d+=a[k][1].length;if(c>b)break;f=c;h=d}if(a.length!=k&&a[k][0]===-1)return h;return h+(b-f)};
n.qQ=function(a){for(var b=[],c=0;c<a.length;c++)switch(a[c][0]){case 1:b[c]="+"+encodeURI(a[c][1]);break;case -1:b[c]="-"+a[c][1].length;break;case 0:b[c]="="+a[c][1].length;break}return b.join("\t").replace(/\0/g,"%00").replace(/%20/g," ")};n.UH=function(a,b,c){c=Math.max(0,Math.min(c,a.length-b.length));return a==b?0:a.length===0?i:a.substring(c,c+b.length)==b?c:this.GX(a,b,c)};
n.GX=function(a,b,c){function d(M,T){T=Math.abs(c-T);return M/b.length/k.yt+T/h/(1-k.yt)}if(b.length>this.KM)e(new Error("Pattern too long for this browser."));var f=this.FX(b),h=a.length;h=Math.max(h,this.$A);h=Math.min(h,this.ZA);var k=this,l=this.aB,m=a.indexOf(b,c);if(m!=-1)l=Math.min(d(0,m),l);m=a.lastIndexOf(b,c+b.length);if(m!=-1)l=Math.min(d(0,m),l);var p=1<<b.length-1;m=i;for(var t,s,A=Math.max(c+c,a.length),D,L=0;L<b.length;L++){var N=Array(a.length);t=c;for(s=A;t<s;){if(d(L,s)<l)t=s;else A=
s;s=Math.floor((A-t)/2+t)}A=s;t=Math.max(0,c-(s-c)-1);s=Math.min(a.length-1,b.length+s);N[s]=a.charAt(s)==b.charAt(b.length-1)?(1<<L+1)-1:(1<<L)-1;for(s=s-1;s>=t;s--){N[s]=L===0?(N[s+1]<<1|1)&f[a.charAt(s)]:(N[s+1]<<1|1)&f[a.charAt(s)]|D[s+1]<<1|1|D[s]<<1|1|D[s+1];if(N[s]&p){var K=d(L,s);if(K<=l){l=K;m=s;if(s>c)t=Math.max(0,c-(s-c));else break}}}if(d(L+1,c)>l)break;D=N}return m};
n.FX=function(a){for(var b={},c=0;c<a.length;c++)b[a.charAt(c)]=0;for(c=0;c<a.length;c++)b[a.charAt(c)]|=1<<a.length-c-1;return b};function Iq(a,b){this.start=a;this.$a=b}Iq.prototype.toString=function(){return["Start: ",this.start,", End: ",this.$a].join("")};function Jq(a){this.pb=a}n=Jq.prototype;n.er=i;n.Ku=i;n.Gp=i;n.Mh=i;n.et=i;n.JA=i;n.Sb=i;n.fJ=j;n.Ra=[];
n.capture=function(){try{this.Ra=["c"];this.er=this.pb.oF();this.Ra.push("v-"+this.er);try{this.pb.cl();this.Ra.push("cr-"+this.al(this.pb));this.Ku=this.pb.getContext();this.Ra.push("cc-"+this.Ku);this.Gp=this.pb.Um(j);this.Ra.push("cl-"+this.Gp)}catch(a){this.Sb=a}if(!this.vW()){this.Ra.push("offscreen");this.Mh=new Kq(this.pb.pa(),this.pb.si());this.Mh.Tk(j);this.Ra.push("vcr-"+this.al(this.Mh));this.et=this.Mh.getContext();this.Ra.push("vcc-"+this.et);this.JA=this.Mh.Um(j);this.Ra.push("vcl-"+
this.JA)}}catch(b){if(!this.Sb)this.Sb=b}};n.al=function(a){try{var b=a.O(),c=a.pa().document;if(!b)return"(no range)";return(new Gq(c)).al(b)}catch(d){return d&&d.message||"(unknown error)"}};
n.restore=function(){this.Ra.push("r");try{this.pb.Py(this.Ku);this.Ra.push("cr-"+this.al(this.pb));this.pb.mj()}catch(a){if(!this.Sb)this.Sb=a}var b=j;if(this.et){this.Ra.push("vsr");try{this.Mh.Py(this.et);this.Ra.push("vcr-"+this.al(this.Mh));b=this.Qy(this.JA,this.Mh.Um(j))}catch(c){if(!this.Sb)this.Sb=c}}if(!b){this.Ra.push("sr");try{this.Qy(this.Gp,this.pb.Um(g))||this.Qy()}catch(d){if(!this.Sb)this.Sb=d}}if(this.Sb)e(this.Sb)};
n.vW=function(){var a=this.Gp,b=this.er;if(a&&b){var c=a.start.y;a=a.$a.y;var d=b.top;b=d+b.height;return d<c&&c<b||d<a&&a<b}return j};n.Qy=function(a,b){this.Ra.push(["sr:",a,",",b].join(""));var c=this.er;if(arguments.length<2){this.Tn(c.left,c.top);return g}else if(a&&b){var d=a.start.y>c.top?b.start.y-a.start.y:b.$a.y-a.$a.y;this.Ra.push("delta:"+d);if(Math.abs(d)>Math.max(150,0.33*Math.max(c.height,Pf(this.pb.pa().document.body).height))){this.fJ=g;return j}else{this.Tn(c.left,c.top+d);return g}}return j};
n.Tn=function(a,b){this.Ra.push(["st:",a,",",b].join(""));var c=this.pb.pa();function d(){c.scrollTo(a,b)}d();si(d,0)};function Kq(a,b){this.$g=a;this.lc=b}n=Kq.prototype;n.H=i;n.kg=g;n.yY=function(){this.kg=g};n.xY=function(){this.kg=j};n.cl=function(){var a=this.H,b=i;try{if(!z||this.kg)b=Bh(this.$g)}catch(c){}var d=this.lM(b),f;if(d){if(a&&(f=this.lM(a))){this.H=i;e(Error("cursor is no longer valid! old range is "+f+" and new range is "+d))}}else this.H=b};
n.lM=function(a){try{if(!a)return"missing";if(!a.Pi())return"not in a document";z&&a.Jc().nodeValue;if(a.pa()!=this.$g)return"in the wrong window"}catch(b){return"throwing an error ("+(b&&b.message||"something weird")+")"}};n.O=function(){return this.H};n.pa=function(){return this.$g};n.si=function(){return this.lc};n.mj=function(a){if(this.H&&(a||this.kg||!z)){this.H.select();if(a||this.kg){this.$g.focus();this.lc.focus()}}};n.J0=function(a,b){this.H=a;b&&this.mj()};
n.getContext=function(){return this.H&&new Lq(this.$g,this.H)};n.Py=function(a){this.H=i;if(a)this.H=a.O()};n.oF=function(){var a=J(this.$g.document),b=a.oe();a=a.pF();return new xf(b.x,b.y,a.width,a.height)};
n.Um=function(a){if(!this.H)return i;var b=[this.lc.wd(Mq.Uf),this.lc.wd(Mq.QA),this.lc.wd(Mq.Aj)];if(!b[1]||!b[2])this.lc.$e(g,g);b[0]||this.lc.ae(Mq.Uf);try{var c=this.H,d=c.hj(),f=i,h=x&&x.pb;if(h&&this!=h){var k=h.O();f=k&&k.hj()}var l=c.L(),m=c.ka(),p=c.da(),t=c.Ma();try{return new Iq(this.HE(l,m),this.HE(p,t))}finally{this.H=d.restore();f&&h.J0(f.restore(),g);a&&this.mj()}}finally{b[0]||this.lc.Hh(Mq.Uf);if(!b[1]||!b[2]){this.lc.Ye(j,j);if(b[1])this.lc.ae(Mq.QA);else b[2]&&this.lc.ae(Mq.Aj)}}};
n.HE=function(a,b){var c=J(this.$g.document),d=c.o("SPAN");d.appendChild(c.createTextNode("\ufeff"));var f,h;try{if(a.nodeType==3){f=a;a=a.parentNode;var k=f.nodeValue,l=k.substring(0,b),m=k.substring(b);if(!ya(l)){if(!ya(m)){f.nodeValue=l;h=function(p,t){return function(){p.nodeValue=t}}(f,k)}f=f.nextSibling}}else f=a.childNodes[b];if(this.P1(a.tagName)){f?a.insertBefore(d,f):a.appendChild(d);try{return Kf(d)}finally{a.removeChild(d)}}else return Kf(a)}finally{h&&h()}};
n.P1=function(a){return a&&a!="BR"&&a!="HR"&&a!="IMG"};
n.Tk=function(a,b,c,d){b=b||this.$g.document.body;d=d||this.oF();c=c||this.aF(b,d);var f=j;switch(c){case 0:case 5:case i:return i;case 3:case 4:f=g;break}for(b=b.firstChild;b;b=b.nextSibling)if(b.nodeType==3){if(f){c=b.nodeValue.match(/^[\t\n\r ]*/)[0].length;if(!a||c<b.nodeValue.length)return this.H=dk(b,c)}}else{c=this.aF(b,d);if(this.Tk(a,b,c,d))return this.H;switch(c){case 4:case 5:case 2:return i;case 1:case 3:f=g;break}if(f&&b.tagName=="BR"&&!z)return this.H=dk(b,0)}return i};
n.aF=function(a,b){try{var c=Qf(a),d=c.top+c.height,f=b.top,h=f+b.height;return{aa:0,ai:1,ab:2,ii:3,ib:4,bb:5}[(c.top<f?"a":c.top<h?"i":"b")+(d<f?"a":d<h?"i":"b")]}catch(k){return i}};function Lq(a,b){this.Cm=a;this.Pp=a.document;this.T=b.L();this.ca=b.da();this.ba=b.ka();this.ia=b.Ma();if((this.Zf=b.isCollapsed())&&z&&this.T.nodeType==1){a=this.T.childNodes;if(this.ba<a.length&&a[this.ba].tagName=="BR"){this.ba++;this.ia=this.ba}}this.nB(g);this.Zf||this.nB(j)}n=Lq.prototype;n.T=i;n.ca=i;n.ba=i;
n.ia=i;n.Zf=i;n.ro=i;n.pv=i;n.to="";n.Ls="";n.Vp="";n.qv="";
n.toString=function(){var a;try{a=this.T.nodeType==3?'"'+this.T.data+'"':this.T.tagName}catch(b){a="["+b+"]"}if(this.Zf)return"Cursor Object\n  startNode_: "+a+"\n  startOffset_: "+this.ba+"\n  startPercent_: "+this.ro+'\n  startPrefix_: "'+this.to+'"\n  startSuffix_: "'+this.Ls+'"';else{var c;try{c=this.ca.nodeType==3?'"'+this.ca.data+'"':this.ca.tagName}catch(d){c="["+d+"]"}return"Cursor Object\n  startNode_: "+a+"\n  endNode_: "+c+"\n  startOffset_: "+this.ba+"\n  endOffset_: "+this.ia+"\n  startPercent_: "+
this.ro+"\n  endPercent_: "+this.pv+'\n  startPrefix_: "'+this.to+'"\n  startSuffix_: "'+this.Ls+'"\n  endPrefix_: "'+this.Vp+'"\n  endSuffix_: "'+this.qv+'"'}};
n.nB=function(a){var b=0,c="",d="",f=this.Pp;c=f.body;d=this.Cm;if(!("nodeType"in d)&&d.document)d=d.document;if(d.nodeType==9)d=d.body;if(f.createRange){f=f.createRange();f.setStartBefore(d);a?f.setEnd(this.T,this.ba):f.setEnd(this.ca,this.ia);c=f.toString();a?f.setStart(this.T,this.ba):f.setStart(this.ca,this.ia);f.setEndAfter(d);d=f.toString()}else if(c.createTextRange){d=c.createTextRange();d.moveToElementText(c);c=this.HP(a);f=c.duplicate();c.setEndPoint("StartToStart",d);c=c.text;f.setEndPoint("EndToEnd",
d);d=f.text}else e(Error("unsupported browser "+navigator.userAgent));if(c.length+d.length!=0)b=c.length/(c.length+d.length);var h;var k=f=a?this.T:this.ca;h=a?this.ba:this.ia;d=c="";if(f.nodeType==3){c=Nq(f.data.substring(0,h));d=Nq(f.data.substring(h))}else if(f.nodeType==1&&h!=0)if(h<f.childNodes.length){f=f.childNodes[h];k=Oq(f)[0]}else{for(;f.lastChild;)f=f.lastChild;c=f.nodeType==3?Nq(f.data)+c:(f.tagName||f.nodeName).charAt(0);k=f}for(;f&&c.length<16;){h=Oq(f);f=h[0];if(!f)break;h=h[1];c=h+
c;c=f.nodeType==3?Nq(f.data)+c:f.nodeName.charAt(0)+c}for(;k&&d.length<16;){h=Pq(k);k=h[0];if(!k)break;h=h[1];d+=h;d+=k.nodeType==3?Nq(k.data):k.nodeName.charAt(0)}c=c.substring(c.length-16);d=d.substring(0,16);if(a){this.ro=b;this.to=c;this.Ls=d}else{this.pv=b;this.Vp=c;this.qv=d}};
n.HP=function(a){var b,c=this.Pp.body.createTextRange(),d,f;if(a){d=this.T;f=this.ba}else{d=this.ca;f=this.ia}if(d.nodeType==1){b=d.childNodes;if(f>=b.length){c.moveToElementText(d);c.collapse(j)}else if(f<=0){c.moveToElementText(d);c.collapse(g)}else if(b[f].nodeType==1){c.moveToElementText(b[f]);c.collapse(g)}else if(b[f-1].nodeType==1){c.moveToElementText(b[f-1]);c.collapse(j)}else{c.moveToElementText(d);c.collapse(a)}}else{for(;d.nodeType!=1;){a=Oq(d);d=a[0];if(d.data)f+=d.data.length}c.moveToElementText(d);
d.hasChildNodes()?c.collapse(g):c.collapse(j);c.moveStart("character",f)}return c};n.O=function(){if(this.WS()){this.ba=Qq(this.T,this.ba);this.ia=Qq(this.ca,this.ia);var a=hk(this.T,this.ba,this.ca,this.ia);if(a)return a;else e(Error("cursor context: failed to create range"))}else e(Error("cursor context: failed to restore"))};
n.WS=function(){var a=this.Pp.body,b=new Hq;b.yt=0.4;b.aB=0.9;b.$A=1E3;b.ZA=1E4;var c;a:{c=new jl;c.append(a.nodeName.charAt(0));for(var d=1,f=a.firstChild||a,h=j,k=[a],l=1;f!=a;){if(h){c.append(f.nodeName.charAt(0).toLowerCase());d++}else if(f.nodeType==3){var m=Nq(f.data);c.append(m);d+=m.length}else{f.goog_docs_charIndex=d;c.append(f.nodeName.charAt(0));d++}if(!h&&f.firstChild){if(z)k[l++]=f;f=f.firstChild}else if(f.nextSibling){f=f.nextSibling;h=j}else{if(z&&k[--l]!==f.parentNode){c=Rq(a);a.replaceNode(c);
if(H("enable_comments")||H("enable_footnotes"))$m();c=i;break a}f=f.parentNode;h=g}}a.goog_docs_charIndex=0;c.append((a.tagName||a.nodeName).charAt(0).toLowerCase());c=c.toString()}if(c==i)return i;h=this.to+this.Ls;d=b.UH(c,h,Math.round(Math.max(0,Math.min(c.length,this.ro*c.length-16))));if(d!==i){k=c.substring(d,d+h.length);h=b.Tj(h,k,j);d+=b.iD(h,this.to.length);h=Sq(a,d);this.T=h[0];this.ba=h[1]}f=i;if(!this.Zf){h=this.Vp+this.qv;f=b.UH(c,h,Math.round(Math.max(0,Math.min(c.length,this.pv*c.length-
16))));if(f!==i){k=c.substring(f,f+h.length);h=b.Tj(h,k,j);f+=b.iD(h,this.Vp.length);h=Sq(a,f);this.ca=h[0];this.ia=h[1]}}if(d!==i&&f===i){this.Zf=g;this.ca=this.T;this.ia=this.ba}else if(d===i&&f!==i){this.Zf=g;this.T=this.ca;this.ba=this.ia}else if(d===i&&f===i){h=Sq(a,Math.round(this.ro*c.length));this.T=h[0];this.ba=h[1];this.Zf=g;this.ca=this.T;this.ia=this.ba}if(this.Zf&&z&&this.T.tagName=="BR"){this.ca=this.T=this.$S(this.T);this.ia=this.ba=this.T.nodeValue.length}return{e4:d,d4:f}};
n.$S=function(a){var b=a.previousSibling;if(!b||b.nodeType!=3){b=this.Pp.createTextNode(" ");a.parentNode.insertBefore(b,a)}return b};function Oq(a){if(a.tagName=="BODY")return[i,""];if(a.previousSibling){var b="";for(a=a.previousSibling;a.hasChildNodes();){b=a.nodeName.charAt(0)+b;a=a.lastChild}return[a,b.toLowerCase()]}if(a.parentNode)return[a.parentNode,""];return[i,""]}
function Pq(a){if(a.hasChildNodes())return[a.firstChild,""];else if(a.nextSibling)return[a.nextSibling,""];for(var b="";a&&a.tagName!="BODY";){if(a.nextSibling)return[a.nextSibling,b.toLowerCase()];a=a.parentNode;b+=a.nodeName.charAt(0)}return[i,b.toLowerCase()]}function Rq(a){for(var b=a.cloneNode(j);a.hasChildNodes();){var c=a.removeChild(a.firstChild);if(c)(c=Rq(c))&&b.appendChild(c)}return b}
function Tq(a){for(var b=g,c=0,d;a;){if("goog_docs_charIndex"in a)return a.goog_docs_charIndex+c;if(b)b=j;else if(a.data)c+=Nq(a.data).length;d=Oq(a);a=d[0];c+=d[1].length;a.nodeType!=3&&c++}return 0}
function Uq(a,b){var c=Tq(a);if(c==b)return a;else if(a.nodeType==3){var d=Nq(a.data);return c+d.length>b?a:c+d.length-1}else if(!a.hasChildNodes())return c;for(d=0;d<a.childNodes.length-1;d++){c=Tq(a.childNodes[d+1]);if(c-1==b)return a.childNodes[d];else if(c>b)return Uq(a.childNodes[d],b)}c=Uq(a.lastChild,b);return typeof c=="object"?c:c+1==b?a:c+1}
function Sq(a,b){var c=Uq(a,b);if(typeof c=="number")return[a,a.childNodes.length];if(c.nodeType==3){a=b-Tq(c);b=Nq(c.data);if(a>=b.length)a=b.length-1}else a=!c.hasChildNodes()||Tq(c)>=b?0:c.childNodes.length;return[c,a]}function Nq(a){return a.replace(/^[\t\n\r ]+/," ").replace(/[\t\n\r ]+$/," ")}function Qq(a,b){if(b==0||a.nodeType!=3)return b;a=a.data;var c=Nq(a);if(b>=c.length)return a.length;a=a.match(/^[\t\n\r ]*/)[0].length;if(a==0)return b;return b+a-1};function Vq(){var a=O("application_version");a=a?Number(a.content):i;this.Vi=new ne(a)}var vb=new Vq;
function Wq(a){var b="";try{lj("make_editable");Xq("DesignPageHasLoaded");var c=O("loadingDiv");if(c)c.style.visibility="hidden";var d=G("dasherdomain");sa=new Yq(window,d?"/a/"+d+"/":"/");b="/writely.editor_";x=new Zq("wys_frame",sa);b="/writely.fieldObj_";sa.Rk(x);b="/makeEditable";$q=new ar(br,Rd(G("refresh_interval_slow"))*1.5);$q.start();b="/startMonitor";try{sa.eE(x.mv.id)}catch(f){rce("failed to place initial focus",f,cr)}b="/focusOnField";if(E)X.onbeforeunload=function(){return window.onbeforeunload()};
dr();b="/EditPage.init";er();b="/AttachKeyHandlers";fr();b="/UpdateToolbarState";x.Ye();b="/startChangeEvents";a||zb("DesignPageHasLoaded: empty revision ID");yb(a,"",i);mb=Wd();ie();ee();b="/startHeartbeat"}catch(h){rce("DesignPageHasLoaded",h,cr+b);e(h)}kj&&window.setTimeout(gr,3E4);qp();hr();if(H("enable_comments")||H("enable_footnotes")){dn();$m()}Fi("make_editable")}var ir=i,jr=i;
function kr(a,b){if(B&&a&&a.button==2&&x){a=x.pb;a.cl();ir=a.getContext()}var c=tf(b,"SPAN","misspell");if(c)jr=window.setTimeout(function(){var f=c.getAttribute("suggestions");if(f!=i){var h=i;if(f.length>0)h=f.split(",");f=X.document.getElementById("bad_word");f!=i&&f.removeAttribute("id");c.id="bad_word";f=Mf(c);var k=O("wys_frame");k=Kf(k).y;(new Dq(f.x,f.y+k+c.offsetHeight,document.body,c,h,X)).Yc()}},100);else{var d=tf(b,"SPAN","writely-comment");if(d)tf(b,De)||(jr=window.setTimeout(function(){uj=
d;(new mj(document.body,d,X,G("userId"))).Yc()},100))}}function lr(a){if(wp()&&E)return mr(a,a.target,g)}
function mr(a,b,c){if(jr){window.clearTimeout(jr);jr=i}if(!(a&&a.shiftKey)){var d=Vp();if(!Wp(d,"writely-toc"))if(!(!qq(d,"table")&&!Wp(d,"google_header")&&!Wp(d,"google_footer")&&!qq(d,"ul")&&!qq(d,"ol")&&!qq(d,"hr"))){Cp();if(B&&ir){b=fq();var f=x.pb;if(b&&b.tagName=="DIV"){f.Py(ir);f.mj()}}ir=i;if(Wp(d,"misspell")||Wp(d,"writely-comment"))if(z){a.cancelBubble=g;a.returnValue=j}else a.preventDefault();else{var h={x:0,y:0};h.x=document.all?a.clientX:a.pageX;h.y=document.all?a.clientY:a.pageY;if(!(h.x<
0)){if(z){a.cancelBubble=g;a.returnValue=j}else if(!y){a.preventDefault();h.x-=X.document.body.scrollLeft;h.y-=E?X.document.body.scrollTop:X.document.documentElement.scrollTop}a=Kf(window.document.getElementById("wys_frame").offsetParent);h.x+=a.x;c||(h.y+=a.y);window.setTimeout(function(){var k=h.x,l=h.y;if(d==i)F("Sorry, but there was an error showing this menu. Please try again.");else{var m=0;m|=qq(d,"table")?1:0;m|=qq(d,"tr")?2:0;m|=qq(d,"td")?4:0;m|=Wp(d,"google_header")?8:0;m|=Wp(d,"google_footer")?
16:0;m|=qq(d,"ul")?32:0;m|=qq(d,"ol")?64:0;m|=qq(d,"hr")?256:0;m|=window.clipboardData&&window.clipboardData.getData?512:0;m|=window.LIMITED_EDITING?2048:0;m|=x.O().isCollapsed()&&qq(d,"li")?128:0;(new nr(k,l,document.body,X,sa,j,m)).Yc()}},100)}}}}}var cr="Not Started, agent: "+navigator.userAgent+", isIE: "+z;
function Xq(a){var b=O("loadingDiv");if(b){var c=b.innerHTML;if(b.innerHTML.length>=20)b.innerHTML=c.substring(0,c.indexOf("."));else b.innerHTML+=".";b.style.left=((b.offsetParent||document.body).clientWidth-b.clientWidth)/2}cr=cr+" / "+a}function Bb(){var a=O("shadow_frame");if(a&&a.contentWindow&&a.contentWindow.document&&a.contentWindow.document.body)return a.contentWindow;return i}function or(a){if(E)X.document.onscroll=a;else U(X,"scroll",a)}
function er(){or(pr);if("addEventListener"in X){X.addEventListener("mousedown",Ji(kr),g);X.addEventListener("contextmenu",Ji(mr),g);B&&!("contentEditable"in window.document.body)&&X.document.addEventListener("DOMNodeRemoved",qr,g)}else{var a=frames.wys_frame.document;a.body.attachEvent("onpaste",function(){if(H("enable_comments")||H("enable_footnotes")){dn();window.setTimeout($m,0)}});a.attachEvent("onmousedown",Ji(kr));a.attachEvent("oncontextmenu",Ji(mr))}}
function pr(){H("enable_toc")==g&&rr();x&&x.Sc();sr()}function tr(){sr()}function sr(){if(H("enable_comments")==g||H("enable_footnotes")==g)(ur||(ur=new vr)).RU()}var wr=0;function qr(){wr!==0&&window.clearTimeout(wr);wr=window.setTimeout(xr,0)}
function xr(){wr=0;var a=X.getSelection();try{var b=a.getRangeAt(a.rangeCount-1)}catch(c){return}a=b.startContainer;var d=b.startOffset,f=a.childNodes;if(a.tagName!="BODY"&&a.nodeType!=3&&b.collapsed){b=X.document.createTextNode("");d>=f.length?a.appendChild(b):a.insertBefore(b,f[d])}}function nq(a){sa.execute("w-spell",a);editUI.V.eb("w-spell",a);editUI.X.v2(a)}
function eq(a){var b=j;if(E&&a!=13)return b;var c=x.O(),d=c?c.Tb():i;if(d&&d.nodeName.toLowerCase()=="marker"){var f=X.document.createElement("span");c.fl(f);c=d.innerHTML;P(f);f=g;if(c=="<span></span>&nbsp;")f=j;if(a==13){b=g;a=X.document.createElement("div");c=X.document.createElement("br");a.appendChild(c);if(f){Ye(a,d);Xl(c,j)}else{Xe(a,d.previousSibling);Xl(d.previousSibling,g)}}else E||(a==37||!f?Xl(d.previousSibling,g):Xl(d,j))}return b}
function dq(a){var b=j,c=a==37,d=a==39,f=a==13;if(!c&&!d&&!f)return b;var h=x.O();if(!h)return b;a=Ul(h.Jc());lc(a.getElementsByTagName("marker"),function(k){var l=k.previousSibling,m=hk(l,0,k,1);if(c&&h.L()==k||d&&h.isCollapsed()&&h.L().nextSibling==l&&h.ka()==h.L().length||m.$f(h,j)){k.style.display="inline";l.style.display="inline";m.collapse(c);if((d||f)&&!k.nextSibling){k.parentNode.appendChild(X.document.createTextNode(" "));var p=g}m.select();k.style.display="inline-block";c&&k.parentNode.insertBefore(l,
k);l.style.display="";p&&X.document.execCommand("delete",j,g);b=!f}});return b}function lq(a){if(z)return j;if((a.which||a.charCode||a.keyCode)!=8)return j;if(dh.startOffset!=0||dh.collapsed==j)return j;a=dh.commonAncestorContainer;var b;if(a.tagName=="BODY")b=a.firstChild;else for(b=a.previousSibling;!b&&a;){a=a.parentNode;b=a.previousSibling}if(b&&b.tagName=="DIV"&&yr(b))return g}
function kq(a){if((a.which||a.charCode||a.keyCode)!=8)return j;a=Z.innerHTML.replace(/(<([^>]+)>)/ig,"");if(Na(a).replace(/\xa0|\s/g," "))return j;if((a=Z.parentNode)&&yr(a)&&a.childNodes.length==1)return g;if(yr(Z))return g;return j}function yr(a){return Be(a,"google_header")||Be(a,"google_footer")}Vq.prototype.ZL=function(a,b,c){var d=a.indexOf(":");if(d<=0||d+1>=a.length)e(Error("invalid revision parameter: "+a));window.offline.U4(a.substring(d+1),b,c)};
Vq.prototype.$M=function(a,b,c,d,f){lj("update_revision_info");if(!(ke||Db)){if((d=a.newContentRevID)&&typeof d!="string"){rce("bad newContentRevID");d=String(d)}if(a.status=="success_collide")if("discardedChanges"in a&&Ba(a.discardedChanges).length>0){f=Number(d.substr(d.indexOf(":")+1));var h=a.discardedChanges,k=Hd();try{be=g;var l=IS_GEARS?"Your most recent changes to the following document conflict with changes just made by a collaborator, and have been discarded. This should only affect changes made in the last few seconds, or changes made while offline:":
"Your most recent changes to the following document conflict with changes just made by a collaborator, and have been discarded. This should only affect changes made in the last few seconds. Please note that this occurred because you and another collaborator were editing the same piece of text at the same time.";l+=" "+Ha(c);l+="\n\n";l+=zr(k,f);l+="\n\n";l+="Here is your discarded text:";Vi(h,l,i,0,5,void 0)}finally{be=j}delete a.discardedChanges}else{c=(IS_GEARS?"Your most recent changes to the following document conflict with changes just made by a collaborator, and have been discarded. This should only affect changes made in the last few seconds, or changes made while offline:":
"Your most recent changes to the following document conflict with changes just made by a collaborator, and have been discarded. This should only affect changes made in the last few seconds. Please note that this occurred because you and another collaborator were editing the same piece of text at the same time.")+" "+Ha(c);me(c,g,f)}a.lastModified&&a.lastModifier?Ar(a.lastModified,a.lastModifier,g,j):$g();if((c=a.newTitleFromServer)&&Cb(c)!=Cb(mb)){H("shelly_chrome")?Br.Y0(c):Yd(c);$g();mb=c;f=O("txtTitleEdit");
h=Xd();if(h.length>32)h=h.substring(0,30)+"...";h=h;if(f)f.innerHTML=Ha(h);document.title=h+" - "+G("sitename")}f=b==vb.Ph();this.Vi.eb(Number(a.version));if(this.Vi.MW()){h=Cr();IS_GEARS&&offline&&offline.p();h.reload(g)}if(d&&f||a.status=="success_collide"){if(a.spellcheckException){F("Spellcheck failed due to internal error.");Dr(j)}else a.newContentIncludesMisspellingAdornments?Er(g):Er(j);k=a.newContentFromServer;if(typeof k!="string")e(Error("ReplaceInnerHTML: newText = "+k));if(!a.includesChangeFromOthers&&
x){x.ae(Mq.Aj);x.ae(Mq.Uf)}Fr=0;f=window.setTimeout(Gr,1);Fr=1;h=i;if(x){lj("cursor_capture");h=new Jq(x.pb);h.capture();Fi("cursor_capture")}Fr=3;l=j;var m=i;if(!(z&&ab("7.0",Ad)==1)&&H("fine_grained_update")&&a&&a.revisionInfo&&a.revisionInfo.data){lj("apply_fugu_update");lj("fugu_loadshadow");var p=Bb();p.document.body.innerHTML=a.newContentFromServer;Fi("fugu_loadshadow");Fr=4;try{var t=p.document,s=X.document,A=a.revisionInfo.data;if(g!==j){t.body.normalize();s.body.normalize()}for(var D=[],
L=0,N;N=A[L];L++){var K=i,M=i;switch(N.operation){case "insert":try{var T=N,Qe=Hr(T.source,t),Rf=Hr(T.target,s);if(Qe){var vj=Ir(s,Qe,j);K=Jr(vj,Rf,s)?{uh:"insert",J:Rf}:i}else K=i}catch(wj){M=wj}break;case "insert-tree":try{T=N;var ph=Hr(T.source,t),qh=Hr(T.target,s);if(ph){var xj=Ir(s,ph,g);K=Jr(xj,qh,s)?{uh:"insert-tree",J:qh}:i}else K=i}catch(yj){M=yj}break;case "delete":try{T=N;T.target=T.target||T.source;var dd=Hr(T.target,s);if(dd)if(!dd.parentNode||dd==s.body)K=i;else{var ge={uh:"delete",
J:dd,parent:dd.parentNode,nextSibling:dd.nextSibling};Kr(dd);K=ge}else K=i}catch(S){M=S}break;case "update":try{T=N;T.target=T.target||T.source;var W=Hr(T.source,t),Ra=Hr(T.target,s);if(!W||!Ra)K=i;else if(Ra.nodeType!=W.nodeType)K=i;else{var C=Ir(s,Ra,j);T={uh:"update",J:Ra,RN:C};Lr(W,Ra);K=T}}catch(Ea){M=Ea}break;case "graft":try{T=N;var vc=Hr(T.source,t),Za=Hr(T.target,s);if(!vc||!Za)K=i;else if(Za.nodeType!=1||vc.nodeType!=1)K=i;else if(Za.nodeType==1&&Za.tagName!=vc.tagName)K=i;else{var qb={uh:"graft",
J:Za,SN:Za.innerHTML};Za.innerHTML=vc.innerHTML;K=qb}}catch(ic){M=ic}break;case "move":try{T=N;var wc=Hr(T.source,s),Lc=Hr(T.target,s);if(!wc&&!Lc)K=i;else if(wc==Lc)K={uh:"no-op"};else{var Vu={uh:"move",J:Lc,parent:Lc.parentNode,nextSibling:Lc.nextSibling},Wu=Kr(wc);K=Jr(Wu,Lc,s)?Vu:i}}catch(mm){M=mm}break;default:M='unknown operation: "'+N.operation+'"'}if(K)D.push(K);else{for(var zj=N.operation+", "+N.source+", "+N.target,Kp=D.length-1;Kp>=0;Kp--){var jc=D[Kp];switch(jc.uh){case "insert":Kr(jc.J);
break;case "insert-tree":Kr(jc.J);break;case "delete":case "move":jc.nextSibling?jc.parent.insertBefore(jc.J,jc.nextSibling):jc.parent.appendChild(jc.J);break;case "update":Lr(jc.RN,jc.J);break;case "graft":jc.J.innerHTML=jc.SN;break;case "no-op":break;default:e(new Error('undoStack_: unknown operation: "'+jc.uh+'"'))}}if(M)e(new Error('changeDom: error: "'+M+" applying ["+zj+']"'));else e(new Error('changeDom: Could not perform operation: "['+zj+']"'))}}l=g;lj("fugu_check");if(X.document.body.innerHTML!=
p.document.body.innerHTML){var he=a.revisionInfo.treesum;if(l&&he&&he.substring(0,4)=="th0:"){he=he.substring(4);var nm=Mr(X.document.body,1);if(nm!=he){Nr.fugu_warn_server_treesum=he+","+nm+","+lb+","+a.newContentRevID;he=Mr(p.document.body,1)}if(nm!=he){l=j;Nr.fugu_fail_treesum=he+","+nm+","+lb+","+a.newContentRevID}}}else Or("fugu_matches_innerhtml");Fi("fugu_check")}catch(vB){m=vB;Nr.fugu_fail_exception=lb+","+a.newContentRevID}l?Or("fugu_success"):Or("fugu_fail");Fi("apply_fugu_update")}m&&!H("fugu_dryrun")&&
rce("Could not apply fine grained updates.",m);if(H("fugu_dryrun")||!l){Fr=5;lj("update_innerhtml");X.document.body.innerHTML=k;Fi("update_innerhtml")}t=X.document.body;if(t.normalize){Fr=6;lj("normalize_body_node");t.normalize();Fi("normalize_body_node")}Fr=8;if(h){try{lj("cursor_restore");h.restore();Fi("cursor_restore")}catch(wB){rce("Heartbeat cursor restore",wB,h.Ra.join(";"));Or("cursor_lost")}h.fJ&&Or("cursor_jumped")}dh=i;Fr=9;window.clearTimeout(f);if(H("enable_comments")||H("enable_footnotes"))$m();
if(x){if(a.includesChangeFromOthers){x.rm.stop();t=x.tf(Pr.prototype.gb());t.Fc(x);t.ou();t.qd(x)}else{x.Ye();x.Hh(Mq.Uf)}x.Ta()}ce=0;t=a.newContentFromServer;s=a.newContentFromServerHash;if(a.disableNextDelta){t="";s=i}else if(a.newContentIncludesMisspellingAdornments){t=a.revisionIDFromUpload==d?b:"";s=i}yb(d,t,s);if(IS_GEARS){b=a.newContentFromServer;if(a.newContentIncludesMisspellingAdornments)b=Qr(b);this.ZL(d,b,c)}}else{if(a=a.revisionIDFromUpload){yb(a,b,i,b);IS_GEARS&&this.ZL(a,b,c)}else Ab(b);
d&&fe()}Fi("update_revision_info")}};function Rr(a){if(!a)return 0;if(a){var b=[];a.pageYOffset&&b.push(a.pageYOffset);a.document.documentElement&&b.push(a.document.documentElement.scrollTop);a.document.body.scrollTop&&b.push(a.document.body.scrollTop);a=Number.MAX_VALUE;for(var c=0;c<b.length;c++)if(typeof b[c]=="number"&&b[c]!=0&&b[c]<a)a=b[c];return a==Number.MAX_VALUE?0:a}}
Vq.prototype.Ph=function(){if(!X)e(Error("can not get document contents: WYSEditor = "+X));if(!X.document)e(Error("can not get document contents: WYSEditor.document = "+X.document));if(!X.document.body)e(Error("can not get document contents: WYSEditor.document.body = "+X.document.body));if(x){x.ae(Mq.Aj);x.ae(Mq.Uf)}var a=X.document;if(a){a=a.getElementsByTagName("span");for(var b=a.length-1;b>=0;--b){var c=a[b],d=c.getAttribute("id"),f=c.className;if(gj.test(d||"")||hj.test(f||""))c&&$e(c)}}a=X.document.body.innerHTML;
b=[];X.location&&X.location.href&&b.push(X.location.href);window.location&&window.location.href&&b.push(window.location.href);for(c=0;c<b.length;c++){d=b[c];if(d.lastIndexOf("#")!=-1)d=d.substring(0,d.lastIndexOf("#"));f=d.replace(/&/g,"&amp;").replace(/([^\w])/g,"\\$1");a=a.replace(new RegExp("(\\shref=['\"])"+f+"#","gi"),"$1#");if(d.lastIndexOf("/")!=-1){d=d.substring(0,d.lastIndexOf("/")+1);d=d.replace(/([^\w])/g,"\\$1");a=a.replace(new RegExp("(\\s(src|href)=['\"])"+d,"gi"),"$1")}}b=H("enable_comments")||
H("enable_footnotes");if(!B){a=a.replace(/ goog_docs_charIndex="\d+"/g,"");if(b){a=a.replace(/ closure_hashcode_="\d+"/ig,"");a=a.replace(/<\?xml\:namespace prefix = gdoc \/>/ig,"")}}b&&gn(a);if(H("enable_cloudboard"))a=a.replace(/<div id="cb-p-tgt">.*?<\/div>/i,"");a=a.replace(/<script[^<]*<\/script>/ig,"");if(Sr)a=Qr(a);a=Ba(a);if(x){x.Ye();x.Hh(Mq.Uf)}return a};
function Fq(a,b){if(y)var c=X.pageXOffset,d=X.pageYOffset;a=X.document.getElementById(a);if(a!=i){if(b==i)b=a.innerHTML;if("insertAdjacentText"in a){a.insertAdjacentText("beforeBegin",b);a.parentNode.removeChild(a)}else{b=X.document.createTextNode(b);a.parentNode.replaceChild(b,a)}y&&X.scrollTo(c,d)}}var Tr=new RegExp("<span[ ]+[^>]*?class=[\"']?misspell[\"']?[^>]*?>([^<]+)</span>","gi");
function Qr(a){if(y)var b=X.pageXOffset,c=X.pageYOffset;if(!Sr)return a;if(a)return a.replace(Tr,"$1");a=(new Ee(X.document)).sf("span","misspell");for(var d=0;d<a.length;d++)if(typeof a[d].insertAdjacentText!="undefined"){a[d].insertAdjacentText("beforeBegin",a[d].innerText);a[d].parentNode.removeChild(a[d])}else{var f=X.document.createTextNode(a[d].innerHTML);a[d].parentNode.replaceChild(f,a[d])}y&&X.scrollTo(b,c);return i}
function iq(a){if(X.document.createRange){var b=X.document.createRange();b.setStart(a,0);b.setEnd(a,0);if(a=$i(X)){a.removeAllRanges();a.addRange(b)}}else{b=X.document.body.createTextRange();b.moveToElementText(a);b.select();if(b=Bh(X)){b.collapse(g);b.select()}}}function qq(a,b){if(a&&b){b=b.toUpperCase();for(var c=0;c<a.length;c++)if(a[c].tagName==b)return g}return j}function Wp(a,b){if(a&&b)for(var c=0;c<a.length;c++)if(a[c]&&Be(a[c],b))return g;return j}
function fq(){var a=Bh(X);return a?a.Tb():i}function Vp(a){try{var b;b=typeof a!="undefined"?a:fq();for(a=[];b&&b.nodeType==1&&b.tagName!="BODY";){a.push(b);b=b.parentNode}X.document.body&&a.push(X.document.body);return a}catch(c){rce("GetAllNodes",c);return i}}
function Ur(){var a=Vp();if(qq(a,"blockquote"))try{var b=Si(fq(),"blockquote");b!=i&&b&&$e(b)}catch(c){F(c.message)}else if(z){if(b=Bh(X)){a=X.document.createElement("BLOCKQUOTE");a.id=Xi();var d=b.Ab()||"\u00a0";d=X.document.createTextNode(d);a.appendChild(d);b.gd();a=b.insertNode(a);b=a.parentNode;if(b.tagName=="FONT"&&b.childNodes.length==1){b.parentNode.appendChild(a);b.parentNode.removeChild(b)}}}else{sa.execute("w-BLOCKQUOTE");X.document.body.lastChild.tagName=="BLOCKQUOTE"&&X.document.body.appendChild(X.document.createElement("BR"))}}
function Vr(){var a=window.clipboardData;if(a=a?a.getData("Text"):i)ch(a,i,g);else a!=""&&oh("EditHtmlSelection")}
function fr(){if(editUI&&editUI.V){Cp();var a=sa.oq()||x;try{var b=a.O().vc(),c=a.O().M()}catch(d){return}var f=a=i,h=i,k=i,l=i,m=i,p=i,t=i,s=i,A=i,D=i,L=i,N=i,K=i,M=i,T=i,Qe=i,Rf=i,vj=i,wj=i,ph=i,qh=i,xj=i,yj=i,dd=i;if(b){var ge,S=b;ge=c.body;var W=[],Ra=j;if("commonAncestorContainer"in S)if(S.collapsed){W=[S.commonAncestorContainer];Ra=g}else{var C=S.startContainer;if((C.nodeType==3?C.length:C.childNodes.length)==S.startOffset){if(C.hasChildNodes())C=C.firstChild;else if(C.nextSibling)C=C.nextSibling;
else for(;C;){if(C.nextSibling){C=C.nextSibling;break}C=C.parentNode}C&&S.setStart(C,0)}var Ea=S.endContainer;if(0==S.endOffset){for(;Ea;){if(Ea.previousSibling){Ea=Ea.previousSibling;break}Ea=Ea.parentNode}if(Ea)S.setEnd(Ea,Ea.nodeType==3?Ea.data.length:Ea.childNodes.length)}Ea=S.commonAncestorContainer;if(Ea.hasChildNodes()&&"isPointInRange"in S){W.push(C);var vc=Ea.childNodes,Za=j;C=0;for(var qb;qb=vc[C];C++)if(S.isPointInRange(qb,0)){W.push(qb);Za=g}else if(Za)break}else if(Ea.hasChildNodes()&&
"compareBoundaryPoints"in S){vc=Ea.childNodes;Za=j;for(C=ge;C.parentNode;)C=C.parentNode;var ic=C.createRange();for(C=0;qb=vc[C];C++){ic.setStartBefore(qb);ic.setEndAfter(qb);if(S.compareBoundaryPoints(Range.END_TO_START,ic)==-1&&S.compareBoundaryPoints(Range.START_TO_END,ic)==1){W.push(qb);Za=g}else if(Za)break}}else W.push(Ea)}else if("parentElement"in S){Ea=S.parentElement();if(S.htmlText!=""&&Ea.hasChildNodes()){for(C=ge;C.parentNode;)C=C.parentNode;C=C.body;vc=Ea.childNodes;ic=C.createTextRange();
Za=j;var wc=i;for(C=0;qb=vc[C];C++)if(qb.nodeType==1){ic.moveToElementText(qb);wc&&ic.compareEndPoints("StartToStart",S)==1&&W.push(wc);wc=i;var Lc=ic.compareEndPoints(Za?"StartToEnd":"EndToStart",S);if(Za?Lc==-1:Lc==1){W.push(qb);if(ic.compareEndPoints("EndToEnd",S)!=-1)break;Za=g}else if(Za)break}else if(qb.nodeType==3)if(Za)W.push(qb);else wc=qb;wc&&W.push(wc);W.length==0&&W.push(Ea)}else{W.push(Ea);Ra=g}}if(!Ra&&W.length==1&&W[0].hasChildNodes()){S=W[0].childNodes;W.pop();for(C=0;Ra=S[C];C++)W.push(Ra)}W.length>
40&&W.splice(16,W.length-32);for(C=W.length-1;C>=0;C--)for(;W[C]&&W[C].nodeType!=1;){S=i;try{S=W[C].data}catch(Vu){}if(W[C].nodeType!=3)W.splice(C,1);else if(W.length!=1&&!S)W.splice(C,1);else if(W.length!=1&&S.match(/^\s+$/))W.splice(C,1);else{S=j;try{W[C]=W[C].parentNode}catch(Wu){S=g}if(S||W[C]==W[C+1])W.splice(C,1)}}W.length||(W=[ge]);ge=W;for(W=0;W<ge.length;W++){S=ge[W];Ra=c.defaultView&&c.defaultView.getComputedStyle?c.defaultView.getComputedStyle(S,i):S.currentStyle;C=Ra.fontWeight;a=Wr(a,
C!="400"&&C!="normal");C=Ra.fontStyle;f=Wr(f,C=="italic");C=Ra.textDecoration;h=Wr(h,C=="underline");C=Ra.textAlign;k=Wr(k,C=="justify");l=Wr(l,C=="left");m=Wr(m,C=="center");p=Wr(p,C=="right");C=Ra.direction;s=Wr(s,C=="rtl");t=Wr(t,C!="rtl");D=Wr(D,Ra.fontSize);C=Ra.fontFamily;if(typeof C=="string")C=C.replace(/^[\'\"](.*)[\'\"]$/,"$1");L=Wr(L,C);T=Wr(T,Ra.color);Qe=Wr(Qe,Ra.backgroundColor);for(var mm=Lc=wc=ic=qb=Za=vc=Ea=C=Ra=j,zj=j;S;){if(S.tagName=="OL"){Ra=g;break}else if(S.tagName=="UL"){C=
g;break}else if(S.tagName=="BLOCKQUOTE"){Ea=g;break}else if(S.tagName=="TABLE"){zj=g;break}else if(S.tagName=="P"){vc=g;break}else if(S.tagName=="H1"){Za=g;break}else if(S.tagName=="H2"){qb=g;break}else if(S.tagName=="H3"){ic=g;break}else if(S.tagName=="H4"){wc=g;break}else if(S.tagName=="H5"){Lc=g;break}else if(S.tagName=="H6"){mm=g;break}S=S.parentNode}if(S&&S.tagName.match("P|H[1-6]"))A=Wr(A,S.tagName);N=Wr(N,Ra);K=Wr(K,C);M=Wr(M,Ea);Rf=Wr(Rf,zj);vj=Wr(vj,vc);wj=Wr(wj,Za);ph=Wr(ph,qb);qh=Wr(qh,
ic);xj=Wr(xj,wc);yj=Wr(yj,Lc);dd=Wr(dd,mm)}if("collapsed"in b&&b.collapsed||"htmlText"in b&&b.htmlText==""){if(Xr!==i){a=Xr;Xr=i}if(Yr!==i){f=Yr;Yr=i}if(Zr!==i){h=Zr;Zr=i}if($r!==i){A=$r;$r=i}if(as!==i){D=as;as=i}if(bs!==i){L=bs;bs=i}if(cs!==i){T=cs;cs=i}}else cs=as=bs=$r=Zr=Yr=Xr=i;if(t&&!s){if(!k&&!m&&!p)l=g}else if(!t&&s)if(!k&&!m&&!l)p=g;editUI.V.eb($.Rl,a);editUI.V.eb($.Sl,f);editUI.V.eb($.Ul,h);editUI.V.eb($.Ko,k);editUI.V.eb($.Lo,l);editUI.V.eb($.Jo,m);editUI.V.eb($.Mo,p);editUI.V.eb($.Oo,
N);editUI.V.eb($.Qo,K);editUI.V.eb("w-textStyle",A);editUI.V.eb("w-fontName",L);editUI.V.eb("w-fontSize",D);editUI.V.eb($.qt,Qe);editUI.V.eb($.Ho,T);if(H("isbidion")){editUI.V.eb($.rt,s);editUI.V.eb($.SA,t)}editUI.X.eb("P",vj);editUI.X.eb("H1",wj);editUI.X.eb("H2",ph);editUI.X.eb("H3",qh);editUI.X.eb("H4",xj);editUI.X.eb("H5",yj);editUI.X.eb("H6",dd);editUI.V.blur();editUI.X.blur();editUI.$d.rd(i);H("enable_toc")==g&&rr()}}}function Wr(a,b){return a==i?b:a==b?b:j}
var Xr=i,Yr=i,Zr=i,$r=i,as=i,bs=i,cs=i;function gq(a){if(!a)return i;if(hq(a,"body")||hq(a,"p")||hq(a,"div")||hq(a,"td")||hq(a,"pre")||hq(a,"ol")||hq(a,"ul")||hq(a,"dl")||hq(a,"th")||hq(a,"h1")||hq(a,"h2")||hq(a,"h3")||hq(a,"h4")||hq(a,"h5")||hq(a,"h6")||hq(a,"blockquote")||hq(a,"address"))return a;return gq(a.parentNode)}var ds=j;
function Dr(a){if(!(a&&window.LIMITED_EDITING))if(a){ds=g;Nd("doclangcode");Sr=g;(new le(i,g,g)).send()}else{ds=j;if(y)var b=X.pageXOffset,c=X.pageYOffset;Qr(i);Sr=j;y&&X.scrollTo(b,c)}}function Er(a){if(ds)if(a)ds=j;else window.setTimeout(function(){Dr(j)},3E3)}o("CorrectSpelling",Fq,void 0);o("PasteHtmlSnippet",Vr,void 0);o("WebKitContextMenu",lr,void 0);function es(a){this.D=a;a=z?"propertychange":E&&a.tagName=="TEXTAREA"&&!Cd("531")?"keypress":"input";this.oX=U(this.D,a,this)}w(es,Og);es.prototype.handleEvent=function(a){a=a.kc;if(a.type=="propertychange"&&a.propertyName=="value"||a.type=="input"||a.type=="keypress"){if(z||y){var b=a.srcElement;if(b!=Fe(b).activeElement)return}a=new eg(a);a.type="input";try{this.dispatchEvent(a)}finally{a.p()}}};es.prototype.k=function(){es.c.k.call(this);Eg(this.oX);delete this.D};function fs(){}w(fs,bi);ga(fs);n=fs.prototype;n.le=function(){return"button"};n.Nl=function(a,b,c){if(B)b==16?Oh(a,"pressed",c):fs.c.Nl.call(this,a,b,c)};n.o=function(a){var b=fs.c.o.call(this,a),c=a.wf();c&&this.oj(b,c);(c=a.Ya())&&this.jb(b,c);a.xd(16)&&this.Nl(b,16,j);return b};n.Aa=function(a,b){b=fs.c.Aa.call(this,a,b);a.c1(this.Ya(b));a.As(this.wf(b));a.xd(16)&&this.Nl(b,16,j);return b};n.Ya=fa;n.jb=fa;n.wf=function(a){return a.title};n.oj=function(a,b){if(a)a.title=b||""};n.Z=function(){return"goog-button"};function gs(){}w(gs,fs);ga(gs);n=gs.prototype;n.le=function(){};n.o=function(a){this.WK(a);return a.G().o("button",{"class":this.rf(a).join(" "),disabled:!a.W(),title:a.wf()||"",value:a.Ya()||""},a.fk()||"")};n.Qc=function(a){return a.tagName=="BUTTON"||a.tagName=="INPUT"&&(a.type=="button"||a.type=="submit"||a.type=="reset")};n.Aa=function(a,b){this.WK(a);b.disabled&&I(b,this.Nm(1));return gs.c.Aa.call(this,a,b)};n.se=function(a){a.Qa().g(a.b(),"click",a.If)};n.$n=fa;n.wl=fa;n.tg=function(a){return a.W()};
n.hd=fa;n.Zd=function(a,b,c){gs.c.Zd.call(this,a,b,c);if((a=a.b())&&b==1)a.disabled=c};n.Ya=function(a){return a.value};n.jb=function(a,b){if(a)a.value=b};n.Nl=fa;n.WK=function(a){a.uz(j);a.a0(255,j);a.we(32,j)};function hs(a,b,c){fi.call(this,a,b||gs.Fa(),c)}w(hs,fi);n=hs.prototype;n.Ya=function(){return this.Sf};n.jb=function(a){this.Sf=a;this.ha.jb(this.b(),a)};n.c1=function(a){this.Sf=a};n.wf=function(){return this.zo};n.oj=function(a){this.zo=a;this.ha.oj(this.b(),a)};n.As=function(a){this.zo=a};n.k=function(){hs.c.k.call(this);delete this.Sf;delete this.zo};n.Ua=function(){hs.c.Ua.call(this);if(this.xd(32)){var a=this.Ub();a&&this.Qa().g(a,"keyup",this.uk)}};
n.uk=function(a){if(a.keyCode==13&&a.type=="key"||a.keyCode==32&&a.type=="keyup")return this.If(a);return a.keyCode==32};Zh("goog-button",function(){return new hs(i)});function is(){}w(is,fs);ga(is);n=is.prototype;n.o=function(a){var b={"class":"goog-inline-block "+this.rf(a).join(" "),title:a.wf()||""};return a.G().o("div",b,this.lm(a.La,a.G()))};n.xa=function(a){return a&&a.firstChild.firstChild};n.lm=function(a,b){return b.o("div","goog-inline-block "+(this.Z()+"-outer-box"),b.o("div","goog-inline-block "+(this.Z()+"-inner-box"),a))};n.Qc=function(a){return a.tagName=="DIV"};
n.dG=function(a,b){if((b=a.G().ti(b))&&b.className.indexOf(this.Z()+"-outer-box")!=-1)if((a=a.G().ti(b))&&a.className.indexOf(this.Z()+"-inner-box")!=-1)return g;return j};n.Aa=function(a,b){js(b,g);js(b,j);this.dG(a,b)||b.appendChild(this.lm(b.childNodes,a.G()));I(b,"goog-inline-block",this.Z());return is.c.Aa.call(this,a,b)};n.Z=function(){return"goog-custom-button"};
function js(a,b){if(a)for(var c=b?a.firstChild:a.lastChild,d;c&&c.parentNode==a;){d=b?c.nextSibling:c.previousSibling;if(c.nodeType==3){var f=c.nodeValue;if(Ba(f)=="")a.removeChild(c);else{c.nodeValue=b?Ca(f):f.replace(/[\s\xa0]+$/,"");break}}else break;c=d}};function ks(){}w(ks,is);ga(ks);ks.prototype.Z=function(){return"goog-toolbar-button"};function ls(a,b,c){hs.call(this,a,b||ks.Fa(),c)}w(ls,hs);Zh("goog-toolbar-button",function(){return new ls(i)});function ms(){}w(ms,is);ga(ms);if(B)ms.prototype.hb=function(a,b){var c=ms.c.xa.call(this,a&&a.firstChild);c&&Ze(this.createCaption(b,J(a)),c)};ms.prototype.xa=function(a){a=ms.c.xa.call(this,a&&a.firstChild);if(B&&a&&a.__goog_wrapper_div)a=a.firstChild;return a};ms.prototype.Aa=function(a,b){var c=He("*","goog-menu",b)[0];if(c){Q(c,j);Fe(c).body.appendChild(c);var d=new pi;d.Aa(c);a.Fg(d)}return ms.c.Aa.call(this,a,b)};
ms.prototype.lm=function(a,b){return ms.c.lm.call(this,[this.createCaption(a,b),this.tP(b)],b)};ms.prototype.createCaption=function(a,b){return ns(a,this.Z(),b)};function ns(a,b,c){return c.o("div","goog-inline-block "+(b+"-caption"),a)}ms.prototype.tP=function(a){return a.o("div","goog-inline-block "+(this.Z()+"-dropdown"),"\u00a0")};ms.prototype.Z=function(){return"goog-menu-button"};function os(a,b,c,d){hs.call(this,a,c||ms.Fa(),d);this.we(64,g);b&&this.Fg(b);this.Ib=new qi(500)}w(os,hs);n=os.prototype;n.wB=g;n.$y=j;n.ix=j;n.Ua=function(){os.c.Ua.call(this);this.N&&this.ap(this.N,g);Oh(this.b(),"haspopup","true")};n.tb=function(){os.c.tb.call(this);if(this.N){this.Cb(j);this.N.tb();this.ap(this.N,j);var a=this.N.b();a&&P(a)}};n.k=function(){os.c.k.call(this);if(this.N){this.N.p();delete this.N}this.Ib.p()};
n.qg=function(a){os.c.qg.call(this,a);if(this.Ne()){this.Cb(!this.isOpen());this.N&&this.N.Dh(this.isOpen())}};n.Di=function(a){os.c.Di.call(this,a);this.N&&!this.Ne()&&this.N.Dh(j)};n.If=function(){this.setActive(j);return g};n.aU=function(a){this.N&&this.N.ga()&&!this.lf(a.target)&&this.Cb(j)};n.lf=function(a){return a&&df(this.b(),a)||this.N&&this.N.lf(a)||j};
n.uk=function(a){if(a.type!=(a.keyCode==32?"keyup":"key"))return j;if(this.N&&this.N.ga()){var b=this.N.sd(a);if(a.keyCode==27){this.Cb(j);return g}return b}if(a.keyCode==40||a.keyCode==38||a.keyCode==32){this.Cb(g);return g}return j};n.dn=function(){this.Cb(j)};n.GU=function(){this.Ne()||this.Cb(j)};n.rd=function(a){this.ix||this.Cb(j);os.c.rd.call(this,a)};n.R=function(){this.N||this.Fg(new pi(this.G()));return this.N||i};
n.Fg=function(a){var b=this.N;if(a!=b){if(b){this.Cb(j);this.va&&this.ap(b,j);delete this.N}if(a){this.N=a;a.Mf(this);a.z(j);a.ll(this.ix);this.va&&this.ap(a,g)}}return b};n.oa=function(a){this.R().kb(a,g)};n.Og=function(a,b){this.R().Wf(a,b,g)};n.ue=ba(12);n.ng=function(a){return this.N?this.N.mc(a):i};n.lk=function(){return this.N?this.N.ne():0};n.z=function(a,b){(a=os.c.z.call(this,a,b))&&!this.ga()&&this.Cb(j);return a};n.F=function(a){os.c.F.call(this,a);this.W()||this.Cb(j)};n.iL=function(){this.Cb(g)};
n.Cb=function(a){os.c.Cb.call(this,a);if(this.N&&this.Ke(64)==a){if(a){this.N.va||this.N.db();this.mM=Jf(this.b());this.YB=Qf(this.b());this.eJ();this.N.Xc(-1)}else{this.setActive(j);this.N.Dh(j);if(this.Kr!=i){this.Kr=undefined;var b=this.N.b();b&&Of(b,"","")}}this.N.z(a);this.JN(a)}};
n.eJ=function(){var a=this.wB?5:7;a=new Kh(this.b(),a,!this.$y,this.$y);var b=this.N.b();if(!this.N.ga()){b.style.visibility="hidden";Q(b,g)}if(!this.Kr&&this.$y)this.Kr=Pf(b);a.Ga(b,this.wB?4:6,i,this.Kr);if(!this.N.ga()){Q(b,j);b.style.visibility="visible"}};n.SY=function(){var a=Qf(this.b()),b=Jf(this.b()),c;c=this.YB;c=c==a?g:!c||!a?j:c.left==a.left&&c.width==a.width&&c.top==a.top&&c.height==a.height;if(!c||!wf(this.mM,b)){this.YB=a;this.mM=b;this.eJ()}};
n.ap=function(a,b){var c=this.Qa();b=b?c.g:c.Da;b.call(c,a,"action",this.dn);b.call(c,a,"highlight",this.ww);b.call(c,a,"unhighlight",this.Fw)};n.ww=function(a){Oh(this.b(),"activedescendant",a.target.b().id)};n.Fw=function(){this.N.mg()||Oh(this.b(),"activedescendant","")};n.JN=function(a){var b=this.Qa(),c=a?b.g:b.Da;c.call(b,this.G().M(),"mousedown",this.aU,g);this.ix&&c.call(b,this.N,"blur",this.GU);c.call(b,this.Ib,"tick",this.SY);a?this.Ib.start():this.Ib.stop()};Zh("goog-menu-button",function(){return new os(i)});function ps(){}w(ps,ms);ga(ps);ps.prototype.Z=function(){return"goog-toolbar-menu-button"};function qs(a,b,c,d){os.call(this,a,b,c||ps.Fa(),d)}w(qs,os);Zh("goog-toolbar-menu-button",function(){return new qs(i)});function kj(){}
var rs={dl_1st_email:3E3,dl_1st_share:3001,load_tab_view:3002,load_tab_edit:3003,load_tab_revlist:3004,load_tab_revcomp:3005,load_tab_revbrowse:3006,load_tab_share:3008,load_tab_publish:3009,doc_load_5k:3010,"doc_load_5k_1-3img":3011,doc_load_5k_4x_img:3012,doc_load_10k:3013,"doc_load_10k_1-3img":3014,doc_load_10k_4x_img:3015,doc_load_20k:3016,"doc_load_20k_1-3img":3017,doc_load_20k_4x_img:3018,doc_load_50k:3019,"doc_load_50k_1-3img":3020,doc_load_50k_4x_img:3021,doc_load_100k:3022,"doc_load_100k_1-3img":3023,
doc_load_100k_4x_img:3024,doc_load_250k:3025,"doc_load_250k_1-3img":3026,doc_load_250k_4x_img:3027,doc_load_500k:3028,"doc_load_500k_1-3img":3029,doc_load_500k_4x_img:3030,click_to_load_5k:3031,"click_to_load_5k_1-3img":3032,click_to_load_5k_4x_img:3033,click_to_load_10k:3034,"click_to_load_10k_1-3img":3035,click_to_load_10k_4x_img:3036,click_to_load_20k:3037,"click_to_load_20k_1-3img":3038,click_to_load_20k_4x_img:3039,click_to_load_50k:3040,"click_to_load_50k_1-3img":3041,click_to_load_50k_4x_img:3042,
click_to_load_100k:3043,"click_to_load_100k_1-3img":3044,click_to_load_100k_4x_img:3045,click_to_load_250k:3046,"click_to_load_250k_1-3img":3047,click_to_load_250k_4x_img:3048,click_to_load_500k:3049,"click_to_load_500k_1-3img":3050,click_to_load_500k_4x_img:3051,html_load_5k:3052,"html_load_5k_1-3img":3053,html_load_5k_4x_img:3054,html_load_10k:3055,"html_load_10k_1-3img":3056,html_load_10k_4x_img:3057,html_load_20k:3058,"html_load_20k_1-3img":3059,html_load_20k_4x_img:3060,html_load_50k:3061,"html_load_50k_1-3img":3062,
html_load_50k_4x_img:3063,html_load_100k:3064,"html_load_100k_1-3img":3065,html_load_100k_4x_img:3066,html_load_250k:3067,"html_load_250k_1-3img":3068,html_load_250k_4x_img:3069,html_load_500k:3070,"html_load_500k_1-3img":3071,html_load_500k_4x_img:3072,js_load:3073,js_parse:3074,js_loadparse:3075,js_execute:3076,dl_BlogSettings:3077,dl_Britannica:3078,dl_ChangeCell:3079,dl_ChangeColumn:3080,dl_ChangeList:3081,dl_ChangeRow:3082,dl_CSSEdit:3083,dl_CommentSettings:3084,dl_DocSettings:3085,dl_EditHtmlSelection:3086,
dl_EmailDocument:3087,dl_EmailMsg:3088,dl_FindReplace:3089,dl_InsertBookmark:3090,dl_InsertChar:3091,dl_InsertImage:3092,dl_InsertLink:3093,dl_InsertTable:3094,dl_MiscTextBox:3095,dl_PrintSettings:3096,dl_TocSettings:3097,dl_WordCount:3098,gears_click_to_load_local:3099,gears_click_to_load_fullsync:3100,gears_html_load_local:3101,gears_html_load_fullsync:3102,newdoc:3103,copydoc:3104,publish:3105,update_collaborators:3106,send_email:3107,doc_load:3108,click_to_load:3109,html_load:3110,css_load:3111,
click_to_html:3112,blocking_save:3113,make_editable:3114,load_dialogs:3115,print:3116,click_to_doc_readable:3117,click_to_doc_readable_5k:3118,"click_to_doc_readable_5k_1-3img":3119,click_to_doc_readable_5k_4x_img:3120,click_to_doc_readable_10k:3121,"click_to_doc_readable_10k_1-3img":3122,click_to_doc_readable_10k_4x_img:3123,click_to_doc_readable_20k:3124,"click_to_doc_readable_20k_1-3img":3125,click_to_doc_readable_20k_4x_img:3126,click_to_doc_readable_50k:3127,"click_to_doc_readable_50k_1-3img":3128,
click_to_doc_readable_50k_4x_img:3129,click_to_doc_readable_100k:3130,"click_to_doc_readable_100k_1-3img":3131,click_to_doc_readable_100k_4x_img:3132,click_to_doc_readable_250k:3133,"click_to_doc_readable_250k_1-3img":3134,click_to_doc_readable_250k_4x_img:3135,click_to_doc_readable_500k:3136,"click_to_doc_readable_500k_1-3img":3137,click_to_doc_readable_500k_4x_img:3138,click_to_doc_loaded:3139,generate_delta:3140,shadow_iframe_delta:3141,post_editor_contents:3142,post_editor_completion:3143,parse_rdc_response:3144,
cursor_capture:3145,apply_fugu_update:3146,update_innerhtml:3147,normalize_body_node:3148,cursor_restore:3149,update_revision_info:3150,rdc_xhr:3151,findbar_find:3152,findbar_replace:3153,findbar_replaceall:3154},ss={click_to_doc_readable:"aft",click_to_doc_loaded:"prt",click_to_load:"pst"},ts={},us=j,vs=window.jstiming?window.jstiming.load:i,ws=i;function lj(a){if(xs()){var b={start:v(),Qd:i,Ut:i};ts[a]||(ts[a]=[]);for(var c=0;c<ts[a].length;c++)ts[a][c].Qd||ts[a].splice(c,1);ts[a].push(b)}}
function ys(a){xs()&&delete ts[a]}function Fi(a,b){if(xs()){var c=v();if(ts[a]&&ts[a].length)for(var d=0;d<ts[a].length;d++){var f=ts[a][d];if(!f.Qd){f.Qd=c-f.start;if(f.Qd<=0||f.Qd>12E4){ts[a].splice(d,1);break}if(b)f.Ut=b;break}}}}function zs(a,b,c,d,f){if(!(!xs()||b==i||c==i)){var h=c-b;if(!(h<=0||h>12E4)){b={start:b,Qd:h,Ut:d};ts[a]||(ts[a]=[]);ts[a].push(b);if(f&2&&vs)vs.tick(ss[a]||a,i,c);f&1&&ws&&ws.tick(a,i,c)}}}
function gr(){if(xs()){if(!us){var a=window,b={},c=G("csi_experiment_id");if(c)b.e=c;c=a.location.protocol=="https:"?"https://gg.google.com/csi":i;a=a.urchinPage?a.urchinPage.substring(1):"";if(vs){vs.name=a;window.jstiming.report(vs,b,c)}if(ws){var d=window.jstiming.pt;window.jstiming.pt=0;b.srt=0;ws.name=a;window.jstiming.report(ws,b,c);window.jstiming.pt=d}us=g}window.setTimeout(gr,6E5);b=[];c=[];a=[];d=/^(click_to_load|doc_load|html_load|click_to_doc_readable)/;for(var f in ts){if(f)for(var h=
ts[f],k=0;k<h.length;k++)if(h[k].Qd){var l=f+(h[k].Ut||""),m=h[k].Qd;As(l,m,b,c,a);var p=l.match(d);p&&p[0]!=l&&As(p[0],m,b,c,a)}delete ts[f]}if(b.length!=0){bh("report_timing",{names:b.join(","),values:c.join(","),events:Gb(a)});try{if(H("x10latency")&&typeof _gat!="undefined"){var t=G("urchinid"),s=_gat._getTracker(t)._createEventTracker("TimeTracker");f=[0,10,25,50,100,250,500,1E3,2500,5E3,1E4];var A=Math.floor(b.length*Math.random()),D=b[A],L=c[A],N;for(k=1;k<f.length;k++)if(L<f[k]){N=f[k-1]+
"-"+(f[k]-1);break}N||(N=f[k-1]+"+");s._trackEvent(N,D,L)}}catch(K){}}}}function As(a,b,c,d,f){c.push(encodeURIComponent(a));d.push(b);(a=rs[a])&&f.push({eC:a,cT:b})}function xs(){return H("client_latency_stats")}
function Bs(a,b,c){var d=window.TIME_pagestart,f=v();try{var h,k=a.body.innerHTML.length*2,l="_500k";if(k<5E3)l="_5k";else if(k<1E4)l="_10k";else if(k<2E4)l="_20k";else if(k<5E4)l="_50k";else if(k<1E5)l="_100k";else if(k<25E4)l="_250k";var m=a.images.length;if(m>3)l+="_4x_img";else if(m>=1)l+="_1-3img";h=l;var p=c||window.opener;if(p){var t;c=a=j;var s=b.split(":")[1];try{if(s=="1"&&Hd()!=Nd("parentid")&&p.WritelyCopyStart){t=p.WritelyCopyStart;c=!!t}else if(p.newDoclist){var A=p.getCreationTime,
D=p.getStartLoadTime;if(s=="0"&&A){t=A();a=!!t}else if(D)t=D(Hd())}}catch(L){}if(t){if(t.getTime)t=t.getTime();ws=new window.jstiming.Timer(t);if(a||c)zs(a?"newdoc":"copydoc",t,f,i,1);else{zs("click_to_html",t,d,i,1);zs("click_to_load",t,f,h,3);zs("click_to_doc_readable",t,window.TIME_doc_load_stop,h,3);zs("click_to_doc_loaded",t,window.TIME_doc_load_full,i,3)}}}zs("html_load",d,f,h,2);zs("doc_load",window.TIME_doc_load_start,window.TIME_doc_load_full,h);var N=window.TIME_loading,K=window.TIME_loaded,
M=window.TIME_jslstart,T=window.TIME_exstart,Qe=window.TIME_exfinish;if(N&&K&&T){zs("js_load",N,K);zs("js_parse",K,T)}else M&&T&&zs("js_loadparse",M,T);zs("js_execute",T,Qe);zs("css_load",d,window.TIME_cssload)}catch(Rf){rce("recordLoadTimings",Rf.message)}}var Nr={};function Cs(a,b){Nr[a]=b}function Or(a){var b=1;if(typeof Nr[a]=="number")b+=Nr[a];Nr[a]=b};function Ds(a,b,c,d,f,h,k,l){this.qa=void 0;this.Cm=a;this.dh=b;this.g(c||new es(O("findtext")),"input",u(this.Gg,this,""));this.zp("findnext",this.dk,f);this.zp("replace",this.SJ,h);this.zp("replaceall",this.Jy,k);this.zp("findclose",this.bq,l);this.Xk=d||ei(O("findoptions"));this.g(this.Xk.R().C("m-findprevious"),"action",u(this.sz,this));this.g(this.Xk,"action",this.ij,j,this);this.g(new Rh(O("editor-findbar")),"key",this.JF,j,this);this.g(O("editor-findbar"),"keydown",this.JF,j,this);this.DK("findtext",
this.dk);this.DK("replacetext",this.SJ);$f(O("findwhat"),g);$f(O("replacewith"),g);this.g(O("regexhelplink"),["mousedown","mouseup","click"],this.NU,j,this);this.fR=Bq;this.Qe=j;this.rn=B&&ab(Ad,"1.9")==-1;this.sz()}w(Ds,V);n=Ds.prototype;n.Yc=function(){this.Hs(g);this.ij()};n.hide=function(){this.bq()};n.ZQ=function(){this.Hs(g);this.tz(j);this.dk()};n.bR=function(){this.Hs(g);this.tz(g);this.dk()};n.nU=function(){this.dk();return g};n.ga=function(){return this.Qe};
n.NU=function(a){this.ij();a.type=="mousedown"&&Pp(a.target);a.stopPropagation();a.preventDefault()};n.JF=function(a){var b=i;if(md&&!this.rn?a.metaKey:a.ctrlKey)switch(a.keyCode){case 70:b=function(){this.bq()};break;case 71:b=function(){this.tz(a.shiftKey);this.dk()};break}else switch(a.keyCode){case 27:b=function(){this.bq()};break}if(b){if(!(a instanceof Wh)||a.repeat&&B)b.call(this);a.preventDefault()}};n.tz=function(a){this.Xk.R().C("m-findprevious").zc(a);this.sz()};
n.DK=function(a,b){this.g(new Rh(O(a)),"key",function(c){if(c.keyCode==13){b.call(this);c.preventDefault()}},j,this)};n.Hs=function(a){if(this.Qe!=a){yf(O("editor-findbar"),"display",a?"block":"none");this.Qe=a}};n.ij=function(){var a=O("findtext");window.focus();a.focus();a.select();this.dh.hi=j};n.zp=function(a,b,c){this.g(c||ei(O(a)),"action",u(b,this))};n.Gg=function(a){var b=O("findnotfound");kf(b,a);Q(b,a!="")};n.Nz=function(){this.Gg("No matches found");this.ij()};
n.lL=function(a){this.Gg(a==1?"Reached end of document, continued from top":"Reached start of document, continued from bottom")};n.sz=function(){var a="Find the next instance of the text. ("+((md&&!this.rn?"\u2318":"Ctrl+")+"G)"),b="Find the previous instance of the text. ("+((md&&!this.rn?"\u21e7\u2318":"Ctrl+Shift+")+"G)"),c=this.Xk.R().C("m-findprevious").Bf();kf(O("findnextlabel"),c?"Find previous":"Find next");O("findnext").setAttribute("title",c?b:a)};
n.Uv=function(a){var b=new this.fR(this.Cm);b.R0(a);var c=this.Xk.R(),d=c.C("m-findprevious").Bf();a=c.C("m-regexp").Bf();var f=c.C("m-matchcase").Bf();c=c.C("m-matchword").Bf();d=d?0:1;var h=O("findtext").value;if(h==""){this.Gg("Please enter some text to find.");this.ij();return i}if(a&&(new RegExp(h)).test("")){this.Gg("Regular expression cannot match the empty string.");this.ij();return i}a=new Cq(h,a,f,c);f=O("replacetext").value;return{Hm:b,direction:d,bz:a,QJ:f}};
n.dk=function(){lj("findbar_find");this.gw(function(a){if(a=this.Uv(a)){var b=a.Hm.YQ(a.direction,a.bz);if(b){a.Hm.ht?this.lL(a.direction):this.Gg("");this.fz(b,j)}else this.Nz()}Fi("findbar_find")})};n.SJ=function(){lj("findbar_replace");this.gw(function(a){if(a=this.Uv(a)){var b=a.Hm.replace(a.direction,a.bz,a.QJ);if(b){a.Hm.ht?this.lL(a.direction):this.Gg("");this.fz(b,g)}else this.Nz()}Fi("findbar_replace")})};
n.Jy=function(){lj("findbar_replaceall");this.gw(function(a){if(a=this.Uv(a))if(a=a.Hm.Iy(a.bz,a.QJ)){this.Gg("Occurrences replaced: "+a.gY);this.fz(a.hX,g)}else this.Nz();Fi("findbar_replaceall")})};n.gw=function(a){var b=u(function(){var c=this.dh.pb;c.cl();a.call(this,c.O())},this);if(z){this.dh.hi=g;this.dh.focus();si(b,0)}else b()};n.fz=function(a,b){b&&this.dh.fa();a.select();this.dh.Ta();a=this.dh.pb;a.cl();a=a.Um(g).start.y;b=Me(this.Cm).height;this.Cm.scrollTo(0,a-Math.floor(b*2/3));z||this.ij()};
n.bq=function(){this.Gg("");this.Hs(j);this.dh.focus()};n.k=function(){Ds.c.k.call(this);this.Xk.p()};function Es(){this.Sb="";this.Qn={}}
Es.prototype.eZ=function(a,b){if(a==i||b||typeof a.responseText!="string"||a.responseText.charAt(0)!="("){if(a==i)Or("error_network_null_req");else if(b)Or("error_network_timeout");else if(typeof a.responseText=="undefined")Or("error_network_undefined");else if(typeof a.responseText!="string"){Or("error_network_bad_type");Nr.error_network_type=typeof a.responseText}else a.responseText.charAt(0)!="("&&Or("error_network_bad_response");a!=i&&Cs("error_network_xhr_status",a.status);this.Sb="error_network"}else{b=
i;try{lj("parse_rdc_response");b=eval(a.responseText);Fi("parse_rdc_response")}catch(c){if(a.responseText.indexOf("self.lm_skeyphrase='")>=0||a.responseText.indexOf('<script src="http://local.ptron/WindowOpen.js">')>=0||a.responseText.indexOf("www.srch-results.com/lm")>=0||a.responseText.indexOf("http://www.qklinkserver.com/lm")>=0)this.Sb="error_firewall";else{Or("error_network_parse");this.Sb="error_network"}return}if(b){a=b.status;if(a.indexOf("error")==0)this.Sb=a;this.Qn=b}else{Or("error_network_null_resp");
this.Sb="error_network"}}};Es.prototype.la=function(a){return this.Qn?this.Qn[a]:i};function ar(a,b,c){this.zx=a;this.Ni=b||0;this.qa=c;this.Oc=u(this.Vj,this)}w(ar,ag);n=ar.prototype;n.nc=0;n.k=function(){ar.c.k.call(this);this.stop();delete this.zx;delete this.qa};n.start=function(a){this.stop();this.nc=si(this.Oc,a!==undefined?a:this.Ni)};n.stop=function(){this.Ne()&&ti(this.nc);this.nc=0};n.hR=function(){this.stop();this.Vj()};n.pi=function(){this.Ne()&&this.hR()};n.Ne=function(){return this.nc!=0};n.Vj=function(){this.nc=0;this.zx&&this.zx.call(this.qa)};function le(a,b,c,d){this.uu=u(this.bi,this,a);this.PZ=b;this.Vb=c;this.cs=0;this.sy=this.yH=-1;this.Nn=this.bj="";this.tj=this.mf=j;this.VJ=d||i;this.gE=Sr}w(le,ag);var Fs=j,Gs=0,Hs=0;le.prototype.k=function(){le.c.k.call(this);this.uu=i};var Is=-1*(new Date).getTimezoneOffset();n=le.prototype;n.bi=function(a){$g();this.p();a&&a()};n.ZO=function(){this.bj=vb.Ph();this.mf=ub(this.bj);var a=Wd();this.tj=Cb(a)!=Cb(mb)};n.KW=function(){return this.mf||this.tj||this.PZ||this.gE};
n.EP=function(){var a=new Mc;if(this.mf){var b=this.wS();if(b){a.u("contentIsDelta",g);a.u("delta",b);(b=ob)&&a.u("deltaParentOutboundHash",b)}else a.u("docContents",this.bj)}a.u("revisionID",lb);this.VJ&&a.u("type",this.VJ);Sr&&a.u("sp",g);this.gE&&a.u("forceNewContent",g);a.u("gears",IS_GEARS?1:0);return a};
n.FP=function(){var a=new Tc("RawDocContents");a.$("action","store");a.$("justBody",g);a.$("docID",Hd());if(this.tj){a.$("storeTitle",g);a.$("docTitle",this.Nn)}this.Vb&&a.$("initiatedByUser",g);var b;if((b=Id())&&!b.he)b=b.S4(Hd());else{b=new Md(WritelyDocVars.sessionEditToken,parseInt(WritelyDocVars.sessionPostbackCount,10));if(b.FW())WritelyDocVars.sessionEditToken=b.NL;WritelyDocVars.sessionPostbackCount=b.Kb();b=b}a.$("tok",b.NL);a.$("ct",b.Kb());a.$("tzo",Is);a.$("strip",!!y);for(var c in Nr){a.$("stats",
Gb(Nr));break}if(H("impression_tracking")){c=nn();if(c.jV()){b=c.mT();a.$("app",3);a.$("subapp",1);a.$("impressions",b);c.clear()}}return a};n.fM=function(){tb=Math.max(this.sy,tb);kb().O0(j)};n.G_=function(){if(this.tj||this.mf)window.offline.T4(this.bj,this.Nn,u(this.fM,this))};
n.oR=function(){var a=X.document.getElementsByTagName("body");if(a.length>1){var b=a[0];a=$b(a);a=dc(a,1);Nb(a,function(c){var d=$b(c.childNodes);Nb(d,function(f){b.appendChild(f)});P(c)});rce("fixupMultipleBodyTags_","Multiple body tags found in document",lb)}};
n.send=function(){if(!wp()){this.p();rce("RdcRequest.send","called when not in editor");return j}try{lj("post_editor_contents");if(this.Vb){Js=i;lj("blocking_save")}this.oR();var a=IS_GEARS&&window.offline.SW();this.ZO();var b=this.KW();kb().NK(b,j);if(!b){this.uu();return j}b=j;if((H("client_adds_ids")||H("fine_grained_update"))&&!x.Zc.hG()){x.ae(Mq.Aj);x.ae(Mq.Uf);a:{for(var c=X.document.body,d=c.firstChild||c,f={},h=j,k="",l=0,m=[c],p=0;d!=c;){if(!h)if(d.nodeType==1){if(d.id)if(f[d.id])d.id="";
else f[d.id]=g;if(!d.id){if(k){var t=String(l++)+k,s=Xi(t);if(s!=t)k=s}else k=s=Xi();d.id=s;f[d.id]=g;p++;if(p>500){b=g;break a}}}if(!h&&d.firstChild){z&&m.push(d);d=d.firstChild}else if(d.nextSibling){d=d.nextSibling;h=j}else{if(z&&m.pop()!==d.parentNode){rce("Fillids IE DOM smashed");b=p>0;break a}d=d.parentNode;h=g}}b=p>0}x.Ye();x.Hh(Mq.Uf)}if(b)this.bj=vb.Ph();this.Nn=Wd();this.sy=rb;var A=this.EP(),D=this.FP();lj("rdc_xhr");Co(D,A,this.OY.bind(this),"postDocContents_"+Hd());a&&this.G_();wb=v();
ae=0;if(!H("shelly_save_model"))if(this.tj||this.mf)Zg("Saving...");Hs=0}catch(L){++Hs;Hs>=3&&me("Sorry, your changes have NOT been saved. To avoid losing your changes, copy the text to the clipboard, refresh the page, then paste the text back in the document. Please also try the troubleshooting steps in the article below:<br/><a target='_blank' href='http://docs.google.com/support/bin/answer.py?answer=157631'>http://docs.google.com/support/bin/answer.py?answer=157631</a> [2]",j,this.Vb);rce("Rdc_Send",
L)}Fi("post_editor_contents");return g};n.wS=function(){var a=nb;if(a){lj("generate_delta");var b=this.bj,c=new Hq;c.st=0.1;a=c.Tj(a,b);Fi("generate_delta");return c.qQ(a)}return i};
n.OY=function(a,b){if(this.he)rce("RdcRequest.onServerResponse","callback on disposed object");else{Fi("rdc_xhr");lj("post_editor_completion");if(wp()){var c=new Es;c.eZ(a,b);c.la("posttoken")&&Ud("posttoken",c.la("posttoken"));if(a=c.Sb)if(a=="error_cantUseDelta"||a=="error_invalidDelta"){nb="";ob=i;this.send();return}else if(this.cs==0){this.cs++;this.yH=(new Date).getTime();this.send();return}else if(this.cs==1){this.cs++;c=(new Date).getTime()-this.yH;c<2E3&&(new ar(this.send,2E3-c,this)).start();
return}else{if(!IS_GEARS||a!="error_network"){this.pg(a,c.la("exceptionHash"));$g();return}}else{Gs=0;Nr={}}IS_GEARS&&window.offline.aM(a=="error_network");this.fM();if(a!="error_network"){a=c.Qn;if(a.status.indexOf("error")!=0){b=O("CollideWarning");if(a.includesChangeFromOthers||a.editUsers.length>0){Vd("isshared",g);$d=v()}if(b!=i){b.collideString="";z&&typeof Rr!="undefined"&&X&&Rr(X);a.editUsersList&&a.editUsersList.length>0?Ks(a.editUsersList):Ls()}}vb.$M(c.Qn,this.bj,this.Nn,this.sy,this.Vb)}$q&&
$q.start();this.Vb&&Fi("blocking_save");Fi("post_editor_completion");this.uu()}else{this.p();rce("RdcRequest.onServerResponse","callback when not in editor")}}};
n.pg=function(a,b){var c=Fs;Fs=j;kb().NK(j,this.tj||this.mf);if(!(!this.mf&&!this.tj&&!this.Vb)){var d="";if(b)d="\n\nError code: "+b;Gs=a=="error_network"?Gs+1:0;switch(a){case "error_network":if(this.Vb||Gs>=2){me(this.mf?"Sorry, a network error has prevented Google Docs from saving your changes. Please try again. If the problem persists, please stop working until you are able to re-establish a network connection, as your unsaved changes may be lost. Please also try the troubleshooting steps in the help article below<br/><a target='_blank' href='http://docs.google.com/support/bin/answer.py?answer=157630'>http://docs.google.com/support/bin/answer.py?answer=157630</a>":"Sorry, a network error has prevented Google Docs from completing this operation.  Please try again.",
j,this.Vb);Gs=0}break;case "error_firewall":me("A browser extension or security product on your system is interfering with Google Docs. Please disable it and try again.",j,this.Vb);break;case "error_noperms":case "error_nowriteperms":b="You don't have permission to edit and therefore no changes will be saved to the following document:"+Ha(this.Nn);me(b,j,this.Vb);break;case "error_nologin":me("You are no longer signed in, so further changes cannot be saved.  Please open a new window, go to docs.google.com, and sign in.  Then you can return to this window and continue editing.",
j,this.Vb);break;case "error_toobig":Fs=g;if(this.Vb||!c&&!le.G4)me("Sorry this document is too large to be saved. Please try splitting the document into two documents. In the meantime,  to avoid losing your changes, please copy the most recently added text to a new document.",j,this.Vb);break;case "error_readonly":me("Sorry, but document editing is temporarily unavailable -- please try saving again in a few minutes.",j,this.Vb);break;case "error_documentDeleted":me("This document has been deleted.",
j,this.Vb);break;case "error_throttled":me("There have been too many updates to this document in the past few minutes. Your last changes were not saved. Please try again in a few minutes",j,this.Vb);break;case "error_posttoken":me("Sorry, your changes have NOT been saved. To avoid losing your changes, copy the text to the clipboard, refresh the page, then paste the text back in the document. Please also try the troubleshooting steps in the article below:<br/><a target='_blank' href='http://docs.google.com/support/bin/answer.py?answer=157631'>http://docs.google.com/support/bin/answer.py?answer=157631</a>"+
d,j,this.Vb);break;case "error_outOfOrder":me("Sorry, your changes have NOT been saved. To avoid losing your changes, copy the text to the clipboard, refresh the page, then paste the text back in the document. Please also try the troubleshooting steps in the article below:<br/><a target='_blank' href='http://docs.google.com/support/bin/answer.py?answer=157631'>http://docs.google.com/support/bin/answer.py?answer=157631</a> [100]",j,this.Vb);break;case "error_invalidArguments":b=this.mf?"An internal error has prevented Google Docs from saving your changes. The error has been logged for immediate investigation.  To avoid losing your changes, copy the text to the clipboard, refresh the page, then paste the text back in the document. Please also try the troubleshooting steps in the help article below.<br/><a target='_blank' href='http://docs.google.com/support/bin/answer.py?answer=157629'>http://docs.google.com/support/bin/answer.py?answer=157629</a>":
"An internal error has prevented Google Docs from completing this operation.  The error has been logged for immediate investigation.  We're sorry for any inconvenience.";me(b+d,j,this.Vb);break;case "error_incompleteRequest":me("Sorry, your changes have NOT been saved. To avoid losing your changes, copy the text to the clipboard, refresh the page, then paste the text back in the document. Please also try the troubleshooting steps in the article below:<br/><a target='_blank' href='http://docs.google.com/support/bin/answer.py?answer=157631'>http://docs.google.com/support/bin/answer.py?answer=157631</a> [200]",
j,this.Vb);break;default:b=this.mf?"An internal error has prevented Google Docs from saving your changes. The error has been logged for immediate investigation.  To avoid losing your changes, copy the text to the clipboard, refresh the page, then paste the text back in the document. Please also try the troubleshooting steps in the help article below.<br/><a target='_blank' href='http://docs.google.com/support/bin/answer.py?answer=157629'>http://docs.google.com/support/bin/answer.py?answer=157629</a>":
"An internal error has prevented Google Docs from completing this operation.  The error has been logged for immediate investigation.  We're sorry for any inconvenience.";me(b+d,j,this.Vb);rce("Postback error","Postback error with no corresponding client message: "+a);break}}};function Ms(a,b){this.Z3=a||"";this.l4=b||"";this.Ue=new Ns(16);this.q=new V(this)}w(Ms,Og);Ms.prototype.ld="";Ms.prototype.sx="";Ms.prototype.fX=i;Ms.prototype.gX=i;Mg("acl_change");var Os=Mg("created"),Ps=Mg("create_requested"),Qs=Mg("last_modified_change"),Rs=Mg("save_state_change"),Ss=Mg("title_change");n=Ms.prototype;n.vs=function(a){var b=this.Ue;if(!b.Sd(a)){ib(this.ir()||!b.Je(2),"Documents cannot be un-created");this.Ue=a;this.dispatchEvent(new Ts(b));return g}return j};n.ir=function(){return this.Ue.Je(2)};
n.k0=function(){this.vs(this.Ue.Ql(1,j).Ql(2,g))&&this.dispatchEvent(Os)};n.jr=function(){return this.Ue.Je(1)};n.nx=function(){return this.Ue.Je(8)};n.O0=function(a){this.vs(this.Ue.Ql(8,a))};n.gH=function(){return this.Ue.Je(4)};n.ts=function(a){this.vs(this.Ue.Ql(4,a))};n.NK=function(a,b){this.vs(this.Ue.Ql(8,a).Ql(4,b))};n.pk=function(){return this.ld};n.Ka=function(a,b){if(this.ld!=a){this.ld=a;this.dispatchEvent(new Us(Ss,!!b))}};n.zW=function(){return this.Ue.Je(16)};
n.A0=function(a,b){if(this.sx!=a){this.sx=a;this.gX=this.fX=i;this.dispatchEvent(new Us(Qs,!!b))}};n.mP=function(a){if(this.ir())a();else{this.q.GH(this,Os,Xj(a));this.jr()||this.dispatchEvent(Ps)}};n.k=function(){Ms.c.k.call(this);this.q.p()};function Us(a,b){R.call(this,a);this.WR=b}w(Us,R);function Ts(a){R.call(this,Rs);this.wZ=a}w(Ts,R);function Ns(a){this.Sf=ma(a)?a.Sf:a;ib(!this.Je(2)||!this.Je(1),"Document cannot be both creating AND created.")}Ns.prototype.Ya=function(){return this.Sf};
Ns.prototype.Je=function(a){ib((a|0)===a,"Flag must be an integer");return!!(this.Sf&a)};Ns.prototype.Ql=function(a,b){return this.Je(a)==b?this:new Ns(this.Sf^a)};Ns.prototype.Sd=function(a){return this.Sf==a.Sf};function Vs(){}w(Vs,is);ga(Vs);n=Vs.prototype;n.o=Vs.c.o;n.xa=function(a){return a&&a.firstChild&&a.firstChild.firstChild&&a.firstChild.firstChild.firstChild.lastChild};n.lm=function(a,b){var c=this.Z();return b.o("div","goog-inline-block "+(c+"-outer-box"),b.o("div","goog-inline-block "+(c+"-inner-box"),b.o("div",c+"-pos",b.o("div",c+"-top-shadow","\u00a0"),b.o("div",c+"-content",a))))};
n.dG=function(a,b){if((b=a.G().ti(b))&&b.className.indexOf(this.Z()+"-outer-box")!=-1)if((b=a.G().ti(b))&&b.className.indexOf(this.Z()+"-inner-box")!=-1)if((b=a.G().ti(b))&&b.className.indexOf(this.Z()+"-pos")!=-1)if((b=a.G().ti(b))&&b.className.indexOf(this.Z()+"-top-shadow")!=-1)if((a=a.G().XS(b))&&a.className.indexOf(this.Z()+"-content")!=-1)return g;return j};n.Z=function(){return"goog-imageless-button"};Zh("goog-imageless-button",function(){return new hs(i,Vs.Fa())});
Zh("goog-imageless-toggle-button",function(){var a=new hs(i,Vs.Fa());a.we(16,g);return a});function Ws(a){this.ie=a;this.q=new V(this);this.$F();this.q.g(this.ie,Rs,this.$F)}w(Ws,Og);var Xs=Mg("change");n=Ws.prototype;n.ya=2;n.Zm=2;n.Ib=i;n.qe=function(){return this.ya};n.aW=function(){this.ie.ir()||this.ie.mP(fa);this.rv(1)};n.$F=function(){var a;a=this.ie.gH()||!this.ie.ir()&&!this.ie.jr()?0:this.ie.nx()||this.ie.jr()?1:2;if(this.Zm!=a){this.Zm=a;this.hI()}};n.rv=function(a){if(this.ya!=a){this.ya=a;this.dispatchEvent(Xs)}this.pC();if(a!=2)this.Ib=si(this.$U,a==0?5E3:300,this)};
n.$U=function(){this.Ib=i;if(this.Zm!=this.ya)this.ya==1&&this.ie.nx()||this.hI()};n.hI=function(){if(this.Zm>this.ya)this.Ib||this.rv(this.ya==0?1:2);else this.rv(this.Zm)};n.pC=function(){this.Ib&&ti(this.Ib);this.Ib=i};n.k=function(){Ws.c.k.call(this);this.pC();this.q.p()};var Ys=Mg("text_change");function Zs(a){Qg.call(this);this.ym=a}w(Zs,Qg);n=Zs.prototype;n.k=function(){Zs.c.k.call(this);bg(this.Kh);bg(this.Ds);bg(this.k1);bg(this.Vy);bg(this.dK);delete this.Sx};n.sE=function(a){return Be(a,"goog-custom-button")?is.Fa():Vs.Fa()};n.Ou=function(a){var b=new hs(i,this.sE(a));b.Aa(a);return b};
n.Ua=function(){Zs.c.Ua.call(this);var a=this.Qa(),b=this.G();this.Kh=new fi(i,di(bi,"docs-title"));this.Kh.Aa(b.b("docs-title"));var c=b.b("docs-titlebar-share");if(c){this.Ds=new os(i,undefined,this.sE(c));this.Ds.Aa(c);this.Ds.ms(64,g)}if(c=b.b("docs-titlebar-share-action"))this.k1=this.Ou(c);if(c=b.b("docs-titlebar-save")){this.Vy=this.Ou(c);if(this.Wy=b.sf(undefined,"docs-titlebar-save-text",c)[0]){this.I_=b.jw(b.sf(undefined,"docs-titlebar-saved",c)[0]);this.J_=b.jw(b.sf(undefined,"docs-titlebar-saving",
c)[0]);this.E_=b.jw(b.sf(undefined,"docs-titlebar-savenow",c)[0])}}if(c=b.b("docs-titlebar-save-close"))this.dK=this.Ou(c);this.Sx=b.b("docs-notice");a.g(this.ym,Ss,this.gM);this.gM();this.DA?a.g(this.DA,Ys,this.yA):a.g(this.ym,Qs,this.yA);if(this.jl&&this.Wy){a.g(this.jl,Xs,this.cM);this.cM()}this.yA()};n.gM=function(){var a=this.ym.pk();if(this.Kh){a&&kf(this.Kh.b().firstChild,a);this.ym.zW()&&Ce(this.Kh.b(),"docs-title-untitled",!a)}};
n.yA=function(){if(this.Sx){var a=this.DA?this.DA.Ab():this.ym.sx;kf(this.Sx,a||"\u00a0")}};n.MQ=function(a){ib(!this.va,"Must be called before entering the document");this.jl=a};n.cM=function(){var a=this.Vy,b=this.jl.qe();this.Wy.innerHTML=b==2?this.I_:b==1?this.J_:this.E_;a.F(b==0)};n.xT=function(){return this.G().b("docs-title-pill")};var $s=Mg("StatusChangeEvent");function at(a){this.m5=a}var bt=new at(1),ct=new at(1),dt=new at(2),et=new at(3),ft=new at(3),gt=new at(4),ht=new at(4),it=new at(5);at.prototype.toString=function(){switch(this){case bt:return"IDLE";case ct:return"BUSY";case et:return"OFFLINE";case ft:return"SERVER_DOWN";case dt:return"RECOVERING";case gt:return"FORBIDDEN";case ht:return"AUTH_REQUIRED";case it:return"CLIENT_ERROR";default:return"UNKNOWN_STATE"}};function jt(a,b,c,d){if(!c){c=new Ug(b.G());b.kb(c,g)}this.DX=c;this.q=new V(this);this.ie=a;this.q.g(a,Rs,this.QU);if(d){ib(d.qe()==bt,"Net service must be idle when attached to a NetworkStatusIndicator");this.q.g(d,$s,this.KU)}this.Zy=new ar(u(this.RK,this,g),7E3)}w(jt,ag);n=jt.prototype;n.jL=j;n.Qx=i;n.QU=function(a){a=a.wZ;a=a.Je(8)||a.Je(1);var b=this.ie.nx()||this.ie.jr();if(b&&!a)this.Zy.start();else if(!b&&a){this.Zy.stop();this.RK(j)}};n.RK=function(a){this.jL=a;this.AJ()};
n.F0=function(a){this.Qx=a;this.AJ()};n.KU=function(a){this.F0(this.pT(a.R4))};
n.pT=function(a){switch(a){case dt:return"Reconnecting now...";case et:return"The Internet connection failed. Trying to reconnect...";case ft:return"The Google Docs server is unavailable.  Trying to reconnect...";case gt:return"You no longer have permission to access this document. If you believe this is an error, contact the document owner.";case ht:return"You are signed out. Refresh the page, or sign in from another tab.";case it:return"An error has occurred. Please refresh the page.";default:return i}};
n.AJ=function(){var a=i;if(this.Qx)a=this.Qx;else if(this.jL)a="Saving...";this.DX.yz(a)};n.k=function(){jt.c.k.call(this);this.Zy.p();this.q.p()};function kt(a,b,c,d,f,h,k){Jo.call(this,f,h,k);this.Ka(a);this.hb(b+"<br><br>");this.Oc=c;this.Ru=d!==undefined?d:"";U(this,"dialogselect",this.FI);a=new Lo(k);a.u("ok","OK",g);a.u("cancel","Cancel",j,g);this.We(a)}w(kt,Jo);n=kt.prototype;n.Oc=fa;n.Ru="";n.ce=i;n.$w=j;n.Uy=1;n.wp=0;
n.o=function(){kt.c.o.call(this);var a={className:this.bc+"-userInput",value:this.Ru};if(this.Uy==1){this.ce=this.G().o("input",a);this.ce.type="text";if(this.wp)this.ce.size=this.wp}else{this.ce=this.G().o("textarea",a);this.ce.rows=this.Uy;if(this.wp)this.ce.cols=this.wp}this.xa().appendChild(this.G().o("div",{style:"overflow: auto"},this.ce));this.Uy>1&&this.ac.pz(i)};n.z=function(a){Jo.prototype.z.call(this,a);if(a){this.$w=j;this.ce.value=this.Ru;y&&this.ce.focus();this.ce.select()}};
n.FI=function(a){if(!this.$w){this.$w=g;a.Wb=="ok"?si(u(this.Oc,this,this.ce.value),1):si(u(this.Oc,this,i),1)}};n.k=function(){P(this.ce);Cg(this,"dialogselect",this.FI,g,this);kt.c.k.call(this);this.ce=this.f4=i};function lt(a){var b=new kt("Rename Document","Enter a new document name:",function(c){c&&a.Ka(c)},a.pk());b.BK(g);b.z(g);I(b.b(),"docs-rename-dialog")};var Br=i;function mt(a,b,c,d){this.Cn=b;this.jl=new Ws(b);d=d||new Zs(b);c&&d.MQ(this.jl);d.Aa(O("docs-titlebar"));this.yo=d;this.Q4=c?new jt(this.Cn,Yg()):i;this.q=new V(this);a?this.q.g(d.Kh,"action",this.mJ):d.Kh.F(j);this.q.g(b,Ss,this.TY)}w(mt,ag);n=mt.prototype;n.k=function(){mt.c.k.call(this);this.q.p();this.yo.p();delete this.Cn;delete this.yo;delete this.q};n.mJ=function(){lt(this.Cn)};n.TY=function(a){Yd(this.Cn.pk());if(!a.WR){Zg();nt(fa)}};n.Y0=function(a){this.Cn.Ka(a,g)};
n.gL=function(a){var b=O("docs-doc-icon");We(b);if(a){a=Se("img","docs-doc-icon-img");a.src="images/labs_bar_icon.png";b.appendChild(a)}};function ot(a){Br=new mt(a,kb(),H("shelly_save_model"))}function pt(a){function b(d,f){d=new mi(d);d.lj(f);c.oa(d)}var c=a.R();H("enable_common_email_as_attachment")||b("Email as attachment...","senddoc");b("Send message to collaborators...","email");b("Publish as web page...","publish");b("View as web page (Preview)","preview")};function qt(a,b,c,d){var f={};if(a)f.recipient=a;if(b)f.subject=b;if(c)f.message=c;if(d)f.optionValues=d;return f};function rt(a){this.nd=a||window}var st=i;function Cr(a){if(a)return new rt(a);st||(st=new rt);return st}rt.prototype.Xv=function(){return new Tc(this.nd.location.href)};rt.prototype.ho=function(a){this.nd.location.href=String(a.toString())};rt.prototype.j_=function(a){this.nd.location.replace(String(a))};rt.prototype.reload=function(a){this.nd.location.reload(a)};function dj(){}function tt(a,b,c){this.C2=a;this.ya=b?1:0;this.YR=c}tt.prototype.ug=function(){return 1==this.ya||this.dH()};tt.prototype.dH=function(){return 2==this.ya};tt.prototype.B0=function(){return this.ya=1};tt.prototype.w0=function(){return this.ya=2};var ut=i;function fj(){if(!ut)if(typeof EditPageTab!="undefined")ut=EditPageTab;else{ut=Gd().fc("tab")||"edit";if(ut=="share")ut="edit"}return ut}function vt(){return"publish"==fj()}function wt(){return"view"==fj()}
function wp(){return"edit"==fj()}var xt=["edit","publish"],yt={edit:new tt("EditTab?docid=%DOCID%".replace("%DOCID%",encodeURIComponent(Hd())),IS_GEARS||fj()=="edit",g),publish:new tt("PublishTab?docid=%DOCID%".replace("%DOCID%",encodeURIComponent(Hd())),!IS_GEARS&&fj()=="publish",j)},zt=i,At=i,Bt=0,Ct=i;
function dr(){if(wt()){Ct=g;editUI.X=new Dt(Et);editUI.X.xV();if(H("enable_find_bar"))O("editor-findbar").style.display="none";if(H("enable_comments")||H("enable_footnotes"))Ft();Sd("isexperimental")&&H("shelly_chrome")&&Br.gL(g)}else{a:{var a=fj();if(!Ct){if(!Gt(a))if(Gt("edit"))a=ut="edit";else{rce("missing tab: "+a);break a}var b=i;if(IS_GEARS){var c=Gd().fc("userstoinvite");if(a=="share"&&c)b="&userstoinvite="+encodeURIComponent(c)}Ht(a,b);document.body.style.overflow="hidden";if(wp())if(a=O("loadingDiv")){a.className=
"visibleStatus";a.style.left=a.offsetParent.clientWidth-a.clientWidth}Ct=g;window.onbeforeunload=It;if(navigator.userAgent.indexOf("MSIE")>-1)try{document.execCommand("BackgroundImageCache",j,g)}catch(d){}}}a=Gd().fc("tab");if(a=="share"){b=i;if(c=Gd().fc("userstoinvite"))b="&userstoinvite="+encodeURIComponent(c);Ht(a,b)}}}
function Jt(a){if(x){B&&x.$e(g,g);x.Uc()}de=j;rr(g);Kt();for(var b=0;b<xt.length;b++){var c=xt[b],d=Gt(c);if(d)d.style.display=c==a?"":"none"}if(a){b=yt[a];c=O("encloser");b.YR?c.setAttribute("height","100%"):c.removeAttribute("height")}if(a=="edit")O("editor-chrome").style.display="block";else O("editor-chrome").style.display="none"}
function Lt(a){var b=O("tabLoadingSpan");if(b)if(a){ze(b,"hiddenStatus","visibleStatus");a=O("tab_container");b.style.top=a.offsetTop+"px";b.style.left=a.offsetLeft+a.offsetWidth-b.offsetWidth+"px"}else ze(b,"visibleStatus","hiddenStatus")}function Mt(a){var b=!wt();if(b){var c=Sd("canedit");if(!c||"view"==a){rce("oops, we invoked old tab switching code: oldTab|newTab|canEdit="+fj()+"|"+a+"|"+c);b=j;a=Zd("ViewDoc?docid="+Hd());IS_GEARS&&offline&&!offline.he?offline.a5(a):Cr().j_(a)}}return b}
function Ht(a,b,c){if(Mt(a)){var d=fj(),f=a=="share",h;if(f){a=d=="share"?"edit":d;var k=b&&(new Uc(b)).la("userstoinvite");if(!xa(Xa(k))){h={};h.notificationInfo=qt(k)}}if(editUI.Qp)Sd("isshared")?editUI.Qp.F(g):editUI.Qp.F(j);if(window.LIMITED_EDITING&&dj.A4())Lt(j);else if(!(!c&&Bt>0))if(je("postDocContents_"+Hd())){c||(Bt=100);if(Bt>0){Bt--;window.setTimeout(function(){Ht(a,b,g)},100)}}else if(!c&&d=="edit"&&a!="edit"){Lt(g);Bt=100;nt(function(){Ht(a,b,g)})}else{Bt=0;c=new Tc(window.location);
d=c.fc("tab");k=d=="share";if(d&&d!="edit"&&a=="edit"&&!k){c.qc.remove("tab");It();window.location=c}else{ut=a;Jt(a);c=yt[a];if(c.ug()){Lt(j);c.dH()?Nt(a):Ot(a);f&&editUI.Bl.ig("invite",h)}else{var l=f?function(){editUI.Bl.ig("invite",h)}:i;window.setTimeout(function(){Pt(a,b,l)},0)}Zm().d0(wp());if(a=="edit"&&(H("enable_comments")||H("enable_footnotes")))O("wys_sidebar")&&Ft()}}}}function ej(){Pt(fj())}
function Pt(a,b,c){if(Mt(a)){Lt(g);zt&&Qt();zt=new wo;zt.Al(2E4);U(zt,["success","error","timeout"],c?function(d){Rt(d,c)}:Rt);At=a;zt.send(Ao(yt[a].C2+(b||"")));kj&&lj("load_tab_"+a)}}function Rt(a,b){var c=At;if(a.type=="success"){a=Gt(c);a.innerHTML=zt.Dq();yt[c].B0();Ot(c);St(c);b&&b();kj&&Fi("load_tab_"+c)}else{kj&&ys("load_tab_"+c);if(c!="edit"){Ht("edit");return}a=Gt(c);a.innerHTML='<b class="app">Could not load tab. Please try again.</b>'}Qt();Lt(j)}
function Tt(a,b,c,d,f){Sd("isshared")?a.F(g):a.F(j);if(H("is_newborn")||d>Rd(G("max_email_recipients"))){a.F(j);b&&b.F(j)}else b&&b.F(g);c.F(f)}
function Ut(){if(!editUI.$d){Vt.F(H("userloggedin")&&!Sd("anonymouseditor"));H("shelly_save_model")||Wt.F(g);editUI.$d=Vt;editUI.Bl=Xt;editUI.Qp=editUI.$d.R().C("email");var a=editUI.$d.R().C("senddoc"),b=editUI.$d.R().C("publish");Tt(editUI.Qp,a,b,Td("numcollaborators")+Td("numviewers"),Sd("allowchangesharing"));U(editUI.$d,"action",function(c){switch(c.target.Lb()){case "share":editUI.Bl.ig("invite");break;case "email":Yt();break;case "email_attach":Zt();break;case "senddoc":Sd("canedit")?jj(g):
nt(function(){jj(g)});break;case "publish":Ht("publish");break;case "preview":$t("");break}});editUI.fK=Wt;U(editUI.fK,"action",function(){pq(fa)});if(au){au.F(g);U(au,"action",function(){bu(au.b())})}Ar(Td("lastmodified"),Nd("lastmodifier"),j);if(Sd("isexperimental"))if(H("shelly_chrome"))Br.gL(g);else if(a=O("experimentalDoc")){b=Se("img",{src:"images/labs_bar_icon.png",border:0});Ze(b,a)}}}
function Ot(a){document.body.style.overflow=vt()?"auto":"hidden";Ut();switch(a){case "edit":editUI.X=new Dt(Et);editUI.V=new cu(du);if(H("enable_find_bar"))editUI.jg=new Ds(X,x);ee();break;case "share":shareUI.u5(g);var b=new eu(G("contactsServerBase"),"writely");b.wz(G("language"));var c=O("users_to_invite");if(c)try{b.Pt(c,{groups:g,implicitGroups:g,extendedInterface:g});O("contact_picker_link").onclick=function(k){b.vx(c,k);return j}}catch(d){}var f=Number(O("numCollaborators").innerHTML),h=Number(O("numViewers").innerHTML);
Vd("isshared",f+h>0);break;case "publish":Fi("publish");publishUI.NA();break}yt[a].w0()}function Nt(a){document.body.style.overflow=vt()?"hidden":"auto";switch(a){case "edit":ee();x&&x.Ye();break;case "publish":publishUI.NA();break}}function Gt(a){return O(a+"_tab_contents")}function Qt(){if(zt){Cg(zt,["success","error","timeout"],Rt);zt.abort();zt.p();At=zt=i}}function St(a){a=a||fj()||"edit";Gt(a).style.display=""}
function Ft(){var a=O("wys_sidebar"),b=ur||(ur=new vr);df(a,b.XB())||a.appendChild(b.XB())}function Yt(){nt(function(){editUI.Bl.ig("email")})}function Zt(){nt(function(){editUI.Bl.ig("email_attach")})}function fu(a){var b=O("fsDiv");if(b){b.style.display=a?"block":"";X&&X.focus()}}
function mq(a){var b=editUI.X.ZR;if(i!=b){var c=O("editor-chrome"),d=O("navigation");try{if(a)c.style.display=d.style.display="none";else{d.style.display=c.style.display="";b.zc(j)}fu(a);(ur||(ur=new vr)).xk()}catch(f){rce("changeFullscreen: ",f)}}}
function br(){var a=be,b=ke||Db,c=fj();if(!(a||b||c!="edit")){a=[a,b,de,c];for(var d in Bo)a.push(d);d=g;try{if(d=ub()){kb().ts(d);Jp()}}catch(f){}d&&me("Sorry, your changes have NOT been saved. To avoid losing your changes, copy the text to the clipboard, refresh the page, then paste the text back in the document. Please also try the troubleshooting steps in the article below:<br/><a target='_blank' href='http://docs.google.com/support/bin/answer.py?answer=157631'>http://docs.google.com/support/bin/answer.py?answer=157631</a> [1000]",j,
j);$q&&$q.start();rce("stale_page",a.join(","))}}var $q=i;function Ar(a,b,c,d){Vd("lastmodified",String(a));Vd("lastmodifier",String(b));$g();var f=Di(Number(a));a="Saved "+(f+(" by "+b));b="Updated "+(f+(" by "+b));f="Saved offline on "+f;c=d?f:c?a:b;kb().A0(c)}function gu(){function a(){var b=new Tc("Revs");b.qc.u("id",Hd());b.qc.u("tab","revlist");Pi();Cr().ho(b)}Fs?a():nt(a)}
function hu(){if(wp()){var a=X.document.body.innerHTML;a=gn(a);a=['<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n',Sd("fullwidtheditor")?"<html>":'<html class="pageview">','<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="SKYPE_TOOLBAR" content="SKYPE_TOOLBAR_PARSER_COMPATIBLE"><meta http-equiv="X-UA-Compatible" content="IE=7"><base target="_top"><style type="text/css">',Nd("styles"),'</style></head><body id="doc-contents"',
wp()?' class="editor"':"",">",a,"</body></html>"].join("");var b=O("wys_frame").contentWindow.document;b.open("text/html","replace");b.write(a);b.close();X=O("wys_frame").contentWindow;iu(function(){Wq(lb)})}else rce("invoking refreshWysFrame, not in editor: "+fj())}function Pi(){IS_GEARS&&window.offline.p();window.onbeforeunload=""}o("writely.EditPage",dj,void 0);o("writely.EditPage.selectTab",Ht,void 0);o("writely.EditPage.showFSHint",fu,void 0);o("writely.EditPage.inEditor",wp,void 0);function ju(a,b,c,d){this.R3=a;this.S3=b;this.p5=c;this.wO=d}function ku(a,b){switch(a){case 0:return new ju(g,g,j,b);case 1:return new ju(g,g,g,b);case 2:return new ju(g,j,g,b);case 3:default:return new ju(j,j,g,b)}};function lu(a,b,c,d,f){this.Br=a;this.nc=String(b);this.e5=c||"user";this.O4=!!d;this.x4=f||i}var mu=new Mc;lu.prototype.Lb=function(){return this.nc};function nu(a){var b=a.scopeType;if(mu.Ce(b))return mu.la(b).call(undefined,a);return new lu(a.name,a.id,a.scopeType,a.me,a.iconUrl)};function ou(a,b,c,d,f,h){lu.call(this,a,b,"domain",f,h);this.m1=d;this.g4=c}w(ou,lu);mu.u("domain",function(a){var b=a.sharingPolicy,c=b.access;return new ou(a.name,a.id,a.domainName,c!=i?ku(c,!!b.canPublishOut):new ju(!!b.canShareIn,!!b.canShareOut,!!b.showShareOutWarning,!!b.canPublishOut),a.me,a.iconUrl)});var pu=new ou("","DEFAULT","",ku(0,g),g);function qu(a,b,c,d){this.ya=a;this.r5=b;this.D_=c||0;this.c5=d!==undefined?d:g}qu.prototype.xi=function(){return this.D_};function ru(a){this.I2=a.userRole||0;this.HX=a.maxAnyoneRole!=i?a.maxDomainRole:30;this.IX=a.maxAnyoneRole!=i?a.maxDomainRole:30;this.IQ=!!a.editorsCanInvite;this.hY=a.numSharedUsers||0;this.aL=!!a.shareable;this.E2=a.userDomain||pu;var b=a.itemDomains;this.UW=Qb(ia(b)?b:[b],function(c){return c||pu});this.UQ=!!a.exportable;this.w5=a.visibilitySetting}w(ru,ag);n=ru.prototype;n.Kq=function(){return this.I2};n.Sv=function(){return this.IQ};n.Yv=function(){return this.hY};n.Jq=function(){return this.E2};
n.rq=function(){return this.UW};function su(a){a=zc(a);var b=a.userDomain;if(b)a.userDomain=nu(b);b=a.itemDomains;b=ia(b)?b:[b];a.itemDomains=Qb(b,function(c){return c?nu(c):c});if(b=a.visibilitySetting)a.visibilitySetting=new qu(b.visibilityState,b.summary,b.role,b.restrictedToDomain);return new ru(a)};function tu(){}w(tu,ag);n=tu.prototype;n.R=function(a,b,c,d,f,h){f=new pi(d,f);this.cJ(f,a,b,c,d,undefined,h);return f};n.AA=function(a,b,c,d,f,h,k,l,m,p,t,s){this.f_(a);this.cJ(a,d,f,i,t,0,s);c=k>=20;l=l>=20;p=!ka(p)||p==1;if(h)this.BA(a,g,g,l&&p,c&&p,p&&!!m,p);else b>=30?this.BA(a,j,g,j,j,p&&!!m,p):this.BA(a,j,j,j,j,p&&!!m,j)};
n.f_=function(a){for(var b=a.jS(),c=0;c<b.length;c++){var d=a.C(b[c]);switch(d.Fn){case "access":case "email":case "emailAttach":case "invite":case "link":case "separator":case "settings":a.removeChild(d,g);break}}};
n.BA=function(a,b,c,d,f,h,k){a.ke(function(l){switch(l.Fn){case "invite":b!==undefined&&l.F(b);break;case "link":if(f!==undefined||d!==undefined)l.F(f||d);break;case "access":c!==undefined&&l.F(c);break;case "settings":c!==undefined&&l.F(c);break;case "email":k!==undefined&&l.F(k);break;case "emailAttach":h!==undefined&&l.F(h);break}})};
n.cJ=function(a,b,c,d,f,h,k){b=this.Qv(b,c,f,k);if(d){b.push(new oi);b.concat(d)}ka(h)?Ob(b,function(l){a.Wf(l,h,g)}):Nb(b,function(l){a.kb(l,g)});d=a.b();Be(d,"goog-menu-noicon")&&xe(d,"goog-menu-noicon")};function uu(a,b,c,d,f,h){mi.call(this,a,d,f,h||vu||(vu=new wu));this.vG=b||i;this.rG=c||i}w(uu,mi);uu.prototype.k=function(){uu.c.k.call(this);this.rG=this.vG=i};function wu(){this.np=[]}w(wu,li);var vu=i;wu.prototype.o=function(a){var b=wu.c.o.call(this,a),c=a.G(),d=a.vG;d=c.o("span",d?{"class":[d,"goog-menuitem-icon apps-share-sprite"].join(" ")}:i);var f=a.rG,h=i;if(f)h=c.o("span",{"class":"share-menu-hint"}," "+f);this.hb(b,[d,a.La,h]);return b};function xu(){}w(xu,tu);xu.prototype.Qv=function(a,b,c,d){b=ia(b)?b:[b];var f=[],h=new uu("Invite people...","share-menu-invite-icon",undefined,"invite",c);f.push(h);if(a.Lb()!="DEFAULT"||Tb(b,function(k){return k.m1.wO||k.Lb()=="DEFAULT"})){a=new uu("Get the link to share...","share-menu-link-icon",undefined,"link",c);f.push(a)}a=new uu("See who has access...",undefined,undefined,"access",c);f.push(a);if(d){c=new uu("Email as attachment...",undefined,undefined,"emailAttach",c);f.push(c)}return f};function yu(){}w(yu,tu);yu.prototype.Qv=function(a,b,c){ia(b);a=[];b=new uu("Sharing settings...",undefined,undefined,"settings",c);a.push(b);b=new oi(c);b.JK("separator");a.push(b);b=new uu("Email editors/viewers...",undefined,undefined,"email",c);a.push(b);c=new uu("Email as attachment...",undefined,undefined,"emailAttach",c);a.push(c);return a};function zu(a,b,c,d,f,h,k){this.G2=a;if(a=f)a.ne()&&a.Wf(new oi(d),0,g);else a=new pi(d);f=a.b();if(!f){a.o();f=a.b()}I(f,"goog-menu-noaccel");this.zt&&a.z(j);this.Hg=a;(this.Ax=new mi(this.HM)).F(j);(this.Fs=new mi(this.IM)).F(j);d=new Jo(undefined,j,d);d.We(i);this.wa=d;this.Zn=b;this.$R=c;this.jf=new ru({});this.Wj=a.G();this.Es=(b=k=="stjw")?new yu:new xu;this.CZ=Math.max(1,b?2:1);window.SC_setTitle=u(this.Z0,this);window.SC_resize=u(this.Ny,this);window.SC_setVisible=u(this.m0,this);window.SC_prepareForVisible=
u(this.qZ,this);window.SC_setAclInfo=u(this.xK,this);window.SC_setClientModel=u(this.xK,this);window.SC_dispatchEvent=u(this.xm,this);window.SC_handleError=u(this.pg,this);window.SC_handleCommandComplete=u(this.RT,this);window.SC_setExecuteCommandFn=u(this.q0,this);window.SC_setSetShareSystemVisibleFn=u(this.U0,this);window.SC_setGetInterfaceVersionNumberFn=u(this.t0,this);window.SC_getVersionNumber=u(this.wT,this);this.zt&&this.mq().g(a,"show",this.vU);this.mq().g(d,"afterhide",this.$T)}w(zu,Og);
var Au=new Tc("images/doclist/apps_share_icons_5.png");n=zu.prototype;n.zt=g;n.vt=j;n.At=g;n.Wl=g;n.Dt=g;n.MM=!zu.prototype.vt&&zu.prototype.Wl&&zu.prototype.At;n.Ix=g;n.vv=i;n.fu=i;n.am=i;n.iB=j;n.Cl=j;n.fD=j;n.xv=i;n.ys=i;n.q=i;n.Ri=i;n.ki=i;n.ar=i;n.Mg=j;n.bf=j;n.Iu=i;n.Vq=i;n.Fr=0;n.Sp=j;n.Xu=j;n.uH=0;n.mo=i;n.HM="Loading...";n.IM="Sharing unavailable";n.JM="Sorry, sharing is unavailable at this time.";n.dM=function(){this.mo&&this.mo.F(this.Kq()>20)};n.p0=function(a){this.Sp=a};
n.b0=function(a){if(q(a))a=new Tc(a);this.am=a;this.g1()};n.z0=function(a){a=ia(a)?a:[a];Lb.sort.call(a,fc);var b;a:{b=this.Ri;if(!ja(a)||!ja(b)||a.length!=b.length)b=j;else{for(var c=a.length,d=0;d<c;d++)if(a[d]!==b[d]){b=j;break a}b=g}}if(!b){this.Ri=a;this.ND();this.Cl=this.iB=j;this.wa.ga()&&this.pl(j)}};n.wT=function(){return 2};n.WG=function(){return v()-this.uH>2E4};
n.xK=function(a){this.jf=su(a);this.iB=g;this.Dt||this.Mg&&this.Tw(g);this.Wl||this.bf&&this.Cw();if(!this.Dt||!this.Mg){this.eM();this.dM()}this.xm("aclInfoUpdated")};n.ND=function(){if(this.zt&&!this.Hg.ga())this.Ix=g;else this.oK()};n.vU=function(){this.Ix?this.oK():this.gJ()};n.pg=function(a,b){switch(a){case "init":this.Mg&&this.Tw(j,b);break}};
n.RT=function(a,b){if(this.Wl)switch(a){case "init":if(this.Dt&&b=="success"&&this.Mg){this.Tw(g);this.eM();this.dM()}this.Ey();break;case "init_share":case "data":this.uH=v();this.Cw();break}};n.PS=function(){return-1};n.t0=function(a){this.PS=a};n.q0=function(a){this.Cl=g;this.xv=a;this.Wl||this.Cw()};n.U0=function(a){this.ys=a};
n.Tw=function(a,b){this.Mg=j;this.Yr();if(a)this.mq().g(this.Hg,"action",this.UF);else if(b){a=new mi(Te(document,b));a.F(j);this.Wo(a)}else this.Wo(this.Fs);this.Wl||si(this.Ey,0,this)};n.Z0=function(a){this.wa.Ka(a)};n.Kq=function(){return this.jf.Kq()};n.Sv=function(){return this.jf.Sv()};n.Jq=function(){return this.jf.Jq()};n.rq=function(){return this.jf.rq()};n.Yv=function(){return this.jf.Yv()};
n.g1=function(){this.Vq&&Xf(this.Vq);var a=".apps-share-sprite{background-image: url("+this.am.gj(Au).toString()+"); }";this.Vq=Vf(a,this.Hg.b())};n.oK=function(){this.Ix=j;this.Yr();this.mq().Da(this.Hg,"action",this.UF);if(this.Ri&&this.Ri.length!=0){this.Wo(this.Ax);this.Mg=g;si(this.IO,1E4,this);si(this.DO,6E4,this);this.OS().src=this.lF("init");this.gJ()}};n.gJ=function(){if(this.MM)if(!this.bf&&!this.Cl){this.bf=g;this.pK()}else if(this.Cl&&this.WG()){this.bf=g;this.rK()}};
n.pK=function(){this.wa.hb(this.xS("init_share"));this.pl(g,g)};n.rK=function(){this.wv("data")};n.Yr=function(){for(var a=this.Hg,b=this.Fr,c=0;c<b;c++)a.Cy(0,g);this.Fr=0;this.xm("menuUpdated")};n.Wo=function(a){this.Hg.Wf(a,0,g);this.Fr++;this.xm("menuUpdated")};n.mq=function(){return this.q||(this.q=new V(this))};n.xS=function(a){return Ya('<iframe frameborder=0 src="',this.lF(a),'"></iframe>')};
n.lF=function(a){if(!this.am)return'javascript:""';var b=this.am.Sa();b.$("id",this.Ri);b.$("foreignService",this.Zn);b.$("gaiaService",this.$R);b.$("shareProtocolVersion",this.CZ);b.$("command",a);b.$("user",this.G2);b.$("rand",v());return b.toString()};n.ig=function(a,b){if(a=="init")this.ND();else if(this.Cl&&!this.vt&&!this.WG())this.wv(a,b);else{this.Iu=a;this.NC=b;this.OC=(new Date).getTime();this.f1();if(!this.bf){this.bf=g;!this.Cl||this.vt?this.pK():this.rK()}}};
n.wv=function(a,b,c){this.At||this.pl(g,g);this.xv(a,b,c)};n.f1=function(){ka(this.vv)&&ti(this.vv);ka(this.fu)&&ti(this.fu);this.vv=si(this.GO,25E3,this);this.fu=si(this.CO,6E4,this)};n.Cw=function(){this.bf=j;var a=this.Iu;if(a){this.wv(a,this.NC,this.OC);this.Iu=i;delete this.NC;delete this.OC}};
n.OS=function(){var a=this.ar;if(!a){a=Oe("iframe");a.src='javascript:""';var b=a.style;b.visibility="hidden";b.width=b.height="10px";if(E)b.marginTop=b.marginLeft="-99px";else{b.position="absolute";b.top=b.left="-10px"}document.body.appendChild(a);this.ar=a}return a};n.Ey=function(){var a=this.ar;if(a){P(a);this.ar=i}};n.DO=function(){if(this.Mg){this.Ey();this.Mg=j}};n.IO=function(){if(this.Mg){this.Yr();this.Wo(this.Fs)}};n.VZ=function(){this.wa.hb("");this.pl(j)};
n.GO=function(){if(this.bf){this.B4=i;this.s1()}};n.CO=function(){if(this.bf){this.VZ();this.bf=j}};n.s1=function(){var a=this.ki;if(!a){a=new Jo(undefined,g,this.Wj);a.hb(this.JM);a.We(No);a.db();I(a.b(),"share-client-error-dialog");this.ki=a}a.z(g)};n.UF=function(a){var b;switch(a.target.Ya()){case "access":b="access";break;case "email":b="email";break;case "emailAttach":b="email_attach";break;case "invite":b="invite";break;case "link":b="link";break;case "settings":b="settings";break}b&&this.ig(b)};
n.eM=function(){this.Yr();var a=this.jf;this.Fr=this.Es.Qv(a.Jq(),a.rq(),this.Wj,this.Sp).length;this.Es.AA(this.Hg,a.Kq(),a.Sv(),a.Jq(),a.rq(),a.aL,a.HX,a.IX,a.UQ&&this.Sp,this.Ri.length,this.Wj,this.Sp);this.xm("menuUpdated")};n.Ny=function(a,b){var c=this.wa.xa();c.style.width=a+"px";c.style.height=b+"px";if(z)this.wa.b().style.width=a+18+"px"};n.m0=function(a){if(a){this.bf=j;this.ki&&this.ki.z(j)}this.pl(a)};n.qZ=function(){this.At&&!this.wa.ga()&&this.pl(g,g)};
n.pl=function(a,b){this.NV();var c=this.wa;b=b?"hidden":"visible";c.b().style.visibility=b;c.gS().style.visibility=b;if(a){this.Xu=g;c.z(j);this.Xu=j}c.z(a)};n.$T=function(){!this.Xu&&this.ys&&this.ys(j)};n.xm=function(a){this.dispatchEvent(new R(a))};n.NV=function(){if(!this.fD){var a=this.wa;a.va||a.db();I(a.b(),"share-client-dialog");this.fD=g}};
n.k=function(){zu.c.k.call(this);this.Hg.p();delete this.Hg;if(this.mo){this.mo.p();delete this.mo}this.Ax.p();delete this.Ax;this.Fs.p();delete this.Fs;delete this.Wj;this.Es.p();delete this.Es;this.wa.p();delete this.wa;if(this.ki){this.ki.p();this.ki=i}if(this.q){this.q.p();this.q=i}this.Vq=this.am=this.Ri=i;this.jf.p();delete this.jf;this.ys=this.xv=i};function Bu(a,b,c,d,f,h){zu.call(this,a,b,c,d,f,h)}w(Bu,zu);Bu.prototype.ig=function(a,b){Bu.c.ig.call(this,a,b);nt(fa)};function Cu(){Zj.call(this)}w(Cu,bk);n=Cu.prototype;n.Dd=function(){Cu.c.Dd.apply(this,arguments)};n.Rf=function(){Cu.c.Dd.apply(this,arguments)};n.qd=function(){this.cr()};n.Fc=function(){this.oA()};n.gb=function(){return"PasteInterceptor"};n.b=function(){return this.n.b()};n.M=function(){return Fe(this.b())};n.pa=function(){return Ne(this.M())};
n.qD=function(a){var b=this.n.execCommand("userpaste",a);if(b!==""){b||(b=a);z?Bh(this.pa()).Ud(0).vc().pasteHTML(b):this.M().execCommand("inserthtml",i,b)}};function Du(){Zj.call(this);this.Pa=new V(this)}w(Du,Cu);n=Du.prototype;n.fi=i;n.Sn=i;n.Mr="display:none";n.ky="";n.cr=function(){var a=this.Pa,b=this.b();a.g(b,"paste",this.QF)};n.oA=function(){this.Im();this.Pa.Mc()};n.QF=function(){this.Im();this.eW();this.Sj(this.RG)};n.RG=function(){var a=this.XE();this.Zh();this.qD(a)};n.Fy=function(){var a=this.Td();if(a){a.parentNode.removeChild(a);this.n.Ye()}};n.e_=function(){this.Ry();this.Fy()};n.Td=function(){return this.M().getElementById("goog_paste_interceptor")};
n.CP=function(){var a=this.M().createElement("DIV");a.id="goog_paste_interceptor";a.style.cssText=this.Mr;a.innerHTML=this.ky;return a};n.Uw=function(){this.n.$e(g,g);var a=this.CP();this.b().insertBefore(a,this.b().firstChild)};n.ez=function(){this.F_();this.Un()};n.Un=function(){var a=this.Td();jk(a,void 0).select()};n.eW=function(){this.Uw();this.ez()};n.F_=function(){this.Sn=Bh(this.pa())};n.Ry=function(){this.Sn.select()};n.XE=function(){return this.Td().innerHTML};
n.Zh=function(){this.nu();this.e_()};n.Sj=function(a,b){this.nu();this.fi=new ar(a,b||0,this);this.fi.start()};n.Im=function(){if(this.fi){this.fi.pi();this.nu()}};n.nu=function(){if(this.fi){this.fi.p();this.fi=i}};n.k=function(){this.oA();this.Pa.p();Du.c.k.apply(this,arguments)};function Eu(){Du.call(this)}w(Eu,Du);Eu.prototype.Mr="display:-moz-deck;width:100%;font-size:0;visibility:hidden;line-height:0;position:fixed";Eu.prototype.Un=function(){var a=this.Td().style,b=this.iS();a.bottom=b.y+"px";a.right=b.x+"px";Eu.c.Un.apply(this,arguments)};Eu.prototype.iS=function(){var a=this.n.Yb.getBoundingClientRect();a=new oe(Math.max(-a.left,0),Math.max(-a.top,0));var b=this.pa();return pe(new oe(b.innerWidth,b.innerHeight),a)};function Fu(){Du.call(this)}w(Fu,Du);Du.prototype.Bp=j;Du.prototype.Mr="width:0;height:0;overflow:hidden;zoom:0.01;float:right";Du.prototype.ky="<span>**</span>";n=Fu.prototype;n.Fy=function(){this.Pa.Da(this.Td(),"selectstart",this.SF);Fu.c.Fy.apply(this,arguments)};
n.cr=function(){Fu.c.cr.apply(this,arguments);var a=this.b(),b=this.Pa;b.g(a,"contextmenu",this.UT);b.g(a,"beforepaste",this.GT);b.g(a,["cut","copy"],this.VT);b.g(a,"losecapture",this.DU);this.M().execCommand("respectvisibilityindesign",j,g);this.tZ()};n.SF=function(){this.Zh();this.Sj(function(){document.execCommand("selectall",j,g)})};n.VT=function(){this.Zh()};n.UT=function(){this.Im();this.Bp=g};n.GT=function(){this.Im();if(this.Bp)this.Sj(this.e0);else{this.Uw();this.ez();this.Sj(this.HQ,250)}};
n.QF=function(){if(this.Td()){this.Sj(this.RG);We(this.Td())}else this.Im()};n.DU=function(){if(this.Bp){this.Bp=j;this.Uw();this.ez();this.Sj(this.gQ)}};n.HQ=function(){this.Zh()};n.gQ=function(){var a=this.Td();this.Zh();a.innerText=="*"&&this.M().execCommand("delete",j,g)};n.Tn=function(a,b){if(b.x!=a.scrollLeft)a.scrollLeft=b.x;if(b.y!=a.scrollTop)a.scrollTop=b.y};n.Un=function(){var a=this.Td().firstChild.firstChild;hk(a,0,a,1).select();this.Pa.g(this.Td(),"selectstart",this.SF)};
n.Ry=function(){if(this.Sn){var a=this.Sn,b=this.Td(),c=Bh(this.pa()),d=c.Jc();d=d.nodeType==3?d.parentNode:d;if(b&&b.contains(d)||a.$f(c)){a=(new Ee(this.M())).oe();b=this.b();b=new oe(b.scrollLeft,b.scrollTop);Fu.c.Ry.apply(this,arguments);this.Tn(this.M().body,a);this.Tn(this.b(),b)}this.Sn=i}};n.Zh=function(){this.RZ();Fu.c.Zh.apply(this,arguments)};n.e0=function(){this.b().setCapture()};n.RZ=function(){this.b().releaseCapture()};
n.tZ=function(){var a=Hg(this.b(),"paste",this.n.fa,j,this.n);a&&Eg(a.Wb)};function Gu(){Zj.call(this)}w(Gu,Cu);Gu.prototype.cr=function(){U(this.b(),"paste",this.QG,j,this)};Gu.prototype.oA=function(){Cg(this.b(),"paste",this.QG,j,this)};Gu.prototype.QG=function(a){if(a.clipboardData){this.qD(a.clipboardData.getData("text/html"));a.preventDefault();a.stopPropagation()}};function Hu(){Du.call(this)}w(Hu,Du);Hu.prototype.Mr="position:fixed;bottom:0;right:100%;opacity:0";Hu.prototype.ky='<div>&nbsp;<br class="temp_br"></div><br class="temp_br">';Hu.prototype.Un=function(){var a=this.Td().firstChild.firstChild;jk(a,void 0).select()};
Hu.prototype.XE=function(){var a=this.Td(),b;b=a.getElementsByClassName?a.getElementsByClassName("temp_br"):a.getElementsByTagName("BR");lc(ac(b),function(c){c.className=="temp_br"&&P(c)});if(a.childNodes.length==1)return a.firstChild.innerHTML;return a.innerHTML};function Iu(){Zj.call(this);this.ef=E&&!md?new Hu:B&&Cd("1.9")?new Eu:z&&!Cd("8")?new Fu:new Gu}w(Iu,bk);n=Iu.prototype;n.Dd=function(){return this.ef.Dd.apply(this.ef,arguments)};n.Rf=function(){return this.ef.Rf.apply(this.ef,arguments)};n.qd=function(){return this.ef.qd.apply(this.ef,arguments)};n.Fc=function(){return this.ef.Fc.apply(this.ef,arguments)};n.gb=function(){return this.ef.gb.apply(this.ef,arguments)};function Ju(a,b,c,d,f){this.id=a;this.Sy=b;this.size=c;this.NP=d;this.close=f};var Ku={};function Lu(a,b){b=b||Mu;for(var c=b.length,d="";a-- >0;)d+=b.charAt(Math.floor(Math.random()*c));return d}var Mu="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";function Nu(){}w(Nu,ag);Nu.prototype.Ml=0;Nu.prototype.xf=function(){return this.Ml};function Ou(a){this.Q=a;this.On=[];this.cQ=u(this.dQ,this)}w(Ou,Nu);n=Ou.prototype;n.Ml=2;n.xy=j;n.Ib=0;n.kf=function(){if(this.Q.xi()==0){this.sg=this.Q.Ek;this.sg.XPC_toOuter=u(this.EG,this)}else this.KB()};
n.KB=function(){var a=g;try{if(!this.sg)this.sg=window.frameElement;if(this.sg&&this.sg.XPC_toOuter){this.gy=this.sg.XPC_toOuter;this.sg.XPC_toOuter.XPC_toInner=u(this.EG,this);a=j;this.send("tp","SETUP_ACK");this.Q.th()}}catch(b){}if(a){if(!this.JB)this.JB=u(this.KB,this);window.setTimeout(this.JB,100)}};n.kA=function(a){if(this.Q.xi()==0&&!this.Q.vd()&&a=="SETUP_ACK"){this.gy=this.sg.XPC_toOuter.XPC_toInner;this.Q.th()}else e(Error("Got unexpected transport message."))};
n.EG=function(a,b){if(!this.xy&&this.On.length==0)this.Q.Vg(a,b);else{this.On.push({X_:a,my:b});if(this.On.length==1)this.Ib=window.setTimeout(this.cQ,1)}};n.dQ=function(){for(;this.On.length;){var a=this.On.shift();this.Q.Vg(a.X_,a.my)}};n.send=function(a,b){this.xy=g;this.gy(a,b);this.xy=j};n.k=function(){Ou.c.k.call(this);this.sg=this.gy=i};function Pu(a){this.Q=a;this.Xn=this.Q.ob.ppu;this.EZ=this.Q.ob.lpu;this.kj=[]}var Qu,Ru;w(Pu,Nu);n=Pu.prototype;n.Ml=4;n.iz=0;n.Pl=j;n.Li=j;n.vq=function(){return"googlexpc_"+this.Q.name+"_msg"};n.gq=function(){return"googlexpc_"+this.Q.name+"_ack"};n.kf=function(){if(!this.Li){this.gP();this.Li=g}this.HO()};n.gP=function(){var a=this.vq();this.Uk=this.wu(a);this.Ox=window.frames[a];a=this.gq();this.Cj=this.wu(a);this.Et=window.frames[a]};
n.wu=function(a){var b=document.createElement("iframe"),c=b.style;c.position="absolute";c.top="-10px";c.left="10px";c.width="1px";c.height="1px";b.id=b.name=a;b.src=this.Xn+"#INITIAL";document.body.appendChild(b);return b};n.dW=function(){this.Q.name=Lu(10);this.WC();this.Li=j;this.JZ=this.wu("googlexpc_reconnect_"+this.Q.name)};
n.$Y=function(){for(var a=this.Q.Se.frames,b=a.length,c=0;c<b;c++){var d;try{if(a[c]&&a[c].name)d=a[c].name}catch(f){}if(d){var h=d.split("_");if(h.length==3&&h[0]=="googlexpc"&&h[1]=="reconnect"){this.Q.name=h[2];this.WC();this.Li=j;break}}}};n.WC=function(){if(this.Uk){this.Uk.parentNode.removeChild(this.Uk);this.Ox=this.Uk=i}if(this.Cj){this.Cj.parentNode.removeChild(this.Cj);this.Et=this.Cj=i}};
n.HO=function(){if(this.hH(this.vq())&&this.hH(this.gq())){this.iI=new Su(this,this.Q.Se.frames[this.vq()],u(this.zZ,this));this.hB=new Su(this,this.Q.Se.frames[this.gq()],u(this.yZ,this));this.kC()}else{if(this.Q.xi()==1&&!this.JZ)this.dW();else this.Q.xi()==0&&this.$Y();window.setTimeout(u(this.kf,this),100)}};n.hH=function(a){try{var b=this.Q.Se.frames[a];if(!b||b.location.href.indexOf(this.EZ)!=0)return j}catch(c){return j}return g};
n.kC=function(){var a=this.Q.Se.frames;if(a[this.gq()]&&a[this.vq()]){this.jI=new Tu(this.Xn,this.Ox);this.Ro=new Tu(this.Xn,this.Et);window.setTimeout(u(function(){this.jI.send("SETUP");this.Pl=this.h5=g},this),100)}else{if(!this.jC)this.jC=u(this.kC,this);window.setTimeout(this.jC,100)}};n.iC=function(){if(this.tK&&this.FZ){this.Q.th();if(this.sm){for(var a=0,b;a<this.sm.length;a++){b=this.sm[a];this.Q.Vg(b.V_,b.my)}delete this.sm}}};
n.zZ=function(a){if(a=="SETUP"){if(this.Ro){this.Ro.send("SETUP_ACK");this.tK=g;this.iC()}}else if(this.Q.vd()||this.tK){var b=a.indexOf("|"),c=a.substring(0,b);a=a.substring(b+1);b=c.indexOf(",");if(b==-1){var d=c;this.Ro.send("ACK:"+d);this.ZC(a)}else{d=c.substring(0,b);this.Ro.send("ACK:"+d);c=c.substring(b+1).split("/");b=parseInt(c[0],10);c=parseInt(c[1],10);if(b==1)this.jy=[];this.jy.push(a);if(b==c){this.ZC(this.jy.join(""));delete this.jy}}}};
n.yZ=function(a){if(a=="SETUP_ACK"){this.Pl=j;this.FZ=g;this.iC()}else if(this.Q.vd())if(this.Pl)if(parseInt(a.split(":")[1],10)==this.iz){this.Pl=j;this.qK()}};n.qK=function(){if(!(this.Pl||!this.kj.length)){var a=this.kj.shift();++this.iz;this.jI.send(this.iz+a);this.Pl=g}};n.ZC=function(a){var b=a.indexOf(":"),c=a.substr(0,b);a=a.substring(b+1);this.Q.vd()?this.Q.Vg(c,a):(this.sm||(this.sm=[])).push({V_:c,my:a})};n.No=3800;
n.send=function(a,b){a=a+":"+b;if(!z||b.length<=this.No)this.kj.push("|"+a);else{b=b.length;for(var c=Math.ceil(b/this.No),d=0,f=1;d<b;){this.kj.push(","+f+"/"+c+"|"+a.substr(d,this.No));f++;d+=this.No}}this.qK()};n.k=function(){Pu.c.k.call(this);var a=Uu;Xb(a,this.iI);Xb(a,this.hB);this.iI=this.hB=i;P(this.Uk);P(this.Cj);this.Ox=this.Et=this.Uk=this.Cj=i};
var Uu=[],Xu=u(function(){var a=j;try{for(var b=0,c=Uu.length;b<c;b++)a=a||Uu[b].HZ()}catch(d){Uu[b].Eb.Q.eY();if(!Uu.length)return}b=v();if(a)Qu=b;Ru=window.setTimeout(Xu,b-Qu<1E3?10:100)},Pu);function Yu(){Qu=v();Ru&&window.clearTimeout(Ru);Ru=window.setTimeout(Xu,10)}function Tu(a,b){this.Xn=a;this.nK=b;this.Lu=0}Tu.prototype.send=function(a){this.Lu=++this.Lu%2;a=this.Xn+"#"+this.Lu+encodeURIComponent(a);try{if(E)this.nK.location.href=a;else this.nK.location.replace(a)}catch(b){}Yu()};
function Su(a,b,c){this.Eb=a;this.vJ=b;this.yO=c;this.PC=this.vJ.location.href.split("#")[0]+"#INITIAL";Uu.push(this);Yu()}Su.prototype.HZ=function(){var a=this.vJ.location.href;if(a!=this.PC){this.PC=a;if(a=a.split("#")[1]){a=a.substr(1);this.yO(decodeURIComponent(a))}return g}else return j};function Zu(a){this.Q=a;this.hZ=this.Q.ob.pru;this.YI=this.Q.ob.ifrid;E&&$u()}w(Zu,Nu);if(E)var av=[],bv=0,$u=function(){bv||(bv=window.setTimeout(function(){cv()},1E3))},cv=function(a){var b=v();for(a=a||3E3;av.length&&b-av[0].timestamp>=a;){var c=av.shift().JV;P(c)}bv=window.setTimeout(dv,1E3)},dv=function(){cv()};Zu.prototype.Ml=3;Zu.prototype.kf=function(){this.send("tp","SETUP")};Zu.prototype.kA=function(a){if(a=="SETUP"){this.send("tp","SETUP_ACK");this.Q.th()}else a=="SETUP_ACK"&&this.Q.th()};
Zu.prototype.send=function(a,b){if(z){var c=document.createElement("div");c.innerHTML='<iframe onload="this.xpcOnload()"></iframe>';c=c.childNodes[0];c.P2=ev}else{c=document.createElement("iframe");E?av.push({timestamp:v(),JV:c}):U(c,"load",ev)}var d=c.style;d.visibility="hidden";d.width=c.style.height="0px";d.position="absolute";d=this.hZ;d+="#"+this.Q.name;if(this.YI)d+=","+this.YI;d+="|"+a+":"+encodeURIComponent(b);c.src=d;document.body.appendChild(c)};function ev(){P(this);this.P2=i}
window.xpcRelay=function(a,b){var c=b.indexOf(":"),d=b.substring(0,c);b=b.substring(c+1);Ku[a].Vg(d,decodeURIComponent(b))};Zu.prototype.k=function(){Zu.c.k.call(this);E&&cv(0)};function fv(a,b){this.Q=a;this.gZ=b||"*"}w(fv,Nu);fv.prototype.Li=j;fv.prototype.Ml=1;var gv=0;function hv(a){var b=a.kc.data,c=b.indexOf("|"),d=b.indexOf(":");if(c==-1||d==-1)return j;a=b.substring(0,c);c=b.substring(c+1,d);b=b.substring(d+1);if(d=Ku[a]){d.Vg(c,b);return g}for(var f in Ku){d=Ku[f];if(d.xi()==1&&!d.vd()&&c=="tp"&&b=="SETUP"){d.name=a;delete Ku[f];Ku[a]=d;d.Vg(c,b);return g}}return j}n=fv.prototype;
n.kA=function(a){switch(a){case "SETUP":this.send("tp","SETUP_ACK");break;case "SETUP_ACK":this.Q.th();break}};n.kf=function(){if(gv==0)U(window.postMessage?window:document,"message",hv,j,fv);gv++;this.Li=g;this.wC()};n.wC=function(){if(!this.Q.vd()){this.send("tp","SETUP");window.setTimeout(u(this.wC,this),100)}};n.send=function(a,b){var c=this.Q.Se;if(c){var d=c.postMessage?c:c.document;this.send=function(f,h){d.postMessage(this.Q.name+"|"+f+":"+h,this.gZ)};this.send(a,b)}};
n.k=function(){fv.c.k.call(this);if(this.Li){gv--;if(gv==0)Cg(window.postMessage?window:document,"message",hv,j,fv)}};function iv(a){this.Q=a;this.LB=a.at||"";this.FJ=a.rat||"";if(!window.nix_setup_complete)try{window.execScript("Class GCXPC____NIXVBS_wrapper\n Private m_Transport\nPrivate m_Auth\nPublic Sub SetTransport(transport)\nIf isEmpty(m_Transport) Then\nSet m_Transport = transport\nEnd If\nEnd Sub\nPublic Sub SetAuth(auth)\nIf isEmpty(m_Auth) Then\nm_Auth = auth\nEnd If\nEnd Sub\nPublic Function GetAuthToken()\n GetAuthToken = m_Auth\nEnd Function\nPublic Sub SendMessage(service, payload)\n Call m_Transport.GCXPC____NIXJS_handle_message(service, payload)\nEnd Sub\nPublic Sub CreateChannel(channel)\n Call m_Transport.GCXPC____NIXJS_create_channel(channel)\nEnd Sub\nPublic Sub GCXPC____NIXVBS_container()\n End Sub\nEnd Class\n Function GCXPC____NIXVBS_get_wrapper(transport, auth)\nDim wrap\nSet wrap = New GCXPC____NIXVBS_wrapper\nwrap.SetTransport transport\nwrap.SetAuth auth\nSet GCXPC____NIXVBS_get_wrapper = wrap\nEnd Function",
"vbscript");window.nix_setup_complete=g}catch(b){}this.GCXPC____NIXJS_handle_message=this.JU;this.GCXPC____NIXJS_create_channel=this.Cp}w(iv,Nu);n=iv.prototype;n.Ml=6;n.Qk=j;n.Wi=i;n.kf=function(){this.Q.xi()==0?this.IB():this.HB()};n.IB=function(){if(!this.Qk){var a=this.Q.Ek;try{a.contentWindow.opener=window.GCXPC____NIXVBS_get_wrapper(this,this.LB);this.Qk=g}catch(b){}this.Qk||window.setTimeout(u(this.IB,this),100)}};
n.HB=function(){if(!this.Qk){try{var a=window.opener;if(a&&"GCXPC____NIXVBS_container"in a){this.Wi=a;if(this.Wi.GetAuthToken()!=this.FJ)return;this.Wi.CreateChannel(window.GCXPC____NIXVBS_get_wrapper(this,this.LB));this.Qk=g;this.Q.th()}}catch(b){return}this.Qk||window.setTimeout(u(this.HB,this),100)}};n.Cp=function(a){this.Wi=a;this.Wi.GetAuthToken()==this.FJ&&this.Q.th()};n.JU=function(a,b){function c(){this.Q.Vg(a,b)}window.setTimeout(u(c,this),1)};n.send=function(a,b){this.Wi.SendMessage(a,b)};
n.k=function(){iv.c.k.call(this);this.Wi=i};function jv(a){this.ob=a;this.name=this.ob.cn||Lu(10);this.lz={};Ku[this.name]=this;U(window,"unload",kv)}w(jv,ag);n=jv.prototype;n.Eb=i;n.ya=1;n.vd=function(){return this.ya==2};n.Se=i;n.Ek=i;n.KK=function(a){this.Se=a};n.hQ=function(){var a;if(la(document.postMessage)||la(window.postMessage)||z&&window.postMessage)a=1;else if(B)a=2;else if(z&&this.ob.pru)a=3;else if(z)a=6;else if(this.ob.lpu&&this.ob.ppu)a=4;return a};
n.KP=function(){if(!this.Eb){this.ob.tp||(this.ob.tp=this.hQ());switch(this.ob.tp){case 1:this.Eb=new fv(this,this.ob.ph);break;case 6:this.Eb=new iv(this);break;case 2:this.Eb=new Ou(this);break;case 3:this.Eb=new Zu(this);break;case 4:this.Eb=new Pu(this);break}if(!this.Eb)e(Error("CrossPageChannel: No suitable transport found!"))}};n.dT=function(){var a={};a.cn=this.name;a.tp=this.ob.tp;if(this.ob.lru)a.pru=this.ob.lru;if(this.ob.lpu)a.ppu=this.ob.lpu;if(this.ob.ppu)a.lpu=this.ob.ppu;return a};
n.DP=function(a,b,c){var d=this.ob.ifrid;d||(d=this.ob.ifrid="xpcpeer"+Lu(4));var f=document.createElement("IFRAME");f.id=f.name=d;if(b)b(f);else f.style.width=f.style.height="100%";var h=this.ob.pu;if(q(h))h=this.ob.pu=new Tc(h);c!==j&&h.$("xpc",Gb(this.dT()));if(B||E){this.Su=g;window.setTimeout(u(function(){this.Su=j;a.appendChild(f);f.src=h.toString();this.vC&&this.kf(this.tC)},this),1)}else{f.src=h.toString();a.appendChild(f)}return f};n.Su=j;n.vC=j;
n.kf=function(a){this.tC=a||fa;if(this.Su)this.vC=g;else{if(this.ob.ifrid)this.Ek=Ge(this.ob.ifrid);if(this.Ek){(a=this.Ek.contentWindow)||(a=window.frames[this.ob.ifrid]);this.KK(a)}if(!this.Se)if(window==top)e(Error("CrossPageChannel: Can't connect, peer window-object not set."));else this.KK(window.parent);this.KP();this.Eb.kf()}};n.close=function(){if(this.vd()){this.ya=3;this.Eb.p();this.Eb=i}};n.th=function(){if(!this.vd()){this.ya=2;this.tC()}};n.eY=function(){this.close()};
n.registerService=function(a,b,c){this.lz[a]={name:a,oO:b,XW:!!c}};n.send=function(a,b){if(this.vd())if(this.Se.closed)this.close();else{if(ma(b))b=Gb(b);this.Eb.send(a,b)}};n.Vg=function(a,b){if(!a||a=="tp")this.Eb.kA(b);else if(this.vd())if(a=this.lz[a]){if(a.XW)try{b=Eb(b)}catch(c){return}a.oO(b)}};n.xi=function(){return window.parent==this.Se?1:0};n.k=function(){jv.c.k.call(this);this.close();this.Ek=this.Se=i;delete this.lz;Ku[this.name]=i};
function kv(){for(var a in Ku){var b=Ku[a];b&&b.p()}};function lv(a,b,c){this.yr=[];if(a=="inner"){this.Q=this.TV(b);this.Q.kf(u(this.kj,this))}else if(a=="outer"){if(!c)e(Error("Please specify xpc config when initializing outer frame"));this.Q=this.VV(b,c)}}w(lv,ag);n=lv.prototype;n.k=function(){lv.c.k.call(this);this.Q.p();delete this.Q;delete this.yr};n.db=function(a,b){a=this.Q.DP(a,b);this.Q.kf(u(this.kj,this));return a};n.vd=function(){return this.Q.vd()};n.send=function(a,b){this.Q.vd()?this.Q.send(a,b):this.yr.push([a,b])};
n.kj=function(){for(var a=this.yr,b=0;b<a.length;b++){var c=a[b];this.send(c[0],c[1])}this.yr=[]};n.TV=function(a){var b=Eb((new Tc(window.location.href)).fc("xpc"));b=new jv(b);this.CJ(b,a);return b};n.VV=function(a,b){b=new jv(b);this.CJ(b,a);return b};n.CJ=function(a,b){for(var c in b)a.registerService(c,b[c],g)};function mv(a){this.qa=a||i;this.eI=this.EQ=this.zD=this.IG=this.dI=Wj;this.T1=this.$I=0}n=mv.prototype;n.Fz=function(a){this.D=a;return this};n.HY=function(a){this.dI=a;return this};n.EY=function(a){this.IG=a;return this};n.vY=function(a){this.zD=a;return this};n.IY=function(a){this.eI=a;return this};
n.hf=function(){var a=this.qa,b=this.zD,c=this;return function(d){function f(){p=g;c.IG.call(a,m,s);b.call(a,m,s);m=i}function h(D){t=g;Nb(A,Eg);p&&c.EQ.call(a,D,s)}if(!(!d.pn(0)||d.ctrlKey&&md)){d.preventDefault();d.stopPropagation();var k=[d.clientX,d.clientY],l=c.D||d.currentTarget,m=new eg(d.kc,l),p=j,t=j,s={},A=[];A.push(U(l,"mousemove",function(D){D.stopPropagation();D.preventDefault();if(p)b.call(a,D,s);else{var L=D.clientX-k[0],N=D.clientY-k[1];if(L*L+N*N>c.$I){f();b.call(a,D,s)}}}));A.push(U(l,
"mouseup",function(D){if(D.pn(0)){D.stopPropagation();D.preventDefault();h(D);c.eI.call(a,D,s)}}));c.xO&&A.push(U(c.xO,c.U3,function(D){D.T3=g;h(D)}));c.dI.call(a,m,s);c.$I?si(function(){!p&&!t&&f()},c.T1):f()}}};function nv(a,b,c,d,f){function h(){this.Q.send("escape",{})}this.Xz=a.replace("/drawings/a/","/a/drawings/");this.Bx=b;this.Nt=c;this.Zi=d;this.K=f||J();this.xb=j;this.rx=i;this.ks=this.cG=this.rr=j;this.Nd=this.K.o("span",{"class":"sketchy-dialog-title-text"});this.Us=this.K.o("span",{"class":"sketchy-dialog-title-autosave"});this.Oa=this.K.o("div",{"class":"sketchy-dialog-bg"});Tf(this.Oa,0.3);Q(this.Oa,j);this.ni=this.K.o("div",{"class":"sketchy-dialog-fg"});Q(this.ni,j);this.be=this.K.o("button",
{"class":"sketchy-dialog-title-close"},"Save & Close");a=this.K.o("div",{"class":"sketchy-dialog-title"},this.Nd,this.Us,this.be);this.tc=this.K.o("div",{"class":"sketchy-dialog-content"});this.D=this.K.o("div",{"class":"sketchy-dialog",tabIndex:0},a,this.tc);Q(this.D,j);a=this.K.M().body;a.appendChild(this.Oa);a.appendChild(this.D);a.appendChild(this.ni);this.W_=Dc("close",u(this.RO,this),"update",u(this.sK,this),"autoSave",u(function(k){this.cG=g;this.OB(k)},this));a=(new mv(this)).Fz(this.ni).HY(qa(Q,
this.ni,g)).EY(function(k,l){var m=Me(Ne(document));l.JX=m.width-this.D.offsetWidth;l.KX=m.height-this.D.offsetHeight;l.x=this.D.offsetLeft-k.clientX;l.y=this.D.offsetTop-k.clientY}).vY(function(k,l){Ff(this.D,Math.max(0,Math.min(l.JX,k.clientX+l.x)),Math.max(0,Math.min(l.KX,k.clientY+l.y)))}).IY(qa(Q,this.ni,j)).hf();this.qa=(new V(this)).g(this.Oa,"mouseup",h).g(this.D,"mouseup",h).g(this.D,"mousedown",a).g(this.be,"mousedown",function(k){k.stopPropagation()}).g(this.be,"click",function(){this.Q.send("close",
{});this.Q.vd()||this.z(j)})}w(nv,ag);n=nv.prototype;n.Ka=function(a){kf(this.Nd,a)};n.Mf=function(a){this.Zi=a};n.WX=function(a,b){this.ks=g;b=b||this.ZB();this.ey("newDrawing",{size:[b.width,b.height]},a);this.rr=g};n.rX=function(a,b){this.ks=j;this.ey("loadDrawing",{id:a},b);this.rr=j};n.kP=function(a,b,c){this.ks=g;this.ey("copyDrawing",{copyId:a,rev:c||i},b);this.rr=g};
n.ey=function(a,b,c){this.EO(b.id||i);kf(this.Us,"");this.Oc=c;this.s_(this.ZB());Cc(b,{app:this.Nt,parent:this.Zi});this.Q.send(a,b);si(function(){this.z(g);(this.Ba.contentWindow||jf(this.Ba).parentWindow||jf(this.Ba).defaultView).focus()},0,this)};n.ZB=function(){for(var a=[720,800,960,1024,1152,1280],b=Me(Ne(document)),c=a[0],d=a.length-1;d>0;d--)if(a[d]+66<=b.width&&a[d]*0.75+129<=b.height){c=a[d];break}return{width:c*381,height:c*0.75*381}};
n.z=function(a){if(a!=this.xb){var b=this.K.M(),c=Ne(b);if(a){this.fj();this.TJ();U(c,"resize",this.fj,g,this)}else Cg(c,"resize",this.fj,g,this);Q(this.Oa,a);Q(this.D,a);if(a){c=this.Us.style;var d=20+this.be.offsetWidth+"px";if(b.body.dir=="rtl")c.left=d;else c.right=d;this.Ev()}this.xb=a}};n.ga=function(){return this.xb};n.RO=function(a){this.z(j);this.sK(a,g)};n.OB=function(a){a="Auto-saved at "+(a.timestr||(new Date(a.time)).toLocaleTimeString());kf(this.Us,a)};
n.sK=function(a,b){this.cG||this.OB(a);var c=a.id;if(c){this.rx=c;if(b||this.ks){var d=a.size,f=a.crop;this.Oc(new Ju(c,a.revision,{width:d[0],height:d[1]},f?{left:f[0],top:f[1],width:f[2]-f[0],height:f[3]-f[1]}:i,!!b))}}};n.s_=function(a){a={width:Math.max(1,Math.round(a.width/381)),height:Math.max(1,Math.round(a.height/381))};this.Ba.width=a.width;this.Ba.height=a.height;this.tc.style.height=a.height+"px";this.D.style.width=a.width+"px";this.TJ()};
n.EO=function(a){if(this.Q){if(a!=this.rx&&(a||!this.rr)){this.tc.removeChild(this.Ba);this.Q.p();this.Cp(a)}}else this.Cp(a);this.rx=a};n.Cp=function(a){var b=new Tc(this.Xz);a&&b.$("id",a);a=Dc("pu",b.toString(),"ppu",b.gj(new Tc("relay.html")).toString(),"lpu",this.Bx);this.Q=new lv("outer",this.W_,a);this.Ba=this.Q.db(this.tc,u(this.s0,this))};n.s0=function(a){a.style.border="0px";a.frameBorder="no";a.scrolling="no";a.marginheight="0";a.marginwidth="0"};
n.fj=function(){Q(this.Oa,j);var a=Me(Ne(document));Q(this.Oa,g);Of(this.Oa,a.width,a.height);Of(this.ni,a.width,a.height)};n.TJ=function(){if(Ef(this.D)=="fixed")var a=0,b=0;else{b=this.K.oe();a=b.x;b=b.y}var c=Pf(this.D),d=Me(Ne(document));a=Math.max(a+d.width/2-c.width/2,0);b=Math.max(b+d.height/2-c.height/2,0);Ff(this.D,a,b)};n.k=function(){this.z(j);this.qa.p();P(this.D);P(this.Oa);P(this.ni)};n.Ev=function(){this.K.M().body.focus();this.D.focus()};function ov(a,b,c,d,f){this.QD=a;this.Yz=b;this.Vt=c;this.bE=d;this.Av=f||{}}function pv(a,b){this.x5=a;this.MC=b};function qv(a,b){this.Le=this.id=a;this.sb=i;this.Jf={};this.mh={};for(var c in $j)this.mh[c]=[];this.Oj="";if(E&&Cd("525.13")&&ab(Ad,"525.18")<=0){this.MA="tr-webkit-workaround";this.Oj="."+this.MA+">*{padding-right:1}"}this.bA={};this.ae("change");this.ae("delayedchange");this.gx=this.mr=j;this.rm=new ar(this.nD,250,this);this.Hp={};for(var d in rv)this.Hp[rv[d]]=0;if(Jk)this.de=new ar(this.Lq,15,this);this.Pa=new V(this);this.N2=[];this.Pk=0;this.zg=J(b||document);this.Yb=this.zg.b(this.id);this.cf=
this.zg.pa()}w(qv,Og);qv.prototype.field=i;qv.prototype.Yb=i;var rv={uM:"cvc",DM:"load",z3:"unload",Uf:"beforechange",QA:"change",Aj:"delayedchange",T2:"beforefocus",TA:"focus",tM:"blur",U2:"beforetab",PM:"selectionchange"},sv=i;qv.prototype.DG=j;function tv(a){sv=a}n=qv.prototype;n.jn=function(){return this.DG};n.ss=function(a){this.DG=a};n.b=function(){return this.field};
n.Pb=function(a,b,c,d){var f=this.b();if(!$k&&f.parentNode.contentEditable)f=f.parentNode;if(f&&Ok)f=f.ownerDocument;this.Pa.g(f,a,b,c,d)};n.tf=function(a){return this.Jf[a]};n.cb=function(a){this.Jf[a.gb()]=a;for(var b in $j)a[$j[b]]&&this.mh[b].push(a);a.Dd(this);this.ug()&&a.qd(this)};n.pA=function(a){delete this.Jf[a.gb()];for(var b in $j)a[$j[b]]&&Xb(this.mh[b],a);a.Rf(this)};n.v0=function(a){this.cssText=a};
n.q_=function(){var a=this.Yb;a.removeAttribute("contentEditable");a.removeAttribute("g_editable");if(this.id)a.id=this.id;else a.removeAttribute("id");a.className=this.H_||"";var b=this.cssText;b?Ke(a,{style:b}):a.removeAttribute("style");if(q(this.QI)){yf(a,"lineHeight",this.QI);this.QI=i}};n.Lh=Vj;var uv={46:g,8:g};z||(uv[9]=g);var vv={86:g,88:g};if(z)uv[229]=g;function wv(a,b){if(xv(a))return g;return!!(b&&!(a.ctrlKey||a.metaKey)&&(!B||a.charCode))}
function xv(a){var b=!(a.ctrlKey||a.metaKey)&&a.keyCode in uv;return(a.ctrlKey||a.metaKey)&&a.keyCode in vv||b}n=qv.prototype;n.Y_=function(a){this.cf=a};n.mz=function(a){this.VN=a};n.oE=function(){return this.VN||0};n.YK=function(a){this.Pk=2;this.field=a;this.sb=J(a);this.gx=this.mr=j;a.setAttribute("g_editable","true")};n.FL=function(){for(var a in this.Jf){var b=this.Jf[a];b.Gt()||b.Fc(this)}this.Pk=0;this.sb=this.field=i};
n.d1=function(){if(y&&this.Lh()){this.Pa.g(this.sb.M(),"focus",this.dv);this.Pa.g(this.sb.M(),"blur",this.mD)}else{if(Wk){this.Pb("focus",this.pD);this.Pb(Ig,this.lD)}else this.Pb("focus",this.dv);this.Pb("blur",this.mD,Jk)}if(Jk)this.i1();else{this.Pb(["beforecut","beforepaste","drop","dragend"],this.Uc);this.Pb(["cut","paste"],this.fa);this.Pb("drop",this.CF)}this.Pb(E?"dragend":"dragdrop",this.CF);this.Pb("keydown",this.xw);this.Pb("keypress",this.yw);this.Pb("keyup",this.BU);var a=u(this.Ta,this);
this.js=new ar(a,250);Uk&&this.Pb("click",yv);this.Pb("mousedown",this.en);this.Pb("mouseup",this.Pq)};n.oC=function(){this.Pa&&this.Pa.Mc();this.de&&this.de.stop();this.rm.stop()};n.k=function(){this.Yb&&this.execCommand("clearlorem");this.FL();this.oC();this.zg=i;if(this.Pa){this.Pa.p();this.Pa=i}this.SZ();sv==this.id&&tv(i);for(var a in this.Jf){var b=this.Jf[a];b.MB&&b.p()}delete this.Jf;qv.c.k.call(this)};n.SZ=function(){for(var a;a=this.N2.pop();)a.p()};
var zv=["DOMNodeInserted","DOMNodeRemoved","DOMNodeRemovedFromDocument","DOMNodeInsertedIntoDocument","DOMCharacterDataModified"];qv.prototype.i1=function(){if(Kk)this.Pa.g(this.b(),"DOMSubtreeModified",this.Aw);else{var a=this.sb.M();this.Pa.g(a,zv,this.Aw,g);this.Pa.g(a,"DOMAttrModified",u(this.eU,this,this.Aw),g)}};qv.prototype.tF=function(a){if(a.keyCode==9&&!this.rQ(a)||B&&a.metaKey&&(a.keyCode==37||a.keyCode==39)){a.preventDefault();return j}else(this.lw=a.charCode||wv(a,B))&&this.Uc();return g};
var Av={8:1,9:1,13:1,33:1,34:1,35:1,36:1,37:1,38:1,39:1,40:1,46:1},Bv={65:g,86:g,88:g},Cv={8:1,9:1,13:1,27:1,33:1,34:1,37:1,38:1,39:1,40:1};n=qv.prototype;n.nn=function(a){for(var b=this.mh[a],c=dc(arguments,1),d=0;d<b.length;++d){var f=b[d];if((f.W(this)||ak[a])&&f[$j[a]].apply(f,c))return g}return j};n.qW=function(a){for(var b=this.mh[a],c=dc(arguments,1),d=0;d<b.length;++d){var f=b[d];if(f.W(this)||ak[a])f[$j[a]].apply(f,c)}};
n.Ay=function(a){for(var b=this.mh[a],c=dc(arguments,1),d=0;d<b.length;++d){var f=b[d];if(f.W(this)||ak[a])c[0]=f[$j[a]].apply(f,c)}return c[0]};n.bW=function(a,b){var c={};a=this.RE(a,c);yf(b,c);b.innerHTML=a};n.RE=function(a,b){return this.Ay(8,a||"",b)};n.xw=function(a){if(!Jk)if(!this.tF(a))return;!this.nn(1,a)&&al&&this.KF(a)};n.yw=function(a){if(Jk){if(!this.tF(a))return}else{this.lw=g;this.Uc()}!this.nn(2,a)&&!al&&this.KF(a)};
n.BU=function(a){if(!Jk&&(this.lw||xv(a)))this.Lq();this.nn(3,a);if(!this.wd("selectionchange"))if(Av[a.keyCode]||(a.ctrlKey||a.metaKey)&&Bv[a.keyCode])this.js.start()};n.KF=function(a){if(!a.altKey){var b=md?a.metaKey:a.ctrlKey;if(b||Cv[a.keyCode]){var c=a.charCode||a.keyCode;if(c!=17){c=String.fromCharCode(c).toLowerCase();this.nn(5,a,c,b)&&a.preventDefault()}}}};
n.execCommand=function(a){for(var b=arguments,c,d=this.mh[6],f=0;f<d.length;++f){var h=d[f];if(h.W(this)&&h.te(a)){c=h.execCommand.apply(h,b);break}}return c};n.queryCommandValue=function(a){var b=this.ug()&&this.ox;if(q(a))return this.Vr(a,b);else{for(var c={},d=0;d<a.length;d++)c[a[d]]=this.Vr(a[d],b);return c}};n.Vr=function(a,b){for(var c=this.mh[7],d=0;d<c.length;++d){var f=c[d];if(f.W(this)&&f.te(a)&&(b||f.Gt()))return f.queryCommandValue(a)}return b?i:j};
n.eU=function(a,b){if(!this.wd("change")){b=b.kc;try{if(b.originalTarget.prefix||b.originalTarget.nodeName=="scrollbar")return}catch(c){return}b.prevValue!=b.newValue&&a.call(this,b)}};n.Aw=function(a){if(!this.wd("change")){a=a.qE?a.kc:a;if(!a.target.p4){this.gx=this.mr=g;this.de.start()}}};n.CF=function(){z&&this.execCommand("clearlorem",g);Jk&&this.dv();this.fa()};n.Rv=function(){var a;if(this.Lh()&&(a=this.sb))return(a=a.pa())&&a.frameElement;return i};
n.O=function(){var a=this.sb&&this.sb.pa();return a&&Bh(a)};n.Ta=function(a){if(!this.wd("selectionchange")){var b=this.O();b=b&&b.Tb();this.ox=!!b&&df(this.b(),b);this.sQ();this.dispatchEvent({type:"selectionchange",W4:a&&a.type});this.nn(4,a)}};n.Uc=function(){this.wd("beforechange")||this.dispatchEvent("beforechange")};n.rQ=function(a){return this.dispatchEvent({type:"beforetab",shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.ctrlKey})};
n.$e=function(a,b){if(a){this.de&&this.de.pi();this.ae("change")}if(b){this.jm();this.ae("delayedchange")}};n.Ye=function(a,b){!a&&this.de&&this.de.pi();this.Hh("change");this.Hh("delayedchange");a&&this.Lq();b&&this.nD()};n.ae=function(a){this.bA[a]=1};n.Hh=function(a){this.bA[a]=0};n.TP=function(a){this.Hp[a]=v()};n.wd=function(a){return!!this.bA[a]||this.Hp[a]&&v()-this.Hp[a]<=500};n.wr=ba(14);n.sQ=function(a){a?this.dispatchEvent({type:"cvc",WO:a}):this.dispatchEvent("cvc")};
n.fa=function(a){this.Ye(g,a)};n.Lq=function(){if(!this.wd("change")){this.de&&this.de.stop();this.gx=this.mr=g;this.wd("delayedchange")||this.rm.start()}};n.nD=function(){if(!this.wd("delayedchange")){this.rm.stop();this.mr=j;this.dispatchEvent("delayedchange")}};n.jm=function(){this.de&&this.de.pi();this.rm.pi()};n.dv=function(){this.lD();this.pD()};n.lD=function(){if(!this.wd("beforefocus")){this.execCommand("clearlorem",g);this.dispatchEvent("beforefocus")}};
n.pD=function(){if(!this.wd("focus")){sv=this.id;this.ox=g;this.dispatchEvent("focus");if(Lk){var a=this.b(),b=this.O();if(b){var c=b.jk();if(b.Rm()==0&&(!c||c==a||c.tagName=="BODY"))dk(Ij(a),0).select()}}!Mk&&this.Lh()&&this.sb.pa().parent.getSelection().removeAllRanges()}};n.mD=function(){if(!this.wd("blur")){sv==this.id&&tv(i);this.ox=j;this.dispatchEvent("blur")}};function yv(a){tf(a.target,De)&&a.preventDefault()}n=qv.prototype;
n.en=function(a){sv||tv(this.id);if(z){var b=a.target;b&&b.tagName==De&&a.ctrlKey&&this.zg.pa().open(b.href)}};n.Pq=function(a){this.Ta(a);z&&this.js.start()};n.jq=function(){if(this.queryCommandValue("usinglorem"))return"\u00a0";if(!this.ug())return this.Yb.innerHTML;var a=this.FS();this.qW(11,a);return this.Ay(10,a.innerHTML)};n.FS=function(){var a=this.b(),b=a.cloneNode(j);a=a.innerHTML;if(z&&a.match(/^\s*<script/i))a="\u00a0"+a;b.innerHTML=a;return b};
n.rl=function(a,b,c,d){if(!this.EW()){d&&this.execCommand("clearlorem");if(b&&a)b="<p>"+b+"</p>";c&&this.$e(j,g);this.x0(b);d&&this.execCommand("updatelorem");if(this.ug())if(c){Jk&&this.de.pi();this.Ye()}else this.fa()}};n.x0=function(a){var b=this.b();if(b){if(this.Lh()&&Xk)for(var c=b.ownerDocument.getElementsByTagName("HEAD"),d=c.length-1;d>=1;--d)c[d].parentNode.removeChild(c[d])}else b=this.Yb;b&&this.bW(a,b)};
n.c2=function(){var a=this.sb.M();a.designMode="on";Tk&&a.execCommand("styleWithCSS",j,j)};n.nW=function(){this.Oj&&this.Gs()&&Vf(this.Oj,this.b())};n.uQ=function(){var a=this.b();this.MA&&I(a,this.MA);this.nW();this.Ye();this.dispatchEvent("load")};n.RW=function(){return this.Pk==0};n.ug=function(){return this.Pk==2};n.EW=function(){return this.Pk==1};
n.focus=function(){if(!Ik||E)this.sb.pa().focus();else{if(y)var a=this.cf.pageXOffset,b=this.cf.pageYOffset;var c=this.b();if(!$k&&c.parentNode.contentEditable)c=c.parentNode;c.focus();y&&this.cf.scrollTo(a,b)}};n.qR=function(){if(Gk||E)this.py();this.focus()};n.py=function(){var a=this.b(),b=a;if(a){b=Ij(a);if(a==b){b=J(b).createTextNode("");a.appendChild(b);dk(b,0);this.Ta();return}}Xl(b,g);this.Ta()};
n.Rk=function(a){this.Pk=1;var b=this.Yb;this.nodeName=b.nodeName;this.H_=b.className;this.v0(b.style.cssText);b.className+=" editable";this.uX(a)};n.uX=function(a){this.wX(a)};n.EF=function(){z&&Rl(this.sb.pa());sv!=this.id&&this.execCommand("updatelorem");this.d1();this.uQ();for(var a in this.Jf)this.Jf[a].qd(this)};
n.QH=function(a){if(this.RW())e(Error("makeUneditable: Field is already uneditable"));this.jm();this.js.pi();this.execCommand("clearlorem");var b=i;if(!a&&this.b())b=this.jq();this.nC();a=this.Yb;sv==a.id&&tv(i);this.oC();if(q(b)){a.innerHTML=b;this.q_()}this.x_();this.FL();E&&a.blur();this.execCommand("updatelorem");this.dispatchEvent("unload")};n.x_=function(){var a=this.Yb;if(a){var b=this.Rv();b&&Ze(a,b)}};
n.Gs=function(){if(this.jx===undefined){this.jx=j;if(z&&this.Lh()){for(var a=this.zg.pa();a!=a.parent;)try{a=a.parent}catch(b){break}a=a.location;this.jx=a.protocol=="https:"&&a.search.indexOf("nocheckhttps")==-1}}return this.jx};n.wX=function(a){var b=this.Yb;if(b){b=b.innerHTML;var c={};b=this.Ay(8,b,c);var d=this.zg.o("IFRAME",this.LS());if(this.Gs()){var f=u(this.Wq,this,d,b,c);this.Bv=U(d,"load",f,g);if(a)d.src=a}this.IN(d);this.Gs()||this.Wq(d,b,c)}};
n.IN=function(a){var b=this.Yb;a.className=b.className;a.id=b.id;Ze(a,b)};n.GS=function(a){var b=Fj(this.Yb);return new ov(this.id,b,j,j,a)};
n.O2=function(a,b,c){c=this.GS(c);if(this.Gs()){a=jf(a).body;if(Ik)a.contentEditable=g;a.className="editable";a.setAttribute("g_editable",g);a.hideFocus=g;a.id=c.QD;yf(a,c.Av);a.innerHTML=b}else{var d=new pv(this.b(),this.Oj),f=[];c.Vt&&c.Yz&&f.push("<!DOCTYPE HTML>");f.push("<html ");Ik&&!$k&&f.push("contentEditable ");f.push('style="background:none transparent;');Ik&&!$k&&f.push("min-height:100%;");if(c.Vt)f.push("height:",c.bE?"100%":"auto");f.push('">');f.push("<head><style>");d&&d.MC&&f.push(d.MC);
B&&c.Yz&&f.push(" img {-moz-force-broken-image-icon: 1;}");f.push("</style></head>");f.push('<body g_editable="true" hidefocus="true" ');Ik&&$k&&f.push("contentEditable ");f.push('class="editable ');f.push('" id="',c.QD,'" style="');if(B&&c.Vt){f.push(";width:100%;border:0;margin:0;background:none transparent;",";height:",c.Yz?"100%":"auto");c.bE?f.push(";overflow:auto"):f.push(";overflow-y:hidden;overflow-x:auto")}for(var h in c.Av)f.push(";"+h+":"+c.Av[h]);f.push('">',b,"</body></html>");b=f.join("");
a=jf(a);a.open();a.write(b);a.close()}};n.Wq=function(a,b,c){this.nC();a.G3="true";this.O2(a,b,c);this.YK(jf(a).body);Ik||this.c2();this.EF()};n.nC=function(){if(this.Bv){Eg(this.Bv);this.Bv=i}};n.LS=function(){var a="padding:0;"+this.Yb.style.cssText;ua(a,";")||(a+=";");a+="background-color:white;";if(z)a+="overflow:visible;";return{frameBorder:0,style:a}};var Dv=/\s*;\s*/;function Ev(){var a;a:{a=String(document.cookie).split(Dv);for(var b=0,c;c=a[b];b++)if(c.indexOf("letmeinanyway=")==0){a=c.substr(14);break a}a=void 0}return a||B&&ab(Ad,"1.8")>=0||z&&ab(Ad,"6.0")>=0}o("TR_IsBrowserSupported",Ev,void 0);function Fv(a){this.L2=a;this.aq={}}n=Fv.prototype;n.oN=function(a,b){this.aq[a]=b};n.a_=function(a){this.aq[a]=i};n.qF=function(a){var b=(a=a||sv)?this.Qm(a):i;return a&&b.Lh()&&this.aq[a]?b.MS():this.L2};n.M=function(a){return this.qF(a).M()};n.G=function(a){return J(this.M(a))};n.pa=function(a){return this.qF(a).pa()};n.Qm=function(a){return this.aq[a]};n.bS=function(){var a=sv;return a?this.Qm(a):i};function Gv(a,b){this.Ba=a;this.hV=!!b;this.kx=this.fH();if(!this.kx){a=z&&!Cd("7")?"readystatechange":"load";this.Re=U(this.Ba,a,this.bn,j,this);this.Ww=window.setInterval(u(this.bn,this),100)}}w(Gv,Og);n=Gv.prototype;n.Re=i;n.ug=function(){return this.kx};n.YH=function(){if(this.Ww){window.clearInterval(this.Ww);this.Ww=i}};n.Sm=function(){return this.Ba};n.k=function(){delete this.Ba;this.YH();Eg(this.Re);Gv.c.k.call(this)};
n.fH=function(){var a=j;try{a=z?this.Ba.readyState=="complete":!!jf(this.Ba).body&&(!this.hV||!!jf(this.Ba).body.firstChild)}catch(b){}return a};n.bn=function(){if(this.fH()){this.YH();Eg(this.Re);this.Re=i;this.kx=g;this.dispatchEvent("ifload")}};function Hv(a){this.SI=a}n=Hv.prototype;n.pa=function(){return this.SI};n.M=function(){if(!this.Xg)this.Xg=this.pa().document;return this.Xg};n.pE=function(){if(!this.RB)this.RB=this.M().body;return this.RB};n.JS=function(){if(!this.sG)this.sG=this.pE().parentNode;return this.sG};n.ho=function(a){try{this.pa().location=a}catch(b){}};n.tR=function(){this.pa().focus()};n.O=function(){return Bh(this.pa())};function Iv(){Qp.status="";return g};function Jv(a,b){this.Xq=new Gv(a,b);this.dy=[];try{var c=a.contentWindow}catch(d){}finally{c?this.$K():this.load()}}w(Jv,Hv);n=Jv.prototype;n.$C=function(){if(this.Re){Eg(this.Re);this.Re=i}this.Xq.p()};n.$K=function(){this.SI=this.Sm().contentWindow;this.TW=g};n.load=function(a){a&&this.dy.push(a);if(!this.Re)this.Re=U(this.Xq,"ifload",this.wD,g,this);this.Xq.ug()&&this.wD()};n.wD=function(){for(this.TW||this.$K();this.dy.length;)this.dy.pop()();Eg(this.Re);this.Re=i};n.Sm=function(){return this.Xq.Sm()};
n.VE=function(){return this.Sm().ownerDocument};n.nJ=function(a,b){a.g(this.VE(),"mouseover",u(this.GZ,this),g);var c=u(this.BZ,this),d=this.M();if(y)d=d.documentElement;b=!!b;for(var f=0;f<Kv.length;f++)a.g(d,Kv[f],c,b)};n.GZ=function(a){this.K_=a.screenX-a.clientX;this.L_=a.screenY-a.clientY};var Lv=["target","originalTarget"],Kv=["mousedown","mouseup","mousemove","mouseover","mouseout","click"];
Jv.prototype.BZ=function(a){var b=this.Sm();if(b&&b.parentNode){var c,d=this.M(),f=a;c=this.K_;var h=this.L_;f=f.kc;var k;if(d.createEvent){f=f;d=d.createEvent("MouseEvents");d.initMouseEvent(f.type,f.bubbles,f.cancelable,f.view,f.detail,f.screenX,f.screenY,c!==undefined?f.screenX-c:f.clientX,h!==undefined?f.screenY-h:f.clientY,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.button,f.relatedTarget);k=d}else if(d.createEventObject){f=f;d=d.createEventObject(f);if(c!==undefined)d.clientX=f.screenX-c;if(h!==
undefined)d.clientY=f.screenY-h;k=d}c=k;for(h=0;h<Lv.length;h++){d=Lv[h];b[d]=a[d]}b.dispatchEvent?b.dispatchEvent(c):b.fireEvent("on"+c.type,c)}};function Mv(){}Mv.prototype.Mi=function(a,b,c,d){return Vn(a,b,c,d)};function Nv(a,b){this.z4={};this.L4=[];this.y4=[];this.Zg=new Hv(a);a=this.Zg.pa();this.cf=window;this.G1=b+"static_files";this.TN=this.G1+"/blank_"+(!z&&a.document.compatMode=="CSS1Compat"?"standards":"quirks")+".html";this.Bc=On(a);this.Xj=new Fv(this.Zg);this.Zj=new V(this);this.style=new Mv;this.je={};this.oi={}}w(Nv,Og);n=Nv.prototype;n.vT=function(){return this.Bc};n.kw=function(){return this.Zg};n.mz=function(a){this.UN=a};n.hS=function(){return this.UN||0};
n.Rk=function(a){if(ia(a))for(var b=0;b<a.length;++b)this.MH(a[b]);else this.MH(a)};n.nq=function(a){return this.je[a]};n.vr=function(a,b){if(ia(a))for(var c=0;c<a.length;++c)a[c].QH(b);else a.QH(b)};n.qU=function(a){a=a.target;var b=a.id;if(this.oi[b]){this.oi[b].p();this.oi[b]=i}this.Xj.a_(b);delete this.je[a.Le];if(tc(this.je)){this.Zj&&this.Zj.Mc();this.oi={}}};n.DZ=function(){this.p()};
n.k=function(){if(this.zG){this.zG.p();this.zG=i}for(var a in this.je){var b=this.je[a];this.vr(b,g);b.p()}if(this.Zj){this.Zj.p();this.Zj=i}Nv.c.k.call(this)};n.dl=function(a,b,c,d){var f=a.id;this.oi[f]||(this.oi[f]=new V(this));this.oi[f].g(a,b,c,d)};
n.mR=function(a){if(Zf(a.target)){a=a.target.ownerDocument;var b=a.defaultView;if((a=a.activeElement)&&a.contentEditable){var c=Bh(b);if(!c.isCollapsed()){if(Zk){b.getSelection().collapseToEnd();c.select()}b.setTimeout(function(){var d=Bh(b);if(d.isCollapsed()){var f=d.L();d=d.ka();if(f==c.L()&&d==c.ka()||f==c.da()&&d==c.Ma())c.select()}},0)}}}};n.EK=function(a,b,c,d,f){a.Yb||a.Cv(this.Zg.M());a.rl(j,c,d,f)};n.r0=function(a,b,c){this.EK(this.Xj.Qm(a),j,b,c,g)};
n.IE=function(a){a.Yb||a.Cv(this.Zg.M());return a.jq()};n.ES=function(a){return this.IE(this.Xj.Qm(a))};n.oU=function(a){this.dispatchEvent({type:"focus",n:a.target})};n.mU=function(a){var b=g;if(z){var c=a.b(),d=Ne(Fe(c)).frameElement,f;a:{try{f=Fe(d).activeElement;break a}catch(h){}f=i}if(d.contains(f))b=j;else(d=(d=a.O())&&d.Tb())&&df(c,d)&&Rl(a.sb.pa())}this.dispatchEvent({type:"blur",n:a});b&&a.execCommand("updatelorem")};
n.MH=function(a){a.Y_(this.cf);var b=this.hS();b&&!a.oE()&&a.mz(b);b=a.id;a.Cv(this.Zg.M());if(a.Yb){a.execCommand("clearlorem",g);Yk&&!a.Lh()&&this.Zj.g(this.kw().M(),"mousedown",this.mR);this.Xj.oN(b,a);this.dl(a,"load",this.pU);this.dl(a,"cvc",qa(En,this));a.Rk(this.TN);this.je[a.Le]=a}};n.pU=function(a){a=a.target;this.FN(a);var b=a.Rv();b&&(new Jv(b)).nJ(a.Pa,g)};
n.FN=function(a){a.b();this.dl(a,"unload",this.qU);this.dl(a,"focus",this.oU);this.dl(a,"blur",u(this.mU,this,a));this.dl(a,"selectionchange",qa(En,this))};n.openDialog=function(a,b){var c=this.NE();c&&c.execCommand(a,b)};n.oq=function(){return this.Xj.bS()};n.NE=function(){var a=this.oq();if(!a&&!tc(this.je)){a:{a=this.je;for(var b in a){a=a[b];break a}a=void 0}this.fE(a)}return a};n.oS=function(a){var b=this.oq();return b?b.queryCommandValue(a):{}};var $=Yj;Ac(io);n=Nv.prototype;
n.execute=function(a,b){var c=i,d=this.NE();if(!d)return i;c=d.execCommand(a,b);a=="+link"&&this.aV(d,c);return c};n.fE=function(a){if(sv==a.id)Bh(this.Zg.pa())||a.py();else{sv=a.id;this.Zg.tR();a.qR()}};n.eE=function(a){this.fE(this.Xj.Qm(a))};n.aV=function(a,b){if(b){var c=b.rS();if(Rp(c))this.XK(a,b,Sn(c));else jm.test(c)?this.XK(a,b,"mailto:"+c):this.openDialog("link",b)}};n.XK=function(a,b,c){b.MG(c);c=b.$o;b.aJ();a.execCommand("openLinkBubble",c)};o("TR_Editor",Nv,void 0);var Ov=Nv.prototype;
Ov.execute=Ov.execute;Ov.getCommandValues=Ov.oS;Ov.makeEditable=Ov.Rk;Ov.makeNotEditable=Ov.vr;Ov.getFieldContentsById=Ov.ES;Ov.openDialog=Ov.openDialog;Ov.quit=Ov.DZ;Ov.dispose=Ov.p;Ov.focusOnField=Ov.eE;Ov.setFieldContentsById=Ov.r0;Ov.setBaseZindex=Ov.mz;Ov.getFieldHTML=Ov.IE;Ov.setFieldHTML=Ov.EK;Nv.isBrowserSupported=Ev;Nv.setInvalidUrlCheck=function(a){Tn=a};Nv.setInternalUrlCheck=function(a){Rn=a};o("TR_EditorCommand",Yj,void 0);Nv.COMMAND=Yj;Yj.UNDO="+undo";Yj.REDO="+redo";Yj.LINK="+link";
Yj.FORMAT_BLOCK="+formatBlock";Yj.INDENT="+indent";Yj.OUTDENT="+outdent";Yj.REMOVE_FORMAT="+removeFormat";Yj.STRIKE_THROUGH="+strikeThrough";Yj.HORIZONTAL_RULE="+insertHorizontalRule";Yj.SUBSCRIPT="+subscript";Yj.SUPERSCRIPT="+superscript";Yj.UNDERLINE="+underline";Yj.UNLINK="+unlink";Yj.BOLD="+bold";Yj.ITALIC="+italic";Yj.FONT_SIZE="+fontSize";Yj.FONT_FACE="+fontName";Yj.FONT_COLOR="+foreColor";Yj.EMOTICON="+emoticon";Yj.BACKGROUND_COLOR="+backColor";Yj.ORDERED_LIST="+insertOrderedList";
Yj.UNORDERED_LIST="+insertUnorderedList";Yj.TABLE="+table";Yj.JUSTIFY_CENTER="+justifyCenter";Yj.JUSTIFY_FULL="+justifyFull";Yj.JUSTIFY_RIGHT="+justifyRight";Yj.JUSTIFY_LEFT="+justifyLeft";Yj.BLOCKQUOTE="+BLOCKQUOTE";Yj.DIR_LTR="ltr";Yj.DIR_RTL="rtl";o("TR_DialogType",io,void 0);Nv.DIALOG=io;io.IMAGE="image";io.SP_CHAR="spChar";io.EDIT_HTML="editHtml";io.EDIT_IMAGE="editImage";io.LINK="link";io.INSERT_MODULE="insertModule";Ov.getUrlUtil=Ov.vT;function Pv(a){this.Bc=a.Bc}Pv.prototype.Mi=function(a,b,c,d,f,h){if(f=Vn(a,this.Bc,u(this.xU,this,a,!!f),h)){Sk&&co(f);f.src=this.Bc.qk(b,"live");d||(void 0)(f,this.Bc,c);a.fa()}return f};Pv.prototype.xU=function(a,b,c){a.fa();!b&&a.execCommand("openImageBubble",c)};var Qv=2/3,Rv=1/Qv;function Sv(a,b,c,d,f){fo.call(this,"openSketchyBubble");this.Z_(j);this.K=f||J();this.AG=new Pv(a);this.Xz=b;this.BG=b.replace(/\/client$/,"/image");this.Os=this.BG.replace(/^[^:]+:/,":");this.K1=this.Os.indexOf("/drawings/a/")?this.Os.replace("/drawings/a/","/a/drawings/"):this.Os.replace("/a/drawings/","/drawings/a/");this.Bx=c;this.Nt=d;this.Zi="";this.NI=g}w(Sv,fo);n=Sv.prototype;n.G0=function(a){this.NI=a};n.Mf=function(a){this.Zi=a};n.gb=function(){return"Sketchy"};
n.Mm=function(a){return this.xW(a)?a:i};n.xW=function(a){return!!(this.NI&&a&&a.nodeName=="IMG"&&this.ex(a.src)&&bd(a.src).fc("id"))};n.ex=function(a){a=a.replace(/^[^:]+:/,":");return ta(a,this.Os)||ta(a,this.K1)};n.qd=function(a){Sv.c.qd.call(this,a);if(this.W(a))this.Mu=U(a.b(),"dblclick",function(b){b.target==this.wb&&this.Op()},j,this)};n.Fc=function(a){Sv.c.Fc.call(this,a);this.W(a)||Eg(this.Mu)};n.FE=function(a){return String(a.fc("id"))};
n.Mj=function(a){Mn(a,"Drawing:"+om);this.nf("sketchy-edit-link","Edit",this.Op,a).style.fontWeight="700";var b=this.Nj("sketchy-dup-span"),c=this.Nj("sketchy-sm-span"),d=this.Nj("sketchy-lg-span");a.appendChild(b);a.appendChild(c);a.appendChild(d);this.nf("sketchy-dup-link","Duplicate",this.FQ,b);this.nf("sketchy-sm-link","Smaller",this.y1,c);this.nf("sketchy-lg-link","Bigger",this.XN,d);a=bd(this.wb.src);this.Np=this.FE(a);this.$k=Number(a.fc("w")||a.fc("h"))||400;this.Px=a.fc("copy")=="1";this.B_=
Number(a.fc("rev"))};var Tv=Ac({n3:"+newDrawing",c3:"+editDrawing"});n=Sv.prototype;n.te=function(a){return a in Tv};n.VX=function(){return new nv(this.Xz,this.Bx,this.Nt,this.Zi,this.K)};n.Op=function(a){this.fs();if(!a&&this.yW())this.q1();else{a=this.AE();a.Ka("Edit Drawing");a.Mf(this.Zi);var b=u(this.Gw,this),c=this.Np;this.Px?a.kP(c,b,this.B_):a.rX(c,b);this.Sc()}};
n.q1=function(){var a=new Jo;a.Ka("Duplicate Drawing Detected");a.hb("The drawing you are attempting to edit appears more than once in this document. If you edit this drawing, all instances of the drawing will be affected. Would you like to duplicate this drawing instead?");a.We(Oo);a.BK(g);a.xa().style.cssText="padding: 4px; width: 400px; font-size: 14px";U(a,"dialogselect",u(this.gU,this));a.z(g)};n.gU=function(a){if(a.Wb=="yes")this.Px=g;this.Op(g)};
n.yW=function(){var a=this.Np;return Rb(this.eF(),function(b,c){return bd(c.src).fc("id")==a?b+1:b},0)>1};n.eF=function(){var a=He("IMG",i,this.n.b());return Pb(a,u(function(b){return this.ex(b.src)},this))};n.XX=function(){this.fs();this.Np=this.wb=i;this.$k=400;var a=this.AE();a.Ka("Insert Drawing");a.Mf(this.Zi);a.WX(u(this.Gw,this))};n.mI=ba(7);n.fs=function(){var a=this.n.O();this.Ed=a&&a.eK();Rl(this.n.sb.pa())};n.YJ=function(){if(this.Ed){this.Ed.restore();this.Ed=i}};
n.Gw=function(a){function b(){c.fa()}var c=this.n;if(this.wb){if(a.close){this.n.focus();this.YJ();if(this.Px){Wn(this.wb,b);this.wb.src=this.QE(a.id,a.Sy)}else this.p2(a.id,a.Sy)}}else if(a.NP){this.YJ();this.wb=this.AG.Mi(this.n,this.QE(a.id,a.Sy),i,g);this.fs()}};
n.QE=function(a,b){var c=this.BG,d={width:this.$k,height:this.$k};c=c.replace("/drawings/a/","/a/drawings/");a=(new Tc(c)).$("id",a).$("w",String(Math.ceil(d.width))).$("h",String(Math.ceil(d.height)));b!=i&&a.$("rev",String(b));return a.toString()+"&ac=1"};
n.p2=function(a,b){function c(){--f==0&&d.fa()}for(var d=this.n,f=0,h=this.eF(),k=0;k<h.length;k++){var l=h[k],m=bd(l.src);if(a==m.fc("id")&&b!=m.fc("rev")&&!m.fc("copy")){f++==0&&d.Uc();m.$("rev",b);Wn(l,c);l.src=m.toString();l.removeAttribute("width");l.removeAttribute("height")}}};n.AE=function(){if(!this.wa){this.wa=this.VX();var a=this.wa.z;this.wa.z=function(b){Db=b;a.call(this,b)}}return this.wa};n.y1=function(){this.fC(Qv)};n.XN=function(){this.fC(Rv)};
n.fC=function(a){a=this.$k*a;var b=Math.ceil(a);if(b>=100&&b<=1024){this.$k=a;a=bd(this.wb.src);a.$("w",b);a.$("h",b);b=this.n;var c=this.wb;b.Uc();Wn(c,u(b.fa,b));c.src=a.toString();c.removeAttribute("height");c.removeAttribute("width")}};n.FQ=function(){this.Sc();Xl(this.wb,j);var a=bd(this.wb.src);a.$("copy","1");this.AG.Mi(this.n,a.toString(),i,g)};n.execCommand=function(a){switch(a){case "+editDrawing":this.Op();break;case "+newDrawing":this.XX();break}};function Uv(){Zj.call(this)}w(Uv,bk);var Vv={cp:"dir",Hu:"direction",hM:j},Wv={cp:"align",Hu:"textAlign",hM:g};Uv.prototype.yv=j;var Xv=/^[^<]*<DIV\s+(?:xmlns[\S^>]*\s+)?DIR\s*=\s*.?(LTR|RTL).?(?:\s+xmlns[\S^>]*)?>([\s\S]*)<\/DIV>[^>]*$/i,Yv=/^[^<]*<DIV([^<]+TRBIDI\s*=\s*.?ON.?[^<]*)>([\s\S]*)<\/DIV>[^>]*$/i,Zv=/DIR\s*=\s*.?(LTR|RTL).?/i,$v=!!Date.now;n=Uv.prototype;n.gb=function(){return"Bidi"};n.te=function(a){return a=="ltr"||a=="rtl"};n.bh=function(a){this.te(a)&&this.S0(a)};
n.queryCommandValue=function(a){return this.te(a)&&this.lT()==a};n.Sr=function(a,b){var c=this.vS(),d=Yv.exec(a);if(d){if(a=Zv.exec(d[1]))c=a[1];a=d[2]}else if(d=Xv.exec(a)){c=d[1];a=d[2]}if(b){b.direction=c;if(this.yv)b.textAlign=aw(c)}return a};n.mC=function(a){var b=this.n.b(),c=bw(b,Vv,g);if(c){b=new jl('<DIV DIR="',c);if(this.yv){c=aw(c);b.append('" trbidi="on" style="text-align:').append(c)}b.append('">').append(a).append("</DIV>");a=b.toString()}return a};
n.vS=function(){if(!this.XC){var a=this.n;this.XC=(a=a.b()||a.Yb)&&Lf(a)?"rtl":"ltr"}return this.XC};function cw(a){var b=a.style;if(!b)return 0;var c=parseInt(b.marginLeft,10);b=parseInt(b.marginRight,10);return a.tagName=="BLOCKQUOTE"?(b==0)-(c==0):!b-!c}function dw(a,b){return Qj(a)&&Jj(a)||a!=b&&Nj(a)||ew(a,b)}function ew(a,b){if(a!=b)for(;(a=a.parentNode)&&a!=b;){var c=Nj(a);if(c)return c}return i}n=Uv.prototype;
n.qL=function(a,b){var c=a.parentNode,d,f;if(c==this.n.b()||B&&c.tagName=="BLOCKQUOTE"){f=a;d=J(c).createElement("DIV")}else{f=c;d=c.cloneNode(j)}Ln(d,b?c.firstChild:a.nextSibling,b?a.previousSibling:c.lastChild);b?Xe(d,f):Ye(d,f);return d};
n.UD=function(a,b,c,d){if(a==this.n.b())return a;var f=b?Mj:Nj;if(c){c=a;for(var h=i;c&&!Sj(c);){var k=c.tagName;if(k=="UL"||k=="OL")h=c;c=c.parentNode}if(c=h)return c}if(B&&d){c=b?Hj:Jj;d=a;do if(d.tagName=="BR"){if(b)d=a;do{a=d;f(d)&&this.qL(d,b)}while((d=d.parentNode)&&!Qj(d))}else{a=d;if((d=f(d))&&!Qj(d))for(h=c(d);h;h=c(d))d=h;else d=a.parentNode}while(d&&!Qj(d))}else if(!Qj(a))for(b=2;b;){d=b==2?a.parentNode:f(a);if(!d||Qj(d))b--;else a=d}return a};
n.bG=function(a,b){var c=this.n.b();a=uf(a,function(d){return d==c||d.tagName==b},g);return a!=c&&a!=i};
n.S0=function(a){var b=this.n.O();if(b){var c=b.L(),d=b.da(),f;if(!(this.bG(c,"TABLE")||this.bG(d,"TABLE"))){var h=b.hj();if(c==d){var k=dm(b,g).J;if(B&&b.isCollapsed()&&k.tagName=="BR"){f=k;c=(b=k.previousSibling)&&b.nodeType==3?b:k;d=k}else if(c==this.n.b()){if(!c.firstChild){c.innerHTML="<div>&nbsp;</div>";this.zs(Jj(c),a);dk(c,0).select();return}c=Jj(c);d=Hj(d)}}b=[this.UD(c,g,g,g),this.UD(d,j,g,g)];if(c=hf(b[0],b[1])){if(!Qj(c))c=c.parentNode;d=new Array(2);for(var l=c!=this.n.b(),m=0;m<2;m++){if(df(b[1-
m],b[m]))b[m]=b[1-m];var p=m?Mj:Nj,t=m?Nj:Mj,s=i,A=i,D=i,L=b[m]==c;for(k=b[m];k!=this.n.b();k=k.parentNode){if(k.parentNode==c){L=g;d[m]=A?p(k):k}if(A){if(cw(k)){s=k;D=!L&&k}}else if(t(k)){A=k;D=!L&&k}if(k.parentNode==c)l=l&&!A}if(s)for(k=A;k&&k!=s;k=k.parentNode)this.qL(k,!m);for(k=D;k&&k.parentNode!=c;k=k.parentNode){if(k==D){t=m?Jj(k.parentNode):k;s=m?k:Hj(k.parentNode)}else{t=m?Jj(k.parentNode):p(k);s=m?p(k):Hj(k.parentNode)}t&&s&&this.MK(t,s,a)}}if(l)this.zs(c,a);else Mj(d[0])!=d[1]&&this.MK(d[0],
d[1],a);this.OX(Ij(b[0]),Gj(b[1]),a);if(f){a=f.parentNode;for(h=0;a.childNodes[h]!=f;h++);dk(a,h).select()}else h.restore().select()}}}};n.OX=function(a,b,c){var d=a;if(d!=this.n.b())for(;(d=d.parentNode)&&d!=this.n.b();)this.aI(d,c);do this.aI(a,c);while(a!=b&&(a=dw(a)))};n.aI=function(a,b){var c=a.style;if(c)if(cw(a)*(b=="rtl"?1:-1)>0){a=a.style.marginLeft;c.marginLeft=c.marginRight;c.marginRight=a}};
n.MK=function(a,b,c){var d,f;do if(Qj(a)){if(d){this.LH(d,f,c);d=i}this.zs(a,c)}else{d=d||a;f=a}while(a!=b&&(a=Nj(a)));d&&this.LH(d,f,c)};n.LH=function(a,b,c){if(bw(a.parentNode,Vv,g)!=c){var d=J(a).createElement("DIV");Xe(d,a);Ln(d,a,b);this.zs(d,c)}};
function bw(a,b,c){var d=b.Hu,f;if(c)f=z?Cf(a,d):Bf(a,d);f=f||a.style[d]||a[b.cp];if(!B&&c&&(!f||f=="inherit"))if((d=a.parentNode)&&d.nodeType==1)f=bw(d,b,g);if(B&&b==Wv)switch(f){case "start":return fw(a,b);case "-moz-left":return"left";case "-moz-right":return"right";case "-moz-center":return"center"}else if(E&&b==Wv&&f=="auto")return fw(a,b);return f||(c?fw(a,b):i)}
Uv.prototype.LK=function(a,b,c,d){if(!d&&c&&a!=this.n.b()&&bw(a.parentNode,b,g)==c)c="";if(b.hM||!c)a.removeAttribute(b.cp);else{a.setAttribute(b.cp,c);c=""}yf(a,b.Hu,c)};function fw(a,b){switch(b){case Wv:a=bw(a,Vv,g);return aw(a);case Vv:return"ltr"}return""}Uv.prototype.zs=function(a,b){for(var c=aw(b),d=aw(b,g),f=a;f;f=dw(f,a))if(Qj(f)){this.LK(f,Vv,b);b="";var h=bw(f,Wv,f==a);if(h==d||this.yv&&h==c)this.LK(f,Wv,c,g)}};function aw(a,b){return(!a||a=="ltr")!=!!b?"left":"right"}n=Uv.prototype;
n.$E=function(a,b,c){var d=i,f=hf(a,b);if(!f)return i;if(a==b)a=Jj(a)||a;var h;this.D1();do if(!Qj(a)&&h!=a.parentNode){h=a.parentNode;var k=bw(h,c,g);if(d&&k!=d)return i;d=k}while(a!=b&&(a=dw(a,f))&&!this.eA());return d};n.lT=function(){var a=this.n.O();return!this.lH(a)?i:this.$E(a.L(),a.da(),Vv)};n.jT=function(){var a=this.n.O();return!this.lH(a)?i:this.$E(a.L(),a.da(),Wv)};n.lH=function(a){return!!a&&this.cH(a.L())&&this.cH(a.da())};n.cH=function(a){for(;a;){if(a==this.n.b())return g;a=a.parentNode}return j};
n.D1=function(){this.fY=0;if(!$v)this.ku=40;this.E1=v()};n.eA=function(){if($v||++this.fY>this.ku){var a=v()-this.E1;if(a>=20)return g;else if(!$v){this.ku*=1+(1-a/20)*2;this.ku++}}return j};function gw(){Zj.call(this)}w(gw,bk);gw.prototype.gb=function(){return"TabHandler"};gw.prototype.an=function(a){if(B&&this.n.jn())return j;if(a.keyCode==9&&!a.metaKey&&!a.ctrlKey)return this.VF(a);return j};function hw(){Zj.call(this)}w(hw,gw);hw.prototype.gb=function(){return"ListTabHandler"};hw.prototype.VF=function(a){var b=this.n.O();if(tf(b.Tb(),"LI")||nc(b,function(c){return c.tagName=="LI"})){this.n.execCommand(a.shiftKey?"+outdent":"+indent");a.preventDefault();return g}return j};function iw(){Zj.call(this)}w(iw,gw);iw.prototype.gb=function(){return"SpacesTabHandler"};iw.prototype.VF=function(a){var b=this.yb(),c=this.n.O();if(!tf(c.Tb(),"LI")&&!nc(c,function(d){return d.tagName=="LI"})){if(!a.shiftKey){this.n.$e(g,g);if(!c.isCollapsed()){b.M().execCommand("delete",j,i);c=this.n.O()}b=b.o("span",i,"\u00a0\u00a0 \u00a0");b=c.insertNode(b,j);this.n.fa();Xl(b,j);this.n.Ta()}a.preventDefault();return g}return j};function jw(a){this.EB=a}w(jw,Og);function kw(){this.WH=100;this.$c=[];this.Cg=[];this.Pr=[]}w(kw,Og);n=kw.prototype;n.Yq=i;n.xz=function(a){this.WH=a};n.nN=function(a){if(this.$c.length==0||!a.Sd(this.$c[this.$c.length-1])){this.$c.push(a);this.$c.length>this.WH&&this.$c.shift();var b=this.Cg.length;this.Cg.length=0;this.dispatchEvent({type:"state_added",Ze:a});if(this.$c.length==1||b)this.ev()}};n.ev=function(){this.dispatchEvent("state_change")};n.nA=function(){this.cL(this.$c,this.Cg)};n.yy=function(){this.cL(this.Cg,this.$c)};
n.oV=function(){return this.$c.length>0};n.hG=function(){return this.Cg.length>0};n.cL=function(a,b){if(a.length){var c=a.pop();b.push(c);this.cN({type:a==this.$c?"before_undo":"before_redo",jE:a==this.$c?c.nA:c.yy,Ze:c});if(a.length==0||b.length==1)this.ev()}};n.cN=function(a){this.Pr.push(a);this.Pr.length==1&&this.Vj()};
n.Vj=function(){if(!(this.Yq||this.Pr.length==0)){var a=this.Pr.shift();if(this.dispatchEvent({type:a.type,Ze:a.Ze}))if(a.Ze.EB){this.Yq=U(a.Ze,"action_completed",this.gR,j,this);a.jE.call(a.Ze)}else{a.jE.call(a.Ze);this.Vj()}}};n.gR=function(){Eg(this.Yq);this.Yq=i;this.Vj()};n.ou=function(){if(this.$c.length>0||this.Cg.length>0){this.$c.length=0;this.Cg.length=0;this.ev()}};n.e2=function(){return this.$c[this.$c.length-1]};n.MZ=function(){return this.Cg[this.Cg.length-1]};function lw(a){Zj.call(this);this.a1(a||new kw);this.li={};this.pm={};this.JG=i;this.aO=u(this.z_,this)}w(lw,Zj);lw.prototype.kn=i;var mw=Ac({Vl:"+undo",Tl:"+redo"});n=lw.prototype;n.xz=function(a){this.Zc.xz(a)};n.a1=function(a){this.SH&&Eg(this.SH);this.Zc=a;this.SH=U(this.Zc,"state_change",this.tQ,j,this)};n.te=function(a){return a in mw};n.Dd=function(a){this.n=a};n.Rf=function(a){this.Fc(a);this.n=i};n.Pv=function(){return this.n};n.nq=function(){return this.n};n.xE=function(){return this.n};
n.qd=function(a){if(!this.W(a)){a.jm();var b=new V(this);Jk||b.g(a,"beforechange",this.FT);b.g(a,"delayedchange",this.XT);b.g(a,"blur",this.qw);this.li[a.Le]=b;this.vA(a)}};n.Fc=function(a){a.jm();var b=this.li[a.Le];if(b){b.p();delete this.li[a.Le]}this.pm[a.Le]&&delete this.pm[a.Le]};n.W=function(a){return!!this.li[a.Le]};n.k=function(){lw.c.k.call(this);for(var a in this.li){this.li[a].p();delete this.li[a]}this.n=i;if(this.Zc){this.Zc.p();delete this.Zc}};n.gb=function(){return"UndoRedo"};
n.execCommand=function(a){if(a=="+undo")this.Zc.nA();else a=="+redo"&&this.Zc.yy()};n.queryCommandValue=function(a){var b=i;if(a=="+undo")b=this.Zc.oV();else if(a=="+redo")b=this.Zc.hG();return b};n.tQ=function(){this.xE().dispatchEvent({type:"cvc",WO:["+redo","+undo"]})};
n.z_=function(a,b,c){var d=this.nq(a.ak);if(d){d.$e(g,g);try{d.Uc();d.execCommand("clearlorem",g);d.b().innerHTML=b;c&&c.select();var f=this.Pv();d.focus();f&&f.Le!=a.ak&&f.execCommand("updatelorem");this.pm[a.ak].VK(b,c)}catch(h){}finally{this.kn=a;d.fa();d.Ta()}}};n.an=function(a,b,c){if(c){var d;if(b=="z")d=a.shiftKey?"+redo":"+undo";else if(b=="y")d="+redo";if(d){(a=d=="+undo"?this.Zc.e2():this.Zc.MZ())&&a.ak?this.Pv().execCommand(d):this.execCommand(d);return g}}return j};
n.ou=function(){this.n.$e(g,g);this.Zc.ou();this.n.Ye()};n.FT=function(a){if(!this.kn){a=a.target;var b=a.Le;if(this.JG!=b){this.JG=b;this.vA(a)}}};n.XT=function(a){if(this.kn){a=this.kn;this.kn=i;a.dispatchEvent("action_completed")}else this.vA(a.target)};n.qw=function(a){(a=a.target)&&a.jm()};n.tS=function(a){a=new nw(a);if(!a.qh())return i;return a};
n.vA=function(a){var b=a.Le,c,d;if(a.queryCommandValue("usinglorem")){c="";d=i}else{c=a.b().innerHTML;d=this.tS(a)}var f=this.pm[b];if(f){if(f.uj==c)return;else if(c==""||f.uj==""){a=a.RE("",{});if(c==a&&f.uj==""||f.uj==a&&c=="")return}f.L0(c,d);this.Zc.nN(f)}this.pm[b]=new ow(b,c,d,this.aO)};function ow(a,b,c,d){this.EB=g;this.ak=a;this.ZJ=d;this.VK(b,c)}w(ow,jw);n=ow.prototype;n.nA=function(){this.ZJ(this,this.uj,this.d2)};n.yy=function(){this.ZJ(this,this.zy,this.LZ)};
n.VK=function(a,b){this.uj=a;this.d2=b};n.L0=function(a,b){this.zy=a;this.LZ=b};n.Sd=function(a){return this.ak==a.ak&&this.uj==a.uj&&this.zy==a.zy};function nw(a){this.lc=a;var b=a.sb.pa();a=(a=a.O())&&a.Pi()&&a.pa()==b?a:i;if(Hk)this.XV(a);else Gk&&this.SV(a)}n=nw.prototype;
n.XV=function(a){this.Cf=j;if(a){var b=a.hq(),c=a.jk();if(b&&c){var d=a.iq();b=new pm(b,this.lc.b());var f=a.Rm();c=new pm(c,this.lc.b());if(a.vg()){this.ba=c;this.Ig=f;this.ia=b;this.gg=d}else{this.ba=b;this.Ig=d;this.ia=c;this.gg=f}this.Cf=g}}};
n.SV=function(a){this.Cf=j;if(a){var b=a.Ud(0).vc();if(df(this.lc.b(),b.parentElement())){a=this.lc.sb.M().body.createTextRange();a.moveToElementText(this.lc.b());var c=b.duplicate();c.collapse(g);c.setEndPoint("StartToStart",a);this.ba=pw(c);b=b.duplicate();b.setEndPoint("StartToStart",a);this.ia=pw(b);this.Cf=g}}};n.qh=function(){return this.Cf};n.toString=function(){if(Hk)return"W3C:"+this.ba.toString()+"\n"+this.Ig+":"+this.ia.toString()+"\n"+this.gg;return"IE:"+this.ba+","+this.ia};
n.select=function(){var a=this.pe(this.lc.b());if(a){Gk&&this.lc.b().focus();Pl(a).select()}};n.pe=function(a){if(Hk){var b=this.ba.ck(a);a=this.ia.ck(a);if(!b||!a)return i;return hk(b,this.Ig,a,this.gg).vc()}b=a.ownerDocument.body.createTextRange();b.moveToElementText(a);b.collapse(g);b.moveEnd("character",this.ia);b.moveStart("character",this.ba);return b};
function pw(a){var b=a.duplicate(),c=a.text,d=c.length;b.collapse(g);b.moveEnd("character",d);for(var f,h=10;f=b.compareEndPoints("EndToEnd",a);){d-=f;b.moveEnd("character",-f);--h;if(0==h)break}a=0;for(b=c.indexOf("\n\r");b!=-1;){++a;b=c.indexOf("\n\r",b+1)}return d+a};function Pr(a){lw.call(this,a)}w(Pr,lw);n=Pr.prototype;n.Dd=function(a){if(!this.bk)this.n=a};n.Pv=function(){return this.bk?this.bk.oq():this.n};n.nq=function(a){return this.bk?this.bk.nq(a):this.n};n.xE=function(){return this.bk||this.n};n.k=function(){Pr.c.k.call(this);this.bk=i};kw.e3={v3:"state_change",u3:"state_added",W2:"before_undo",V2:"before_redo"};function qw(a){this.U1=a&&a>0?a:0}
var rw=/(?:<!--.*?--\>|<!.*?>|<(\/?)(\w+)[^>]*>|[^<]+|<)/g,sw=Ec("script","style","pre","xmp"),tw=Ec("address","applet","area","base","basefont","blockquote","body","caption","center","col","colgroup","dir","div","dl","fieldset","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","hr","html","iframe","isindex","legend","link","menu","meta","noframes","noscript","ol","optgroup","option","p","param","table","tbody","td","tfoot","th","thead","title","tr","ul"),uw=Ec("br","dd","dt","br","li",
"noframes"),vw=Ec("br","hr","isindex");
qw.prototype.Hv=function(a){a=a.replace(/^\s*?( *\S)/,"$1");a=a.replace(/\s+$/,"");for(var b=this.U1,c=b?v():0,d=new ww,f=0,h=[],k;k=rw.exec(a);){var l=k[0];if(k.length==3){var m=k[2];if(m)m=m.toLowerCase();if(sw.hasOwnProperty(m))if(k[1]=="/"){k=h.length;if((k?h[k-1]:i)==m){h.pop();d.Ag(j,l,!h.length)}else d.Ag(j,l,j)}else{d.Ag(!h.length,l,j);h.push(m)}else if(h.length)d.Ag(j,l,j);else if(tw.hasOwnProperty(m)){m=vw.hasOwnProperty(m);k=k[1]=="/";d.Ag(m||!k,l,m||k)}else if(uw.hasOwnProperty(m)){m=
vw.hasOwnProperty(m);k=k[1]=="/";d.Ag(j,l,k||m)}else d.Ag(j,l,j)}else d.Ag(j,l,j);k=rw.lastIndex;if(!l||k<=f)e(Error("Regex failed to make progress through source html."));f=k;if(b)if(v()-c>b){d.Ag(j,a.substring(rw.lastIndex),j);rw.lastIndex=0;break}}d.EH();b=String(d);if(b.length!=a.length+d.TB)e(Error("Lost data pretty printing html."));return b};function ww(){this.fy=new jl}n=ww.prototype;n.TB=0;n.Yw=g;n.lI=j;
n.Ag=function(a,b,c){if((this.lI||a)&&!/^\r?\n/.test(b)&&!/\/ul/i.test(b))this.EH();this.fy.append(b);this.Yw=/\r?\n$/.test(b);this.lI=c&&!this.Yw};n.EH=function(){if(!this.Yw){this.fy.append("\n");++this.TB}};n.toString=function(){return this.fy.toString()};function xw(a,b){if(yw(a)){a.selectionStart=b;a.selectionEnd=b}else if(z){b=b;if(a.type=="textarea")b=a.value.substring(0,b).replace(/(\r\n|\r|\n)/g,"\n").length;b=b;a=a.createTextRange();a.collapse(g);a.move("character",b);a.select()}}function yw(a){try{return typeof a.selectionStart=="number"}catch(b){return j}};function zw(a){this.dc=a}w(zw,Og);zw.prototype.Yc=function(){if(!this.De){this.De=this.Dp();this.De.addEventListener("afterhide",this.CT,j,this)}this.De.z(g)};zw.prototype.hide=function(){this.De&&this.De.z(j)};zw.prototype.isOpen=function(){return!!this.De&&this.De.ga()};function Aw(a){this.Yj=a;this.Nh=new Jo("",g,this.Yj.dc);this.fm=new Lo(this.Yj.dc);this.em={};this.Qh("tr-dialog")}n=Aw.prototype;n.Ka=function(a){this.Nh.Ka(a);return this};
n.qB=function(a){this.fm.u("ok",a||"OK",g);this.em.ok=u(this.Yj.Ei,this.Yj);return this};n.Uo=function(a){this.fm.u("cancel",a||"Cancel",j,g);this.em.cancel=u(this.Yj.OT,this.Yj);return this};n.lB=function(a,b,c){c=c||db();this.fm.u(c,a);this.em[c]=b;return this};n.Qh=function(a){I(this.Nh.yS(),a);return this};n.hb=function(a){this.Nh.xa().appendChild(a);return this};
n.hf=function(){if(this.fm.Oe()){this.qB();this.Uo()}this.Nh.We(this.fm);var a=this.em;this.em=i;this.Nh.addEventListener("dialogselect",function(c){if(a[c.Wb])return a[c.Wb](c)});this.Nh.E0(g);var b=this.Nh;this.Nh=i;return b};n=zw.prototype;n.zq=ba(22);n.eh=function(a){return this.De.ac.rE(a)};n.Ei=function(a){return(a=this.Du(a))?this.dispatchEvent(a):j};n.OT=function(){this.dispatchEvent("cancel")};n.k=function(){if(this.De){this.hide();this.De.p();this.De=i}zw.c.k.call(this)};n.CT=function(){this.dispatchEvent("afterhide")};function Bw(a,b,c,d){this.K=c||J();this.cd=a;this.Ob=[];this.O1=b?b:0;this.iM=!!d;this.MP()}w(Bw,Og);n=Bw.prototype;
n.MP=function(){this.cd.className="goog-tabpane";var a=this.kS();this.pd=this.K.o("ul",{className:"goog-tabpane-tabs",tabIndex:"0"});this.Rd=this.K.o("div","goog-tabpane-cont");this.cd.appendChild(this.Rd);switch(this.O1){case 0:this.cd.insertBefore(this.pd,this.Rd);this.cd.insertBefore(this.DC(),this.Rd);I(this.cd,"goog-tabpane-top");break;case 1:this.cd.appendChild(this.pd);this.cd.appendChild(this.DC());I(this.cd,"goog-tabpane-bottom");break;case 2:this.cd.insertBefore(this.pd,this.Rd);I(this.cd,
"goog-tabpane-left");break;case 3:this.cd.insertBefore(this.pd,this.Rd);I(this.cd,"goog-tabpane-right");break;default:e(Error("Invalid tab location"))}this.pd.tabIndex=0;U(this.pd,this.iM?"mousedown":"click",this.xI,j,this);U(this.pd,"keydown",this.yI,j,this);this.BP(a)};n.DC=function(){Vf(".goog-tabpane-clear { clear: both; height: 0px; overflow: hidden }");return this.K.o("div","goog-tabpane-clear")};
n.k=function(){Bw.c.k.call(this);Cg(this.pd,this.iM?"mousedown":"click",this.xI,j,this);Cg(this.pd,"keydown",this.yI,j,this);delete this.cd;this.Rd=this.pd=i};n.kS=function(){for(var a=[],b=af(this.cd);b;){a.push(b);b=cf(b)}return a};n.BP=function(a){for(var b,c=0;b=a[c];c++)this.Rh(new Cw(b))};
n.Rh=function(a,b){a.Ca&&a.Ca!=this&&a.Ca instanceof Bw&&a.Ca.d_(a);var c=this.Ob.length;if(b!==undefined&&b!=c){c=b;this.Ob.splice(c,0,a);this.pd.insertBefore(a.ah,this.pd.childNodes[c])}else{this.Ob.push(a);this.pd.appendChild(a.ah)}a.Bz(this,c);if(!this.Yd){this.Yd=a;this.dispatchEvent(new Dw("change",this,this.Yd))}this.Rd.appendChild(a.Rd);a.Hz(a==this.Yd);for(b=c+1;a=this.Ob[b];b++)a.Hk=b};
n.d_=function(a){if(ka(a))a=this.Ob[a];this.Ob.splice(a.Hk,1);a.Bz(i);P(a.ah);P(a.Rd);for(var b=0;a=this.Ob[b];b++)a.Bz(this,b)};n.PK=function(a){if(a.W()&&(!this.Yd||a!=this.Yd)){this.Yd.Hz(j);a.Hz(g);this.Yd=a;this.dispatchEvent(new Dw("change",this,this.Yd))}};n.jd=function(a){a>=0&&a<this.Ob.length&&this.PK(this.Ob[a])};n.Ie=function(){return this.Yd?this.Yd.Hk:-1};n.iT=function(){return this.Yd||i};n.xa=function(){return this.Rd||i};n.b=function(){return this.cd||i};
n.xI=function(a){for(var b=a.target;b!=this.pd;){if(b.tagName=="LI"){var c;for(c=0;b=b.previousSibling;c++);this.jd(c);break}b=b.parentNode}a.preventDefault()};n.yI=function(a){if(!(a.altKey||a.metaKey||a.ctrlKey))switch(a.keyCode){case 37:a=this.Yd.Hk-1;this.jd(a<0?this.Ob.length-1:a);break;case 39:a=this.Yd.Hk+1;this.jd(a>=this.Ob.length?0:a);break;case 36:this.jd(0);break;case 35:this.jd(this.Ob.length-1);break}};
function Cw(a,b,c){var d,f;if(q(a)&&b===undefined)d=a;else if(b){d=b;f=a}else if(a){if(b=af(a)){d=qf(b);b.parentNode.removeChild(b)}f=a}this.K=c||J();this.Rd=f||this.K.o("div");this.ah=this.K.o("li",i,d);this.Hk=this.Ca=i;this.mb=g}n=Cw.prototype;n.pk=function(){return qf(this.ah)};n.Ka=function(a){kf(this.ah,a)};n.Ym=function(){return this.ah};n.xa=function(){return this.Rd};n.select=function(){this.Ca&&this.Ca.PK(this)};n.F=function(a){this.mb=a;this.ah.className=a?"goog-tabpane-tab":"goog-tabpane-tab-disabled"};
n.W=function(){return this.mb};n.Hz=function(a){if(this.W()){this.Rd.style.display=a?"":"none";this.ah.className=a?"goog-tabpane-tab-selected":"goog-tabpane-tab"}};n.Bz=function(a,b){this.Ca=a;this.Hk=b!==undefined?b:i};function Dw(a,b,c){R.call(this,a,b);this.page=c}w(Dw,R);function Ew(a,b){var c=J(a);return c.o("DIV",{style:"overflow:auto;height:100%;"},c.o("DIV",b?{style:"padding-left:5px;height:100%"}:{style:"padding-right:5px;height:100%"},a))};function Fw(a,b,c,d,f){this.dc=a;this.Bc=b;this.mH=!!c;this.ty=d||"";this.rZ=f||new qw;this.Tr=new V(this);this.iJ={}}w(Fw,zw);Fw.prototype.Cz=function(a){this.uJ=a;this.OJ()};Fw.prototype.I0=function(a){this.iJ=a};Fw.prototype.Yc=function(){Fw.c.Yc.call(this);this.AD.select();this.Bh.focus();xw(this.Bh,0)};function Gw(a){this.hP=a}w(Gw,R);Gw.prototype.type="ok";n=Fw.prototype;n.Dp=function(){return(new Aw(this)).Ka("Edit HTML").lB("Update",u(this.Ei,this),"ok").Uo().Qh("tr-new-raw-html-dialog").hb(this.Au()).hf()};
n.Du=function(){return new Gw(this.Bh.value)};n.NO=function(){yf(this.yh.M().body,{border:"0",margin:"0",background:"none transparent"});yf(this.yh.JS(),"background","none transparent")};n.k=function(){Fw.c.k.call(this);this.Kl.p();this.Tr.p();this.yh.$C();delete this.Kl;delete this.Bc;delete this.Tr;delete this.yh};n.uJ="";n.mH=j;n.ty="";n.OJ=function(){if(this.Bh)this.Bh.value=this.rZ.Hv(this.uJ)};n.r2=function(a){var b=this.yh.M(),c=b.body;c.innerHTML=a;yf(c,this.iJ);this.Bc.Dx(b)};
n.mY=function(){this.Kl.iT()==this.hJ&&this.r2(this.Bh.value)};n.Au=function(){var a=this.dc.o("DIV");this.Kl=new Bw(a,0,this.dc);this.Kl.Rh(this.wP());this.Kl.Rh(this.GP());U(this.Kl,"change",this.mY,j,this);this.OJ();return a};n.KC=function(a,b,c){a=new Cw(a,b,this.dc);a.Ym().title=c;return a};n.wP=function(){this.Bh=this.dc.o("TEXTAREA",{style:"height:294px;width:99%;direction:ltr"});return this.AD=this.KC(B?Ew(this.Bh):this.Bh,"HTML","Edit your HTML here")};
n.GP=function(){var a={style:"height:294px;width:99%"};if(z)a.src='javascript:""';a=this.dc.o("IFRAME",a);this.yh=new Jv(a);this.yh.load(u(this.j1,this));return this.hJ=this.KC(B?Ew(a):a,"Preview","Preview your changes here")};n.j1=function(){var a=this.yh.M();a.open();this.mH&&a.write("<!DOCTYPE HTML>");a.write("<html><head></head><body></body></html>");a.close();this.Tr.g(this.yh.pE(),["mousedown","click"],Hw,j);this.Tr.g(a,["mousemove","mouseover","mouseout"],Iv);this.ty&&Vf(this.ty,a);this.NO()};
function Hw(a){Iv();if(a instanceof R){a.preventDefault();a.stopPropagation();if(a.qE)a.kc.returnValue=j}else{a.preventDefault&&a.preventDefault();a.stopPropagation&&a.stopPropagation();a.cancelBubble=g;a.returnValue=j}};function Iw(a){Zj.call(this);this.VO=a}w(Iw,Zj);n=Iw.prototype;n.te=function(a){return a==this.VO};n.execCommand=function(){return this.bh.apply(this,arguments)};n.bh=function(a,b){this.aK||this.fv();if(!this.wa)this.wa=this.mm(J(this.n.cf),b);this.Ed=(a=this.n.O())&&new hm(a);Rl(this.n.sb.pa());Bg(this.wa,"afterhide",this.BT,j,this);this.n.ss(g);this.wa.Yc();this.dispatchEvent("dialogOpened");this.n.Ta();return g};
n.BT=function(){this.n.ss(j);this.aK||this.fv();this.bs();this.dispatchEvent("dialogClosed");this.n.Ta();this.n.TP("selectionchange")};n.bs=function(){this.n.focus();if(this.Ed){this.Ed.restore();this.Ed=i}};n.wQ=function(){if(this.Ed){this.Ed.p();this.Ed=i}};n.k=function(){this.fv();Iw.c.k.call(this)};n.aK=j;n.dx=j;n.fv=function(){if(this.wa&&!this.dx){this.dx=g;this.wa.p();this.wa=i;this.dx=j}};function Jw(a,b){a=Hk?new Kw(a,b):new Lw(a.Ud(0).vc(),b);a.qh()||(a=i);return a}function Kw(a,b){this.Cf=j;if(a){var c=a.hq(),d=a.jk();if(c&&d){var f=a.iq();c=new pm(c,b);var h=a.Rm();b=new pm(d,b);if(a.vg()){this.ba=b;this.Ig=h;this.ia=c;this.gg=f}else{this.ba=c;this.Ig=f;this.ia=b;this.gg=h}this.Cf=g}}}Kw.prototype.collapse=function(a){if(a){this.ia=this.ba;this.gg=this.Ig}else{this.ba=this.ia;this.Ig=this.gg}};Kw.prototype.qh=function(){return this.Cf};
Kw.prototype.toString=function(){return"MOZ:"+this.ba.toString()+"\n"+this.Ig+":"+this.ia.toString()+"\n"+this.gg};Kw.prototype.O=function(a){var b=this.ba.ck(a);a=this.ia.ck(a);if(!b||!a)return i;return hk(b,this.Ig,a,this.gg).vc()};
function Lw(a,b){this.Cf=j;if(a&&df(b,a.parentElement())){var c=b.ownerDocument.body.createTextRange();c.moveToElementText(b);b=a.duplicate();b.collapse(g);b.setEndPoint("StartToStart",c);this.ba=Mw(b);a=a.duplicate();a.setEndPoint("StartToStart",c);this.ia=Mw(a);this.Cf=g}}Lw.prototype.qh=function(){return this.Cf};Lw.prototype.toString=function(){return"IE:"+this.ba+","+this.ia};
function Mw(a){var b=a.duplicate(),c=a.text,d=c.length;b.collapse(g);b.moveEnd("character",d);for(var f,h=10;f=b.compareEndPoints("EndToEnd",a);){d-=f;b.moveEnd("character",-f);--h;if(0==h)break}a=0;for(b=c.indexOf("\n\r");b!=-1;){++a;b=c.indexOf("\n\r",b+1)}return d+a}Lw.prototype.O=function(a){var b=a.ownerDocument.body.createTextRange();b.moveToElementText(a);b.collapse(g);b.moveEnd("character",this.ia);b.moveStart("character",this.ba);return b};function Nw(a,b,c){qv.call(this,a,c);if(b&&!q(b)){if(b.cssStyles)this.Oj+=b.cssStyles;if(b.className){this.lC=b.className;this.Pa.g(this,"load",this.fN)}}}w(Nw,qv);Nw.prototype.fN=function(){this.lC&&I(this.b(),this.lC)};var Mq=rv;n=Nw.prototype;n.si=function(){return this.field||this.Yb};n.Cv=function(a){this.zg=J(a);this.mv=this.Yb=this.zg.b(this.id)};n.jn=function(){return Nw.c.jn.call(this)||Db};n.ss=function(a){Nw.c.ss.call(this,a);Db=a};n.tf=function(a){return Nw.c.tf.call(this,a)};
n.kw=function(){var a=this.Rv();return a&&new Jv(a)};n.MS=function(){if(!this.Lh())e("No iframe!");return this.kw()};n.rl=function(a,b,c,d){a=j;Nw.c.rl.call(this,a,b,c,d)};n.M=function(){return this.sb?this.sb.M():i};n.sS=function(){var a=this.O();return a&&Jw(a,this.b())};n.l0=function(a){var b=this.b();if(a=a.O(b)){Gk&&b.focus();Pl(a).select()}};n.Wq=function(a,b,c){Nw.c.Wq.call(this,a,b,c);Ik||On(this.zg.pa()).Dx(jf(a))};o("TR_EditableField",Nw,void 0);var Ow=Nw.prototype;Ow.registerPlugin=Ow.cb;
Ow.getPluginByClassId=Ow.tf;function Pw(a){Iw.call(this,"editHtml");this.Bc=a}w(Pw,Iw);Pw.prototype.gb=Tj("NewRawHtmlDialogPlugin");Pw.prototype.mm=function(a,b){a=new Fw(a,this.Bc,Fj(this.n.b()),i);if(b)a.Cz(b);else{b={};a.Cz(this.mS(b));a.I0(b)}a.addEventListener("ok",this.Ei,j,this);return a};Pw.prototype.mS=function(a){var b=this.n,c=b.jq();if(b=b.tf("Bidi"))c=b.Sr(c,a);return c};Pw.prototype.Ei=function(a){this.wQ();this.n.execCommand("clearlorem",g);this.n.rl(j,a.hP,j,g);B&&this.Bc.Dx(Fe(this.n.si()));this.n.py();this.n.fa()};function Qw(a){Pw.call(this,a.Bc)}w(Qw,Pw);Qw.prototype.mm=function(a){if(!ra||!dj)e(Error("EditPage not defined"));a=new Fw(a,this.Bc,Fj(this.n.b()),Nd("styles"),new qw(4500));a.Cz(vb.Ph());a.addEventListener("ok",this.Ei,j,this);return a};Qw.prototype.Ei=function(a){Qw.c.Ei.call(this,a);$m();nt(i,"htmledit")};function Zq(a,b){Nw.call(this,a);this.cv=j;H("impression_tracking")&&nn().F(g);this.cb(new ck);this.cb(new kn);this.cb(new vm);this.cb(new cq);this.cb(new hn);this.cb(new Qw(b));this.cb(new Uv);this.Zc=new kw;a=new Pr(this.Zc);a.xz(20);this.cb(a);this.cb(new aq);this.cb(new iw);this.cb(new hw);this.cb(new Iu);this.cb(new on);a=Ya(document.location.protocol,"//",G("sketchy_server_url"),"/client");var c=Ya(document.location.protocol,"//",document.location.host,"/relay.html");this.pj=new Sv(b,a,c,"writely");
this.pj.Mf(Nd("cosmo_id"));this.cb(this.pj);this.Qw=new Op;this.cb(this.Qw);this.cb(new Up);this.zj=new V(this);this.zj.g(this,Mq.Aj,this.WT);this.zj.g(this,Mq.PM,this.Fi);this.zj.g(this,Mq.TA,this.zf);this.zj.g(this,Mq.tM,this.rd);this.pb=new Kq(X,this);if(H("enable_cloudboard")&&H("cloudboard_native_integration"))this.TO=pn("editorDeferred",4);si(function(){H("equation_editor")&&pn("editorDeferred",7)(this);pn("editorDeferred",10)();pn("editorDeferred",13)(this)},0)}Zq.Gb(Nw);n=Zq.prototype;
n.Rk=function(){var a=this.mv.id,b=new Jv(this.mv),c=b.M().body;c.id=a;this.YK(c);Vf(this.Oj,this.si());if(B&&Cd("1.9"))c.className+=" br_fix";b.nJ(this.Pa,g);this.Pb("mousedown",this.cV);this.EF();a=["copy","cut"];H("impression_tracking")&&this.Pb(a,this.KZ);H("enable_cloudboard")&&H("cloudboard_native_integration")&&this.Pb(a,this.TO)};n.KZ=function(){nn().xJ(2)};
n.QW=function(a){switch(a){case "w-link":case "w-SelectAll":case "w-Cut":case "w-Copy":case "w-Paste":case "w-BLOCKQUOTE":case "w-comment":return g;default:return j}};n.Z1=function(a){var b=X.document.body;b=b.style.direction||b.dir;if(a!=b){Vd("rtl",!Sd("rtl"));a=i;if(b=="rtl"&&!Sd("fullwidtheditor"))a=function(){hu()};bh("save_doc_settings",{docid:Hd(),usesSS:g,rtl:b=="rtl"},a)}};
n.execCommand=function(a,b){var c;c=arguments;var d=arguments[1];if(this.cv&&(a==$.Vl||a==$.Tl))return j;switch(a){case $.Rl:if(typeof d=="undefined"){Xr=!editUI.V.Lv(a);editUI.V.oz(a,Xr)}else Xr=d;break;case $.Sl:if(typeof d=="undefined"){Yr=!editUI.V.Lv(a);editUI.V.oz(a,Yr)}else Yr=d;break;case $.Ul:if(typeof d=="undefined"){Zr=!editUI.V.Lv(a);editUI.V.oz(a,Zr)}else Zr=d;break;case $.Ho:cs=d;break;case "w-textStyle":$r=d;break;case "w-fontName":bs=d;break;case "w-fontSize":as=d.toString();break}if(a==
"w-spell"){if(d){B&&x.$e(g,g);x.Uc();this.cv=g}Dr(d);if(!d){x.fa();x.Ta();this.cv=j}return g}if(this.QW(a)){B&&this.$e(g,g);this.Uc();c=this.RQ.apply(a,c);this.fa();this.Ta()}else{var f;if(a==$.FM||a==$.OM){f=X.document.body;f=f.style.direction||f.dir}c=Zq.c.execCommand.call(this,a,b);if(a==$.FM||a==$.OM)this.Z1(f);if((H("enable_comments")||H("enable_footnotes"))&&(a==$.Vl||a==$.Tl||a==$.Po)){dn();$m()}}return c};
n.iH=function(){try{var a=this.O(),b=this.b(),c=Ql(b,0,a.L(),a.ka());if(!xa(c.Ab()))return j;var d=Ql(a.da(),a.Ma(),b,Pj(b));if(!xa(d.Ab()))return j;var f=b.getElementsByTagName("img"),h=f[0];if(h){var k=f[f.length-1];if(!a.containsNode(h)||!a.containsNode(k))return j}return g}catch(l){return j}};
n.RQ=function(a){X.focus();var b,c=arguments[1];switch(a){case "w-link":Tp(Vp());b=g;break;case "w-comment":if(H("enable_comments")){c=new ra.xp.fB;(Rw||(Rw=new Sw)).Jt(c)}break;case "w-Cut":case "w-Copy":case "w-Paste":case "w-SelectAll":try{if(E&&a=="w-Paste")b=j;else{X.document.execCommand(a.substring(2),j,c);b=g}}catch(d){b=j}if(!b){c="Your browser does not allow access to your computer's clipboard.\n\nInstead, please use Ctrl-C for Copy, Ctrl-X for Cut and Ctrl-V for Paste,\nor use Edit menu above the browser toolbar.";
if(md)c=c.replace(/Ctrl/g,"\u2318");F(c)}break;case "w-BLOCKQUOTE":b=X.document.execCommand("FormatBlock",j,"blockquote");break;default:b=j}return b};n.WT=function(){Jp();var a=this.tf(on.prototype.gb());if(a&&a.kz){a.OO();nt(i,"paste")}z&&this.js.start();if(H("enable_comments")||H("enable_footnotes"))window.setTimeout(cn,0)};n.Fi=function(){try{this.pb.cl()}catch(a){rce("Cursor update in handleSelectionChange",a)}};
n.zf=function(){this.pb.yY();var a=this.tf(on.prototype.gb());if(z&&!this.dq&&!(a&&a.ly))try{this.pb.mj()}catch(b){rce("Cursor restore in handleFocus",b)}this.dq=j};n.rd=function(){this.pb.xY()};n.dq=j;n.hi=j;n.cV=function(){this.dq=g;window.setTimeout(u(function(){this.dq=j},this),0);this.hi=j};n.Sc=function(){var a=this.tf("LinkBubble");a&&a.Sc()};function Yq(a,b){Nv.call(this,a,b);this.zj=new V(this);this.zj.g(this,Mq.uM,fr);this.zj.g(this,Mq.TA,this.rU)}Yq.Gb(Nv);Yq.prototype.execute=function(a,b){var c=g;switch(a){case "w-print":oq();break;case "w-save":pq(i);break;default:c=Yq.c.execute.call(this,a,b);break}return c};Yq.prototype.rU=function(a){typeof editUI!="undefined"&&editUI.GK(x!=a.n)};function hp(){this.qb="InsertTable";Y.call(this);this.Jd=i}hp.Gb(Y);n=hp.prototype;
n.sa=function(){if(hp.c.sa.call(this)){if(this.Jd=Z?Si(Z,"table"):i){this.Ka("Change Table");this.Vc("Change");this.Ha("rowsandcols");this.Ha("width_same_row");this.Ik(this.Jd,"width","width_select","width_amt");this.Ik(this.Jd,"height","height_select","height_amt");this.xj();this.ud(this.Jd,"float","float_select","select");this.Jd.parentNode!=i&&this.Jd.parentNode.tagName=="DIV"&&this.ud(this.Jd.parentNode,"align","align_select","select");this.ud(this.Jd,"cellPadding","padding_amt",1);this.ud(this.Jd,
"cellSpacing","spacing_amt",2);this.ud(this.Jd,"border","border_amt",0);var a=this.Jd.getAttribute("bordercolor");this.nh(a,"bordercolor");a=Ii(this.Jd);this.nh(a,"bgcolor")}else{this.Ka("Insert Table");this.Vc("Insert");this.Db("rowsandcols");this.Db("width_same_row");this.na("rows","2");this.na("columns","2");this.na("width_select","0");this.na("height_select","1");this.na("padding_amt","3");this.na("spacing_amt","0");this.na("align_select","select");this.na("float_select","select");this.na("border_amt",
"1");this.nh("#000000","bordercolor");this.nh("","bgcolor");this.xj()}if(!this.vb){a=O(this.j("width_select"));var b=O(this.j("height_select"));U(a,"change",this.xj.bind(this));U(b,"change",this.xj.bind(this));this.vb=g}}};n.Na=function(a){var b=this.Jd;if(!b){this.hm("rows",1,100);this.hm("columns",1,25);this.hm("padding_amt",0,50);this.hm("spacing_amt",0,50);this.hm("border_amt",0,50);b=this.AX()}b&&this.x2(b);x.fa();Jp();hp.c.Na.call(this,a)};
n.AX=function(){var a=Xi(),b="";if(B||E)b="<br>";var c='<div><table id="'+a+'"><tbody>',d=this.Y("columns"),f=this.Y("rows"),h="";if(this.Wa("width_same"))h=' width="'+100/d+'%"';for(var k=0;k<f;k++){c+="<tr>";for(var l=0;l<d;l++)c+="<td"+h+">"+b+"</td>";c+="</tr>"}c+="</tbody></table></div>";a=ch(c,a,j);if(!a)return i;if(a.tagName=="div"){b=X.document.createElement("table");a.appendChild(b);a=b}bj(X,a.parentNode);return a};
n.x2=function(a){this.zl(a,"width_select","width_amt","width");this.zl(a,"height_select","height_amt","height");var b=a.parentNode;if(b.tagName.toUpperCase()!="DIV"){var c=X.document.createElement("DIV");a.parentNode.insertBefore(c,a);a.parentNode.removeChild(a);c.appendChild(a)}c=this.Y("align_select")||"select";this.Gd(a.parentNode,c,"align",c!="select");c=this.Y("float_select")||"select";this.Gd(a,c,"float",c!="select");c=this.Y("padding_amt")||"select";this.Gd(a,c,"cellPadding",c!="select");c=
this.Y("spacing_amt")||"select";this.Gd(a,c,"cellSpacing",c!="select");c=this.Y("border_amt")||"";if(B){var d=b.style[Af("position")]||"";yf(b,"position",d=="relative"?"absolute":"relative");si(function(){yf(b,"position",d)})}this.Gd(a,c,"border",c!=""&&!isNaN(c));this.IJ(a);c=["tbody","thead","tfoot","th","tr","td"];for(var f=0,h;h=c[f];f++){h=a.getElementsByTagName(h);for(var k=0,l;l=h[k];k++)this.IJ(l)}a.getAttribute("border")=="0"?I(a,"zeroBorder"):xe(a,"zeroBorder");this.eo(a,"bordercolor","bordercolor");
this.eo(a,"bgcolor","bgcolor")};n.IJ=function(a){yf(a,"borderStyle","");yf(a,"borderWidth","");yf(a,"borderColor","")};function Tw(a){if(a)Z=i;oh("InsertTable")};function nr(a,b,c,d,f,h,k){this.OA=a;this.PA=b;this.D=c;this.uc=d;this.jt=f;this.Oc=h||this.Bn;this.Ad=k||0;this.ea=new vi;this.Ed=i}var Uw=md?"&#x2318;+":"Ctrl+";n=nr.prototype;
n.Bn=function(a){this.Ed&&this.Ed.restore().select();switch(a.target.Ya()){case 0:this.jt.execute("w-Cut");break;case 1:this.jt.execute("w-Copy");break;case 2:this.jt.execute("w-Paste");break;case 3:this.jt.execute("w-SelectAll");break;case 4:oh("EditHtmlSelection");break;case 5:oh("ChangeList");break;case 6:this.gI(g);break;case 7:this.gI(j);break;case 8:Tw(j);break;case 9:oh("ChangeRow");break;case 10:oh("ChangeColumn");break;case 11:Vw(g);break;case 12:Vw(j);break;case 13:jq(g);break;case 14:jq(j);
break;case 15:Ww(g);break;case 16:Ww(j);break;case 17:Xw();break;case 18:Yw();break;case 19:Zw();break;case 22:$w("header");break;case 23:$w("footer");break;case 24:oh("ChangeCell");break;case 25:Vr();break;default:}this.p()};
n.Yc=function(){this.om("Cut",Uw+"X",0);this.om("Copy",Uw+"C",1);this.om("Paste",Uw+"V",2);this.om("Select All",Uw+"A",3);this.ea.oa(new oi);this.Ad&512&&this.cc("Paste HTML at Selection",25);this.cc("Insert HTML at Selection...",4);this.w1();if(this.Ad&8){this.ea.oa(new oi);this.cc("Delete Header...",22)}else if(this.Ad&16){this.ea.oa(new oi);this.cc("Delete Footer...",23)}if(this.Ad&32||this.Ad&64||this.Ad&256){this.ea.oa(new oi);if(this.Ad&32||this.Ad&64){this.om("Change list...",Uw+"9",5);if(this.Ad&
128){this.cc("Move list item up",6);this.cc("Move list item down",7)}}}var a=Bh(this.uc);this.Ed=a&&a.hj();this.ea.ll(j);U(this.ea,"action",this.Oc,g,this);U(this.uc.document,"mousedown",this.p,j,this);U(this.uc.document,"keydown",this.p,g,this);this.ea.db(this.D);this.ea.fL(this.OA,this.PA,0);this.ea.hd(j);this.ea.z(g)};
n.w1=function(){if(this.Ad&1){this.ea.oa(new oi);this.cc("Change table...",8);if(this.Ad&2){this.cc("Change row...",9);if(this.Ad&4){this.cc("Change column...",10);this.cc("Change cell...",24)}}this.ea.oa(new oi);if(this.Ad&2){this.cc("Move row up",11);this.cc("Move row down",12);this.cc("Insert row above",13);this.cc("Insert row below",14);this.cc("Insert column on the left",15);this.cc("Insert column on the right",16);this.ea.oa(new oi)}this.cc("Delete table",17);if(this.Ad&2){this.cc("Delete row",
18);this.cc("Delete column",19)}}};n.cc=function(a,b){this.ea.oa(new mi(a,b))};n.om=function(a,b,c){this.cc([Oe("div","goog-menuitem-accel",b),document.createTextNode(a)],c)};n.p=function(){Cg(this.ea,"action",this.Oc,g,this);Cg(this.uc.document,"mousedown",this.p,j,this);Cg(this.uc.document,"keydown",this.p,g,this);this.ea.p()};n.bT=function(a){return uf(a,function(b){return b.nodeName=="OL"||b.nodeName=="UL"},g)};
n.gI=function(a){if(Z){var b=tf(Z,"LI"),c=this.bT(b);if(!c||!b)rce("moveListItem_","List or item null");if(!(a&&b.previousSibling==i||!a&&b.nextSibling==i||b.parentNode!=c)){if(a){a=b.previousSibling;c.insertBefore(c.removeChild(b),a)}else if(b.nextSibling&&b.nextSibling.nextSibling){a=b.nextSibling.nextSibling;c.insertBefore(c.removeChild(b),a)}else c.appendChild(c.removeChild(b));Zi(Z);this.uc.focus()}}};var Z=i,hh=i,dh=i;function Cp(){var a=ax();if(a){hh=$i(X);dh=a;Z=fq()}}function hq(a,b){if(!a)return j;if(j in a)return j;return a.tagName.toLowerCase()==b}
function Eq(a){if(y)var b=X.pageXOffset,c=X.pageYOffset;var d=X.document.getElementById(a);if(d){d=Ba(d.innerHTML);Aj("addtouserdictionary",{badword:d},function(){var f=X.document.getElementById(a);f=Ba(f.innerHTML);var h=X;if(y)var k=X.pageXOffset,l=X.pageYOffset;for(var m=(new Ee(h.document)).sf("span","misspell"),p=0;p<m.length;p++)if(Ba(m[p].innerHTML)==f)if("insertAdjacentText"in m[p]){m[p].insertAdjacentText("beforeBegin",m[p].innerText);m[p].parentNode.removeChild(m[p])}else{var t=h.document.createTextNode(f);
m[p].parentNode.replaceChild(t,m[p])}y&&X.scrollTo(k,l)},"spellCheck_addtodict_"+Hd());y&&X.scrollTo(b,c)}}function bx(a,b,c){b.getAttribute(c)!=i&&b.getAttribute(c)!=""&&a.setAttribute(c,b.getAttribute(c),0)}function cx(a,b){bx(a,b,"style");bx(a,b,"width");bx(a,b,"height");bx(a,b,"bgcolor");x.fa();x.Ta()}
function jq(a){if(Z){var b=Si(Z,"tr"),c=Si(b,"table");if(c&&b){var d=b.rowIndex;a||d++;a=c.insertRow(d);cx(a,b);for(c=0;c<b.cells.length;c++){d=a.insertCell(-1);if(z)d.mergeAttributes(b.cells[c]);else{cx(d,b.cells[c]);d.innerHTML="<br />"}}}else rce("InsertRow","Table or row null");x.fa();x.Ta()}}
function Vw(a){if(Z){var b=Si(Z,"tr"),c=Si(b,"table");if(c&&b){var d=b.rowIndex;if(a&&d==0)return Zi(Z);if(!a&&d==c.rows.length-1)return Zi(Z);var f=b.parentNode;f.removeChild(b);if(a)f.insertBefore(b,c.rows[d-1]);else d==c.rows.length-1?f.appendChild(b):f.insertBefore(b,c.rows[d+1]);Zi(Z);X.focus()}else rce("MoveRow","Table or row null");x.fa();x.Ta()}}
function Ww(a){if(Z){var b=Si(Z,"td"),c=Si(b,"table");if(c&&b){b=b.cellIndex;a||b++;for(var d=0;d<c.rows.length;d++){var f=c.rows[d],h=a?f.cells[b]:f.cells[b-1];f=f.insertCell(b);if(h)if(z)f.mergeAttributes(h);else{cx(f,h);f.innerHTML="<br />"}}Ld("Click 'OK' to evenly distribute column widths. Click 'Cancel' to insert the new column without adjusting widths.")&&dx(c)}else rce("InsertColumn","Table or column null");x.fa();x.Ta()}}
function dx(a){for(var b=100/a.rows[0].cells.length+"%",c=0;c<a.rows.length;c++)for(var d=a.rows[c],f=0;f<d.cells.length;f++){var h=d.cells[f];h.width=b;if(h.style&&h.style.width)h.style.width=""}x.fa();x.Ta()}function Yw(){if(Z){var a=Si(Z,"tr"),b=Si(a,"table");b&&a?b.deleteRow(a.rowIndex):rce("DeleteRow","Table or row null");x.fa();x.Ta();X.focus()}}
function Zw(){if(Z){var a=Si(Z,"td"),b=Si(a,"table");if(b&&a){a=a.cellIndex;for(var c=0;c<b.rows.length;c++){var d=b.rows[c];a<d.cells.length&&d.deleteCell(a)}Ld("Click 'OK' to evenly distribute column widths. Click 'Cancel' to delete the column without adjusting widths.")&&dx(b)}else rce("DeleteColumn","Table or column null");x.fa();x.Ta();X.focus()}}function Xw(){if(Z){var a=Si(Z,"table");a?a.parentNode.removeChild(a):rce("DeleteTable","Table is null");x.fa();x.Ta();X.focus()}}
function $w(a){if(Z){(a=Ti(Z,"google_"+a))?a.parentNode.removeChild(a):rce("DeleteHeaderFooter","Header/Footer is null");x.fa();x.Ta();X.focus()}}
function ex(a){var b=X.document,c="google_"+a;if(b){var d=b.getElementById(c),f=b.body;if(d)f.removeChild(d);else{d=b.createElement("div");d.className=c;d.id=c;d.innerHTML="<p>&nbsp;</p>"}var h;if(a=="header"){f.insertBefore(d,f.firstChild);h=0}else f.appendChild(d);c=b.documentElement;b=J((X||da||window).document).oe().y;if(a!="header"){a=Me(X).height;if(E)a=window.innerHeight-200;h=Math.max(f.offsetHeight,f.scrollHeight)-a}(new fx(c,[0,b],[0,h],500,gx)).play();iq(d);x.fa();x.Ta()}}
function hx(){if(z)ix();else{var a=Vp();if(a==i)F("Sorry, but we were unable to insert this page break.");else{if(qq(a,"table"))if(!Ld("This browser probably can't break the page in the\nmiddle of this table.         Continue anyway?"))return;window.setTimeout(ix,100)}}}function ix(){ih("<hr class=pb>");x.fa();x.Ta()}o("AddWordToDict",Eq,void 0);o("DeleteColumn",Zw,void 0);o("DeleteHeaderFooter",$w,void 0);o("DeleteRow",Yw,void 0);o("DeleteTable",Xw,void 0);o("InsertColumn",Ww,void 0);
o("InsertRow",jq,void 0);o("MoveRow",Vw,void 0);function Jr(a,b){b.eH?b.J.appendChild(a):b.parentNode.insertBefore(a,b);return g}
function Ir(a,b,c){if(document.importNode){var d=a.importNode(b,c);d.nodeType==1&&b.getAttributeNode("style")&&!b.getAttributeNode("style").specified&&d.removeAttribute("style");return d}d=i;switch(b.nodeType){case 1:if(b.getAttribute("name")){d=a.createElement("div");d.innerHTML=b.cloneNode(j).outerHTML;d=d.removeChild(d.firstChild)}else{d=a.createElement(b.nodeName);jx(b,d)}if(c&&b.firstChild){c=0;for(var f=[],h=[],k=b;k&&k.nodeType==1&&k.nodeName.toLowerCase()!="body";){f.unshift("<"+k.nodeName+
">");h.push("</"+k.nodeName+">");k=k.parentNode;c++}k=a.createDocumentFragment();k.appendChild(a.createElement("body"));k.body.innerHTML=f.join("")+b.innerHTML+h.join("");for(a=k.body;a&&c>0;){a=a.firstChild;c--}if(!a)e(new Error("Root for insert disappeared, root.id = "+b.id));for(a=a.firstChild;a;){c=a.nextSibling;d.appendChild(a);a=c}if(d.firstChild&&d.firstChild.nodeType==3&&/^[\s]/.test(b.firstChild.nodeValue))d.firstChild.nodeValue=b.firstChild.nodeValue}break;case 3:d=a.createTextNode(b.nodeValue);
break;case 8:d=a.createComment(b.nodeValue);break;default:e(new Error("importNode_: unknown type: "+b.nodeType))}return d}
function Lr(a,b){if(a.nodeType==1)if(b.nodeName!=a.nodeName||z&&a.getAttribute("name")!=b.getAttribute("name")){a=Ir(b.ownerDocument,a,j);for(var c=b.firstChild;c!=i;){var d=c.nextSibling;a.appendChild(b.removeChild(c));c=d}b.parentNode.replaceChild(a,b)}else{for(c=0;c<b.attributes.length;c++){d=b.attributes[c];if(d.specified){var f=a.getAttributeNode(d.nodeName);if(f==i||!f.specified||f.nodeValue==i)b.removeAttribute(d.nodeName)}}jx(a,b)}else if(a.nodeType==3||a.nodeType==8)if(b.nodeValue!=a.nodeValue)b.nodeValue=
a.nodeValue}function jx(a,b){for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];if(d.specified&&d.nodeValue!=i){var f=d.nodeName;if(f=="class")b.className=d.nodeValue;else b.setAttribute(f,d.nodeValue)}}if(z)if((c=a.getAttributeNode("style"))&&c.specified)b.style.cssText=a.style.cssText}
function Kr(a){var b=-1,c=i;if(a.previousSibling&&a.previousSibling.nodeType==3&&a.nextSibling&&a.nextSibling.nodeType==3){c=a.previousSibling;b=c.nodeValue.length}a=a.parentNode.removeChild(a);c&&c.nodeValue.length>b&&c.splitText(b);return a};var kx=/[^0-9A-Za-z]+/g,lx=/^[\x09\x0a\x0b\x0c\x0d ]+|[\x09\x0a\x0b\x0c\x0d ]+$/g,mx=/[\x09\x0a\x0b\x0c\x0d ][\x09\x0a\x0b\x0c\x0d ]+/g;
function Mr(a,b){var c=0;if(a.nodeType==3&&b<=0){if(a.previousSibling&&a.previousSibling.nodeType==3)return 0;b=i;if(a.nextSibling&&a.nextSibling.nodeType==3){b=[];for(a=a;a&&a.nodeType==3;){b.push(a.nodeValue);a=a.nextSibling}b=b.join("")}else b=a.nodeValue;b=b.replace(lx,"").replace(mx," ");return b.length}else if(a.nodeType==1){if(b<=0)if(a.id){c=parseInt(a.id.substring(0,6),36);if(isNaN(c)){c=a.id.replace(kx,"").substring(0,6);c=parseInt(c,36);if(isNaN(c))c=666}}else c=31137;a=a.firstChild;for(var d=
0;a;){var f=Mr(a,b-1);if(f!=0){c=c*37+f&2147483647;d++}a=a.nextSibling}if(d>0)c=c*37-d&2147483647;return c}return c};var X=i,nx;var ox=B&&Cd("1.8")||z&&Cd("6")||E&&Cd("522")||y&&Cd("9.50");if(navigator.userAgent.toLowerCase().indexOf("konqueror")>=0)ox=j;var px=typeof document.getElementById!="undefined"&&typeof document.designMode!="undefined";nx=(!ox||!px)&&Gd().fc("browserok")!="true"?j:g;nx||window.location.replace("DocAction?action=unsupported_browser");var Js=i,Sr=j,qx=0;
function me(a,b,c){if(!(!c&&Js!==i&&Js>(new Date).getTime()/1E3)){try{be=g;if(typeof RunningOnLocalServer=="function"&&!RunningOnLocalServer()){F(a);b&&rce("Postback Error",a)}else zb(a)}catch(d){}finally{be=j}Js=(new Date).getTime()/1E3+300}}function zr(a,b){var c=new Tc("Revs");c.$("id",a);c.$("tab","revcomp");c.$("frev",a+":"+(b-1));c.$("trev",a+":"+b);c=Zd(c.toString());return'<a href="'+c+'" target="_blank">Show differences</a>'}
function Ls(){O("CollideWarning").style.display="none";z&&Cg(window,"scroll",rx)}function Ks(a){var b="",c=a.length;if(c>3)b=Ha(a[0])+(", "+(Ha(a[1])+(" + "+(c-2+" more"))));else if(c==3)b=Ha(a[0])+(", "+(Ha(a[1])+(", "+Ha(a[2]))));else if(c==2)b=Ha(a[0])+(", "+Ha(a[1]));else if(c==1)b=Ha(a[0]);if(b!=O("WhoIsEditing").innerHTML)O("WhoIsEditing").innerHTML=b;O("CollideWarning").style.display="";z&&U(window,"scroll",rx)}
function rx(){var a=O("CollideWarning"),b=a.style.display;if(b=="block")a.style.display="";else b="block";a.style.display=b}
function It(){try{if(wp()&&ub())if(IS_GEARS&&window.offline.SW(g)){var a=vb.Ph();Id().l2(Hd(),a,Wd())}else return E?"You have unsaved changes in this document. Click 'Stay on this Page' now, then 'Save' to save them. Click 'Leave this Page' now to discard them.":"You have unsaved changes in this document. Click Cancel now, then 'Save' to save them. Click OK now to discard them."}catch(b){rce("EditorWindowClosing failed.",b)}finally{IS_GEARS&&window.offline.p()}}
function $t(a,b){function c(){var d="View?docID="+encodeURIComponent(Hd())+"&revision=_latest";if(a)d+=a;if(b)window.open(d);else{Pi();window.location.href=d}}wp()?nt(c):c();return j}function sx(a,b){function c(){var d="ViewDocTranslation?docID="+encodeURIComponent(Hd())+"&revision=_latest&targetLang="+a;if(b)window.open(d);else{Pi();window.location.href=d}}wp()?nt(c):c();return j}function bu(a){a&&a.blur();nt(Oi)}
function pq(a){nt(a,"manual");try{Br.jl.aW()}catch(b){rce("SaveDocContentsWithNotify",b)}}function nt(a,b){if(wp())return(new le(a,j,g,b)).send();else a()}function Jp(){sb=v();rb++;try{var a=kb();a.gH()||a.ts(g)}catch(b){rce("writely.DocumentState.markChanged",b)}++qx;Js=i}
function ih(a){if(!a)return i;X.focus();var b=Bh(X);if(b){b.isCollapsed()||b.gd();var c=X.document.createElement("span");c.innerHTML=a;var d;if(c.hasChildNodes()){a=c.removeChild(c.firstChild);for(d=b.insertNode(a,g);c.hasChildNodes();){a=c.removeChild(c.firstChild);Ye(a,d);d=a}}if(!z)(b=d.nextSibling)&&b.nodeType==3&&b.nodeValue==""&&P(b);d=Xl(d,j);Jp();return d}else return i}
function ax(){var a=$i(X),b=i;if(a)if("rangeCount"in a&&"getRangeAt"in a){if(a.rangeCount==0)return i;b=a.getRangeAt(a.rangeCount-1)}else if("createRange"in a)try{b=a.createRange();if(!("parentElement"in b))if("length"in b){var c=b(0);b=X.document.body.createTextRange();b.moveToElementText(c)}}catch(d){}if(!b)return i;a=i;if("startContainer"in b)a=b.startContainer;else if("parentElement"in b)a=b.parentElement();if(Fe(a)!=X.document)return i;return b}
function gh(a){if(z&&"htmlText"in a){var b=a.htmlText;if(/^[\s]*<tbody/i.test(b)&&/<\/tbody>[\s]*$/i.test(b)){b=a.parentElement().parentNode;var c=b.document.createElement("div");b.parentNode.replaceChild(c,b);c.appendChild(b);a.moveToElementText(c)}}}var Fr=-1;function Gr(){rce("RestoreCheckNow failed.",Fr);Fr=-1}
function tx(){var a="http://b/createIssue?component=35239&notes=",b="unknown";if(y)b="Opera "+Ad;if(z)b="Internet Explorer "+Ad;if(B)b=(b=navigator.userAgent.match(/Firefox\/([\d\.]+)/))&&b[1]?"Firefox "+b[1]:"Gecko "+Ad+" (Firefox or Mozilla)";if(E){b=navigator.userAgent.match(/Chrome\/([\d\.]+)/);var c=navigator.userAgent.match(/Version\/([\d\.]+)/);b=b&&b[1]?"Chrome "+b[1]:c&&c[1]?"Safari "+c[1]:"WebKit "+Ad}c=new jl;c.append("CONFIGURATION:\n");c.append("Build: ",G("label"),"\n");c.append("Browser: ",
b,"\n");c.append("OS: ",ud,"\n");c.append("Language: ",G("language"),"\n");c.append("Gears enabled: ",window.offline?"yes":"no","\n");c.append("Document ID and revision: ",lb,"\n\n");c.append("STEPS TO REPRODUCE:\n[add here]\n\n");c.append("RESULT:\n[add here]\n\n");c.append("EXPECTED:\n[add here]\n\n");c.append("[Please attach a screenshot if possible.");B&&c.append(" Also note if you are using any Firefox extensions.");c.append("]");a+=encodeURIComponent(c);window.open(a)}o("reportBug",tx,void 0);
o("DoneButtonClicked",bu,void 0);function ux(a,b,c){Jo.call(this,a,b,c);this.uW=this.cx=this.bx=j;this.AW=g;this.XQ="";this.lu=this.NH("copy-checkbox");this.RD=this.NH("copy-filename-input");this.Ka("Copy Document?");this.hb(Ya("<div>Would you like to create a new copy of the document?</div>",'<div><br><input id="',this.RD,'" type="text" style="width: 95%;"></div>','<div><br><label for="',this.lu,'">','<input id="',this.lu,'" type="checkbox">',"Also copy document collaborators","</label></div>"))}w(ux,Jo);n=ux.prototype;
n.z=function(a){ux.c.z.call(this,a);if(a){this.uA();this.m2()}};n.uA=function(){var a=this.wE();if(a){a.disabled=j;a.checked=this.bx;a.disabled=this.cx;Q(a.parentNode.parentNode,!this.uW)}};n.m2=function(){var a=this.HS();if(a){a.value=this.XQ;Q(a.parentNode,!this.AW)}};n.pS=function(){var a=this.wE();return a?!a.disabled&&a.checked:!this.cx&&this.bx};n.i0=function(a){this.bx=a;this.uA()};n.j0=function(a){this.cx=a;this.uA()};n.wE=function(){return this.G().b(this.lu)};n.HS=function(){return this.G().b(this.RD)};var vx;function wx(a){if(!vx){vx=new ux;(new V).g(vx,"dialogselect",xx)}vx.j0(!a||!Sd("isshared"));vx.i0(j);vx.xa().style.padding="8px";vx.z(g)}
function xx(a){if(a.Wb=="ok"){(a=O("copydocform"))&&P(a);a=vx.pS();a=Oe("form",{action:"DocAction?action=copy&ts="+v(),target:"_blank",method:"POST",id:"copydocform"},Oe("input",{name:"docid",value:Hd(),type:"hidden"}),Oe("input",{name:"copycollaborators",value:a,type:"hidden"}),Oe("input",{name:"POST_TOKEN",value:G("posttoken"),type:"hidden"}));document.body.appendChild(a);a.submit()}}
function yx(){if(!window.LIMITED_EDITING)if(H("shelly_chrome"))Br.mJ();else{var a;a=Xd();a=(a=Kd("Enter new document name:",a||""))?a.replace(/[\r\n]/g," "):i;if(a!=i&&a.length>0){Zg();Yd(a);nt(i)}}}function oq(){window.LIMITED_EDITING?$t("&spi=1&hgd=1",g):nt(function(){zx("Print")})}
function zx(a,b){var c="";if(b)c+="&"+fd(b).toString();if(a!="Export")c+="&print=1";b="MiscCommands?command=save_print_settings&docID="+encodeURIComponent(Hd())+c;c=new Date((new Date).getTime()+12E4);document.cookie="PDF_INLINE=ok;path=/;expires="+c.toUTCString();if(a=="Export"){z||lj("print");Ei(b)}else window.open(b)}o("RenameDocument",yx,void 0);var Ax=i;
function Bx(a,b){var c=[],d=[],f=9;do{var h=Cx(f);if(h&&h.length>0){d.push(f);c=c.concat(h)}}while(--f);c=c.sort(function(m,p){return p.position-m.position});if(!c.length){F("A table of documents cannot be generated for documents that do not use the Heading paragraph styles.");return j}f=d.length-1;var k=0;h={};do h[d[f]]=k++;while(f--);k=0;d=['<ol class="writely-toc-',a,'">'];f=c.length-1;do{for(var l=h[c[f].kX];k!=l;)if(k<l){d.push('<ol style="margin-left:0" class="writely-toc-subheading writely-toc-',b,
'">');k++}else{d.push("</ol>");k--}d.push('<li><a target="_self" href="#',c[f].id,'">',Ba(c[f].EV),"</a>")}while(f--);for(;k>=0;){d.push("</ol>");k--}d=d.join("");b=a+"+"+b;if(a=Dx()){a.innerHTML=d;a.setAttribute("toctype",b)}else{ih('<div class="writely-toc" id="WritelyTableOfContents" toctype="'+b+'">'+d+"</div>");a=Dx()}b=a.parentNode;do/^h\d$/i.test(b.tagName)&&b.parentNode.insertBefore(a,b);while(b=b.parentNode);if(z){a=a.getElementsByTagName("a");f=a.length-1;do(""+a[f].getAttribute("href")).indexOf("#")!=
0&&a[f].setAttribute("href","#"+(""+a[f].getAttribute("href")).split("#")[1]);while(f--)}Jp();x.fa();x.Ta();rr();return g}function Ex(a){if(X.document.getElementsByName&&X.document.getElementsByName(a).length||X.document.getElementById(a)){var b=(""+Math.random()).replace("0.","");return Ex(a+"_"+b)}return a}function Fx(a){a=a.replace(/[^a-zA-Z0-9]+/g,"_");a.length||(a="_");if(a.length>30)a=a.substr(0,30);return a=Ex(a)}
function Cx(a){var b=x.pb;b.cl();var c=X.document.body.getElementsByTagName("h"+a),d=c.length-1;if(d==-1)return[];var f=[];do{var h=c[d],k=h.getElementsByTagName("a"),l=h.innerText||h.textContent;if(!xa(Xa(l))){l=l.replace(/<[^>]*>/ig,"");var m=document.createElement("a");l=!k.length||!k[0].getAttribute("name")||!k[0].getAttribute("name").length?Fx(l):Fx(k[0].getAttribute("name"));m.setAttribute("name",l);m.id=l;(k=k)||(k=h.getElementsByTagName("a"));var p=k.length-1;if(p!=-1){do{var t=k[p];t.getAttribute("name")&&
$e(t)}while(p--)}k=Gx(h);f[f.length]={EV:k,kX:a,position:Kf(h).y,id:l};k=document.createElement("span");k.appendChild(m);h.innerHTML=k.innerHTML+h.innerHTML;if(z)h.innerHTML=h.innerHTML.replace(/\<a id\=[a-z_0-9]+\>/i,'<a name="'+l+'" id="'+l+'">')}}while(d--);b.mj();return f}function Gx(a){if(a.nodeType==3)return a.data;if(Be(a,"writely-comment")||Be(a,"writely-callout"))return"";var b=[];a=a.childNodes;for(var c=0;c<a.length;c++)b.push(Gx(a[c]));return b.join("")}
function Dx(){if(X&&X.document)return X.document.getElementById("WritelyTableOfContents");return i}
function rr(a){var b=Dx();if(!a&&b&&Wp(Vp(),"writely-toc")){if(!Ax){Ax=Oe("div",{"class":"toc-tooltip"},Oe("a",{href:"#",onclick:Hx},"Update now")," (clears edits)"," | ",Oe("a",{href:"#",onclick:Ix},"Properties")," | ",Oe("a",{href:"#",onclick:Jx},"Remove"));document.body.appendChild(Ax)}a=Kf(O("wys_frame"));var c=Mf(b),d=Pf(b);if(c.y+d.height<0)Ax.style.display="none";else{b=Pf(Ax);d=Sd("rtl")==g?a.x+c.x:a.x+c.x+(d.width-b.width);c=a.y+c.y-b.height;if(z){d-=1;c-=1}else if(B){d+=1;c+=1}else if(E){d+=
2;c+=2}c=Math.max(c,a.y);Ff(Ax,d,c);Ax.style.display=""}}else if(Ax)Ax.style.display="none"}function Hx(){var a=Dx();a=(a?a.getAttribute("toctype"):"none+none").split("+");Bx(a[0]||"none",a[1]||"none");return j}function Ix(){oh("TocSettings");return j}function Jx(){var a=Dx();if(a){a.parentNode.removeChild(a);Jp();x.fa();x.Ta();X.focus()}rr();return j}
function Kx(a){if(!(!a.target||a.target.tagName!="A"||!a.target.hash)){var b=a.target.hash.substring(1);if(b=J(a.target).b(b)){b.scrollIntoView(g);a.preventDefault()}}};var Et,Vt,Wt,Xt,au,du,Lx;function Mx(){for(var a=X.TimeoutId||0,b=X.setTimeout("",0);a<b;a++)X.clearTimeout(a)}function Nx(){X=O("viewiframe").contentWindow;or(tr);if(H("enable_comments")||H("enable_footnotes")){dn();$m()}Ox();z&&U(X.document,"click",editUI.X.blur.bind(editUI.X));B&&U(X.document,"click",Kx);U(X.document,B?"keypress":"keydown",function(a){a.keyCode==27&&mq(j);var b=String.fromCharCode(a.keyCode||a.charCode).toLowerCase();a.ctrlKey&&a.shiftKey&&b=="f"&&mq(g)});hr()}
function Ox(){if(document.location.hash&&document.location.hash.length>1){var a=document.location.hash.substring(1);if(a=X.document.getElementById(a)){X.scrollTo(0,Kf(a).y-a.parentNode.offsetHeight);return g}}return j}
function iu(a){try{if(z){if(!X.frameElement||!X.location)X=O("wys_frame").contentWindow;X.document.body.contentEditable="true";X.document.execCommand("respectvisibilityindesign",j,g)}else if(E)X.document.body.contentEditable="true";else{X.document.designMode="On";X.document.execCommand("styleWithCSS",j,j);X.document.execCommand("useCSS",j,g)}}catch(b){a=u(iu,i,a);window.setTimeout(a,200);return}typeof a=="function"&&a()}
function Px(){var a=Xt,b=a.Yv();Vd("isshared",b>0);a=a.jf.aL;editUI.$d||Ut();Tt(editUI.$d.R().C("email"),editUI.$d.R().C("senddoc"),editUI.$d.R().C("publish"),b,a)}function hr(){Co("RawDocContents",{action:"meta",revision:"_latest",docID:Hd(),timestamp:(new Date).getTime()},function(a,b){if(th(a)||b)rce("MetaInformationUpdate")})}
o("WritelyUIInit",function(){Et=new Qx;Et.Aa(O("editor-menubar"));Et.hd(j);var a=new Ms;a.Ka(Xd());a.k0();jb=a;if(wp()||vt()){du=new Qx;du.Aa(O("editor-toolbar"));du.hd(j);ot(wp());a=Br.yo;Wt=a.Vy;au=a.dK;Vt=a.Ds;pt(Vt);a=new Bu(G("username"),"writely","writely",undefined,Vt.R(),Br.yo.xT());var b=G("explorerServerUrl");b=new Tc(b?b:"");a.b0(b.gj(new Tc("share")));a.z0([Nd("cosmo_id")]);a.p0(!!H("enable_common_email_as_attachment"));Xt=a;U(a,"aclInfoUpdated",Px)}else wt()&&ot(j);if(IS_GEARS){if(wp()||
wt())Et.z(g);wp()&&du.z(g);St();if(a=O("loadingDiv"))a.style.visibility="visible"}Lx=new V;publishUI=new Rx(j);editUI=new Sx(Br&&Br.yo);vt()&&Lx.g(window,"load",dr)},void 0);
o("WritelyUIOnDocLoad",function(a){IS_GEARS&&offline&&offline.V4();if(!vt())if(wt()){dr();Nx()}else{X=O("wys_frame").contentWindow;iu(function(){var b=X.document.documentElement.scrollTop;Bs(X.document,a);Wq(a);window.setTimeout(function(){!Ox()&&z&&X.scrollTo(0,b);var c=x.pb;if(z){if(!c.Tk(j)){var d=X.document.body;if(!d.firstChild||d.firstChild==d.lastChild&&d.firstChild.tagName=="BR"){d.insertBefore(X.document.createTextNode(" "),d.firstChild);c.Tk(j)}}}else c.Tk(g)||c.Tk(j);c.mj(g)},10)});B&&
window.addEventListener("load",Mx,j)}},void 0);function Sx(a){this.Rj=Rd(G("highlightcolor"));if(this.Rj==i||this.Rj<0)this.Rj=0;this.fK=this.$d=this.X=this.jg=this.V=i;this.bL=a}Sx.prototype.Xi=j;Sx.prototype.fq=j;Sx.prototype.GK=function(a){if(!!a!=this.fq){this.fq=!!a;this.w2()}};
Sx.prototype.w2=function(){this.V&&this.V.updateStatus(this.Xi,this.fq);this.X&&this.X.updateStatus(this.Xi,this.fq);this.$d&&this.$d.F(!this.Xi&&H("userloggedin")&&!Sd("anonymouseditor"));x.pj&&x.pj.G0(!this.Xi);if(this.bL)this.bL.Kh.F(!this.Xi&&!wt());else{var a=O("txtTitleEdit");if(a){a.title=this.Xi?"":"Click to rename this document";a.style.color=this.Xi?"#666":"#000"}}};Sx.prototype.defaultCommentColor=Sx.prototype.Rj;function Tx(){}w(Tx,hi);ga(Tx);Tx.prototype.o=function(a){return a.G().o("div",this.Z()+" goog-inline-block","\u00a0")};Tx.prototype.Aa=function(a,b){b=Tx.c.Aa.call(this,a,b);I(b,"goog-inline-block");return b};Tx.prototype.Z=function(){return"goog-toolbar-separator"};function Ux(){}w(Ux,ji);ga(Ux);Ux.prototype.le=function(){return"toolbar"};Ux.prototype.Om=function(a){return a.tagName=="HR"?new ii(Tx.Fa()):Ux.c.Om.call(this,a)};Ux.prototype.Z=function(){return"goog-toolbar"};Ux.prototype.zE=function(){return"horizontal"};function Qx(a,b,c){ki.call(this,b,a||Ux.Fa(),c)}w(Qx,ki);var Vx=j;function Wx(){if(wt()){O("editor-chrome").style.display="none";O("view_tab_contents").style.display="none"}else Jt();if(!Vx){Q(O("printpreview-settings"),Sd("canedit"));var a=new Qx;a.Aa(O("printpreview-toolbar"));a.hd(j);a.z(g);a.F(g);U(a,"action",Xx);Vx=g}Yx();Q(O("printpreview_contents"),g)}
function Xx(a){a=a.target.Lb();a=a.replace(/^printpreview\-/,"");switch(a){case "close":Kt();if(wt()){O("editor-chrome").style.display="block";O("view_tab_contents").style.display=""}else Ht(fj());break;case "print":oq();break;case "settings":Zx();break}}function Zx(){window.LIMITED_EDITING?$t("&spi=1&hgd=1"):nt(function(){oh("PrintSettings")})}function Kt(){Q(O("printpreview_contents"),j)}
function Yx(){var a=new Tc(G("gview_base_url"));a.ul(Zd("/viewer"));a.$("a","v");a.$("pid","writely");a.$("srcid",Hd());a.$("chrome",j);a.$("pli",1);O("printpreview-frame").contentWindow.location.replace(a.toString())};function Dt(a){this.X=a;this.X.F(g);this.X.z(g);if(wt()||B){this.X.hd(g);Nh(this.X.b(),"menubar");a=this.X.Ub();this.ZH=this.X.Qa();this.ZH.g(a,"focus",function(){Ce(this.b(),"writely-menubar-focused",g)});this.ZH.g(a,"blur",function(){Ce(this.b(),"writely-menubar-focused",j)})}this.IA=j;a=this.X.C("tools-menu").R();this.Oy=a.C("m-respell");this.Vz=a.C("m-spell");this.zQ=a.C("m-donespell");this.Wz=a.C("m-spell-lang");this.QL=a.C("m-translate");a=this.Wz.R();var b=Nd("doclangcode");(a=a.C("m-lang-"+
b))&&a.zc(g);this.Oy.z(j);a=this.X.C("view-menu").R();this.Dv=a.C("m-fixedwidth-page");this.wh=j;this.ZR=a.C("m-fullscreen");if(H("enable_comments")){this.mL=a.C("m-show-comments");this.Eh=j}if(H("enable_footnotes")){this.Sz=a.C("m-show-footnotes");this.Fh=g}this.Am=this.X.C("edit-menu").R();this.FV=this.Am.C("m-htmledit");this.BD=this.Am.C("m-editcss");this.BD.z(H("enable_css_editing"));this.f2=this.Am.C("m-+undo");this.NZ=this.Am.C("m-+redo");this.WI=this.Am.C("m-pastehtmlsnippet");a=this.X.C("file-menu").R();
this.C_=a.C("m-revisions");this.xZ=a.C("m-print");this.lJ=a.C("m-printsetting");if(H("enable_printpreview")){this.kJ=a.C("m-printpreview");this.kJ.F(!IS_GEARS)}this.h_=a.C("m-rename");this.CQ=a.C("m-download");this.$X=a.C("m-new");this.lP=a.C("m-copydoc");this.B2=a.C("m-upload");this.Kk=this.X.C("insert-menu").R();this.lX=this.Kk.C("m-link");this.iZ=this.Kk.C("m-picture");this.DQ=this.Kk.C("m-drawing");this.XO=this.Kk.C("m-comment");this.wV=this.X.C("help-menu").R();this.BL=this.X.C("table-menu").R();
this.Iv=this.X.C("format-menu").R();this.xQ=this.Iv.C("m-docstyles");this.Ih=this.Iv.C("m-textStyle").R();this.cZ=this.Ih.C("m-P");this.vV=this.Ih.C("m-H6");this.uV=this.Ih.C("m-H5");this.tV=this.Ih.C("m-H4");this.sV=this.Ih.C("m-H3");this.rV=this.Ih.C("m-H2");this.qV=this.Ih.C("m-H1");this.YN=this.Ih.C("m-w-BLOCKQUOTE");this.qa=new V(this);this.qa.g(this.X,"action",this.ow);this.gW=pn("editorDeferred",11);this.lW=pn("editorDeferred",12);a=this.X.C("tools-menu").R();if(H("enable_britannica")){b=G("language");
if(b=="en"||b=="en_US"){this.UB=a.C("m-britannica").R();this.qa.g(this.UB,"show",$x)}}this.iK=a.C("m-google-search").R();this.qa.g(this.iK,"show",ay);this.qa.g(this.Iv,"show",function(){var c=Vp();this.eb("format",qq(c,"ul")||qq(c,"ol"))},this);this.qa.g(this.BL,"show",function(){var c=Vp();this.eb("table",qq(c,"table"))},this);this.k2();if(H("equation_editor")){this.hW=pn("editorDeferred",8);this.KQ=pn("editorDeferred",9)}this.kW=pn("editorDeferred",14)}Dt.prototype.qa=i;Dt.prototype.X=i;
Dt.prototype.ow=function(a){a=a.target.Lb();var b;if(a.substring(0,2)=="m-")a=a.substring(2);if(a.substring(0,10)=="trans-lang"){b=a.substring(11,a.length);a="trans-lang"}switch(a){case "newdoc":case "newdrawing":case "newkix":case "newpres":case "newtrix":case "newform":case "newtemp":this.AP(a);break;case "open":window.open(G("siteprefix")+"/#documents","_blank");break;case "upload":window.open(G("siteprefix")+"/DocAction?action=updoc");break;case "copydoc":window.WritelyCopyStart=(new Date).getTime();
this.IA?wx(j):nt(function(){wx(g)});break;case "save":pq(i);break;case "saveclose":bu(i);break;case "revisions":gu();break;case "requestaccess":break;case "edit":b=new Tc(window.location);b.qc.u("tab","edit");window.location=b.toString();break;case "rename":yx();break;case "pdf":case "rtf":case "txt":case "oo":case "doc":this.AQ(a);break;case "html":this.BQ();break;case "printsetting":Zx();break;case "printpreview":wp()?nt(function(){Wx()}):Wx();break;case "print":oq();break;case "printhtml":$t("&hgd=1&spi=1",
g);break;case "preview":$t("&hgd=1",g);break;case $.Vl:case $.Tl:case "w-Cut":case "w-Copy":case "w-Paste":sa.execute(a);break;case "pastehtmlsnippet":Vr();break;case "w-SelectAll":sa.execute(a);break;case "findreplace":H("enable_find_bar")?editUI.jg.Yc():Ah();break;case "htmledit":nt(function(){sa.openDialog("editHtml")});break;case "show-comments":(this.Eh=!this.Eh)?Zm().Dm("comment"):Zm().av("comment");this.mL.zc(this.Eh);break;case "show-footnotes":(this.Fh=!this.Fh)?Zm().Dm("footnote"):Zm().av("footnote");
this.Sz.zc(this.Fh);break;case "fixedwidth-page":this.wh=!this.wh;this.Dv.zc(this.wh);Vd("fullwidtheditor",!this.wh);Ce(X.document.documentElement,"pageview",this.wh);if(z)X.document.body.className=X.document.body.className;b=new Mc("docid",Hd(),"fullWidthEditor",!this.wh,"makeDefault",g);bh("set_full_width_editor",b,this.AO.bind(this));break;case "fullscreen":mq(g);break;case "picture":Np(g);break;case "equation":H("equation_editor")&&this.hW();break;case "drawing":sa.execute("+newDrawing");break;
case "link":Tp(Vp());break;case "table":case "table2":Tw(g);break;case "comment":if(H("enable_comments")){b=new ra.xp.fB;(Rw||(Rw=new Sw)).Jt(b)}else rj();break;case "footnote":b=new an;(Rw||(Rw=new Sw)).Jt(b,g);Zm().Dm("footnote");this.Fh=g;this.Sz.zc(g);break;case "specialchars":this.kW();break;case $.WA:sa.execute(a);break;case "pagebreak":hx();break;case "header":ex("header");break;case "footer":ex("footer");break;case "toc":oh("TocSettings");break;case "bookmark":case "bookmark2":jh=Bh(X).Ab();
oh("InsertBookmark");break;case "htmlsnippet":oh("EditHtmlSelection");break;case "P":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":sa.execute($.Io,a);break;case "docstyles":nt(function(){oh("DocSettings")});break;case "editcss":H("enable_css_editing")&&nt(function(){oh("CSSEdit")});break;case $.Po:case $.Mo:case $.Jo:case $.Lo:case $.Ko:case $.cB:case $.Ct:case $.Bt:sa.execute(a);break;case "w-BLOCKQUOTE":Ur();break;case "w-changeListStyle":oh("ChangeList");break;case $.rt:case $.SA:sa.execute(a);
break;case "respell":case "spell":nq(g);break;case "donespell":nq(j);break;case "trans-lang":sx(b,g);break;case "wcount":oh("WordCount",{lK:Bh(X)});break;case "translate":this.lW();break;case "dictionary":this.gW();break;case "encyclopedia":b=G("language");if(H("enable_britannica")&&(b=="en"||b=="en_US"))oh("Britannica",by);break;case "websearch":case "imagesearch":cy(a);break;case "mod-table":Tw(j);break;case "mod-row":oh("ChangeRow");break;case "mod-column":oh("ChangeColumn");break;case "mod-cell":oh("ChangeCell");
break;case "mv-row-up":Vw(g);break;case "mv-row-down":Vw(j);break;case "insert-row-up":jq(g);break;case "insert-row-down":jq(j);break;case "insert-col-left":Ww(g);break;case "insert-col-right":Ww(j);break;case "del-table":Xw();break;case "del-row":Yw();break;case "del-col":Zw();break;case "help":window.open(G("helpurl"));break;case "help-group":window.open("http://www.google.com/support/forum/p/Google+Docs");break;case "help-video":window.open(dy);break;case "help-shortcuts":window.open(rq);break;
default:if(a.indexOf("lang-")==0){b=a.substring(5);a="m-lang-"+Nd("doclangcode");(a=this.Wz.R().C(a))&&a.zc(j);Vd("doclangcode",b);bh("setdoclang",{docid:Hd(),code:b})}}};Dt.prototype.blur=function(){this.X.rd(i)};
var ey=["m-w-changeListStyle"],fy=["m-mod-table","m-mod-row","m-mod-column","m-mod-cell","m-mv-row-up","m-mv-row-down","m-insert-row-up","m-insert-row-down","m-insert-col-left","m-insert-col-right","m-del-table","m-del-row","m-del-col"],rq="http://docs.google.com/support/bin/answer.py?answer=66280&hl="+G("language"),dy="http://www.youtube.com/watch?v=eRqUE6IHTEA&hl="+G("language");n=Dt.prototype;
n.eb=function(a,b){if(this.X.W()){var c;switch(a){case "P":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":c=this.X.C("format-menu").R();c.C("m-textStyle").R().C("m-"+a).zc(b);break;case "format":c=this.X.C("format-menu").R();a=0;for(var d;d=ey[a];a++)c.C(d).F(b);break;case "table":c=this.X.C("table-menu").R();for(a=0;d=fy[a];a++)c.C(d).F(b);break}}};n.v2=function(a){this.zQ.F(a);this.Vz.z(!a);this.Oy.z(a)};
n.updateStatus=function(a,b){this.Vz.F(!a&&!b);this.Oy.F(!a&&!b);this.Wz.F(!a&&!b);this.QL&&this.QL.F(!a&&!b);var c=this.X.C("tools-menu").R();if(H("enable_britannica")){G("language");c.C("m-britannica").R().F(!a);c.C("m-google-search").R().F(!a)}this.xQ.F(!a);H("enable_css_editing")&&this.BD.F(!a);this.C_.F(!a);this.xZ.F(!a);this.lJ.F(!a);H("enable_printpreview")&&this.kJ.F(!a);this.h_.F(!a);this.CQ.F(!a);this.$X.F(!a);this.lP.F(!a);this.B2.F(!a);this.FV.F(!b);this.iZ.F(!a);this.DQ.F(!a);if(H("equation_editor")){this.Kk.C("m-equation").F(!a);
this.KQ(!a)}this.Dv.F(!a);this.wV.F(!a);this.BL.F(!b);this.YN.F(!b);this.Kk.F(!b);this.f2.F(!b);this.NZ.F(!b);this.WI&&this.WI.F(!b);this.TL()};n.Mk=function(a){var b=g;switch(a){case "w-spell":b=this.Vz.W();break;case "w-link":b=this.lX.W();break;case "w-comment":b=this.XO.W();break;case "P":b=this.cZ.W();break;case "H1":b=this.qV.W();break;case "H2":b=this.rV.W();break;case "H3":b=this.sV.W();break;case "H4":b=this.tV.W();break;case "H5":b=this.uV.W();break;case "H6":b=this.vV.W();break}return b};
n.xV=function(){Nb(["edit-menu","insert-menu","format-menu","table-menu","tools-menu"],function(c){this.X.C(c).z(j)},this);var a=this.X.C("file-menu").R();Nb(["m-revisions","m-rename","m-save","m-saveclose","m-printsetting"],function(c){a.C(c).z(j)},this);var b=a.Gk(a.C("m-revisions"))+1;a.mc(b).z(j);this.X.ke(function(c){c=c.R().b();Nb(He("DIV","goog-menuitem-accel",c),function(d){Q(d,j)})});this.IA=g};
n.AO=function(a){if(a.responseText){a=a.responseText.replace("while(true);","");if(a.replace(/\s/g,"")!=""){a=Fb(a);a.styles&&Vd("styles",a.styles)}}if(H("enable_footnotes")||H("enable_comments")){Zm().dispatchEvent(new Vm);this.IA&&window.setTimeout($m,0)}};
n.k2=function(){this.wh=!Sd("fullwidtheditor");this.Dv.zc(this.wh);if(H("enable_comments")){this.Eh=Sd("show_comments");this.mL.zc(this.Eh);this.Eh=this.Eh}if(H("enable_footnotes")){this.Fh=g;this.Sz.zc(this.Fh);this.Fh&&Zm().Dm("footnote")}this.lJ.F(Sd("canedit"));this.TL()};
n.TL=function(){var a=this.X.C("file-menu").R();if(H("userloggedin"))Sd("anonymouseditor")&&a.C("m-rename").F(j);else{a.C("m-copydoc").F(j);a.C("m-rename").F(j);a.C("m-revisions").F(j);a.C("m-new").F(j);a.C("m-printpreview").F(j);a.C("m-download").R().C("m-html").F(j);this.X.C("tools-menu").R()}};n.AQ=function(a){if(a=="pdf")nt(function(){zx("Export")});else{var b="MiscCommands?command=saveasdoc&docID="+encodeURIComponent(Hd())+"&exportFormat="+a;nt(function(){Ei(b)})}};
n.BQ=function(){var a="UserMiscCommands?command=saveaszip&docID="+encodeURIComponent(Hd());nt(function(){Ei(a)})};
n.AP=function(a){var b=da.open("","_blank");if(!(!b||b.closed)){var c=G("siteprefix"),d;switch(a){case "newdoc":d=c+"/DocAction?action=newdoc";break;case "newpres":d=c+"/DocAction?action=new_presentation&source=writely";break;case "newtrix":d=da.location.protocol+"//spreadsheets.google.com"+c+"/ccc?new";break;case "newform":d=da.location.protocol+"//spreadsheets.google.com"+c+"/newform";break;case "newtemp":d=c+"/templates?type=docs";break;case "newdrawing":d=c+"/drawings/create";break;case "newkix":d=
c+"/document/create";break}b.location.href=d;b.focus()}};function gy(){this.ZI={};this.Mx={};this.oy={};this.GA=i;this.ny=[]}ga(gy);gy.prototype.UE=function(a,b){return a+"_"+b+".js"};function hy(a){eval(a)}gy.prototype.re=function(a,b){o("__gjsload__",hy,void 0);this.GA=a.replace(".js","");if(b)this.UE=b;Nb(this.ny,function(c){this.JH(c)},this);Wb(this.ny)};gy.prototype.p_=function(a,b,c){var d=this.ZI,f=this.Mx;if(f[a])c(f[a][b]);else if(d[a])d[a].push([b,c]);else{d[a]=[[b,c]];this.GA?this.JH(a):this.ny.push(a)}};gy.prototype.oJ=ba(20);
gy.prototype.JH=function(a){si(function(){if(!this.Mx[a]){var b=this.UE(this.GA,a),c=sc(this.oy,b);this.oy[a]=b;if(!c){b=Oe("script",{type:"text/javascript",src:b});document.body.appendChild(b)}}},0,this)};function iy(a,b,c){gy.Fa().p_(a,b,c)}function pn(a,b){return function(){var c=arguments;iy(a,b,function(d){d.apply(i,c)})}};function cu(a){this.V=a;this.V.F(g);this.V.z(g);if(B){this.V.hd(g);Nh(this.V.b(),"menubar");a=this.V.Ub();this.PL=this.V.Qa();this.PL.g(a,"focus",function(){Ce(this.b(),"writely-toolbar-focused",g)});this.PL.g(a,"blur",function(){Ce(this.b(),"writely-toolbar-focused",j)})}this.WV(this.V.C("w-textStyle"));this.Gv={};this.PV(this.V.C("w-fontName"));this.QV(this.V.C("w-fontSize"));if(H("enable_cloudboard")){pn("editorDeferred",1)(this);this.g0=pn("editorDeferred",6)}this.qa=new V(this);this.qa.g(this.V,
"action",this.ow);this.qa.g(this.V.C("w-textStyle"),"action",this.FU)}var jy={8:1,10:2,12:3,14:4,18:5,24:6,36:7},ky={1:"8.0",2:"10.0",3:"12.0",4:"14.0",5:"18.0",6:"24.0",7:"36.0"};n=cu.prototype;n.qa=i;n.V=i;n.Gv=i;
n.eb=function(a,b){if(this.V.W()){var c=this.V.C(a);if(c)switch(a){case "w-fontName":if(b){b=b.split(",")[0].toLowerCase();c.jb(b)}else c.jb("");break;case "w-textStyle":b?c.jb(b):c.jb("");ly(c,b);break;case "w-fontSize":if(b){if(b.indexOf("px")!=-1){b=parseInt(b,10);b*=0.75;b=jy[Math.round(b)]}else if(b.indexOf("pt")!=-1){b=parseInt(b,10);b=jy[b]}else{b=parseInt(b,10);b=Math.min(b,7);b=Math.max(b,1)}c.jb(b)}else c.jb("");break;case $.qt:case $.Ho:if(b=="transparent")b="#ffffff";c.jb(b);break;case $.rt:a=
!!b;Ce(this.V.b(),"goog-edit-rtl-mode",a);c.zc(a);break;default:c.zc(!!b);break}}};n.updateStatus=function(a,b){this.V.C("w-spell").F(!b&&!a);H("enable_cloudboard")&&this.g0(!b&&!a);this.V.C($.Vl).F(!b);this.V.C($.Tl).F(!b);this.V.C($.Qo).F(!b);this.V.C($.Oo).F(!b);this.V.C("w-link").F(!b);this.V.C($.bB).F(!b);this.V.C($.XA).F(!b)};n.Mk=function(a){if(a=this.V.C(a))return a.W();return g};
n.ow=function(a){var b=a.target.Lb(),c=a.target.Ya();switch(b){case "w-textStyle":c=="removeFormat"?sa.execute($.Po,c):sa.execute($.Io,c);break;case "w-fontSize":this.zN(c);break;case "w-fontName":(a=this.Gv[c])&&this.AN(a);break;case "w-spell":nq(a.target.Bf());break;case $.Rl:case $.Sl:case $.Ul:sa.execute(b,a.target.Bf());break;default:sa.execute(b,c);break}};
n.WV=function(a){var b={P:"Normal Paragraph Text",H1:"Heading 1 (Biggest)",H2:"Heading 2",H3:"Heading 3",H4:"Heading 4",H5:"Heading 5",H6:"Heading 6 (Smallest)"},c={P:"Ctrl+0",H1:"Ctrl+1",H2:"Ctrl+2",H3:"Ctrl+3",H4:"Ctrl+4",H5:"Ctrl+5",H6:"Ctrl+6"};if(a){a.oa(this.JC(a.K,"removeFormat","Clear formatting",md?"":"Ctrl+Space","goog-edit-removeFormat"));a.oa(new oi);for(var d in b)a.oa(this.JC(a.K,d,b[d],c[d]))}};
n.JC=function(a,b,c,d,f){var h=[];f&&h.push(a.o("div","goog-menuitem-icon "+f));d&&h.push(a.o("div","goog-menuitem-accel",d));h.push(a.createTextNode(c));a=new my(h,b,a);a.lj(b);return a};n.FU=function(a){var b=a.currentTarget.Ya();ly(a.currentTarget,b)};
function ly(a,b){if(b)switch(b){case "H1":a.yc("Heading 1");break;case "H2":a.yc("Heading 2");break;case "H3":a.yc("Heading 3");break;case "H4":a.yc("Heading 4");break;case "H5":a.yc("Heading 5");break;case "H6":a.yc("Heading 6");break;case "P":a.yc("Normal");break;case "removeFormat":a.yc("Styles");break;default:a.yc("Styles");break}else a.yc("Styles")}n=cu.prototype;
n.zN=function(a){if(x.iH()){var b=ky[a],c=Nd("fontsize");if(b&&b!=c){Vd("fontsize",b);yf(X.document.body,"font-size",b+"pt");var d=new Mc;d.u("size",b);d.u("docid",Hd());bh("save_doc_settings",d,this.CY.bind(this,c))}}sa.execute($.VA,a)};n.CY=function(a,b,c){if(c||!b||th(b)){Vd("fontsize",a);yf(X.document.body,"font-size",a+"pt")}};
n.AN=function(a){if(x.iH()){var b=Nd("fontname");if(a!=b){Vd("fontname",a);yf(X.document.body,"font-family",a);var c=new Mc;c.u("face",a);c.u("docid",Hd());bh("save_doc_settings",c,this.BY.bind(this,b))}}sa.execute($.UA,a)};n.BY=function(a,b,c){if(c||!b||th(b)){Vd("fontname",a);yf(X.document.body,"font-family",a)}};
n.uR=function(a){if(!a)return a;var b={},c=Oe("div",{style:"visibility:hidden"}),d=Oe("span",{style:"font-size:72px; font-family:monospace"},"wwwwwwwwww"),f=Oe("span",{style:"font-size:72px; font-family:monospace"},"wwwwwwwwww");c.appendChild(d);c.appendChild(f);document.body.appendChild(c);for(var h in a)if(h){f.style.fontFamily=a[h]+",monospace";if(f.offsetWidth!=d.offsetWidth||f.offsetHeight!=d.offsetHeight)b[a[h]]=a[h];else b[h]=a[h]}P(c);return SITE_UPDATED_FONTS=b};
n.PV=function(a){if(a){this.It(a,SITE_LANG_FONTS);H("enable_font_detection")?this.It(a,this.uR(SITE_DEFAULT_FONTS)):this.It(a,SITE_DEFAULT_FONTS);I(a.R().xa(),"goog-menu-noaccel")}};
n.It=function(a,b){if(a&&b)for(var c in b)if(c){var d=b[c].split(",")[0].toLowerCase();if(!(c=="Wingdings"&&(E||B))){var f;if(c=="Wingdings"){f=a.K.o("span",{style:"font-family:"+b[c]},decodeURIComponent("%C3%981*J%26"));f=a.K.o("div",i,c," (",f,")");f=new my(f,d,a.K);f.fk=function(){return"Wingdings"}}else f=new my(a.K.o("span",{style:"font-family:"+b[c]},c),d,a.K);f.lj(d);a.oa(f);this.Gv[d]=b[c]}}};n.QV=function(a){if(a){for(var b in jy)a.oa(new my(b+"pt",jy[b],a.K));I(a.R().xa(),"goog-menu-noaccel")}};
n.Lv=function(a){return this.V.C(a).Bf()};n.oz=function(a,b){this.V.C(a).zc(b)};n.blur=function(){this.V.rd(i)};var by=i;function $x(){var a=by=ny(),b=!!a,c='See definitions and synonyms for "'+(a+'"...'),d='See encyclopedia entries for "'+(a+'"...'),f='Translate "'+(a+'"...'),h=editUI.X.UB,k=h.C("m-dictionary");k.yc(a?c:"See definitions and synonyms for word...");c=h.C("m-encyclopedia");c.yc(a?d:"See encyclopedia entries for word...");d=h.C("m-translate");d.yc(a?f:"Translate word...");k.F(!window.LIMITED_EDITING);c.F(b&&!window.LIMITED_EDITING);d.F(!window.LIMITED_EDITING)}
function ay(){var a=by=ny(),b=!!a,c='Go to results for "'+(a+'"...'),d='Go to images for "'+(a+'"...'),f=editUI.X.iK;f.C("m-websearch").yc(a?c:"Go to results for word...");f.C("m-imagesearch").yc(a?d:"Go to images for word...");f.F(b&&!window.LIMITED_EDITING)}function cy(a){var b=encodeURIComponent(by);window.open((a=="websearch"?"http://www.google.com/search?q=%1":"http://images.google.com/images?q=%1").replace("%1",b),"GoogleWebSearchWindow")}
function ny(){var a=i;try{var b=Bh(X);a=Ba(b.Ab());if(a.length>50)a=a.substring(0,50)}catch(c){return i}return a||i};function oy(a){this.P3=a}oy.prototype.b=function(a){if(document.getElementById(a)!=i)return O(a);else if(window.parent!=i)return window.parent.document.getElementById(a)};oy.prototype.EJ=function(){typeof dj!="undefined"?ej():window.location.reload(g)};function gx(a){return 1-Math.pow(1-a,3)}function py(a,b,c,d){if(!ia(a)||!ia(b))e(Error("Start and end parameters must be arrays"));if(a.length!=b.length)e(Error("Start and end points must be the same length"));this.so=a;this.OQ=b;this.Qd=c;this.gB=d;this.coords=[]}w(py,Og);var qy={},ry=i;function sy(){ri.clearTimeout(ry);var a=v();for(var b in qy)qy[b].TC(a);ry=tc(qy)?i:ri.setTimeout(sy,20)}function ty(a){a=r(a);delete qy[a];if(ry&&tc(qy)){ri.clearTimeout(ry);ry=i}}n=py.prototype;n.ya=0;n.hE=0;
n.Ra=0;n.rj=i;n.ID=i;n.qx=i;n.play=function(a){if(a||this.ya==0){this.Ra=0;this.coords=this.so}else if(this.ya==1)return j;ty(this);this.rj=v();if(this.ya==-1)this.rj-=this.Qd*this.Ra;this.ID=this.rj+this.Qd;this.qx=this.rj;this.Ra||this.Wx();this.KY();this.ya==-1&&this.MY();this.ya=1;a=r(this);a in qy||(qy[a]=this);ry||(ry=ri.setTimeout(sy,20));this.TC(this.rj);return g};n.stop=function(a){ty(this);this.ya=0;if(a)this.Ra=1;this.tA(this.Ra);this.PY();this.Hr()};
n.k=function(){this.ya!=0&&this.stop(j);this.sY();py.c.k.call(this)};n.$C=function(){this.p()};n.TC=function(a){this.Ra=(a-this.rj)/(this.ID-this.rj);if(this.Ra>=1)this.Ra=1;this.hE=1E3/(a-this.qx);this.qx=a;la(this.gB)?this.tA(this.gB(this.Ra)):this.tA(this.Ra);if(this.Ra==1){this.ya=0;ty(this);this.zY();this.Hr()}else this.ya==1&&this.Ux()};n.tA=function(a){this.coords=new Array(this.so.length);for(var b=0;b<this.so.length;b++)this.coords[b]=(this.OQ[b]-this.so[b])*a+this.so[b]};n.Ux=function(){this.Wg("animate")};
n.Wx=function(){this.Wg("begin")};n.sY=function(){this.Wg("destroy")};n.Hr=function(){this.Wg("end")};n.zY=function(){this.Wg("finish")};n.KY=function(){this.Wg("play")};n.MY=function(){this.Wg("resume")};n.PY=function(){this.Wg("stop")};n.Wg=function(a){this.dispatchEvent(new uy(a,this))};function uy(a,b){R.call(this,a);this.coords=b.coords;this.x=b.coords[0];this.y=b.coords[1];this.y5=b.coords[2];this.Qd=b.Qd;this.Ra=b.Ra;this.r4=b.hE;this.Ze=b.ya;this.I3=b}w(uy,R);var vy={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function wy(a){var b={};a=String(a);var c=a.charAt(0)=="#"?a:"#"+a;if(xy.test(c)){b.Tq=yy(c);b.type="hex";return b}else{a:{var d=a.match(zy);if(d){c=Number(d[1]);var f=Number(d[2]);d=Number(d[3]);if(c>=0&&c<=255&&f>=0&&f<=255&&d>=0&&d<=255){c=[c,f,d];break a}}c=[]}if(c.length){b.Tq=Ay(c[0],c[1],c[2]);b.type="rgb";return b}else if(vy)if(c=vy[a.toLowerCase()]){b.Tq=c;b.type="named";return b}}e(Error(a+" is not a valid color string"))}var By=/#(.)(.)(.)/;
function yy(a){if(!xy.test(a))e(Error("'"+a+"' is not a valid hex color"));if(a.length==4)a=a.replace(By,"#$1$1$2$2$3$3");return a.toLowerCase()}function Cy(a){a=yy(a);var b=parseInt(a.substr(1,2),16),c=parseInt(a.substr(3,2),16);a=parseInt(a.substr(5,2),16);return[b,c,a]}
function Ay(a,b,c){a=Number(a);b=Number(b);c=Number(c);if(isNaN(a)||a<0||a>255||isNaN(b)||b<0||b>255||isNaN(c)||c<0||c>255)e(Error('"('+a+","+b+","+c+'") is not a valid RGB color'));a=Dy(a.toString(16));b=Dy(b.toString(16));c=Dy(c.toString(16));return"#"+a+b+c}var xy=/^#(?:[0-9a-f]{3}){1,2}$/i,zy=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;function Dy(a){return a.length==1?"0"+a:a};function Ey(a,b,c,d,f){py.call(this,b,c,d,f);this.Ee=a}w(Ey,py);Ey.prototype.ct=fa;Ey.prototype.Ux=function(){this.ct();Ey.c.Ux.call(this)};Ey.prototype.Hr=function(){this.ct();Ey.c.Hr.call(this)};Ey.prototype.Wx=function(){this.ct();Ey.c.Wx.call(this)};function fx(a,b,c){if(b.length!=2||c.length!=2)e(Error("Start and end points must be 2D"));Ey.apply(this,arguments)}w(fx,Ey);fx.prototype.ct=function(){this.Ee.scrollLeft=Math.round(this.coords[0]);this.Ee.scrollTop=Math.round(this.coords[1])};wo.send=yo;wo.W3=function(){for(;xo.length;)xo.pop().p()};wo.Y4=function(a,b){wo.prototype.ay=a.X4(wo.prototype.ay,b)};wo.X3=zo;wo.Y2="Content-Type";wo.h3="application/x-www-form-urlencoded;charset=utf-8";wo.g5=xo;function my(a,b,c){mi.call(this,a,b,c);this.xs(g)}w(my,mi);my.prototype.If=function(){return this.dispatchEvent("action")};Zh("goog-option",function(){return new my(i)});function Fy(){this.np=[]}w(Fy,li);ga(Fy);Fy.prototype.o=function(a){var b=Fy.c.o.call(this,a);I(b,"goog-submenu");this.kB(a,b);return b};Fy.prototype.Aa=function(a,b){b=Fy.c.Aa.call(this,a,b);I(b,"goog-submenu");this.kB(a,b);var c=He("div","goog-menu",b);if(c.length){var d=new pi(a.G());c=c[0];Q(c,j);a.G().M().body.appendChild(c);d.Aa(c);a.Fg(d,g)}return b};
Fy.prototype.se=function(a){Fy.c.se.call(this,a);var b=a.xa(),c=a.G().sf("span","goog-submenu-arrow",b)[0];Gy(a,c);c!=b.lastChild&&b.appendChild(c);Oh(a.b(),"haspopup","true")};Fy.prototype.kB=function(a,b){var c=a.G().o("span");c.className="goog-submenu-arrow";Gy(a,c);this.xa(b).appendChild(c)};function Gy(a,b){if(a.un()){I(b,"goog-submenu-arrow-rtl");kf(b,a.Yo?"\u25c4":"\u25ba")}else{xe(b,"goog-submenu-arrow-rtl");kf(b,a.Yo?"\u25ba":"\u25c4")}};function Hy(a,b,c,d){mi.call(this,a,b,c,d||Fy.Fa())}w(Hy,mi);n=Hy.prototype;n.wm=i;n.Qz=i;n.fG=j;n.gc=i;n.Xp=j;n.Yo=g;n.JW=j;n.Ua=function(){Hy.c.Ua.call(this);this.Qa().g(this.Ca,"hide",this.EI);this.gc&&this.rs(this.gc,g)};n.tb=function(){this.Qa().Da(this.Ca,"hide",this.EI);if(this.gc){this.rs(this.gc,j);if(!this.Xp){this.gc.tb();P(this.gc.b())}}Hy.c.tb.call(this)};n.k=function(){this.gc&&!this.Xp&&this.gc.p();this.gc=i;Hy.c.k.call(this)};
n.Fd=function(a,b){Hy.c.Fd.call(this,a);b&&this.R().Dh(g);if(!a){this.wm&&ti(this.wm);this.wm=si(this.cg,350,this)}};n.Pz=function(){var a=this.Ca;if(a&&a.mg()==this){this.TK(g);this.kD();this.E4=j}};n.cg=function(){var a=this.gc;if(a&&a.Ca==this){this.TK(j);a.ke(function(b){typeof b.cg=="function"&&b.cg()})}};n.Jj=function(){this.wm&&ti(this.wm);this.Qz&&ti(this.Qz)};n.z=function(a,b){(a=Hy.c.z.call(this,a,b))&&!this.ga()&&this.cg();return a};
n.kD=function(){for(var a=this.Ca.mk(),b=0;b<a.length;b++)if(a[b]!=this&&typeof a[b].cg=="function"){a[b].cg();a[b].Jj()}};n.sd=function(a){var b=a.keyCode;if(this.fG){if(!this.R().sd(a))if(b==37)this.cg();else return j}else if(this.W()&&b==39){this.Pz();this.R().pG();this.Jj()}else return j;a.preventDefault();return g};n.oY=function(){if(this.gc.Ca==this){this.Jj();this.Yk.Fd(this);this.kD()}};n.EI=function(a){if(a.target==this.Yk){this.cg();this.Jj()}};
n.td=function(a){if(this.W()){this.Jj();this.Qz=si(this.Pz,350,this)}Hy.c.td.call(this,a)};n.If=function(){this.Jj();this.Pz();return g};n.TK=function(a){this.dispatchEvent(Sg(64,a));var b=this.R();if(a!=b.ga()){if(a){b.va||b.db();this.oZ();b.Xc(-1)}this.fG=a;Ce(this.b(),"goog-submenu-open",a);b.z(a)}};n.rs=function(a,b){var c=this.Qa();(b?c.g:c.Da).call(c,a,"highlight",this.oY)};
n.oZ=function(){var a=new Jh(this.b(),this.Yo?6:4,this.JW),b=this.R(),c=b.b();if(!b.ga()){c.style.visibility="hidden";Q(c,g)}a.Ga(c,this.Yo?4:6);if(!b.ga()){Q(c,j);c.style.visibility="visible"}};n.oa=function(a){this.R().kb(a,g)};n.Og=function(a,b){this.R().Wf(a,b,g)};n.ue=ba(11);n.ng=function(a){return this.R().mc(a)};n.lk=function(){return this.R().ne()};n.mk=function(){return this.R().mk()};
n.R=function(){if(this.gc)this.Xp&&this.gc.Ca!=this&&this.gc.Mf(this);else this.Fg(new pi(this.G()),g);this.gc.b()||this.gc.o();return this.gc};n.Fg=function(a,b){var c=this.gc;if(a!=c){if(c){this.cg();this.va&&this.rs(c,j)}this.gc=a;this.Xp=!b;if(a){a.Mf(this);a.z(j,g);a.ll(j);a.hd(j);this.va&&this.rs(a,g)}}};n.lf=function(a){return this.R().lf(a)};Zh("goog-submenu",function(){return new Hy(i)});function Iy(){}w(Iy,ms);ga(Iy);Iy.prototype.createCaption=function(a,b){return Iy.c.createCaption.call(this,Jy(a,b),b)};function Jy(a,b){return b.o("div","goog-color-menu-button-indicator",a)}Iy.prototype.jb=function(a,b){a&&Ky(this.xa(a),b)};function Ky(a,b){if(a&&a.firstChild){var c;try{c=wy(b).Tq}catch(d){c=i}a.firstChild.style.borderBottomColor=c||(z?"":"transparent")}}Iy.prototype.se=function(a){this.jb(a.b(),a.Ya());I(a.b(),"goog-color-menu-button");Iy.c.se.call(this,a)};function Ly(){}w(Ly,bi);ga(Ly);var My=0;n=Ly.prototype;n.o=function(a){var b=this.rf(a);return a.G().o("div",b?b.join(" "):i,this.vP(a.La,a.hw(),a.G()))};n.vP=function(a,b,c){for(var d=[],f=0,h=0;f<b.height;f++){for(var k=[],l=0;l<b.width;l++){var m=a&&a[h++];k.push(this.zu(m,c))}d.push(this.Fu(k,c))}return this.Ep(d,c)};n.Ep=function(a,b){a=b.o("table",this.Z()+"-table",b.o("tbody",this.Z()+"-body",a));a.cellSpacing=0;a.cellPadding=0;Nh(a,"grid");return a};
n.Fu=function(a,b){return b.o("tr",this.Z()+"-row",a)};n.zu=function(a,b){a=b.o("td",{"class":this.Z()+"-cell",id:this.Z()+"-cell-"+My++},a);Nh(a,"gridcell");return a};n.Qc=function(){return j};n.Aa=function(){return i};
n.hb=function(a,b){if(a){var c=He("tbody",this.Z()+"-body",a)[0];if(c){var d=0;Nb(c.rows,function(m){Nb(m.cells,function(p){We(p);if(b){var t=b[d++];t&&Ve(p,t)}})});if(d<b.length){for(var f=[],h=J(a),k=c.rows[0].cells.length;d<b.length;){var l=b[d++];f.push(this.zu(l,h));if(f.length==k){l=this.Fu(f,h);c.appendChild(l);f.length=0}}if(f.length>0){for(;f.length<k;)f.push(this.zu("",h));l=this.Fu(f,h);c.appendChild(l)}}}$f(a,g,B)}};
n.Nv=function(a,b){for(a=a.b();b&&b.nodeType==1&&b!=a;){if(b.tagName=="TD"&&Be(b,this.Z()+"-cell"))return b.firstChild;b=b.parentNode}return i};n.oG=function(a,b,c){if(b){b=b.parentNode;Ce(b,this.Z()+"-cell-hover",c);a=a.b().firstChild;Oh(a,"activedescendent",b.id)}};n.O_=function(a,b,c){b&&Ce(b.parentNode,this.Z()+"-cell-selected",c)};n.Z=function(){return"goog-palette"};function Ny(a){this.yd=[];this.pB(a)}w(Ny,Og);n=Ny.prototype;n.Eg=i;n.gz=i;n.T0=function(a){this.gz=a};n.lk=function(){return this.yd.length};n.MV=function(a){return a?Mb(this.yd,a):-1};n.ng=function(a){return this.yd[a]||i};n.pB=function(a){if(a){Nb(a,function(b){this.kl(b,j)},this);bc(this.yd,a)}};n.oa=function(a){this.Og(a,this.lk())};n.Og=function(a,b){if(a){this.kl(a,j);cc(this.yd,b,0,a)}};n.ue=ba(10);n.yi=function(){return this.Eg};
n.Nf=function(a){if(a!=this.Eg){this.kl(this.Eg,j);this.Eg=a;this.kl(a,g)}this.dispatchEvent("select")};n.Ie=function(){return this.MV(this.Eg)};n.jd=function(a){this.Nf(this.ng(a))};n.clear=function(){Wb(this.yd);this.Eg=i};n.k=function(){Ny.c.k.call(this);delete this.yd;this.Eg=i};n.kl=function(a,b){if(a)if(typeof this.gz=="function")this.gz(a,b);else typeof a.xl=="function"&&a.xl(b)};function Oy(a,b,c){fi.call(this,a,b||Ly.Fa(),c)}w(Oy,fi);n=Oy.prototype;n.rc=i;n.Mb=-1;n.ma=i;n.k=function(){Oy.c.k.call(this);if(this.ma){this.ma.p();this.ma=i}this.rc=i};n.ol=function(a){Oy.c.ol.call(this,a);this.tB();if(this.ma){this.ma.clear();this.ma.pB(a)}else{this.ma=new Ny(a);this.ma.T0(u(this.kl,this));this.Qa().g(this.ma,"select",this.Fi)}this.Mb=-1};n.fk=function(){return i};n.yc=function(){};
n.td=function(a){Oy.c.td.call(this,a);var b=this.ha.Nv(this,a.target);b&&a.relatedTarget&&df(b,a.relatedTarget)||b!=this.pq()&&this.HK(b)};n.Ci=function(a){Oy.c.Ci.call(this,a);var b=this.ha.Nv(this,a.target);b&&a.relatedTarget&&df(b,a.relatedTarget)||b==this.pq()&&this.ha.oG(this,b,j)};n.qg=function(a){Oy.c.qg.call(this,a);if(this.Ne()){a=this.ha.Nv(this,a.target);a!=this.pq()&&this.HK(a)}};n.If=function(){var a=this.pq();if(a){this.Nf(a);return this.dispatchEvent("action")}return j};
n.sd=function(a){var b=this.La;b=b?b.length:0;var c=this.rc.width;if(b==0||!this.W())return j;if(a.keyCode==13||a.keyCode==32)return this.If(a);if(a.keyCode==36){this.Xc(0);return g}else if(a.keyCode==35){this.Xc(b-1);return g}var d=this.Mb<0?this.Ie():this.Mb;switch(a.keyCode){case 37:if(d==-1)d=b;if(d>0){this.Xc(d-1);a.preventDefault();return g}break;case 39:if(d<b-1){this.Xc(d+1);a.preventDefault();return g}break;case 38:if(d==-1)d=b+c-1;if(d>=c){this.Xc(d-c);a.preventDefault();return g}break;
case 40:if(d==-1)d=-c;if(d<b-c){this.Xc(d+c);a.preventDefault();return g}break}return j};n.Fi=function(){};n.hw=function(){return this.rc};n.nj=function(a,b){if(this.b())e(Error("Component already rendered"));this.rc=ka(a)?new qe(a,b):a;this.tB()};n.pq=function(){var a=this.La;return a&&a[this.Mb]};n.Xc=function(a){if(a!=this.Mb){this.qG(this.Mb,j);this.Mb=a;this.qG(a,g)}};n.HK=function(a){var b=this.La;this.Xc(b?Mb(b,a):-1)};n.Ie=function(){return this.ma?this.ma.Ie():-1};
n.yi=function(){return this.ma?this.ma.yi():i};n.jd=function(a){this.ma&&this.ma.jd(a)};n.Nf=function(a){this.ma&&this.ma.Nf(a)};n.qG=function(a,b){if(this.b()){var c=this.La;c&&a>=0&&a<c.length&&this.ha.oG(this,c[a],b)}};n.kl=function(a,b){this.b()&&this.ha.O_(this,a,b)};
n.tB=function(){var a=this.La;if(a)if(this.rc&&this.rc.width){a=Math.ceil(a.length/this.rc.width);if(!ka(this.rc.height)||this.rc.height<a)this.rc.height=a}else{a=Math.ceil(Math.sqrt(a.length));this.rc=new qe(a,a)}else this.rc=new qe(0,0)};function Py(a,b,c){this.vp=a||[];Oy.call(this,i,b||Ly.Fa(),c);this.h0(this.vp)}w(Py,Oy);n=Py.prototype;n.Er=i;n.h0=function(a){this.vp=a;this.Er=i;this.hb(this.qP())};n.dw=function(){var a=this.yi();if(a){a=a.style[Af("background-color")];return Qy(a)}else return i};n.Dz=function(a){a=Qy(a);if(!this.Er)this.Er=Qb(this.vp,function(b){return Qy(b)});this.jd(a?Mb(this.Er,a):-1)};
n.qP=function(){return Qb(this.vp,function(a){var b=this.G().o("div",{"class":this.ha.Z()+"-colorswatch",style:"background-color:"+a});b.title=a.charAt(0)=="#"?"RGB ("+Cy(a).join(", ")+")":a;return b},this)};function Qy(a){if(a)try{return wy(a).Tq}catch(b){}return i};function Ry(a,b,c,d){os.call(this,a,b,c||Iy.Fa(),d)}w(Ry,os);
var Sy={i3:["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],s3:["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],o3:["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc","#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd","#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0","#cc0000","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79","#990000","#b45f06","#bf9000","#38761d","#134f5c",
"#0b5394","#351c75","#741b47","#660000","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]};function Ty(a,b){var c=new pi(b);a&&Nb(a,function(d){c.kb(d,g)});pc(Sy,function(d){d=new Py(d,i,b);d.nj(8);c.kb(d,g)});return c}n=Ry.prototype;n.dw=function(){return this.Ya()};n.Dz=function(a){this.jb(a)};n.jb=function(a){for(var b=0,c;c=this.ng(b);b++)typeof c.Dz=="function"&&c.Dz(a);Ry.c.jb.call(this,a)};
n.dn=function(a){if(typeof a.target.dw=="function")this.jb(a.target.dw());else a.target.Ya()=="none"&&this.jb(i);Ry.c.dn.call(this,a);a.stopPropagation();this.dispatchEvent("action")};n.Cb=function(a){if(a&&this.lk()==0){this.Fg(Ty(i,this.G()));this.jb(this.Ya())}Ry.c.Cb.call(this,a)};Zh("goog-color-menu-button",function(){return new Ry(i)});function Uy(){}w(Uy,ps);ga(Uy);Uy.prototype.createCaption=function(a,b){return ns(Jy(a,b),this.Z(),b)};Uy.prototype.jb=function(a,b){a&&Ky(this.xa(a),b)};Uy.prototype.se=function(a){this.jb(a.b(),a.Ya());I(a.b(),"goog-toolbar-color-menu-button");Uy.c.se.call(this,a)};function Vy(a,b,c,d){Ry.call(this,a,b,c||Uy.Fa(),d)}w(Vy,Ry);Zh("goog-toolbar-color-menu-button",function(){return new Vy(i)});function Wy(a,b,c,d){os.call(this,a,b,c,d);this.AK(a)}w(Wy,os);n=Wy.prototype;n.ma=i;n.Qu=i;n.Ua=function(){Wy.c.Ua.call(this);this.sA()};n.bd=function(a){Wy.c.bd.call(this,a);(a=this.fk())?this.AK(a):this.jd(0)};n.k=function(){Wy.c.k.call(this);if(this.ma){this.ma.p();this.ma=i}this.Qu=i};n.dn=function(a){this.Nf(a.target);Wy.c.dn.call(this,a);a.stopPropagation();this.dispatchEvent("action")};n.Fi=function(){var a=this.yi();Wy.c.jb.call(this,a&&a.Ya());this.sA()};
n.Fg=function(a){var b=Wy.c.Fg.call(this,a);if(a!=b){this.ma&&this.ma.clear();if(a)this.ma?a.ke(function(c){this.ma.oa(c)},this):this.Gu(a)}return b};n.AK=function(a){this.Qu=a;this.sA()};n.oa=function(a){Wy.c.oa.call(this,a);this.ma?this.ma.oa(a):this.Gu(this.R())};n.Og=function(a,b){Wy.c.Og.call(this,a,b);this.ma?this.ma.Og(a,b):this.Gu(this.R())};n.ue=ba(9);n.Nf=function(a){this.ma&&this.ma.Nf(a)};n.jd=function(a){this.ma&&this.Nf(this.ma.ng(a))};
n.jb=function(a){if(a!=i&&this.ma)for(var b=0,c;c=this.ma.ng(b);b++)if(c&&typeof c.Ya=="function"&&c.Ya()==a){this.Nf(c);return}this.Nf(i)};n.yi=function(){return this.ma?this.ma.yi():i};n.Ie=function(){return this.ma?this.ma.Ie():-1};n.Gu=function(a){this.ma=new Ny;a&&a.ke(function(b){this.ma.oa(b)},this);this.Qa().g(this.ma,"select",this.Fi)};n.sA=function(){var a=this.yi();this.hb(a?a.fk():this.Qu)};n.Cb=function(a){Wy.c.Cb.call(this,a);this.isOpen()&&this.R().Xc(this.Ie())};Zh("goog-select",function(){return new Wy(i)});function Xy(a,b,c,d){Wy.call(this,a,b,c||ps.Fa(),d)}w(Xy,Wy);Zh("goog-toolbar-select",function(){return new Xy(i)});function Yy(a,b){ii.call(this,a||Tx.Fa(),b)}w(Yy,ii);Zh("goog-toolbar-separator",function(){return new Yy});function Zy(a,b,c){hs.call(this,a,b||is.Fa(),c);this.we(16,g)}w(Zy,hs);Zh("goog-toggle-button",function(){return new Zy(i)});function $y(a,b,c){Zy.call(this,a,b||ks.Fa(),c)}w($y,Zy);Zh("goog-toolbar-toggle-button",function(){return new $y(i)});var az="/ui/";da.HtmlUtil_setServerBase=function(a){az=a};var bz,cz,dz;function ez(a,b){var c;if(a){c=Kf(a);var d=Pf(a);c.y+=d.height}else c=new oe(0,0);a=d.width>307?d.width:307;if(b){c.x+=b.screenX-b.clientX;c.y+=b.screenY-b.clientY}if(c.x+313>screen.width)c.x=screen.width-313;if(c.y+600>screen.height)c.y=screen.height-600;return new xf(c.x,c.y,a,554)}
function fz(a,b,c,d){var f,h;if(b){h=O(b);f=h.getAttribute("id")}else f=i;b=!E&&h?Ne(Fe(h))||window:window;c=ez(h,c);c="toolbar=no,location=no,menubar=no,scrollbars=no,resizable=yes,status=no,width="+c.width+",height="+c.height+",top="+c.top+",left="+c.left;a=gz(a,f,d);if(!bz||bz.closed)bz=b.open(a.toString(),"_chooser",c);bz.focus()}
function gz(a,b,c){a=a.gj(new Tc("widgets/ContactChooser"));b&&a.$("inputId",b);if(c){c.serviceName&&a.$("service",c.serviceName);c.hl&&a.$("hl",c.hl);c.tempTitle&&a.$("tempTitle",c.tempTitle)}return a}function hz(){P(dz);cz=dz=i}o("goog.focus.ChooserLauncher.popChooser",function(a,b,c){var d=new Tc(az.replace(/ui\/?$/,""));fz(d,a,b,c)},void 0);
o("goog.focus.ChooserLauncher.popIframe",function(a,b,c){cz&&hz();var d=new Tc(az.replace(/ui\/?$/,""));b=O(a);b=ez(b,i);a=gz(d,a,c);window.iframeDone=hz;a.$("done","iframeDone");c=O("chooser-iframe-div");if(c==i){c=Oe("div",{id:"chooser-iframe-div",style:"position: absolute; background-color; #FFF",zIndex:10});document.body.appendChild(c);c.innerHTML='<iframe id="chooser-iframe" style="display:none;background-color; #FFF; border: 0"></iframe>'}d=O("chooser-iframe");d.style.display="block";Nf(c,b.left,
b.top);Of(d,b.width,b.height);d.src=a;dz=c;cz=d},void 0);var iz,jz,kz;function lz(a,b){var c=307,d;if(z)c+=5;if(a){d=Kf(a);var f=Pf(a);d.y+=f.height}else d=new oe(0,0);a=f.width>c?f.width:c;if(b){d.x+=b.screenX-b.clientX;d.y+=b.screenY-b.clientY}if(d.x+313>screen.width)d.x=screen.width-313;if(d.y+600>screen.height)d.y=screen.height-600;return new xf(d.x,d.y,a,554)}
function mz(a,b,c,d){var f,h;if(b){h=O(b);f=h.getAttribute("id")}else f=i;b=!E&&h?Ne(Fe(h))||window:window;c=lz(h,c);h="toolbar=no,location=no,menubar=no,scrollbars=no,resizable=yes,status=no,width="+c.width+",height="+c.height+",top="+c.top+",left="+c.left;a=nz(a,f,d);a.$("width",c.width);a.$("height",c.height);if(!iz||iz.closed)iz=b.open(a.toString(),"_picker",h);iz.focus()}
function nz(a,b,c){a=a.gj(new Tc("ui/ContactPicker"));b&&a.$("inputId",b);if(c){c.serviceName&&a.$("service",c.serviceName);c.hl&&a.$("hl",c.hl)}return a}function oz(){P(kz);jz=kz=i}o("goog.focus.PickerLauncher.popPicker",function(a,b){var c=new Tc(az.replace(/ui\/?$/,""));mz(c,a,b)},void 0);
o("goog.focus.PickerLauncher.popIframe",function(a,b,c){jz&&oz();var d=new Tc(az.replace(/ui\/?$/,""));b=O(a);b=lz(b,i);a=nz(d,a,c);window.iframeDone=oz;a.$("done","iframeDone");c=O("PICKER_IFRAME_DIV_ID");if(c==i){c=Oe("div",{id:"PICKER_IFRAME_DIV_ID",style:"position: absolute; background-color; #FFF",zIndex:10});document.body.appendChild(c);c.innerHTML='<iframe id="PICKER_IFRAME_ID" style="display: none; background-color; #FFF; border: 0"></iframe>'}d=O("PICKER_IFRAME_ID");d.style.display="block";
Nf(c,b.left,b.top);Of(d,b.width,b.height);d.src=a;kz=c;jz=d},void 0);function eu(a,b){this.k4=[];this.Yn=q(a)?new Tc(a):a;if(this.Yn.Hf.charAt(0)!="/")e(Error());this.Zn=b;this.yp={};this.br=i;this.Bj={};this.Tx={};this.gr={};this.eq=i}eu.prototype.wz=function(a){this.ur=a};function pz(a){this.dZ=a;this.Kn=new Ch;this.eg=i}pz.prototype.lN=function(a){this.eg?this.eg.addInput(a):this.Kn.add(a)};pz.prototype.c_=function(a){this.eg?this.eg.removeInput(a):this.Kn.remove(a)};pz.prototype.Fz=function(a){this.eg&&this.eg.setTarget(a)};n=eu.prototype;
n.Sw=function(a){if(this.DD)e(Error("Email autcomplete was already initialized. To attach it to an input field, please use attachAutocomplete()"));this.DD=g;this.yp=a||{};var b=this;this.DS().SQ(function(c){if(c=(c.contentWindow||c.contentDocument.defaultView)._EmailAc_create){b.br=c;for(var d in b.Bj)b.HG(b.Bj[d]);if(b.eq){c=r(b.eq);(c=b.gr[c])&&c.Fz(b.eq)}for(d in b.Bj){c=b.Bj[d];c=c.Kn.Kc();for(var f=1;f<c.length;f++)Cg(c[f],"focus",b.cy,j,b)}}})};
n.HG=function(a){if(this.br){var b=a.dZ;b.serverBase=this.Yn;b.onComplete=u(this.qY,this);for(var c in this.yp)b[c]=this.yp[c];c=a.Kn.Kc();a.eg=this.br(c[0],b);for(b=1;b<c.length;b++)a.eg.addInput(c[b]);a.Kn.clear()}};n.Ot=function(a,b,c){a=O(a);b=b||{};var d=r(a);this.Tx[d]=c;var f;c="";for(f in b)c+=f+"="+b[f]+";";f=c;c=this.Bj[f];if(!c){c=new pz(b);this.Bj[f]=c}c.lN(a);this.gr[d]=c;c.eg||(this.br?this.HG(c):U(a,"focus",this.cy,j,this))};n.cy=function(a){this.eq=a.target;this.DD||this.Sw()};
n.qY=function(a){var b=this.Tx[r(a)];b&&b(a)};n.eQ=function(a){a=O(a);Cg(a,"focus",this.cy,j,this);var b=r(a);delete this.Tx[b];var c=this.gr[b];if(c){c.c_(a);delete this.gr[b]}};n.Pt=function(a,b){this.Sw(b);this.Ot(a,b)};n.GN=function(a){this.Ot(a)};n.vx=function(a,b){mz(this.Yn,a,b,{serviceName:this.Zn,hl:this.ur})};n.jX=function(a,b){fz(this.Yn,a,b,{serviceName:this.Zn,hl:this.ur})};
n.DS=function(){if(!this.CD){var a=this.Yn.gj(new Tc(this.yp.ac2?"ui/EmailAc2":"ui/EmailAc"));a.$("service",this.Zn);this.ur&&a.$("hl",this.ur);this.CD=this.YX(a.toString())}return this.CD};n.YX=function(a){return new qz(a)};o("goog.ContactTools",eu,void 0);eu.prototype.setLocale=eu.prototype.wz;eu.prototype.attachAutocompleteTo=eu.prototype.Pt;eu.prototype.attachAutocompleteAlsoTo=eu.prototype.GN;eu.prototype.initAutocomplete=eu.prototype.Sw;eu.prototype.attachAutocomplete=eu.prototype.Ot;
eu.prototype.detachAutocomplete=eu.prototype.eQ;eu.prototype.launchPicker=eu.prototype.vx;eu.prototype.launchChooser=eu.prototype.jX;function qz(a){this.gp=[];this.aj=this.Bu();document.body.appendChild(this.aj);z?U(this.aj,"readystatechange",this.Hn,j,this):U(this.aj,"load",this.zI,j,this);this.aj.src=a}qz.prototype.SQ=function(a){this.Ba?a(this.Ba):this.gp.push(a)};
qz.prototype.Bu=function(){var a=Oe("iframe");a.src='javascript:""';var b=a.style;b.visibility="hidden";b.width=b.height="10px";if(E)b.marginTop=b.marginLeft="-99px";else{b.position="absolute";b.top=b.left="-10px"}return a};qz.prototype.Hn=function(){this.aj.readyState=="complete"&&this.zI()};qz.prototype.zI=function(){this.Ba=this.aj;delete this.aj;for(var a=0;this.gp[a];++a)this.gp[a](this.Ba);delete this.gp};Dc("tr_small_link","Small","tr_medium_link","Medium","tr_large_link","Large","tr_original_link","Original size");if(window.jstiming){window.jstiming.PB={};window.jstiming.l_=1;var rz=function(a,b,c){var d=a.t[b],f=a.t.start;if(d&&(f||c)){d=a.t[b][0];f=c!=undefined?c:f[0];return d-f}};window.jstiming.report=function(a,b,c){var d="";if(window.jstiming.pt){d+="&srt="+window.jstiming.pt;delete window.jstiming.pt}try{if(window.external&&window.external.tran)d+="&tran="+window.external.tran;else if(window.gtbExternal&&window.gtbExternal.tran)d+="&tran="+window.gtbExternal.tran();else if(window.chrome&&window.chrome.csi)d+=
"&tran="+window.chrome.csi().tran}catch(f){}if(a.QP)d+="&"+a.QP;var h=a.t,k=h.start,l=[],m=[];for(var p in h)if(p!="start")if(p.indexOf("_")!=0){var t=h[p][1];if(t)h[t]&&m.push(p+"."+rz(a,p,h[t][0]));else k&&l.push(p+"."+rz(a,p))}delete h.start;if(b)for(var s in b)d+="&"+s+"="+b[s];a=[c?c:"http://csi.gstatic.com/csi","?v=3","&s="+(window.jstiming.sn||"writely")+"&action=",a.name,m.length?"&it="+m.join(","):"","",d,"&rt=",l.join(",")].join("");b=new Image;var A=window.jstiming.l_++;window.jstiming.PB[A]=
b;b.onload=b.onerror=function(){delete window.jstiming.PB[A]};b.src=a;b=i;return a}};function up(){}var sz=j;function vp(a,b,c){if(!sz){a=qa(tz,a,b,c);sz=g;b=J().createElement("script");b.src="https://ssl.google-analytics.com/ga.js";b.onreadystatechange=a;b.onload=a;J().appendChild(document.body,b)}}
function tz(a,b,c){if(typeof _gat!="undefined"){var d=window.urchinPage||Cr().Xv().toString();a=_gat._getTracker(a);a._setAllowAnchor(g);a._trackPageview(d);if(b){a=_gat._getTracker(b);a._setAllowAnchor(g);document.location.host.indexOf(".google.com")!=-1&&a._setCookiePath("/a/"+c);a._trackPageview()}}};function To(){this.qb="Britannica";Y.call(this);this.We(new Lo)}To.Gb(Y);n=To.prototype;n.Ng="";n.NQ="";n.sa=function(a){this.Ng=a;this.NQ=encodeURIComponent(this.Ng);if(To.c.sa.call(this,g,this.Ng)){this.kL('Looking up "'+(this.Ng+'" in Encyclopedia Britannica...'));Aj("getfrombritannica",{word:this.Ng},this.vI.bind(this));this.GG()}};
n.GG=function(){this.Ha("SearchSep");this.Ha("EBCopyright");if(!this.vb){U(O(this.j("Searchbttn")),"click",this.iU.bind(this));this.vb=g}this.Ka("Britannica.com");this.Db("EBCopyright");this.Db("SearchSep");To.c.sa.call(this)};n.x1=function(a,b){O(this.j(a)).innerHTML=b};
n.vI=function(a){if(!a||!a.responseText||Ba(a.responseText).length==0)this.r1("Sorry, there was en error with this request. Please try again.");else{this.GG();O(this.j("EnyclopediaTermInput")).value=this.Ng;a=a.responseText;if(ta(a,"while(true);"))a=a.substr(12);a=Fb(a);if(a.file=="error"){O(this.j("SearchAgainPrompt")).style.display="none";this.x1("ResultsDiv","No results found.")}else{O(this.j("SearchAgainPrompt")).style.display="";a=a.results;O(this.j("ResultsDiv")).innerHTML=this.fO(a)}if(z){this.Ha("SearchSep");
this.Db("SearchSep")}this.zV()}};n.fO=function(a){var b="",c=a.length;if(c>14)c=14;for(var d=0,f=1;d<c;){var h=a[d];d++;var k=a[d];d++;var l=a[d];d++;b+="<b>"+f+'. </b><a id="<?cs var:Dialog.Namespace ?>link'+f+'" target="_blank" href="'+k+'">'+h+"</a><br>"+l+"<p>";f++}return b};n.iU=function(){this.Ng=O(this.j("EnyclopediaTermInput")).value;this.kL('Looking up "'+(this.Ng+'" in Encyclopedia Britannica...'));Aj("getfrombritannica",{type:"encyclopedia",word:this.Ng},this.vI.bind(this))};
n.kL=function(a){this.Ha("MainDialog");O(this.j("Status")).innerHTML=a;this.Db("Status");this.Ga()};n.zV=function(){this.Ha("Status");this.Db("MainDialog");this.Ga()};n.r1=function(a){this.z(j);F(a)};function Uo(){this.qb="Captcha";Y.call(this)}Uo.Gb(Y);Uo.prototype.sa=function(a){if(Uo.c.sa.call(this,g)){this.ry=a.pZ;this.XR=a.l1;this.CG=new Tc(a.KV);O(this.j("img")).src=this.CG.toString();this.Vc("Send email");a=this.xa();a.style.paddingTop="15px";a.style.paddingBottom="15px";a.style.paddingLeft="20px";a.style.paddingRight="100px";this.z(g);O(this.j("input")).focus()}};
Uo.prototype.Na=function(a){var b=this.Y("input");if(b){this.ry.u("canswer",b);this.ry.u("ctoken",this.CG.fc("ctoken"));uz(this.ry,this.XR);O(this.j("img")).src="";O(this.j("input")).value=""}else{F("Please type the characters you see in the picture",O(this.j("input")));a.preventDefault()}};function Vo(){this.qb="ChangeCell";Y.call(this);this.Yf=[];this.vb=j}Vo.Gb(Y);
Vo.prototype.sa=function(){if(Vo.c.sa.call(this)){this.Vc("Change");this.Yf=[];if(!z){var a=$i(X);if(a)for(var b=0;b<a.rangeCount;b++){var c=a.getRangeAt(b),d=c.startContainer;if(c&&d.nodeType==1)d=d.childNodes[c.startOffset];d&&d.tagName=="TD"&&this.Yf.push(d)}}if(this.Yf.length==0){this.Yf=[Si(Z,"td")];if(!this.Yf[0]){F("Please click on a table cell and try again.");this.z(j);return}}this.Yf.length==1?this.Ka("Change Cell"):this.Ka("Change Cells");a=this.Yf[0];this.Ik(a,"width","width_select","width_amt");
this.Ik(a,"height","height_select","height_amt");this.xj();if(!this.vb){b=O(this.j("width_select"));c=O(this.j("height_select"));U(b,"change",this.xj.bind(this));U(c,"change",this.xj.bind(this));this.vb=g}if(a.style.textAlign){a.setAttribute("align",a.style.textAlign);a.style.textAlign=""}this.ud(a,"align","halign_select","select");this.ud(a,"valign","valign_select","select");this.nh(Ii(a),"bgcolor")}};
Vo.prototype.Na=function(a){for(var b=0;b<this.Yf.length;b++){var c=this.Yf[b];this.zl(c,"width_select","width_amt","width");this.zl(c,"height_select","height_amt","height");var d=this.Y("halign_select")||"select";this.Gd(c,d,"align",this.Y("halign_select")!="select");d=this.Y("valign_select")||"select";this.Gd(c,d,"valign",this.Y("valign_select")!="select");this.eo(c,"bgcolor","bgcolor")}x.fa();Jp();Vo.c.Na.call(this,a)};function Wo(){this.qb="ChangeColumn";Y.call(this);this.Rg=i;this.vb=j}Wo.Gb(Y);
Wo.prototype.sa=function(){if(Wo.c.sa.call(this)){this.Vc("Change");this.Rg=Si(Z,"td");if(this.Rg==i){F("Please click on a table column and try again.");this.z(j)}else{this.Ik(this.Rg,"width","width_select","width_amt");this.Ol("width_select","width_amt",j);if(!this.vb){var a=O(this.j("width_select"));U(a,"change",this.Ol.bind(this,"width_select","width_amt",j));this.vb=g}this.ud(this.Rg,"align","halign_select","select");this.ud(this.Rg,"valign","valign_select","select");this.nh(Ii(this.Rg),"bgcolor")}}};
Wo.prototype.Na=function(a){var b=Si(this.Rg,"table");if(b!=i)for(var c=this.Y("halign_select")||"select",d=this.Y("valign_select")||"select",f=this.Rg.cellIndex,h=0;h<b.rows.length;h++){var k=b.rows[h];if(f<k.cells.length){k=k.cells[f];this.zl(k,"width_select","width_amt","width");this.Gd(k,c,"align",c!="select");this.Gd(k,d,"valign",d!="select");this.eo(k,"bgcolor","bgcolor")}}x.fa();Jp();Wo.c.Na.call(this,a)};function Xo(){this.qb="ChangeList";Y.call(this)}Xo.Gb(Y);
Xo.prototype.sa=function(){if(Xo.c.sa.call(this)){this.Vc("Change");this.wg=Si(Z,"ul","ol");if(this.wg==i){F("Please click on a list and try again.");this.z(j)}else{if(this.wg.tagName=="OL"){this.Ha("bullets");this.Db("numbers");this.ud(this.wg,"start","start_at","1");this.ud(this.wg,"type","number_select","decimal");this.vy="decimal";this.zC();var a=O(this.j("number_select"));U(a,"change",this.zC.bind(this))}else{this.Ha("numbers");this.Db("bullets");this.ud(this.wg,"type","shape_select","disc")}this.Ga()}}};
Xo.prototype.Na=function(a){if(this.wg.tagName=="OL"){var b=this.Y("start_at");b=vz(b,this.Y("number_select"),"decimal");this.Gd(this.wg,b,"start",b!="1");b=this.Y("number_select")||"decimal";this.Gd(this.wg,b,"type",b!="decimal")}else{b=this.Y("shape_select")||"disc";this.Gd(this.wg,b,"type",b!="disc")}x.fa();Jp();Xo.c.Na.call(this,a)};Xo.prototype.vy="decimal";
Xo.prototype.zC=function(){var a=this.Y("start_at");a=vz(a,this.vy,this.Y("number_select"));this.na("start_at",a);this.vy=this.Y("number_select")||"decimal"};function vz(a,b,c){var d=parseInt(a,10);if(isNaN(d))d=b=="I"||b=="i"?wz(a):b=="A"||b=="a"?xz(a):0;d=Math.max(1,Math.round(d));if(c=="decimal")return d;else if(c=="I")return yz(d,g);else if(c=="i")return yz(d,j);else if(c=="A")return zz(d,g);else if(c=="a")return zz(d,j);return 1}
function xz(a){a=a.toUpperCase();for(var b=0,c=0;c<a.length;c++){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(a.charAt(c))+1;if(d){b*=26;b+=d}}return b}function zz(a,b){a=typeof a!="number"||a<1?0:Math.floor(a);for(var c="";a>0;){var d=a%26;if(d==0)d=26;c="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(d-1)+c;a-=d;a/=26}return b?c:c.toLowerCase()}
function wz(a){a=a.toUpperCase();for(var b=0,c=0;c<a.length;c++){var d=a.charAt(c),f=a.charAt(c+1);if(d=="M")b+=1E3;else if(d=="D")b+=500;else if(d=="C"&&f=="M"){b+=900;c++}else if(d=="C"&&f=="D"){b+=400;c++}else if(d=="C")b+=100;else if(d=="L")b+=50;else if(d=="X"&&f=="C"){b+=90;c++}else if(d=="X"&&f=="L"){b+=40;c++}else if(d=="X")b+=10;else if(d=="V")b+=5;else if(d=="I"&&f=="X"){b+=9;c++}else if(d=="I"&&f=="V"){b+=4;c++}else if(d=="I")b+=1;else return 0}return b}
function yz(a,b){a=typeof a!="number"||a<1?0:Math.floor(a);for(var c="";a>0;)if(a>=1E3){c+="M";a-=1E3}else if(a>=900){c+="CM";a-=900}else if(a>=500){c+="D";a-=500}else if(a>=400){c+="CD";a-=400}else if(a>=100){c+="C";a-=100}else if(a>=90){c+="XC";a-=90}else if(a>=50){c+="L";a-=50}else if(a>=40){c+="XL";a-=40}else if(a>=10){c+="X";a-=10}else if(a>=9){c+="IX";a-=9}else if(a>=5){c+="V";a-=5}else if(a>=4){c+="IV";a-=4}else if(a>=1){c+="I";a-=1}return b?c:c.toLowerCase()};function Yo(){this.qb="ChangeRow";Y.call(this)}Yo.Gb(Y);
Yo.prototype.sa=function(){if(Yo.c.sa.call(this)){this.Vc("Change");this.il=Si(Z,"td");if(this.il==i){F("Please click on a table row and try again.");this.z(j)}else{this.Ik(this.il,"height","height_select","height_amt");this.Ol("height_select","height_amt",j);if(!this.vb){var a=O(this.j("height_select"));U(a,"change",this.Ol.bind(this,"height_select","height_amt",j));this.vb=g}this.ud(this.il,"align","halign_select","select");this.ud(this.il,"valign","valign_select","select");this.nh(Ii(this.il),
"bgcolor")}}};Yo.prototype.Na=function(a){var b=Si(this.il,"tr");if(b!=i){b=b.childNodes;for(var c=0,d;d=b[c];c++){this.zl(d,"height_select","height_amt","height");var f=this.Y("halign_select")||"select";this.Gd(d,f,"align",f!="select");f=this.Y("valign_select")||"select";this.Gd(d,f,"valign",f!="select");this.eo(d,"bgcolor","bgcolor")}}x.fa();Jp();Yo.c.Na.call(this,a)};function $o(){this.qb="CommentSettings";Y.call(this)}$o.Gb(Y);$o.prototype.Na=function(a){qj(this.Wa("ColorAll"),this.Wa("SaveColor"));x.fa();Jp();$o.c.Na.call(this,a)};function Zo(){this.qb="CSSEdit";Y.call(this)}Zo.Gb(Y);Zo.prototype.sa=function(){if(Zo.c.sa.call(this)){this.na("CSSText",Nd("css_style"));O(this.j("CSSText")).focus();this.ac.pz(j)}};Zo.prototype.Na=function(a){var b=new Mc;b.u("stylesheet",this.Y("CSSText"));b.u("updateStyleSheets",g);var c=Hd();b.u("docID",c);bh("setstylesheet",b,this.Wk.bind(this),"postCssContents_"+c);Zo.c.Na.call(this,a)};
Zo.prototype.Wk=function(a){if(!th(a)){if(a.responseText){a=a.responseText.replace("while(true);","");if(a.replace(/\s/g,"")!=""){a=Fb(a);a.css_style!=i&&Vd("css_style",a.css_style);a.styles!=i&&Vd("styles",a.styles)}}hu()}};function Az(a,b,c,d){this.Nw=a;this.Wn=b;this.kr=typeof c=="undefined"||!!c;this.sW=!!d;this.sv=j;this.Ow=[];this.JL=[];this.hy=[];this.iy=[];this.hz=[];this.LA=[];this.Yh=[];this.Go=[];this.Jl=[];this.ek=[];this.qi=[];this.Th=[]}
var Bz=new RegExp("(\\s*<\\/?(address|br|div|hr|p|pre|h1|h2|h3|h4|h5|h6|table|tbody|tfoot|td|th|thead|tr|dl|ul|ol|menu)[^>]*>\\s*)+","ig"),Cz=new RegExp("(\\s*(<\\/?(address|br|div|hr|p|pre|h1|h2|h3|h4|h5|h6|table|tbody|tfoot|td|th|thead|tr|dl|ul|ol|menu|blockquote|li|dt|dd)[^>]*>|[\\.!\\?])\\s*)+","ig"),Dz=/[\s\,\!\?\"\\\/\@\&\*\+\|\=\^\<\>\(\)\[\]\{\}]+/g;n=Az.prototype;n.Xd=function(){return this.jh(1)>1};
n.cw=function(a,b){a=a.replace(b,"<p>");a=a.replace(/(<p>)+/g,"<p>");a=a.replace(/^<p>/,"");a=a.replace(/<p>$/,"");a=a.split("<p>");return a.length==1&&!a[0]?0:a.length};n.Aq=function(a){if(this.hy[a]==i){var b;if(a==1){b=this.Wn.vc().L3;if(typeof b=="undefined"){b=this.Wn.L().parentNode;var c=this.Wn.da().parentNode;b=Kf(c).y+c.offsetHeight-Kf(b).y}}else b=this.Nw.scrollHeight;c=Math.min(this.Nw.scrollWidth,1E3);this.hy[a]=Math.ceil(b*c/8E5)}return this.hy[a]};
n.Bq=function(a){if(this.iy[a]==i)this.iy[a]=this.cw(this.kk(a),Bz);return this.iy[a]};n.zi=function(a){if(this.hz[a]==i)this.hz[a]=this.cw(this.kk(a),Cz);return this.hz[a]};n.jh=function(a){if(this.LA[a]==i)this.LA[a]=this.sW?this.rk(a):this.cw(this.Ab(a),Dz);return this.LA[a]};n.kk=function(a){if(this.Ow[a]==i)this.Ow[a]=a==1?this.Wn.ui():this.Nw.innerHTML;return this.Ow[a]};
n.Ab=function(a){var b=this.JL[a];if(b==i){b=b=a==1?this.Wn.Ab():this.kk(a);b=b.replace(/(<[^>]+>)/g," ");b=b.replace(/&nbsp;/g," ");b=b.replace(/&#12288;/g," ");b=b.replace(/&#x3000;/g," ");b=b.replace(/&[#\w]+;/g,"_");b=b.replace(/\s+/g," ");b=b.replace(/^ /,"");b=b=b.replace(/ $/,"");this.JL[a]=b}return b};n.vE=function(a){if(this.Yh[a]==i)this.Yh[a]=this.Ab(a).length;this.sv=this.Yh[0]&&this.Yh[1]&&this.Yh[0]==this.Yh[1];return this.Yh[a]};
n.rk=function(a){if(this.Go[a]==i){var b=this.Ab(a).replace(/\s+/g,"");this.Go[a]=b.length;if(this.sv)this.Go[1]=this.Go[0]}return this.Go[a]};
n.hF=function(a){if(!this.Jl[a])if(this.kr){var b=this.Ab(a);b=" "+b+" ";b=b.replace(/(ed|e|)\s+/ig," ");b=b.replace(/[^ aeiouy]*[aeiouy]+[^ aeiouy]*/ig,"e");b=b.replace(/ee/g,"e e");if((b=b.replace(/ee/g,"e e"))&&b.charAt(0)==" ")b=b.substring(1);if(b&&b.charAt(b.length-1)==" ")b=b.substring(0,b.length-1);this.Jl[a]=b.split(" ").length;if(this.sv)this.Jl[1]=this.Jl[0]}else this.Jl[a]="-";return this.Jl[a]};
n.ME=function(a){if(this.ek[a]==i)if(this.kr){var b=this.jh(a),c=b/this.zi(a);b=this.hF(a)/b;this.ek[a]=206.835-1.015*c-84.6*b;this.ek[a]=Math.max(0,this.ek[a])}else this.ek[a]="-";return this.ek[a]};n.LE=function(a){if(this.qi[a]==i)if(this.kr){var b=this.jh(a),c=b/this.zi(a);b=this.hF(a)/b;this.qi[a]=0.39*c+11.8*b-15.59;if(E)this.qi[a]*=1.01;this.qi[a]=Math.round(Math.max(0,this.qi[a]))}else this.qi[a]="-";return this.qi[a]};
n.mE=function(a){if(this.Th[a]==i)if(this.kr){var b=this.jh(a),c=b/this.zi(a);b=this.rk(a)/b;this.Th[a]=4.71*b+0.5*c-21.43;if(E)this.Th[a]*=1.02;this.Th[a]=Math.round(Math.max(0,this.Th[a]))}else this.Th[a]="-";return this.Th[a]};function ap(){this.qb="DocSettings";Y.call(this)}ap.Gb(Y);n=ap.prototype;n.sa=function(){if(ap.c.sa.call(this)){H("enable_font_detection")&&this.n2();this.YV();this.ZV();this.Kp()}};n.n2=function(){var a=Ge(this.j("fontNameSel"));if(a&&SITE_UPDATED_FONTS){a.innerHTML="";for(var b in SITE_UPDATED_FONTS)if(b){var c=Oe("option",{value:SITE_UPDATED_FONTS[b],text:b});a.options.add(c)}return g}else return j};
n.YV=function(){if(!this.vb){var a=O(this.j("fontNameSel")),b=O(this.j("fontSizeSel")),c=O(this.j("paraSpacingSel"));U(a,"change",this.Kp.bind(this));U(b,"change",this.Kp.bind(this));U(c,"change",this.Kp.bind(this));this.vb=g;b=[];var d;for(d in SITE_LANG_FONTS)if(d&&SITE_LANG_FONTS[d]){c=document.createElement("OPTION");c.value=SITE_LANG_FONTS[d];c.innerHTML=d;b.unshift(c)}for(d=0;d<b.length;d++)Xe(b[d],a.firstChild)}};
n.ZV=function(){O(this.j("rtlSetting")).checked=Sd("rtl");O(this.j("makeDefault")).checked=Sd("makedefault");var a=Nd("fontname");a&&this.na("fontNameSel",a);(a=Nd("fontsize"))&&this.na("fontSizeSel",a);a=Nd("linespacing");if(a=="normal")a="";a&&this.na("paraSpacingSel",a);this.nh(String(Nd("bgcolor")),"docBgColor")};
n.Na=function(a){var b=new Mc;b.u("makeDefault",this.Wa("makeDefault"));b.u("updateStyleSheets",g);b.u("face",this.zb("fontNameSel"));b.u("size",this.zb("fontSizeSel"));b.u("spacing",this.zb("paraSpacingSel"));b.u("rtl",this.Wa("rtlSetting"));var c=this.kq(O(this.j("docBgColor")));b.u("bgColor",c);b.u("docid",Hd());bh("save_doc_settings",b,this.Wk.bind(this));a.preventDefault()};
n.Kp=function(){var a=O(this.j("preview"));a.style.fontFamily=this.zb("fontNameSel");a.style.fontSize=this.zb("fontSizeSel")+"pt";a.style.lineHeight=this.zb("paraSpacingSel");a.style.backgroundColor=this.kq(O(this.j("docBgColor")))};
n.Wk=function(a){if(!a||th(a)){F("Could not save document settings.");this.z(j)}else{if(a.responseText){a=a.responseText.replace("while(true);","");if(a.replace(/\s/g,"")!=""){a=Fb(a);a.styles&&Vd("styles",a.styles)}}(a=this.zb("fontNameSel"))&&Vd("fontname",a);(a=this.zb("fontSizeSel"))&&Vd("fontsize",a);(a=this.zb("paraSpacingSel"))&&Vd("linespacing",a);Vd("rtl",O(this.j("rtlSetting")).checked);a=this.kq(O(this.j("docBgColor")));Vd("bgcolor",a);Vd("makedefault",O(this.j("makeDefault")).checked);
this.z(j);hu()}};function bp(){this.qb="EditHtmlSelection";Y.call(this)}bp.Gb(Y);bp.prototype.sa=function(){bp.c.sa.call(this)&&O(this.j("htmlSnippet")).focus()};bp.prototype.Na=function(a){var b=O(this.j("htmlSnippet")).value||"";if(b)b=Ba(b);if(b){ch(b,i,g);Jp()}this.na("htmlSnippet","");bp.c.Na.call(this,a)};bp.prototype.Vk=function(a){this.na("htmlSnippet","");bp.c.Vk.call(this,a)};function Ez(a){for(var b="",c="",d=0;d<a.length;){var f=Fz(a,d);if(f.charAt(0)=="<"&&f.indexOf(">")!=-1){c=f.indexOf(">");c=f.substring(1,c)}else if(c=="")b+=f;d+=f.length}if(c==""&&b.indexOf("@")!=-1){c=b;b=""}b=wa(b);b=Qa(b,"'");b=Qa(b,'"');c=wa(c);return[b,c]}function Fz(a,b){var c=a.charAt(b),d='"<(['.indexOf(c);if(d==-1)return c;d=a.indexOf('">)]'.charAt(d),b+1);return d>=0?a.substring(b,d+1):c}
function Gz(a){if(a.indexOf("=")!=-1)return'"=" is not allowed.';else if(a.indexOf(" ")!=-1)return"Spaces are not allowed.";else if(a.indexOf("@")==-1||a.indexOf(".")==-1||a.lastIndexOf(".")<a.indexOf("@"))return"Address is malformed.";else{a=a.split("@");if(a.length!=2)return'Only one "@" is allowed.';else if(a[0].length==0)return"No username specified.";for(var b=a[1].split("."),c=j,d=0;d<b.length;d++)if(b[d].length==0){c=g;break}if(a[1].length<4||b.length<2||c)return"Invalid domain specified."}return i}
;function cp(){this.qb="EmailDocument";Y.call(this);this.Rx=i;this.Lx=0}cp.Gb(Y);n=cp.prototype;
n.sa=function(a){if(cp.c.sa.call(this,g,a)){this.Rx=i;if(!this.vb){a=O(this.j("tab1"));var b=O(this.j("tab2")),c=O(this.j("includeAsDocInBody")),d=O(this.j("includeAsAttachment"));U(a,"click",this.jj.bind(this,1,j));U(b,"click",this.jj.bind(this,2,j));U(c,"click",function(){O("EmailDocumentattachmentSelect").setAttribute("disabled",g)});U(d,"click",function(){O("EmailDocumentattachmentSelect").removeAttribute("disabled")});this.vb=g;a=[a,b];b=function(){return j};for(c=0;c<a.length;c++)a[c].onclick=
b}document.forms[this.j("EmailForm")].reset();O(this.j("attachmentSelect")).removeAttribute("disabled");this.MJ("Cancel");this.Vc("Send");this.ac.pz(j);this.z(g);this.Db("tabRow");this.Ka("Email Document");this.OV(window.NewFolks,window.SendDocument);document.forms[this.j("EmailForm")].reset();this.na("subject",Xd());O(this.j("CCme")).checked=H("ccme");var f=new eu(G("contactsServerBase"),"writely");f.wz(G("language"));var h=O(this.j("toanytext"));try{f.Pt(h,{groups:g,implicitGroups:g,extendedInterface:g});
O(this.j("email_picker_link")).onclick=function(l){f.vx(h,l);return j}}catch(k){}}};n.OV=function(a,b){this.Ha("newFolksRow");if(H("cosmosharing"))this.jj(2);else if(a){this.jj(0,g);this.Rx=a;a=Mi(Ba(a));a=Ha(a);a=a.replace(/,+$/,"");O(this.j("newFolksCell")).innerHTML=a;this.Ha("toAny");this.Ha("tabRow");this.Db("newFolksRow");this.Ka("Tell these people about the document?");this.MJ("Skip sending invitation")}else if(!Sd("isshared")||b)!Sd("ispublished")||b?this.jj(2):this.jj(1);else this.jj(0)};
n.jj=function(a,b){if(a==0&&!Sd("isshared")&&!b){if(Ld("This document has not been shared. Do you want to share it now?")){editUI.Bl.ig("invite");this.z(j)}}else if(a==1&&!Sd("ispublished")&&!b){if(Ld("This document has not been published. Do you want to publish it now? Click OK to close this window and switch to the Publish tab.")){Ht("publish");this.z(j)}}else{this.Lx=a;for(b=0;b<3;b++)if(a==b){this.Ha("d"+b+"it");this.Db("d"+b+"at")}else{this.Db("d"+b+"it");this.Ha("d"+b+"at")}switch(a){case 0:this.Ha("toAny");
this.Ha("includeDocAs");O(this.j("cbc0"))&&this.Db("toControlList_c");O(this.j("cbv0"))&&this.Db("toControlList_v");this.Db("linkIncluded");this.Ha("pubLinkIncluded");this.Db("includeEntireDoc");O(this.j("msg")).focus();break;case 1:this.Db("toAny");this.Ha("newFolksRow");this.Ha("includeDocAs");this.Ha("toControlList_c");this.Ha("toControlList_v");this.Ha("linkIncluded");this.Db("pubLinkIncluded");this.Ha("includeEntireDoc");O(this.j("toanytext")).focus();break;case 2:this.Db("toAny");this.Ha("newFolksRow");
this.Db("includeDocAs");this.Ha("toControlList_c");this.Ha("toControlList_v");this.Ha("linkIncluded");this.Ha("pubLinkIncluded");this.Ha("includeEntireDoc");O(this.j("toanytext")).focus()}}};
n.Na=function(a){var b=new Mc;b.u("docID",Hd());var c=!!window.NewFolks,d="";if(c)d=this.Rx;else if(this.Lx==0){d=this.OE("c")+this.OE("v");if(Ba(d)==""){F("Please select some people to send this message to.",j);a.preventDefault();return}}else{d=this.Y("toanytext");var f=O(this.j("toanytext"));if(Ba(d)==""){F("Please select some people to send this message to.",j);a.preventDefault();return}var h;if(h=this.J2(d)){F(h,f);a.preventDefault();return}}b.u("users",d);d=this.Y("msg");if(H("promptEmptyMsg")==
g&&!d&&!Ld("Unless you enter one here, the message will not include a personal note from you. Continue?"))a.preventDefault();else{d&&b.u("msg",d);(d=this.Y("subject"))||(d=Xd());b.u("subject",d);d=this.Wa("CCme");Ud("ccme",d);d&&b.u("cc",d);d=j;switch(this.Lx){case 0:b.u("function","message");d=this.Wa("includeDocInBody");break;case 1:b.u("function","publink");break;case 2:b.u("function","document");b.u("code",this.zb("attachmentSelect"));d=this.Wa("includeAsDocInBody");break}d&&b.u("inc",g);uz(b,
c);cp.c.Na.call(this,a)}};n.Vk=function(){window.NewFolks&&cj();cp.c.Vk.call(this)};n.J2=function(a){for(var b=[],c="",d,f=0;f<a.length;){d=Fz(a,f);if(d==","){xa(c)||b.push(Ez(c));c="";f++}else{c+=d;f+=d.length}}xa(c)||b.push(Ez(c));for(a=0;c=b[a];a++)if(c=Gz(c[1]))return c;return i};function uz(a,b){nt(function(){Hz(a,b)})}
function Hz(a,b){lj("send_email");Zg("Sending Message...");Do(a,function(c,d){if(c&&c.responseText){try{var f=Fb(c.responseText)}catch(h){}if(f&&f.captcha){oh("Captcha",{pZ:a,l1:b,KV:f.captcha});return}}b?Iz(c,d,a):Jz(c,d,a)})}function Kz(a,b,c){$g();if(!a||b)F("There was an error sending your email. Please try again.");else if(a.responseText){b={};try{b=Fb(a.responseText)}catch(d){b.error=a.responseText}if(b.warning){if(Ld(b.warning)){c.u("ignore_warnings",g);uz(c,j)}}else b.error&&F(b.error)}}
function Iz(a,b,c){Kz(a,b,c);cj();Fi("send_email")}function Jz(a,b,c){Kz(a,b,c);Fi("send_email")}cp.prototype.OE=function(a){for(var b=new jl,c=0,d=O(this.j("cb"+a+c));d;){d.checked&&b.append(d.value+"; ");if(++c>1E3)break;d=O(this.j("cb"+a+c))}return b.toString()};function dp(){this.qb="FindReplace";Y.call(this);this.Jy=g}dp.Gb(Y);dp.prototype.sa=function(){if(dp.c.sa.call(this)){this.Vc("Replace All");if(zh){this.na("findText",zh);zh=""}else{this.na("findText","");this.na("txtReplace","")}O(this.j("findText")).focus()}};
dp.prototype.Na=function(a){var b=this.Y("findText"),c=this.Y("txtReplace"),d=O(this.j("findText"));if(b)if(b==c){F("The text to find is the same as the text to replace it with. Please change one of them.",d);a.preventDefault()}else{var f=this.Wa("chkCase")?"g":"gi",h=b;this.Wa("regex")||(h=h.replace(/([^a-zA-Z0-9])/g,"\\$1"));if(this.Wa("chkWord"))h="\\b"+h+"\\b";d=0;d=this.RJ(X.document.body,new RegExp(h,f),c,this.Jy,d);f='Sorry, "'+(b+'" was not found. Please try again.');b='"'+(b+('" was replaced with "'+
(c+'".')));d==0?F(f):F(b);x.fa();dp.c.Na.call(this,a)}else{F("Please enter some text to search for.",d);a.preventDefault()}};dp.prototype.RJ=function(a,b,c,d,f){for(var h=0;h<a.childNodes.length;h++){var k=a.childNodes[h];if(k.nodeType==3){var l=k.nodeValue.replace(b,c);if(k.nodeValue!=l){f++;k.nodeValue=l;k.nodeValue.replace(b,c);if(!d)return f}}f=this.RJ(k,b,c,d,f)}return f};function ep(){this.qb="InsertBookmark";Y.call(this)}ep.Gb(Y);n=ep.prototype;n.sa=function(){if(ep.c.sa.call(this)){this.Vc("Insert");this.SD(X.document,"otherBookmarks",j);this.na("bookmarkname",Ni(jh));O(this.j("bookmarkname")).focus();if(!this.vb){var a=O(this.j("removeBookmark")),b=O(this.j("otherBookmarks"));U(a,"click",this.TZ.bind(this));U(b,"change",this.u2.bind(this));this.vb=g}}};
n.Na=function(a){var b=O(this.j("bookmarkname"));b.value=b.value.replace(/[_&<>\r\n\"]+/g,"_");var c=i;if(b.value=="")c="Please enter a bookmark name.";if(this.$N(b.value))c="A bookmark with this name already exists in the document. Please choose another name.";if(c){F(c,b);a.preventDefault()}else{b=Ni(b.value);ch('<a id="'+b+'" name="'+b+'"></a>',b,g);Jp();ep.c.Na.call(this,a)}};n.$N=function(a){for(var b=X.document.getElementsByTagName("a"),c=0,d;d=b[c];c++)if(d.name==a)return g;return j};
n.u2=function(){this.Y("otherBookmarks")?O(this.j("removeBookmark")).removeAttribute("disabled"):O(this.j("removeBookmark")).setAttribute("disabled",g)};n.TZ=function(){var a=this.Y("otherBookmarks");if(a)for(var b=X.document.getElementsByTagName("a"),c=0,d;d=b[c];c++)if(d.name==a){d.parentNode.removeChild(d);Jp();this.z(j);return}};function ip(){this.qb="MiscTextBox";Y.call(this);var a=new Lo;a.u("cancel","OK",g,g);this.We(a)}ip.Gb(Y);
ip.prototype.sa=function(a){window.setTimeout(u(this.Ga,this),0);if(ip.c.sa.call(this,g,a)){a=a||this.OD;this.z(g);this.b().style.zIndex=1E4;if(a&&a.caption){var b=a.caption.replace(/\n/g,"<br>");O(this.j("caption")).innerHTML=b}else O(this.j("caption")).innerHTML="";b=O(this.j("msg"));var c=O(this.j("ctrlhelp"));if(a&&a.text){b.style.display="";c.style.display="";b.value=a.text;if(a.FH>0)b.style.rows=a.FH;O(this.j("msg")).focus();O(this.j("msg")).select()}else{b.style.display="none";c.style.display=
"none"}if(a&&a.width>0)O(this.j("container")).width=a.width;a&&a.title?this.Ka(a.title):this.Ka("Message From Google Docs")}};function jp(){this.qb="PrintSettings";Y.call(this);var a=this.ac;a.u("print","Print...",j,j);this.We(a)}jp.Gb(Y);n=jp.prototype;
n.sa=function(a){if(jp.c.sa.call(this,g,a)){this.Zb=a||i;a=="Export"?this.Ka("Export as PDF"):this.Ka("Print Settings");this.na("paperSizeSel",Nd("papersize"));if(Sd("usesportrait"))O(this.j("portrait")).checked=g;else O(this.j("landscape")).checked=g;this.Oz();this.na("topMarginSel",Nd("topmargin"));this.na("bottomMarginSel",Nd("bottommargin"));this.na("leftMarginSel",Nd("leftmargin"));this.na("rightMarginSel",Nd("rightmargin"));a=Nd("pagenumber");O(this.j("includePageNumSel")).checked=a!="NONE";
a!="NONE"&&this.na("pageNumberSel",Nd("pagenumber"));O(this.j("includeCommentsSel")).checked=!Sd("stripcomments");if(H("enable_footnotes")){O(this.j("includeFootnotesSel")).checked=Sd("printfootnotes");O(this.j("includeFootnotesSel")).style.display="";O(this.j("includeFootnotesSelLabel")).style.display=""}if(H("enable_print_endnotes")){O(this.j("includeEndnotesSel")).checked=Sd("convertFootnotesToEndnotes");if(a=Nd("endnotesTitle"))O(this.j("includeTitleField")).value=a;this.Lz()}if(!this.vb){a=O(this.j("portrait"));
var b=O(this.j("landscape"));U(a,"click",this.Oz.bind(this));U(b,"click",this.Oz.bind(this));if(H("enable_print_endnotes")){a=O(this.j("includeFootnotesSel"));U(a,"click",this.Lz.bind(this));a=O(this.j("includeEndnotesSel"));U(a,"click",this.Lz.bind(this))}this.vb=g}this.z(g)}};n.Yx=function(a){if(a&&a.Wb=="print"){zx(this.Zb,this.YE());this.Wk()}jp.c.Yx.call(this,a)};
n.YE=function(){var a=new Mc;a.u("paperSize",this.zb("paperSizeSel"));a.u("usesPortrait",O(this.j("portrait")).checked);a.u("topMargin",this.zb("topMarginSel"));a.u("bottomMargin",this.zb("bottomMarginSel"));a.u("leftMargin",this.zb("leftMarginSel"));a.u("rightMargin",this.zb("rightMarginSel"));this.Wa("includePageNumSel")?a.u("pageNumber",this.zb("pageNumberSel")):a.u("pageNumber","NONE");a.u("stripComments",!this.Wa("includeCommentsSel"));if(H("enable_footnotes")){Vd("printfootnotes",this.Wa("includeFootnotesSel"));
a.u("printFootnotes",this.Wa("includeFootnotesSel"))}if(H("enable_print_endnotes")){Vd("convertFootnotesToEndnotes",this.Wa("includeEndnotesSel"));a.u("convertFootnotesToEndNotes",this.Wa("includeEndnotesSel"));a.u("endnotesTitle",O(this.j("includeTitleField")).value)}return a};n.Na=function(a){var b=this.YE();b.u("saveonly",g);b.u("docid",Hd());bh("save_print_settings",b,this.Wk.bind(this));jp.c.Na.call(this,a)};
n.Oz=function(){var a=O(this.j("portrait")).checked,b=O(this.j("portrait-icon")),c=O(this.j("landscape-icon"));if(a){c.style.display="none";b.style.display="block"}else{c.style.display="block";b.style.display="none"}};
n.Lz=function(){var a=O(this.j("includeEndnotesSel")).checked,b=O(this.j("includeFootnotesSel")).checked,c=O(this.j("includeEndnotesSelLabel")),d=O(this.j("includeEndnotesSel")),f=O(this.j("includeTitle")),h=O(this.j("includeTitleField"));if(b){d.style.display="";c.style.display="";if(a){f.style.display="";h.style.display=""}else{f.style.display="none";h.style.display="none"}}else{d.style.display="none";c.style.display="none";f.style.display="none";h.style.display="none"}};
n.Wk=function(){var a=this.zb("paperSizeSel");a&&Vd("papersize",a);Vd("usesportrait",O(this.j("portrait")).checked);(a=this.zb("topMarginSel"))&&Vd("topmargin",a);(a=this.zb("bottomMarginSel"))&&Vd("bottommargin",a);(a=this.zb("leftMarginSel"))&&Vd("leftmargin",a);(a=this.zb("rightMarginSel"))&&Vd("rightmargin",a);a=this.zb("pageNumberSel");this.Wa("includePageNumSel")||(a="NONE");a&&Vd("pagenumber",a);Vd("stripcomments",!this.Wa("includeCommentsSel"));H("enable_footnotes")&&Vd("printfootnotes",this.Wa("includeFootnotesSel"));
if(H("enable_print_endnotes")){Vd("convertFootnotesToEndnotes",this.Wa("includeEndnotesSel"));Vd("endnotesTitle",this.Y("includeTitleField"))}Vx&&Uf(O("printpreview_contents"))&&Yx()};function kp(){this.qb="TocSettings";Y.call(this)}kp.Gb(Y);kp.prototype.sa=function(){if(kp.c.sa.call(this)){if(!this.vb){var a=O(this.j("Type"));U(a,"change",this.s2.bind(this));this.vb=g}if(a=Dx()){a=(a=a.getAttribute("toctype"))||"none+none";this.na("Type",a);this.zA(a);this.Vc("Update Table of Contents")}else{this.na("Type","none+none");this.zA("none+none");this.Vc("Insert Table of Contents")}}};kp.prototype.Na=function(){var a=this.zb("Type").split("+");Bx(a[0]||"none",a[1]||"none")};
kp.prototype.s2=function(){this.zA(this.zb("Type"))};kp.prototype.zA=function(a){a=a.split("+");var b=a[0]||"none";a=a[1]||"none";for(var c=[O(this.j("HtmlList")),O(this.j("PrintList"))],d=0,f;f=c[d];d++){f.style.listStyleType=b;f.style.paddingLeft="3em";for(var h=0,k;k=f.childNodes[h];h++)if(k.tagName=="OL"){k.style.listStyleType=a;k.style.marginLeft="0"}}};function lp(){this.qb="WordCount";Y.call(this);this.ra=i;var a=new Lo;a.u("cancel","Done",g,g);this.We(a)}lp.Gb(Y);n=lp.prototype;n.sa=function(a){if(lp.c.sa.call(this,j,a)){this.ra=new Az(X.document.body,a.lK,H("languageIsEnglish"),H("languageIsAsian"));window.setTimeout(this.bP.bind(this),1)}};n.bP=function(){O(this.j("NumberOfPages")).innerHTML=this.ra.Aq(0);O(this.j("NumberOfPagesSelection")).innerHTML=this.ra.Xd()?this.ra.Aq(1):"-";window.setTimeout(this.aP.bind(this),1)};
n.aP=function(){O(this.j("NumberOfLettersWithSpaces")).innerHTML=this.ra.vE(0);O(this.j("NumberOfLettersWithSpacesSelection")).innerHTML=this.ra.Xd()?this.ra.vE(1):"-";window.setTimeout(this.$O.bind(this),1)};n.$O=function(){O(this.j("NumberOfLettersNoSpaces")).innerHTML=this.ra.rk(0);O(this.j("NumberOfLettersNoSpacesSelection")).innerHTML=this.ra.Xd()?this.ra.rk(1):"-";window.setTimeout(this.cP.bind(this),1)};
n.cP=function(){O(this.j("NumberOfParagraphs")).innerHTML=this.ra.Bq(0);O(this.j("NumberOfParagraphsSelection")).innerHTML=this.ra.Xd()?this.ra.Bq(1):"-";window.setTimeout(this.fP.bind(this),1)};n.fP=function(){O(this.j("NumberOfWords")).innerHTML=this.ra.jh(0);O(this.j("NumberOfWordsSelection")).innerHTML=this.ra.Xd()?this.ra.jh(1):"-";window.setTimeout(this.eP.bind(this),1)};
n.eP=function(){O(this.j("NumberOfSentences")).innerHTML=this.ra.zi(0);O(this.j("NumberOfSentencesSelection")).innerHTML=this.ra.Xd()?this.ra.zi(1):"-";window.setTimeout(this.YO.bind(this),1)};
n.YO=function(){var a=this.ra.zi(0),b=this.ra.Bq(0),c=this.ra.jh(0),d=this.ra.rk(0),f=this.ra.Aq(0);b=a/b;O(this.j("NumberOfSentencesPerParagraph")).innerHTML=b.toFixed(2);a=c/a;O(this.j("NumberOfWordsPerSentence")).innerHTML=a.toFixed(2);d=d/c;O(this.j("NumberOfLettersPerWord")).innerHTML=d.toFixed(2);c=c/f;O(this.j("NumberOfWordsPerPage")).innerHTML=c.toFixed(2);a=this.ra.zi(1);b=this.ra.Bq(1);c=this.ra.jh(1);d=this.ra.rk(1);f=this.ra.Aq(1);O(this.j("NumberOfSentencesPerParagraphSelection")).innerHTML=
this.ra.Xd()?(a/b).toFixed(2):"-";O(this.j("NumberOfWordsPerSentenceSelection")).innerHTML=this.ra.Xd()?(c/a).toFixed(2):"-";O(this.j("NumberOfLettersPerWordSelection")).innerHTML=this.ra.Xd()?(d/c).toFixed(2):"-";O(this.j("NumberOfWordsPerPageSelection")).innerHTML=this.ra.Xd()?(c/f).toFixed(2):"-";window.setTimeout(this.dP.bind(this),1)};
n.dP=function(){if(H("languageIsEnglish")){var a=this.ra.ME(0);if(a!=i)O(this.j("FleschReadingEase")).innerHTML=a.toFixed(2);a=this.ra.ME(1);if(a!=i)O(this.j("FleschReadingEaseSelection")).innerHTML=this.ra.Xd()?a.toFixed(2):"-";a=this.ra.LE(0);if(a!=i)O(this.j("FleschKincaidGradeLevel")).innerHTML=a.toFixed(2);a=this.ra.LE(1);if(a!=i)O(this.j("FleschKincaidGradeLevelSelection")).innerHTML=this.ra.Xd()?a.toFixed(2):"-";a=this.ra.mE(0);if(a!=i)O(this.j("AutomatedReadabilityIndex")).innerHTML=a.toFixed(2);
a=this.ra.mE(1);if(a!=i)O(this.j("AutomatedReadabilityIndexSelection")).innerHTML=this.ra.Xd()?a.toFixed(2):"-"}};(function(){var a="";if(z){function b(d){try{new ActiveXObject(d);return g}catch(f){return j}}if(b("AcroPDF.PDF.1"))a="7";else if(b("PDF.PdfCtrl.6"))a="6"}else if(navigator.mimeTypes&&navigator.mimeTypes.length>0){var c=navigator.mimeTypes["application/pdf"];if(c&&c.enabledPlugin)if((c=c.enabledPlugin.description)&&c.indexOf("Adobe")!=-1)a=c.indexOf("Version")!=-1?c.split("Version")[1]:"7"}nd&&ab(a,"6")>=0})();function So(){this.qb="BlogSettings";Y.call(this);var a=new Lo;a.u("ok","OK",g);a.u("cancel","Cancel",j,g);a.u("test","Test",j,j);this.We(a);U(this,"dialogselect",this.Qq,j,this)}So.Gb(Y);n=So.prototype;
n.sa=function(){if(So.c.sa.call(this)){if(!this.vb){var a=O(this.j("BlogServiceHosted")),b=O(this.j("BlogServiceCustom"));U(a,"click",this.Of.bind(this,g));U(b,"click",this.Of.bind(this,j));this.vb=g}this.na("blog_name",G("blogname"));this.na("user_name",G("blogusername"));this.na("password",G("blogpassword"));O(this.j("includetitle")).checked=H("blogusestitle");if(H("blogiscustom")){O(this.j("BlogServiceCustom")).checked=g;this.na("blog_url",G("blogurl"));this.na("blog_api",G("blogtype"));this.Of(j)}else{O(this.j("BlogServiceHosted")).checked=
g;this.na("provider",G("blogtype"));this.Of(g)}}};
n.Na=function(a){if(this.kM()){var b="",c=this.Y("provider"),d=j;if(!this.Wa("BlogServiceHosted")){b=this.Y("blog_url");c=this.Y("blog_api");d=g}var f=this.Y("blog_name"),h=this.Y("user_name"),k=this.Y("password"),l=this.Wa("includetitle"),m=new Mc;m.u("blog_custom",d);Ud("blogiscustom",d);m.u("blog_usetitle",l);Ud("blogusestitle",l);if(b!=i){m.u("blog_url",b);Ud("blogurl",b)}if(f!=i){m.u("blog_name",f);Ud("blogname",f)}if(h!=i){m.u("blog_user",h);Ud("blogusername",h)}if(k!=i){m.u("blog_pwd",k);Ud("blogpassword",
k)}if(c!=i){m.u("blog_type",c);Ud("blogtype",c)}Zg();Aj("blogsettings_save",m,this.lY.bind(this));So.c.Na.call(this,a)}else a.preventDefault()};
n.test=function(){if(this.kM()){var a="",b=this.Y("provider"),c=j;if(!this.Wa("BlogServiceHosted")){a=this.Y("blog_url");b=this.Y("blog_api");c=g}var d=this.jF();d.value="Testing...";d.disabled=g;d=new Mc;d.u("url",a);d.u("type",b);d.u("name",this.Y("blog_name"));d.u("user",this.Y("user_name"));d.u("pwd",this.Y("password"));d.u("custom",c);bh("blogsettings_test",d,this.m_.bind(this))}};
n.Of=function(a){if(a){this.Db("HostedBlogOptions");this.Ha("CustomBlogOptions")}else{this.Ha("HostedBlogOptions");this.Db("CustomBlogOptions")}this.Ga()};
n.kM=function(){if(this.Wa("BlogServiceHosted")){if(!this.Do("provider","Please select a blog site provider."))return j}else if(!this.Do("blog_api","Please select a blog site API.")||!this.Do("blog_url","Please enter your blog site URL."))return j;if(!this.Do("user_name","Please enter your blog site user name.")||!this.Do("password","Please enter your blog site password."))return j;return g};n.Do=function(a,b){a=O(this.j(a));if(a.value.length==0||a.value=="none"){F(b);a.focus();return j}return g};
n.m_=function(a){if(a!=i){a=a.responseText;a.indexOf("Error: ")==0?F(a.substring(7)):F(a)}a=this.jF();a.value="Test";a.disabled=j};n.lY=function(){$g();typeof lh!="undefined"&&lh==g&&sh();uh()};n.Qq=function(a){if(a.Wb=="test"){this.test();a.preventDefault()}else So.c.Qq.call(this,a)};n.jF=function(){for(var a=this.eh().getElementsByTagName("button"),b=0,c;c=a[b];b++)if(c.name=="test")return c;return i};var Lz=/[^\x09\x0a\x0b\x0c\x0d ]/;
function Hr(a,b){a=a.replace(/([*#^])/g," $1 ").split(" ");var c=a.shift();for(c=c?b.getElementById(c):b.body;c&&a.length;){var d=a.shift();if(a.length==0)e(new Error("pathToNode: Missing number"));b=a.shift();b=parseInt(b,10);if(isNaN(b))e(new Error("pathToNode: Bad number"));switch(d){case "^":a:{c=c;if(b<0)e(new Error("walkToParent_: Negative parent: "+b));for(d=0;d<b;d++){if(c.tagName=="BODY"){c=i;break a}c=c.parentNode;if(!c){c=i;break a}}c=c}break;case "#":c=Mz(c,b);break;case "*":c=Nz(c,b);
break;default:e(new Error('pathToNode: Unknown operation: "'+d+'"'))}}return c}function Mz(a,b){if(b>=0){var c=a;for(a=a.firstChild;;){for(;a!=i&&a.nodeType==3&&!Lz.test(a.nodeValue);)a=a.nextSibling;if(a==i||b==0){if(b==0&&a==i)return{eH:g,J:c};return a}b--;a=a.nextSibling}}else{b=-b-1;for(a=a.lastChild;;){for(;a!=i&&a.nodeType==3&&!Lz.test(a.nodeValue);)a=a.previousSibling;if(a==i||b==0)return a;b--;a=a.previousSibling}}return a}
function Nz(a,b){var c=a.parentNode;if(b>0)for(;b--;){for(a=a.nextSibling;a!=i&&a.nodeType==3&&!Lz.test(a.nodeValue);)a=a.nextSibling;if(!a){if(b==0)return{eH:g,J:c};return i}}else if(b<0)for(;b++;){for(a=a.previousSibling;a!=i&&a.nodeType==3&&!Lz.test(a.nodeValue);)a=a.previousSibling;if(!a)return i}return a};function Oz(a){this.ua=i;this.q=new V(this);this.Fj=new V(this);this.zn=this.xb=this.DV=j;this.Xa=i;this.ao(a);this.q.g(Zm(),"documentchange",this.$m);this.q.g(Zm(),"reload",this.rw)}var Pz;w(Oz,Og);var Qz=new Ch;function Rz(a){if(Qz.contains(a))return j;else{Qz.add(a);return g}}n=Oz.prototype;n.ao=function(a){this.ua&&this.q.Da(this.ua,"datachange",this.tk);if(this.ua=a){this.q.g(this.ua,"datachange",this.tk);this.q.g(this.ua,"datachange",this.LT)}};
n.LN=function(a){this.Fj.Mc();this.Fj.g(a,"remove",this.KT);this.Fj.g(a,"hover",this.HT);this.Fj.g(a,"unhover",this.IT)};n.tk=function(){e(Error("writely.callout.Callout.handleCalloutDataChange_ must be overridden in subclasses."))};n.LT=function(a){Vb(a.je,"markerId")&&this.ua.sh!=i&&!Rz(this.ua.sh)&&this.ua.IK(i)};n.$m=function(){if(this.Xa){this.Kt();var a=this.fp();this.dispatchEvent(new Tm(a))}};
n.rw=function(){this.Fj.Mc();this.Wu();Qz.remove(this.ua.sh);this.ao(i);this.q.Da(Zm(),"documentchange",this.$m);this.q.Da(Zm(),"reload",this.rw)};n.dF=function(){e(Error("writely.callout.Callout.getSidebarBlock must be overriden"))};n.o0=function(a){this.Wu();this.Xa=a;this.Ja=i;U(this.Xa,"mouseover",this.GF,undefined,this);U(this.Xa,"mouseout",this.ZF,undefined,this);this.nM=g};n.VL=function(){};
n.Wu=function(){if(this.Xa){try{Gg(this.Xa)}catch(a){}try{Gg(this.Ja)}catch(b){}try{P(this.Ja)}catch(c){}this.Xa=i;this.nM=g}};n.save=function(){if(this.Xa){this.S_();Jp()}};n.S_=function(){return this.ua.ls(this.Xa)};
n.EU=function(a){this.dispatchEvent(new Wm);if(Zm().du){z&&a.preventDefault();this.Ja.style.display="inline";Ce(x.b(),"writely-footnote-hide-selection",g);this.lv=this.Mp=undefined;this.q.g(document,"mousemove",this.Oq);this.q.g(X.document,"mousemove",this.Oq);this.q.g(document,"mouseup",this.Nq);this.q.g(X.document,"mouseup",this.Nq);return j}};
n.Oq=function(a){if(!this.Mp){this.Mp=a.clientX;this.lv=a.clientY}this.jv=a.clientX;this.kv=a.clientY;if(!this.bg){this.bg=document.createElement("div");this.bg.className="writely-footnote-cursor-follow";this.bg.innerHTML="&nbsp;";Tf(this.bg,0.5);this.dC=Kf(x.Yb);document.body.appendChild(this.bg)}this.bg.style.top=this.dC.y+this.kv+-10;this.bg.style.left=this.dC.x+this.jv+5;a=x;var b=a.O();b.collapse(b.vg());z||Rl(a.sb.pa());b.select()};
n.Nq=function(){this.q.Da(document,"mousemove",this.Oq);this.q.Da(X.document,"mousemove",this.Oq);this.q.Da(document,"mouseup",this.Nq);this.q.Da(X.document,"mouseup",this.Nq);Ce(x.b(),"writely-footnote-hide-selection",j);P(this.bg);this.Ja.style.display="inline-block";this.bg=i;var a=this.Mp,b=this.jv,c=this.lv,d=this.kv;if((b>a?a+10<b:a-10>b)||(d>c?c+10<d:c-10>d))if(z){var f=X.document.body.createTextRange();f.moveToPoint(b,d);a=f.duplicate();a.move("character",-1);c=a.duplicate();c.move("character",
1);f=this.SO(new oe(b,d),f,a,c);f.select();b=f.parentElement().nodeName.toLowerCase();if(b!="gdoc:callout"&&b!="callout"&&b!="marker"){b=Xi();f.execCommand("InsertButton",j,b);b=X.document.getElementById(b);b.parentNode.replaceChild(this.Xa,b)}window.setTimeout($m,1)}else{f=x.O();f.collapse(!(d>c||b>a));b=f.Tb().nodeName.toLowerCase();if(b!="gdoc:callout"&&b!="callout"&&b!="marker"){P(this.Xa);f.fl(this.Xa)}this.Kt();window.setTimeout(cn,1)}this.kv=this.jv=this.lv=this.Mp=undefined};
n.SO=function(a){for(var b=Infinity,c=i,d,f=1;d=arguments[f];f++){var h,k=new oe(d.M3,d.N3);h=a.x-k.x;k=a.y-k.y;h=h*h+k*k;if(h<b){c=d;b=h}}return c};n.bt=function(a){this.DV=a;this.VL(a)};n.GF=function(){this.bt(g);if(z&&x)x.b().style.cursor="move";this.dispatchEvent(new Km)};n.ZF=function(){this.bt(j);if(z&&x)x.b().style.cursor="";this.dispatchEvent(new Lm)};n.HT=function(){this.bt(g)};n.IT=function(){this.bt(j)};
n.$Z=function(){if(this.Xa){var a=this.KJ();this.Wu();this.q.Da(Zm(),"documentchange",this.$m);this.q.Da(Zm(),"reload",this.rw);try{var b=X.document.getElementById(this.ua.sh);b&&b.parentNode.removeChild(b);a=g}catch(c){}a&&Jp()}};n.KJ=function(){var a=j;try{var b=this.Xa.innerHTML,c=X.document.createElement("span");c.innerHTML=b;this.Xa.parentNode.replaceChild(c,this.Xa);a=g}catch(d){}return a};n.remove=function(){this.$Z();this.Fj.Mc();this.dispatchEvent(new Sm)};n.Lk=function(){return this.ua.Lk()};
n.Lb=function(){return this.id};n.lj=function(a){this.id=a;this.nM=g};n.co=function(a,b){if(!b)if(a&&!this.Zr)this.Zr=si(this.remove,1E4,this);else if(!a&&this.Zr){ti(this.Zr);this.Zr=i}};
n.Kt=function(){var a=j,b=g,c=this.ua.sh;if(this.Xa)if(this.Xa.parentNode){if(!this.Ja||!this.Ja.parentNode){this.Ja=c?X.document.getElementById(c):i;a=g}if(this.Ja){if(this.Xa.nextSibling!=this.Ja){this.Ja.parentNode.removeChild(this.Ja);try{this.Xa.parentNode.insertBefore(this.Ja,this.Xa.nextSibling)}catch(d){this.Xa.parentNode.appendChild(this.Ja)}}b=j}else b=g;if(b){this.Ja=X.document.createElement("marker");if(!c||c.length==0){c=Xi();this.ua.IK(c);Rz(c);this.save()}this.Ja.id=c;this.Ja.className=
this.TE();this.Ja.style.display="inline-block";try{this.Xa.parentNode.insertBefore(this.Ja,this.Xa.nextSibling)}catch(f){this.Xa.parentNode.appendChild(this.Ja)}a=g}if(this.Ja.innerHTML!="&nbsp;"&&this.Ja.innerHTML!=String.fromCharCode(160)){if(E&&this.Ja.innerHTML){b=this.Ja.innerHTML;c=g;if(b.charCodeAt(0)==160)b=b.substring(1);else if(b.charCodeAt(b.length-1)==160){b=b.substring(0,b.length-1);c=j}var h=X.document.createElement("span");h.innerHTML=b;c?Ye(h,this.Ja):Xe(h,this.Ja.previousSibling);
b=jk(h,void 0);b.collapse();b.select()}try{this.Ja.innerHTML=String.fromCharCode(160)}catch(k){if(!Pz){Pz=g;rce("Footnote marker load error","between "+(this.Xa.previousSibling?this.Xa.previousSibling.tagName:"none")+" and "+(this.Ja.nextSibling?this.Ja.nextSibling.tagName:"none"))}}}if(a){U(this.Ja,"mousedown",this.EU,undefined,this);U(this.Ja,"mouseover",this.GF,undefined,this);U(this.Ja,"mouseout",this.ZF,undefined,this)}if(B){a=this.Ja;c=Mb(a.parentNode.childNodes,a);h=uf(a,Qj);b=X.document.createRange();
b.setStart(a.parentNode,c+1);b.setEnd(h,Pj(h));c=Bh(X);if(ya(b.toString())&&!b.isPointInRange(c.L(),c.ka())){b=X.document.createTextNode("\u00a0");a.parentNode.insertBefore(b,a.nextSibling)}}}else this.remove()};n.TE=function(){e(Error("Must override Callout.getMarkerElementClassName_"))};n.fp=function(){if(!this.Xa||!this.Xa.parentNode)return new oe(-100,-100);this.Ja||this.Kt();return Kf(this.Ja)};n.KT=function(){this.remove()};function bn(a){Oz.call(this,a)}w(bn,Oz);bn.prototype.dF=function(){return Sz};bn.prototype.tk=function(a){this.save();Vb(a.je,"closed")&&this.co(this.ua.Lk())};bn.prototype.TE=function(){return"writely-footnote-marker"};bn.prototype.VL=function(a){Ce(this.Ja,"writely-footnote-marker-highlight",a)};Oz.prototype.KJ=function(){var a=j;try{P(this.Xa);a=g}catch(b){}return a};function Tz(){this.Gc=i;this.Wr=this.bu=this.Ej=0;this.w4=this.q5=g;this.ua=i;this.Pc=new V(this);this.yG=j;this.Co=new Mc;this.Zx=j}w(Tz,Og);var Uz="threadWrapper"+(z?" threadWrapperIE":""),Vz="calloutBorder"+(z?" calloutBorderIE":"");n=Tz.prototype;n.KN=function(a){this.Pc.Mc();this.Pc.g(a,"hover",this.qO);this.Pc.g(a,"unhover",this.uO);this.Pc.g(a,"positionchange",this.rO);this.Pc.g(a,"remove",this.tO);this.Pc.g(a,"calloutclick",this.pO);this.Pc.g(Zm(),"reload",this.sO);this.$B();this.ao(a.ua)};
n.ao=function(a){this.ua&&this.Pc.Da(this.ua,"datachange",this.tk);if(this.ua=a){this.Pc.g(this.ua,"datachange",this.tk);this.iE()}};n.qO=function(){this.wj(g)};n.uO=function(){this.wj(j)};n.wj=function(){};n.rO=function(a){if(this.Ej!=a.uf().y||this.bu!=a.uf().x){this.Ej=a.uf().y;this.bu=a.uf().x;this.dispatchEvent(new Tm(a.uf()))}};n.uE=function(){return{x:this.bu,y:this.Ej}};n.tO=function(){this.Lf(j);this.Pc.Mc();this.dispatchEvent(new Sm)};n.sO=function(){this.$B();this.ao(i);this.Pc.Mc()};
n.pO=function(){this.jo(g)};n.Pm=function(){e(Error("writely.callout.CalloutBlock.buildDomElement must be overridden"))};n.vF=function(){this.$L(g);this.dispatchEvent(new Km)};n.uF=function(){this.$L(j);this.dispatchEvent(new Lm)};n.$L=function(){e(Error("writely.callout.CalloutBlock.updateHoverState_ must be overridden in subclasses."))};n.tk=function(a){this.yG||this.y2(a.je)};n.xG=function(a){this.yG=a};
n.q2=function(){var a=this.Wr>this.Ej?this.Wr:this.Ej;if(this.iX!=a){this.Gc.style.top=a+"px";this.iX=a;if(this.ed)this.ed.style.display=this.Wr>this.Ej?"none":""}};n.K0=function(a){this.Wr=a;this.q2()};n.xq=function(){return this.Fp=this.Gc?this.Gc.offsetHeight:0};n.y2=function(a){for(var b=0,c;c=a[b];b++)(c=this.Co.la(c))&&c.call(this)};n.iE=function(){for(var a=this.Co.Kc(),b=0,c;c=a[b];b++)c.call(this)};n.jo=function(){e(Error("callout.CalloutBlock.setShowFull must be overridden"))};n.Lf=function(){e(Error("callout.CalloutBlock.setEditable_ must be overridden"))};
n.pN=function(){this.Zx=g;this.dispatchEvent(new Wz)};n.g_=function(){this.Zx=j};n.$B=function(){this.Lf(j)};function Wz(){R.call(this,"addedtodom")};function Sz(){Tz.call(this);this.q=new V(this);this.Fm=new V(this);this.Bm=j;this.Co.u("content",this.EA);this.Co.u("closed",this.z2);this.Co.u("showfull",this.A2)}w(Sz,Tz);n=Sz.prototype;n.xq=function(){if(this.Gc){z&&this.iR();this.Fp=this.Gc.offsetHeight}else this.Fp=0;return this.Fp};
n.Pm=function(){if(!this.Gc){this.Gc=document.createElement("div");this.Gc.className=Uz+" footnoteWrapper-grey";this.q.g(this.Gc,"mouseover",this.vF);this.q.g(this.Gc,"mouseout",this.uF);this.it=document.createElement("div");this.it.className="comment-show-color commentWrapper";this.Ao=document.createElement("div");this.Ao.className="writely-comment-border-height";this.wx=document.createElement("div");this.wx.className="writely-callout-corner-left writely-comment-border-height comment-show-color writely-callout-corner-top";
this.Ty=document.createElement("div");this.Ty.className="writely-callout-corner-right writely-comment-border-height comment-show-color writely-callout-corner-top";if(z){this.wx.style.width="1px";this.Ty.style.width="1px"}this.Jx=document.createElement("div");this.Jx.innerHTML="&nbsp;";this.Jx.className="writely-comment-border-height comment-show-color "+Vz+" calloutBorderTop";this.Ao.appendChild(this.wx);this.Ao.appendChild(this.Jx);this.Ao.appendChild(this.Ty);this.Gc.appendChild(this.Ao);this.Kd=
document.createElement("div");this.Kd.className=z?"calloutBlockTitleBarIE comment-show-color":"calloutBlockTitleBar";this.q.g(this.Kd,"mousedown",this.Dw);this.Vs=document.createElement("div");this.Vs.className="commentTitle";this.Vs.innerHTML="Footnote";this.Ff=document.createElement("div");this.Ff.innerHTML="&nbsp;";this.Ff.className="commentMenu";Tf(this.Ff,0.5);this.q.g(this.Ff,"mouseover",this.IU);this.q.g(this.Ff,"mouseout",this.HU);this.eT().Pg(this.Ff);this.up=document.createElement("div");
this.up.style.overflow="auto";this.up.style.clear="both";this.Qb=document.createElement("div");this.Qb.className="commentBody footnoteBody-grey";this.Qb.title="Click to edit";this.q.g(this.Qb,"click",this.JT);this.ed=document.createElement("div");this.ed.style.position="absolute";this.ed.height="13px";this.ed.width="12px";this.ed.style.top=4;if(ij())this.ed.style.right=2;else this.ed.style.left=-10;var a=this.kZ;this.ed.appendChild(a(0,9,11,2));this.ed.appendChild(a(1,7,9,2));this.ed.appendChild(a(2,
5,7,2));this.ed.appendChild(a(3,3,5,2));this.ed.appendChild(a(4,1,3,2));this.ed.appendChild(a(5,0,1,1));this.Gc.appendChild(this.it);this.Gc.appendChild(this.ed);this.Kd.appendChild(this.Vs);this.Kd.appendChild(this.Ff);this.up.appendChild(this.Qb);this.it.appendChild(this.Kd);this.it.appendChild(this.up);this.cm=document.createElement("div");this.cm.className="writely-comment-border-height";this.Xt=document.createElement("div");this.Xt.className="writely-callout-corner-left writely-comment-border-height comment-show-color writely-callout-corner-bottom";
this.Zt=document.createElement("div");this.Zt.className="writely-callout-corner-right writely-comment-border-height comment-show-color writely-callout-corner-bottom";if(z){this.Xt.style.width="1px";this.Zt.style.width="1px"}this.Yt=document.createElement("div");this.Yt.className="writely-comment-border-height comment-show-color "+Vz+" calloutBorderBottom";this.Yt.innerHTML="&nbsp;";this.cm.appendChild(this.Xt);this.cm.appendChild(this.Yt);this.cm.appendChild(this.Zt);this.Gc.appendChild(this.cm);
this.iE()}return this.Gc};n.kZ=function(a,b,c,d){var f=document.createElement("div");f.style.top=a;f.style.left=ij()?10-b:b;f.className="comment-show-color writely-callout-block-pointer-line";f.style.height=c+"px";f.style.width=d+"px";if(b==0){f.style.borderLeftWidth="1px";f.style.borderLeftStyle="solid";f.style.borderBottomWidth="0px"}f.innerHTML="&nbsp;";return f};
n.eT=function(){if(!this.Rr){this.Rr=new vi;var a=new mi("Delete footnote","");this.Rr.oa(a);this.q.g(a,"action",this.ZT);this.Rr.db();a.F(Zm().du)}return this.Rr};n.ZT=function(){this.ua.co(g)};
n.EA=function(){if(this.Qb)if(this.Bm&&this.ua){var a=this.Rb.sS();this.Rb.rl(j,this.ua.La);this.Rb.l0(a)}else if(this.ua){a=this.ua.La;if(!this.mu)this.mu=document.createElement("div");this.mu.innerHTML=a;if(!this.ua.Lk()&&this.YG(this.mu))this.Lf(g);else this.Qb.innerHTML=this.ua.La}else this.Qb.innerHTML=""};n.iR=function(){this.Qb.style.height=!this.Bm&&Pf(this.Qb).height>=80?"80px":""};
n.z2=function(){if(this.ua.Lk()){this.Lf(j);var a=document.createElement("span");a.innerHTML="Footnote deleted.&nbsp;";a.className="commentTitle";var b=document.createElement("span");b.innerHTML="undo";b.style.color="blue";b.className="commentTitle";this.q.g(b,"click",this.dV);We(this.Kd);this.Kd.appendChild(a);this.Kd.appendChild(b);this.q.Da(this.Kd,"mousedown",this.Dw);this.Qb.style.display="none"}else if(this.Kd){We(this.Kd);this.Kd.appendChild(this.Vs);this.Kd.appendChild(this.Ff);this.q.g(this.Kd,
"mousedown",this.Dw);if(this.ua.Dl)this.Qb.style.display="";this.EA()}this.dispatchEvent(new Um)};n.dV=function(){this.ua.co(j)};
n.Lf=function(a){if(a){de=j;this.XL()}if(this.Bm!=a&&wp())if(a)if(this.Zx){if(!this.Xf){this.Xf=document.createElement("div");this.Xf.id=Xi();this.Xf.style.height="80px";this.Xf.style.width="98%"}this.Qb.innerHTML="";this.Qb.appendChild(this.Xf);this.Rb&&sa.vr(this.Rb);this.Rb=new Xz(this.Xf.id,{cssStyles:"body {font-family: Arial, sans-serif; font-size: 11px; margin:0;} p {margin: 0;}"});this.Fm.g(this.Rb,"delayedchange",this.tw);this.Fm.g(this.Rb,"focus",this.tw);this.Fm.g(this.Rb,Mq.DM,u(this.iN,
this));a=this.Qb.style.display;this.Qb.style.display="";sa.Rk(this.Rb);editUI.GK(g);this.Qb.style.display=a}else this.q.g(this,"addedtodom",this.sF);else{ee();this.MO();this.Fm.Mc();this.es();try{sa.vr(this.Rb)}catch(b){}this.Rb=i;P(this.Xf);this.kg=j;this.vB(a)}};
n.iN=function(){if(this.Qb.style.display=="none"){this.Lf(j);this.Qb.style.display="none"}else{this.Rb.Pb("mousedown",this.tw,j,this);this.Rb.Pb("keypress",this.yw,j,this);x.Pb("mousedown",this.pw,j,this);this.Fm.g(sa,"focus",this.hU);this.Rb.Pb("blur",this.es,j,this);this.Rb.b().focus();this.Rb.focus();this.vB(g)}};n.vB=function(a){this.Bm=a;this.EA();this.dispatchEvent(new Um)};
n.es=function(){if(this.Rb){this.xG(g);var a=this.Rb.jq();if(E)a=a.replace(/(<div[^<]*)(<div[^>]*>)/ig,"$1<br>");a=a.replace(/<div[^>]*>/ig,"");a=a.replace(/<\/div>/ig,"<br>");a=a.replace(/<p[^>]*>/ig,"");a=a.replace(/<\/p>/ig,"<br>");a=a.replace(/(<br[^>]*>)+$/i,"");this.ua.hb(a);this.xG(j)}};n.sF=function(){this.q.Da(this,"addedtodom",this.sF);this.Lf(g)};n.tw=function(){if(this.Xy){ti(this.Xy);this.Xy=i}this.Xy=si(this.es,1E3,this)};n.yw=function(a){if(a.keyCode==27){a.preventDefault();x.focus()}this.XL()};
n.JT=function(){this.Lf(g);this.Xf&&this.Xf.focus()};n.YG=function(a){return Ba(a.innerText==undefined?a.textContent:a.innerText).length<1?g:j};n.XL=function(){this.gn&&window.clearTimeout(this.gn);this.gn=window.setTimeout(u(this.ZN,this),6E4)};n.MO=function(){this.gn&&window.clearTimeout(this.gn);this.gn=i};n.ZN=function(){if(this.Bm){X.focus();E&&this.pw()}};n.pw=function(){ee();this.kg=j;this.wj(j);if(this.Rb)this.YG(this.Rb.b())?this.es():window.setTimeout(u(this.Lf,this,j),0)};n.Dw=function(){this.jo(!this.ua.Dl)};
n.IU=function(){Tf(this.Ff,1)};n.HU=function(){Tf(this.Ff,0.5)};n.A2=function(){if(this.Qb){if(this.ua.Dl)this.Qb.style.display="";else{this.Lf(j);this.Qb.style.display="none"}this.dispatchEvent(new Um)}};n.jo=function(a){this.ua.jo(a)};n.hU=function(a){if(a.n!=this.Rb)this.pw();else{this.kg=g;this.wj(g)}};n.wj=function(a){if(this.kg)a=g;Ce(this.Gc,"footnoteWrapper-grey",!a);Ce(this.Gc,"footnoteWrapper-grey-highlight",a)};n.vF=function(){this.wj(g);this.dispatchEvent(new Km)};
n.uF=function(){this.wj(j);this.dispatchEvent(new Lm)};function Xz(a,b){Nw.call(this,a,b);this.cb(new vm);this.cb(new cq);this.cb(new wm);this.cb(new Xp);this.cb(new iw);this.cb(new hw)}w(Xz,Nw);function Yz(){this.aC="generic";this.sh="";this.Dl=g;this.sp=j;this.nc=""}w(Yz,Og);n=Yz.prototype;n.lj=function(a){this.nc=a;this.dispatchEvent(new Mm(["id"]))};n.Lb=function(){return this.nc};n.jo=function(a){this.Dl=a;this.dispatchEvent(new Mm(["showfull"]))};n.co=function(a){if(this.sp!=a){this.sp=a;this.dispatchEvent(new Mm(["closed"]))}};n.Lk=function(){return this.sp};n.IK=function(a){this.sh=a;this.dispatchEvent(new Mm(["markerId"]))};
n.qA=function(a){this.sh=a.getAttribute("calloutmarkerId");this.co(a.getAttribute("calloutclosed")=="true");this.Dl=a.getAttribute("calloutshowfull")!="false";var b=["markerId","closed","showfull"];a=this.SL(a);bc(b,a);this.dispatchEvent(new Mm(b))};n.ls=function(a){Ce(a,"writely-callout-data",g);a.setAttribute("calloutmarkerId",this.sh);a.setAttribute("calloutclosed",this.sp);a.setAttribute("calloutshowfull",this.Dl?"true":"false");a.setAttribute("contentEditable","false");this.uK(a);return a};
n.SL=function(){return[]};n.uK=function(a){return a};function an(a){Yz.call(this);this.aC="footnote";this.La="";a&&this.qA(a)}w(an,Yz);an.prototype.SL=function(a){this.La=a.innerHTML;return["content"]};an.prototype.uK=function(a){Ce(a,"google_footnote",g);a.innerHTML=this.La;return a};an.prototype.hb=function(a){if(this.La!=a){this.La=a;this.dispatchEvent(new Mm(["content"]))}};function Sw(){this.ee=this.ua=i;this.bp=j}var Rw;n=Sw.prototype;n.Jt=function(a,b){this.ua=a;a=Bh(X);b||a&&!a.isCollapsed()?this.NG(b):this.a2()};n.a2=function(){if(this.bp){this.cD();this.bp=j}else{this.MN();this.bp=g}};
n.MN=function(){if(!this.ee){this.ee=document.createElement("div");this.ee.style.position="absolute";this.ee.className="commentMarker"}document.body.appendChild(this.ee);Tf(this.ee,0.4);U(document,"mousemove",this.OF,undefined,this);this.fI=O("wys_frame");U(X.document,"mousemove",this.NF,undefined,this);U(X.document,"mousedown",this.en,undefined,this)};
n.cD=function(){document.body.removeChild(this.ee);Cg(X.document,"mousemove",this.NF,undefined,this);Cg(document,"mousemove",this.OF,undefined,this);Cg(X.document,"mousedown",this.en,undefined,this)};n.OF=function(a){this.ee.style.top=a.clientY+-10+"px";this.ee.style.left=a.clientX+5+"px"};n.NF=function(a){var b=Kf(this.fI),c=this.fI;this.ee.style.top=a.clientY-c.scrollTop+b.y+-10+"px";this.ee.style.left=a.clientX-c.scrollLeft+b.x+5+"px"};
n.en=function(){Tf(this.ee,1);Cg(X.document,"mousedown",this.en,undefined,this);U(X.document,"mouseup",this.Pq,undefined,this)};n.Pq=function(){Cg(X.document,"mouseup",this.Pq,undefined,this);this.cD();this.NG();this.bp=j;$m()};
n.NG=function(a){var b=i,c=Bh(X);if(!c&&dh)c=Pl(dh);if(!c)return i;if(a){c.collapse(j);b=X.document.createElement("gdoc:callout");b=c.insertNode(b)}else if(!c.isCollapsed()){var d=c.ui();if(z){d=d.replace(/<p (goog_docs_charIndex=\"[0-9]+\")?>/ig,"<br/>");d=d.replace(/<\/p.*>/ig,"")}c.gd();b=X.document.createElement("gdoc:callout");b=c.insertNode(b);a=X.document.createElement("div");for(a.innerHTML=d;a.hasChildNodes();){d=a.removeChild(a.firstChild);b.appendChild(d)}}if(!b)try{ih('<gdoc:callout id="writely-temp-callout-id"></gdoc:callout>');
b=X.document.getElementById("writely-temp-callout-id")}catch(f){b=X.document.createElement("gdoc:callout");if(c)b=c.insertNode(b)}if(b){b.setAttribute("name","gdoccallout");b.id=Xi();b.className="writely-callout";b.setAttribute("callouttype",this.ua.aC);this.ua.ls(b);Jp()}return b};function Zz(){this.Ea=[]}n=Zz.prototype;n.rg=0;n.sj=0;n.JD=function(a){this.Ea[this.sj++]=a};n.Ip=function(){if(this.rg!=this.sj){var a=this.Ea[this.rg];delete this.Ea[this.rg];this.rg++;return a}};n.Kb=function(){return this.sj-this.rg};n.Oe=function(){return this.sj-this.rg==0};n.clear=function(){this.sj=this.rg=this.Ea.length=0};n.contains=function(a){return Vb(this.Ea,a)};n.remove=function(a){a=Mb(this.Ea,a);if(a<0)return j;if(a==this.rg)this.Ip();else{Yb(this.Ea,a);this.sj--}return g};
n.Kc=function(){return this.Ea.slice(this.rg,this.sj)};function $z(a,b){this.$H=a||0;this.Ui=b||10;if(this.$H>this.Ui)e(Error("[goog.structs.Pool] Min can not be greater than max"));this.Hc=new Zz;this.lh=new Ch;this.sB()}w($z,ag);n=$z.prototype;n.gh=function(){var a=this.ZZ();a&&this.lh.add(a);return a};n.dj=function(a){if(this.lh.remove(a)){this.Vo(a);return g}return j};n.ZZ=function(){for(var a;this.Vv()>0;){a=this.Hc.Ip();if(this.oI(a))break;else this.sB()}if(!a&&this.Kb()<this.Ui)a=this.nm();return a};
n.Vo=function(a){this.lh.remove(a);this.oI(a)&&this.Kb()<this.Ui?this.Hc.JD(a):this.Uj(a)};n.sB=function(){for(var a=this.Hc;this.Kb()<this.$H;)a.JD(this.nm());for(;this.Kb()>this.Ui&&this.Vv()>0;)this.Uj(a.Ip())};n.nm=function(){return{}};n.Uj=function(a){if(typeof a.p=="function")a.p();else for(var b in a)a[b]=i};n.oI=function(a){if(typeof a.vO=="function")return a.vO();return g};n.contains=function(a){return this.Hc.contains(a)||this.lh.contains(a)};n.Kb=function(){return this.Hc.Kb()+this.lh.Kb()};
n.NS=function(){return this.lh.Kb()};n.Vv=function(){return this.Hc.Kb()};n.Oe=function(){return this.Hc.Oe()&&this.lh.Oe()};n.k=function(){$z.c.k.call(this);if(this.NS()>0)e(Error("[goog.structs.Pool] Objects not released"));delete this.lh;for(var a=this.Hc;!a.Oe();)this.Uj(a.Ip());delete this.Hc};function vr(){this.q=new V(this);this.Pc=new V(this);this.Xe=i;this.hp=new Mc;this.Gj=new Ch;this.ru=new aA;this.q.g(window,"resize",this.xk);this.q.g(Zm(),"reload",this.NT);this.q.g(Zm(),"addnewitem",this.MT);this.q.g(Zm(),"pageviewswitch",this.cU);this.q.g(Zm(),"documentreload",this.dU);this.q.g(Zm(),"documentchange",this.BF)}var ur;w(vr,ag);n=vr.prototype;n.D=i;n.Fl=j;n.Gh=i;n.p=function(){if(!this.AS()){vr.c.p.call(this);this.q.p();P(this.D)}};
n.Wm=function(){if(!this.Xe)this.Xe=O("wys_sidebar");return this.Xe};n.XB=function(){if(!this.D){this.D=document.createElement("div");this.Gh=document.createElement("div");this.Gh.className="commentThreadContainerElement";if(ij())this.Gh.style.right="10px";this.Gh.style.display="none";for(var a=0,b;b=this.Gj[a];a++)this.mB(b);this.D.appendChild(this.Gh)}return this.D};n.RU=function(){this.rA()};
n.NT=function(){for(var a=this.Gj.Kc(),b=0,c;c=a[b];b++){this.JJ(c);this.hp.la(r(c.constructor)).Vo(c);this.Gj.remove(c);this.ru.HJ(c)}this.visible(j)};n.MT=function(a){var b=a.ip;a=[];for(var c=0,d;d=b[c];c++){var f=d.dF(),h,k=r(f);if(!(h=this.hp.la(k))){h=new $z(0,200);this.hp.u(k,h)}if(h.Vv()<1){f=new f;h.Vo(f)}h=h.gh();this.Gj.add(h);h.KN(d);d.LN(h);this.Pc.g(h,"remove",this.sw);this.mB(h);a.push(h)}for(c=0;b=a[c];c++)this.ru.dN(b)};
n.sw=function(a){a=a.target;var b;if(b=this.hp.la(r(a.constructor)))b.contains(a)&&b.Vo(a);this.Gj.remove(a);this.ru.HJ(a);this.JJ(a)};n.cU=function(){this.xk()};n.dU=function(){this.xk();this.BF();this.rA()};n.mB=function(a){ia(a)||(a=[a]);this.YL();if(this.D)for(var b=0,c;c=a[b];b++){this.Gh.appendChild(c.Pm());c.Pm().style.display="";c.pN()}};n.JJ=function(a){if(this.D)try{a.Pm().style.display="none";P(a.Pm());a.g_()}catch(b){}this.YL()};
n.YL=function(){this.visible(this.Wt()!=0);var a=this.Wt();if(!this.tx||this.tx!=a){var b=this.tx;this.tx=a;if(b==0||a==0)this.aE()}};n.Wt=function(){return this.Gj.Kb()};n.aE=function(){if(X.document.body){var a=this.Wt()>0&&this.Fl;if(Sd("fullwidtheditor"))if(a){X.document.documentElement.style.backgroundColor="#F3F3F3";X.document.body.style.width=this.qq().offsetWidth-230+"px"}else X.document.body.style.width=""}};n.visible=function(a){if(this.Fl!=a){a?this.po():this.Bk();this.aE();this.xk()}};
n.ga=function(){return this.Fl};n.po=function(){this.Fl=g;this.Wm().style.display="";this.Gh.style.display="";this.xk()};n.Bk=function(){this.Fl=j;this.Gh.style.display="none"};n.rA=function(){E?this.i2():this.h2()};n.h2=function(){this.Wm().scrollTop=X.document.documentElement.scrollTop};n.i2=function(){this.Wm().scrollTop=X.document.body.scrollTop};n.BF=function(){this.D.style.height=X.document.documentElement.scrollHeight+O("navigation").offsetHeight;this.rA()};
n.xk=function(){if(!(!this.D||!X||!X.document||!X.document.documentElement))if(this.Fl){this.Wm().style.height=this.qq().offsetHeight;this.Wm();if(Sd("fullwidtheditor")){var a=this.qq().offsetWidth-230;if(ij()){this.Xe.style.left=0;X.document.body.style.width=a+"px";X.document.body.style.marginLeft="230px"}else{this.Xe.style.left=a;X.document.body.style.width=a+"px"}}else{var b=X.document.body.offsetWidth;a=this.qq().offsetWidth;if(z&&!Cd("7"))a+=14;if(a/2-b/2>230){X.document.body.style.marginLeft=
"";X.document.body.style.marginRight="";if(ij()){this.Xe.style.left="";this.Xe.style.right=a/2+b/2-(z&&!Cd("7")?15:0)}else this.Xe.style.left=a/2+b/2-15}else{b=a-b-230;b=b<0?0:b;if(ij()){X.document.body.style.marginRight=b-10+"px";this.Xe.style.right=a-230-(z&&!Cd("7")?15:0);this.Xe.style.left=0}else{X.document.body.style.marginLeft=b+"px";this.Xe.style.left=a-230}}}}else{X.document.body.style.marginLeft="";X.document.body.style.marginRight="";X.document.body.style.width=""}};
n.qq=function(){if(wt())return O("viewiframe");else if(wp())return O("wys_frame")};function bA(){this.Dj=i;this.left=this.height=this.Xb=this.$a=this.start=0;this.Fk=j}w(bA,Og);n=bA.prototype;
n.nz=function(a){if(this.Dj){Cg(this.Dj,"positionchange",this.wF,undefined,this);Cg(this.Dj,"remove",this.xF,undefined,this);Cg(this.Dj,"sizechange",this.yF,undefined,this)}if(this.Dj=a){this.height=a.xq();U(a,"positionchange",this.wF,undefined,this);U(a,"remove",this.xF,undefined,this);U(a,"sizechange",this.yF,undefined,this)}};n.wF=function(a){this.height=a.target.xq();this.dispatchEvent(new cA(a.uf()))};n.xF=function(){this.nz(i);this.dispatchEvent(new Sm)};
n.yF=function(a){this.height=a.target.xq();this.dispatchEvent(new dA)};n.setStart=function(a){this.start=a};function aA(){this.q=new V(this);this.bm=new Mc;this.Pf=[];this.q.g(Zm(),"documentchangepost",this.$m)}n=aA.prototype;n.$m=function(){this.wA(0)};n.dN=function(a){var b=this.bm.la(r(a));if(!b){b=new bA;b.nz(a)}this.bm.u(r(a),b);var c=a.uE();if(c.x>0||c.y>0)this.rB(b,a.uE());this.q.g(b,"bcipositionchange",this.HF);this.q.g(b,"bcisizechange",this.IF)};
n.HJ=function(a){var b=this.bm.la(r(a));if(b){this.q.Da(b,"bcipositionchange",this.HF);this.q.Da(b,"bcisizechange",this.IF);this.yT(b);this.bm.remove(r(a));b.nz(i)}};n.HF=function(a){this.rB(a.target,a.uf())};n.IF=function(a){this.wA(this.cz(a.target))};n.yT=function(a){var b=ec(this.Pf,a,this.tu);if(b>-1){var c=this.Pf;a=ec(c,a,this.tu);a>=0&&Yb(c,a);this.wA(b)}};
n.rB=function(a,b){var c=this.cz(a);if(c>-1){var d=this.Pf[c-1],f=this.Pf[c+1];a.Dr=b.y;a.Cr=b.x;if((!d||this.sC(d,a)<0)&&(!f||this.sC(a,f)<0)){a.Dr=undefined;a.Cr=undefined;a.Xb=b.y;a.left=b.x;return}else{a.Dr=undefined;a.Cr=undefined;Yb(this.Pf,c)}}a.Xb=b.y;a.left=b.x;this.jW(a)};n.jW=function(a){var b=this.cz(a);if(b<0){cc(this.Pf,-(b+1),0,a);return-(b+1)}return-1};n.cz=function(a,b){return ec(this.Pf,a,b||this.tu)};
n.wA=function(a){var b=i,c=i;for(a=a;this.Pf[a];){b=this.Pf[a];c=this.Pf[a-1];if(b&&c&&(c.$a>b.Xb||c.Fk)){if(c.$a>b.Xb){var d=0;d=c.Xb==b.Xb?0:2;c.Fk=g;b.setStart(c.$a+d)}else if(c.Fk){d=0;if(b.Xb-c.$a<2){d=2-(b.Xb-c.$a);c.Fk=g}else c.Fk=j;b.setStart(b.Xb+d)}b.$a=b.start+b.height}else if(b&&!c){b.setStart(b.Xb);b.$a=b.start+b.height}else if(b&&c){d=0;if(b.Xb-c.$a<2){d=2-(b.Xb-c.$a);c.Fk=g}b.setStart(b.Xb+d);b.$a=b.start+b.height}a++}b=this.bm.Kc();for(c=0;a=b[c];c++)a.Dj.K0(a.start)};
n.tu=function(a,b){if(a.Xb<b.Xb)return-1;else if(a.Xb>b.Xb)return 1;else if(a.Xb==b.Xb)if(a.left<b.left)return-1;else if(a.left>b.left)return 1;else if(r(a)==r(b))return 0;else if(r(a)<r(b))return-1;else if(r(a)>r(b))return 1};n.sC=function(a,b){var c=a.Dr||a.Xb,d=b.Dr||b.Xb,f=a.Cr||a.left,h=b.Cr||b.left;if(c<d)return-1;else if(c>d)return 1;else if(c==d)if(f<h)return-1;else if(f>h)return 1;else if(r(a)==r(b))return 0;else if(r(a)<r(b))return-1;else if(r(a)>r(b))return 1};
function cA(a){R.call(this,"bcipositionchange");this.ZX=a}w(cA,R);cA.prototype.uf=function(){return this.ZX};function dA(){R.call(this,"bcisizechange")}w(dA,R);function eA(){this.Z4=u(this.mN,this);this.Jv=new eb.x3;this.Jv.n5=j;this.UG=this.Jv.o5=j}eA.prototype.f0=function(a){if(a!=this.UG){if(!a)this.M4="";this.UG=a}};
eA.prototype.mN=function(a){var b=this.Jv.q4(a);if(window.console&&window.console.firebug)switch(a.u4()){case eb.xt.wt.r3:window.console.info(b);break;case eb.xt.wt.q3:window.console.error(b);break;case eb.xt.wt.C3:window.console.warn(b);break;default:window.console.debug(b);break}else if(window.console)window.console.log(b);else window.opera&&window.opera.postError(b)};var fA=i;function gA(){fA||(fA=new eA);window.location.href.indexOf("Debug=true")!=-1&&fA.f0(g)};var hA={};o("_setFlag",function(a,b){hA[a]=b},void 0);var iA,jA="Debug",kA=0;if(jA.charAt(0)=="!"){jA=jA.substring(1);kA=1}iA=!!(kA^(hA[jA]||window.location.search&&window.location.search.match(jA+"=true")!=i?1:0));function lA(a){i.o4(a);return g}o("_initConsole",function(a){if(a)iA=a;if(iA){i.k5(eb.xt.wt.Q2);window.console&&gA()}lA("Debug console initialized")},void 0);function mA(){this.Ln=[]}w(mA,ag);
function nA(a){switch(a){case 1:return"create_presentation";case 2:return"edit_presentation";case 3:return"edit_page";case 4:return"view_presentation";case 5:return"view_page";case 6:return"update_presentation";case 7:return"create_slide";case 8:return"edit_slide";case 9:return"view_slide";case 10:return"update_slide";case 11:return"show_edit_tab";case 12:return"show_revlist_tab";case 13:return"show_share_tab";case 14:return"show_publish_tab";case 15:return"load_parse_edit_css";case 16:return"load_parse_edit_js";
case 17:return"init_edit_app";case 18:return"load_parse_view_css";case 19:return"load_parse_view_js";case 20:return"init_view_app";case 21:return"load_muc";case 22:return"load_urchin";case 23:return"load_parse_embed_css";case 24:return"load_parse_embed_js";case 25:return"init_embed_app";case 26:return"embed_page";case 27:return"embed_slide";case 28:return"update_print_dialog";case 29:return"publish_presentation";case 30:return"update_sharees";case 31:return"search_videos";case 32:return"insert_videos";
case 33:return"change_theme";case 34:return"load_revision";case 35:return"revert_to_revision";case 36:return"open_speaker_notes";case 37:return"close_speaker_notes";case 38:return"delete_slides";case 39:return"duplicate_slides";case 40:return"nudge_shapes";case 41:return"resize_shapes";case 42:return"move_shapes";case 43:return"edit_from_doclist";case 44:return"view_from_doclist";case 45:return"view_from_editor";case 46:return"create_from_doclist";case 47:return"create_from_editor";case 48:return"create_from_template";
case 49:return"shift_click_object";case 50:return"cross_deck_paste";case 51:return"table_add_row";case 52:return"table_add_column";case 53:return"table_delete_row";case 54:return"table_delete_column";case 55:return"create_slide_from_template";case 56:return"insert_shape";case 57:return"import_slides_load_presentation_list";case 58:return"import_slides_select_presentation";case 59:return"import_slides";case 60:return"move_slides_prepare";case 61:return"move_slides_first_significant_drag";case 62:return"move_slides_drop";
case 63:return"duplicate_slides_drop";case 64:return"view_from_editor_click_to_start_load";case 65:return"init_view_construct_viewer";case 66:return"init_edit_construct_editor";case 67:return"init_edit_create_editor";case 68:return"init_edit_deferred_load_callback";case 69:return"init_view_deferred_load_callback";case 70:return"load_chunk";case 71:return"load_all_chunks";case 72:return"view_presentation_tb_measured";case 73:return"edit_or_create_presentation_tb_measured";default:return"unknown_"+
a}}mA.prototype.Ln=i;mA.prototype.start=function(a,b){if(a&&this.Ln.length<100){var c={};c.uC=a;c.s=v();if(typeof b!="undefined")c.eS=b;this.Ln.push(c)}};mA.prototype.$a=function(a,b){if(a){var c=Ub(this.Ln,function(f){return"s"in f&&f.uC==a},this);if(c&&c.s>0){c.uC=a+2E3;var d=v()-c.s;delete c.s;c.cT=d;if(typeof b!="undefined")c.eS=b;lA(nA(a)+": "+d+"ms")}}};(function(a,b){a.prototype.k=function(){a.c.k.call(this);for(var c in b)if(this[c]){b[c]!=0&&bg(this[c]);delete this[c]}}})(mA,{Ln:1});function Rx(a){this.qu=new oy(this);(this.lx=a)&&this.yJ(j)}n=Rx.prototype;n.ZE=function(){var a=O("publishOutside");return a?!a.checked:i};
n.wy=function(a,b){Zg();document.body.style.cursor="wait";this.yJ(g);b=b||u(this.qu.EJ,this.qu);function c(k){document.body.style.cursor="default";$g();if(k&&!th(k)){Vd("ispublished",a);b()}}var d=Hd(),f={id:d,on:a},h=this.ZE();if(h!=i)f.anyoneParam=h;if(window.location.pathname.indexOf("/present/")==-1)bh("publish_public",f,u(c,this),"publish_public"+d);else{f.POST_TOKEN=G("posttoken");d=Sc(f);yo(Ao("toggle-publish"),u(c,this),"POST",d)}};
n.g2=function(){var a=Sd("ispublished")||Ld("This document is not yet published. Publish it now?"),b=O("autoRepublish").checked;a?this.wy(g,u(this.iv,this,b,"auto_republish")):this.iv(b,"auto_republish")};n.t2=function(){!Sd("ispublished")&&Ld("This document is not yet published. Publish it now?")?this.wy(g):this.iv(!this.ZE(),"disallow_public_access")};
n.iv=function(a,b){Zg();document.body.style.cursor="wait";function c(f){document.body.style.cursor="default";$g();f&&!th(f)&&this.qu.EJ()}var d=Hd();a={id:d,type:b,on:a};if(this.lx){a.POST_TOKEN=G("posttoken");d=Sc(a);yo(Ao("publish-settings"),u(c,this),"POST",d)}else bh("set_sharing_option",a,u(c,this),"set_sharing_option"+d)};
n.yJ=function(a){if(this.lx)window.parent.editor&&typeof window.parent.editor.recordLatencyStat=="function"&&window.parent.editor.recordLatencyStat(a,29);else a?lj("publish"):Fi("publish")};n.NA=function(){var a=O("pubWhen"),b=O("blogPubWhen");if(a){var c=Number(a.getAttribute("publishDate"));c="Published on "+Di(c);kf(a,c)}if(b){a=Number(b.getAttribute("publishDate"));a="Posted on "+Di(a);kf(b,a)}};o("writely.Publish",Rx,void 0);Rx.prototype.publish=Rx.prototype.wy;
Rx.prototype.updateAutoRepublish=Rx.prototype.g2;Rx.prototype.updatePublicAccess=Rx.prototype.t2;Rx.prototype.writePublishDates=Rx.prototype.NA;function oA(a,b,c,d){a=[a];if(b&&b!=3){a.push("&interval=");a.push(b)}c&&a.push("&autoStart=true");d&&a.push("&loop=true");return a.join("")}o("_getPublishedUrl",oA,void 0);var pA={l:[700,559],m:[555,451],s:[410,342]};o("_getEmbeddedHtml",function(a,b,c,d,f,h){a=oA(a,d,f,h);d=pA[c||"s"];return"<iframe "+(b?'id="'+b+'" ':"")+'src="'+encodeURI(c&&c!="s"?a+"&size="+c:a)+'" frameborder="0" width="'+d[0]+'" height="'+d[1]+'"></iframe>'},void 0);
